<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Base - ebcc</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Base";
        var mkdocs_page_input_path = "reference/cc/base.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> ebcc
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../features/">Features</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Code Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >Coupled cluster</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../rebcc/">Restricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../uebcc/">Unrestricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../gebcc/">Generalised</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Base</a>
    <ul class="current">
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Equation of motion</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/reom/">Restricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/ueom/">Unrestricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/geom/">Generalised</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/base/">Base</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Orbital optimisation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Brueckner</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../opt/rbrueckner/">Restricted</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../opt/ubrueckner/">Unrestricted</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../opt/gbrueckner/">Generalised</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../opt/base/">Base</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../core/ansatz/">Ansatz</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../core/damping/">Damping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../core/dump/">Dumping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../core/logging/">Logging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../core/precision/">Precision</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Hamiltonian</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/space/">Space</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/fock/">Fock</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/eris/">ERIs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/cderis/">CDERIs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/elbos/">Bosonic</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/base/">Base</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Utility</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../util/permutations/">Permutations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../util/einsumfunc/">Einstein summations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../util/misc/">Miscellaneous</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">ebcc</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Code Reference</li>
          <li class="breadcrumb-item">Coupled cluster</li>
      <li class="breadcrumb-item active">Base</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="ebcc.cc.base"></a>
    <div class="doc doc-contents first">

        <p>Base classes for <code>ebcc.cc</code>.</p>








  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="ebcc.cc.base.T" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.T = floating</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Defines the type for the <code>eris</code> argument in functions.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ebcc.cc.base.ERIsInputType" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.ERIsInputType = Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Defines the type for arrays, including spin labels.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="ebcc.cc.base.SpinArrayType" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.SpinArrayType = Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Defines the type for the spaces, including spin labels.</p>
    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="ebcc.cc.base.BaseOptions" class="doc doc-heading">
              <code class="highlight language-python">ebcc.cc.base.BaseOptions(e_tol=1e-08, t_tol=1e-08, max_iter=200, diis_space=9, diis_min_space=1, damping=0.0, shift=True)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ebcc.util._BaseOptions">_BaseOptions</span></code></p>


        <p>Options for EBCC calculations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>e_tol</code></b>
                  (<code>float</code>, default:
                      <code>1e-08</code>
)
              –
              <div class="doc-md-description">
                <p>Threshold for convergence in the correlation energy.</p>
              </div>
            </li>
            <li>
              <b><code>t_tol</code></b>
                  (<code>float</code>, default:
                      <code>1e-08</code>
)
              –
              <div class="doc-md-description">
                <p>Threshold for convergence in the amplitude norm.</p>
              </div>
            </li>
            <li>
              <b><code>max_iter</code></b>
                  (<code>int</code>, default:
                      <code>200</code>
)
              –
              <div class="doc-md-description">
                <p>Maximum number of iterations.</p>
              </div>
            </li>
            <li>
              <b><code>diis_space</code></b>
                  (<code>int</code>, default:
                      <code>9</code>
)
              –
              <div class="doc-md-description">
                <p>Number of amplitudes to use in DIIS extrapolation.</p>
              </div>
            </li>
            <li>
              <b><code>diis_min_space</code></b>
                  (<code>int</code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>Minimum number of amplitudes to use in DIIS extrapolation.</p>
              </div>
            </li>
            <li>
              <b><code>damping</code></b>
                  (<code>float</code>, default:
                      <code>0.0</code>
)
              –
              <div class="doc-md-description">
                <p>Damping factor for DIIS extrapolation.</p>
              </div>
            </li>
            <li>
              <b><code>shift</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Shift the boson operators such that the Hamiltonian is normal-ordered with respect
to a coherent state. This removes the bosonic coupling to the static mean-field
density, introducing a constant energy shift.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="ebcc.cc.base.BaseEBCC" class="doc doc-heading">
              <code class="highlight language-python">ebcc.cc.base.BaseEBCC(mf, log=None, ansatz='CCSD', options=None, space=None, omega=None, g=None, G=None, mo_coeff=None, mo_occ=None, fock=None, **kwargs)</code>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for electron-boson coupled cluster.</p>

        <p>Initialise the EBCC object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>mf</code></b>
                  (<code><span title="pyscf.scf.hf.SCF">SCF</span></code>)
              –
              <div class="doc-md-description">
                <p>PySCF mean-field object.</p>
              </div>
            </li>
            <li>
              <b><code>log</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.core.logging.Logger" href="../../core/logging/#ebcc.core.logging.Logger">Logger</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Log to write output to. Default is the global logger, outputting to <code>stderr</code>.</p>
              </div>
            </li>
            <li>
              <b><code>ansatz</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="ebcc.core.ansatz.Ansatz" href="../../core/ansatz/#ebcc.core.ansatz.Ansatz">Ansatz</a>, str]]</code>, default:
                      <code>&#39;CCSD&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Overall ansatz.</p>
              </div>
            </li>
            <li>
              <b><code>options</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.BaseOptions" href="#ebcc.cc.base.BaseOptions">BaseOptions</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Options for the EBCC calculation.</p>
              </div>
            </li>
            <li>
              <b><code>space</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="ebcc.cc.base.SpaceType">SpaceType</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Space containing the frozen, correlated, and active fermionic spaces. Default
assumes all electrons are correlated.</p>
              </div>
            </li>
            <li>
              <b><code>omega</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Bosonic frequencies.</p>
              </div>
            </li>
            <li>
              <b><code>g</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron-boson coupling matrix corresponding to the bosonic annihilation operator
:math:<code>g_{bpq} p^\dagger q b</code>. The creation part is assumed to be the fermionic
conjugate transpose to retain Hermiticity in the Hamiltonian.</p>
              </div>
            </li>
            <li>
              <b><code>G</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Boson non-conserving term :math:<code>G_{b} (b^\dagger + b)</code>.</p>
              </div>
            </li>
            <li>
              <b><code>mo_coeff</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Molecular orbital coefficients. Default is the mean-field coefficients.</p>
              </div>
            </li>
            <li>
              <b><code>mo_occ</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Molecular orbital occupation numbers. Default is the mean-field occupation.</p>
              </div>
            </li>
            <li>
              <b><code>fock</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.ham.base.BaseFock" href="../../ham/base/#ebcc.ham.base.BaseFock">BaseFock</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Fock matrix. Default is the mean-field Fock matrix.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments used to update <code>options</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>





                  <details class="quote">
                    <summary>Source code in <code>ebcc/cc/base.py</code></summary>
                    <pre class="highlight"><code class="language-python">def __init__(
    self,
    mf: SCF,
    log: Optional[Logger] = None,
    ansatz: Optional[Union[Ansatz, str]] = "CCSD",
    options: Optional[BaseOptions] = None,
    space: Optional[SpaceType] = None,
    omega: Optional[NDArray[T]] = None,
    g: Optional[NDArray[T]] = None,
    G: Optional[NDArray[T]] = None,
    mo_coeff: Optional[NDArray[T]] = None,
    mo_occ: Optional[NDArray[T]] = None,
    fock: Optional[BaseFock] = None,
    **kwargs: Any,
) -&gt; None:
    r"""Initialise the EBCC object.

    Args:
        mf: PySCF mean-field object.
        log: Log to write output to. Default is the global logger, outputting to `stderr`.
        ansatz: Overall ansatz.
        options: Options for the EBCC calculation.
        space: Space containing the frozen, correlated, and active fermionic spaces. Default
            assumes all electrons are correlated.
        omega: Bosonic frequencies.
        g: Electron-boson coupling matrix corresponding to the bosonic annihilation operator
            :math:`g_{bpq} p^\dagger q b`. The creation part is assumed to be the fermionic
            conjugate transpose to retain Hermiticity in the Hamiltonian.
        G: Boson non-conserving term :math:`G_{b} (b^\dagger + b)`.
        mo_coeff: Molecular orbital coefficients. Default is the mean-field coefficients.
        mo_occ: Molecular orbital occupation numbers. Default is the mean-field occupation.
        fock: Fock matrix. Default is the mean-field Fock matrix.
        **kwargs: Additional keyword arguments used to update `options`.
    """
    # Options:
    if options is None:
        options = self.Options()
    self.options = options
    for key, val in kwargs.items():
        setattr(self.options, key, val)

    # Parameters:
    self.log = default_log if log is None else log
    self.mf = self._convert_mf(mf)
    self._mo_coeff: Optional[NDArray[T]] = (
        np.asarray(mo_coeff, dtype=types[float]) if mo_coeff is not None else None
    )
    self._mo_occ: Optional[NDArray[T]] = (
        np.asarray(mo_occ, dtype=types[float]) if mo_occ is not None else None
    )

    # Ansatz:
    if isinstance(ansatz, Ansatz):
        self.ansatz = ansatz
    elif isinstance(ansatz, str):
        self.ansatz = Ansatz.from_string(
            ansatz, density_fitting=getattr(self.mf, "with_df", None) is not None
        )
    else:
        raise TypeError("ansatz must be an Ansatz object or a string.")
    self._eqns = self.ansatz._get_eqns(self.spin_type)

    # Space:
    if space is not None:
        self.space = space
    else:
        self.space = self.init_space()

    # Boson parameters:
    if bool(self.fermion_coupling_rank) != bool(self.boson_coupling_rank):
        raise ValueError(
            "Fermionic and bosonic coupling ranks must both be zero, or both non-zero."
        )
    self.omega = np.asarray(omega, dtype=types[float]) if omega is not None else None
    self.bare_g = np.asarray(g, dtype=types[float]) if g is not None else None
    self.bare_G = np.asarray(G, dtype=types[float]) if G is not None else None
    if self.boson_ansatz != "":
        self.g = self.get_g()
        self.G = self.get_mean_field_G()
    else:
        assert self.nbos == 0
        self.options.shift = False
        self.g = None
        self.G = None

    # Fock matrix:
    if fock is None:
        self.fock = self.get_fock()
    else:
        self.fock = fock

    # Attributes:
    self.e_corr = 0.0
    self.amplitudes = util.Namespace()
    self.converged = False
    self.lambdas = util.Namespace()
    self.converged_lambda = False

    # Logging:
    init_logging(self.log)
    self.log.info(f"\n{ANSI.B}{ANSI.U}{self.name}{ANSI.R}")
    self.log.debug(f"{ANSI.B}{'*' * len(self.name)}{ANSI.R}")
    self.log.debug("")
    self.log.info(f"{ANSI.B}Options{ANSI.R}:")
    self.log.info(f" &gt; e_tol:  {ANSI.y}{self.options.e_tol}{ANSI.R}")
    self.log.info(f" &gt; t_tol:  {ANSI.y}{self.options.t_tol}{ANSI.R}")
    self.log.info(f" &gt; max_iter:  {ANSI.y}{self.options.max_iter}{ANSI.R}")
    self.log.info(f" &gt; diis_space:  {ANSI.y}{self.options.diis_space}{ANSI.R}")
    self.log.info(f" &gt; diis_min_space:  {ANSI.y}{self.options.diis_min_space}{ANSI.R}")
    self.log.info(f" &gt; damping:  {ANSI.y}{self.options.damping}{ANSI.R}")
    self.log.debug("")
    self.log.info(f"{ANSI.B}Ansatz{ANSI.R}: {ANSI.m}{self.ansatz}{ANSI.R}")
    self.log.debug("")
    self.log.info(f"{ANSI.B}Space{ANSI.R}: {ANSI.m}{self.space}{ANSI.R}")
    self.log.debug("")
    if self.boson_ansatz != "":
        self.log.info(f"{ANSI.B}Bosons{ANSI.R}: {ANSI.m}{self.nbos}{ANSI.R}")
        self.log.info(" &gt; Energy shift due to polaritonic basis:  %.10f", self.const)
        self.log.debug("")</code></pre>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.spin_type" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.spin_type: str</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a string representation of the spin type.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.name" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.name: str</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of the method.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.fermion_ansatz" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.fermion_ansatz: str</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a string representation of the fermion ansatz.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.boson_ansatz" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.boson_ansatz: str</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a string representation of the boson ansatz.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.fermion_coupling_rank" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.fermion_coupling_rank: int</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get an integer representation of the fermion coupling rank.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.boson_coupling_rank" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.boson_coupling_rank: int</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get an integer representation of the boson coupling rank.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.xi" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.xi: NDArray[T]</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the shift in the bosonic operators to diagonalise the photon Hamiltonian.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>Shift in the bosonic operators.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.const" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.const: float</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the shift in energy from moving to the polaritonic basis.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Constant energy shift due to the polaritonic basis.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.mo_coeff" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.mo_coeff: NDArray[T]</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the molecular orbital coefficients.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>Molecular orbital coefficients.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.mo_occ" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.mo_occ: NDArray[T]</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the molecular orbital occupation numbers.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>Molecular orbital occupation numbers.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.nmo" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.nmo: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the number of molecular orbitals.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>Number of molecular orbitals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.nocc" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.nocc: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the number of occupied molecular orbitals.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>Number of occupied molecular orbitals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.nvir" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.nvir: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the number of virtual molecular orbitals.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>Number of virtual molecular orbitals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.nbos" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.nbos: int</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the number of bosonic modes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>int</code>
              –
              <div class="doc-md-description">
                <p>Number of bosonic modes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.e_tot" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.e_tot: float</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the total energy (mean-field plus correlation).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Total energy.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.t1" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.t1: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the T1 amplitudes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.t2" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.t2: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the T2 amplitudes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.t3" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.t3: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the T3 amplitudes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.l1" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.l1: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the L1 amplitudes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.l2" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.l2: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the L2 amplitudes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="ebcc.cc.base.BaseEBCC.l3" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.l3: Any</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the L3 amplitudes.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.kernel" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.kernel(eris=None)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Run the coupled cluster calculation.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Correlation energy.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def kernel(self, eris: Optional[ERIsInputType] = None) -&gt; float:
    """Run the coupled cluster calculation.

    Args:
        eris: Electron repulsion integrals.

    Returns:
        Correlation energy.
    """
    timer = util.Timer()

    # Get the ERIs:
    eris = self.get_eris(eris)

    # Get the amplitude guesses:
    amplitudes = self.amplitudes
    if not amplitudes:
        amplitudes = self.init_amps(eris=eris)

    # Get the initial energy:
    e_cc = self.energy(amplitudes=amplitudes, eris=eris)

    self.log.output("Solving for excitation amplitudes.")
    self.log.debug("")
    self.log.info(
        f"{ANSI.B}{'Iter':&gt;4s} {'Energy (corr.)':&gt;16s} {'Energy (tot.)':&gt;18s} "
        f"{'Δ(Energy)':&gt;13s} {'Δ(Ampl.)':&gt;13s}{ANSI.R}"
    )
    self.log.info("%4d %16.10f %18.10f", 0, e_cc, e_cc + self.mf.e_tot)

    if not self.ansatz.is_one_shot:
        # Set up damping:
        damping = self.Damping(options=self.options)

        converged = False
        for niter in range(1, self.options.max_iter + 1):
            # Update the amplitudes, extrapolate with DIIS and calculate change:
            amplitudes_prev = amplitudes
            amplitudes = self.update_amps(amplitudes=amplitudes, eris=eris)
            vector = self.amplitudes_to_vector(amplitudes)
            vector = damping(vector)
            amplitudes = self.vector_to_amplitudes(vector)
            dt = np.linalg.norm(
                np.abs(vector - self.amplitudes_to_vector(amplitudes_prev)), ord=np.inf
            )

            # Update the energy and calculate change:
            e_prev = e_cc
            e_cc = self.energy(amplitudes=amplitudes, eris=eris)
            de = abs(e_prev - e_cc)

            # Log the iteration:
            converged_e = bool(de &lt; self.options.e_tol)
            converged_t = bool(dt &lt; self.options.t_tol)
            self.log.info(
                f"%4d %16.10f %18.10f {[ANSI.r, ANSI.g][int(converged_e)]}%13.3e{ANSI.R}"
                f" {[ANSI.r, ANSI.g][int(converged_t)]}%13.3e{ANSI.R}",
                niter,
                e_cc,
                e_cc + self.mf.e_tot,
                de,
                dt,
            )

            # Check for convergence:
            converged = converged_e and converged_t
            if converged:
                self.log.debug("")
                self.log.output(f"{ANSI.g}Converged{ANSI.R}.")
                break
        else:
            self.log.debug("")
            self.log.warning(f"{ANSI.r}Failed to converge{ANSI.R}.")

        # Include perturbative correction if required:
        if self.ansatz.has_perturbative_correction:
            self.log.debug("")
            self.log.info("Computing perturbative energy correction.")
            e_pert = self.energy_perturbative(amplitudes=amplitudes, eris=eris)
            e_cc += e_pert
            self.log.info("E(pert) = %.10f", e_pert)

    else:
        converged = True

    # Update attributes:
    self.e_corr = e_cc
    self.amplitudes = amplitudes
    self.converged = converged

    self.log.debug("")
    self.log.output("E(corr) = %.10f", self.e_corr)
    self.log.output("E(tot)  = %.10f", self.e_corr + self.mf.e_tot)
    self.log.debug("")
    self.log.debug("Time elapsed: %s", timer.format_time(timer()))
    self.log.debug("")

    return e_cc</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.solve_lambda" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.solve_lambda(amplitudes=None, eris=None)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Solve for the lambda amplitudes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def solve_lambda(
    self,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    eris: Optional[ERIsInputType] = None,
) -&gt; None:
    """Solve for the lambda amplitudes.

    Args:
        amplitudes: Cluster amplitudes.
        eris: Electron repulsion integrals.
    """
    timer = util.Timer()

    # Get the ERIs:
    eris = self.get_eris(eris)

    # Get the amplitudes:
    amplitudes = self.amplitudes
    if not amplitudes:
        amplitudes = self.init_amps(eris=eris)

    # If needed, get the perturbative part of the lambda amplitudes:
    lambdas_pert = None
    if self.ansatz.has_perturbative_correction:
        lambdas_pert = self.update_lams(eris=eris, amplitudes=amplitudes, perturbative=True)

    # Get the initial lambda amplitudes:
    lambdas = self.lambdas
    if not lambdas:
        lambdas = self.init_lams(amplitudes=amplitudes)

    self.log.output("Solving for de-excitation (lambda) amplitudes.")
    self.log.debug("")
    self.log.info(f"{ANSI.B}{'Iter':&gt;4s} {'Δ(Ampl.)':&gt;13s}{ANSI.R}")

    # Set up damping:
    damping = self.Damping(options=self.options)

    converged = False
    for niter in range(1, self.options.max_iter + 1):
        # Update the lambda amplitudes, extrapolate with DIIS and calculate change:
        lambdas_prev = lambdas
        lambdas = self.update_lams(
            amplitudes=amplitudes,
            lambdas=lambdas,
            lambdas_pert=lambdas_pert,
            eris=eris,
        )
        vector = self.lambdas_to_vector(lambdas)
        vector = damping(vector)
        lambdas = self.vector_to_lambdas(vector)
        dl = np.linalg.norm(np.abs(vector - self.lambdas_to_vector(lambdas_prev)), ord=np.inf)

        # Log the iteration:
        converged = bool(dl &lt; self.options.t_tol)
        self.log.info(f"%4d {[ANSI.r, ANSI.g][int(converged)]}%13.3e{ANSI.R}", niter, dl)

        # Check for convergence:
        if converged:
            self.log.debug("")
            self.log.output(f"{ANSI.g}Converged{ANSI.R}.")
            break
    else:
        self.log.debug("")
        self.log.warning(f"{ANSI.r}Failed to converge{ANSI.R}.")

    self.log.debug("")
    self.log.debug("Time elapsed: %s", timer.format_time(timer()))
    self.log.debug("")
    self.log.debug("")

    # Update attributes:
    self.lambdas = lambdas
    self.converged_lambda = converged</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.ip_eom" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.ip_eom(**kwargs)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the IP-EOM object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>IP-EOM object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def ip_eom(self, **kwargs: Any) -&gt; Any:
    """Get the IP-EOM object.

    Args:
        **kwargs: Additional keyword arguments.

    Returns:
        IP-EOM object.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.ea_eom" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.ea_eom(**kwargs)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the EA-EOM object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>EA-EOM object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def ea_eom(self, **kwargs: Any) -&gt; Any:
    """Get the EA-EOM object.

    Args:
        **kwargs: Additional keyword arguments.

    Returns:
        EA-EOM object.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.ee_eom" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.ee_eom(**kwargs)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the EE-EOM object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>EE-EOM object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def ee_eom(self, **kwargs: Any) -&gt; Any:
    """Get the EE-EOM object.

    Args:
        **kwargs: Additional keyword arguments.

    Returns:
        EE-EOM object.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.brueckner" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.brueckner(*args, **kwargs)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Run a Brueckner orbital coupled cluster calculation.</p>
<p>The coupled cluster object will be updated in-place.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>*args</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>Arguments to pass to the Brueckner object.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the Brueckner object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Correlation energy.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def brueckner(self, *args: Any, **kwargs: Any) -&gt; float:
    """Run a Brueckner orbital coupled cluster calculation.

    The coupled cluster object will be updated in-place.

    Args:
        *args: Arguments to pass to the Brueckner object.
        **kwargs: Keyword arguments to pass to the Brueckner object.

    Returns:
        Correlation energy.
    """
    bcc = self.Brueckner(self, *args, **kwargs)
    return bcc.kernel()</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.external_correction" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.external_correction(*args, **kwargs)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Run an externally corrected coupled cluster calculation.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>*args</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>Arguments to pass to the external correction object.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the external correction object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Correlation energy.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def external_correction(self, *args: Any, **kwargs: Any) -&gt; float:
    """Run an externally corrected coupled cluster calculation.

    Args:
        *args: Arguments to pass to the external correction object.
        **kwargs: Keyword arguments to pass to the external correction object.

    Returns:
        Correlation energy.
    """
    with self.ExternalCorrection(self, *args, **kwargs):
        return self.kernel()</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.tailor" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.tailor(*args, **kwargs)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Run a tailored coupled cluster calculation.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>*args</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>Arguments to pass to the tailored object.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="typing.Any">Any</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the tailored object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Correlation energy.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def tailor(self, *args: Any, **kwargs: Any) -&gt; float:
    """Run a tailored coupled cluster calculation.

    Args:
        *args: Arguments to pass to the tailored object.
        **kwargs: Keyword arguments to pass to the tailored object.

    Returns:
        Correlation energy.
    """
    with self.Tailor(self, *args, **kwargs):
        return self.kernel()</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.write" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.write(file)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Write the EBCC object to a file.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>File to write the object to.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def write(self, file: str) -&gt; None:
    """Write the EBCC object to a file.

    Args:
        file: File to write the object to.
    """
    writer = Dump(file)
    writer.write(self)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.read" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.read(file, log=None)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Read the EBCC object from a file.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>file</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>File to read the object from.</p>
              </div>
            </li>
            <li>
              <b><code>log</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.core.logging.Logger" href="../../core/logging/#ebcc.core.logging.Logger">Logger</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Logger to use for new object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.cc.base.BaseEBCC" href="#ebcc.cc.base.BaseEBCC">BaseEBCC</a></code>
              –
              <div class="doc-md-description">
                <p>EBCC object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@classmethod
def read(cls, file: str, log: Optional[Logger] = None) -&gt; BaseEBCC:
    """Read the EBCC object from a file.

    Args:
        file: File to read the object from.
        log: Logger to use for new object.

    Returns:
        EBCC object.
    """
    reader = Dump(file)
    return reader.read(cls=cls, log=log)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.init_amps" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.init_amps(eris=None)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Initialise the cluster amplitudes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>
              –
              <div class="doc-md-description">
                <p>Initial cluster amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def init_amps(self, eris: Optional[ERIsInputType] = None) -&gt; Namespace[SpinArrayType]:
    """Initialise the cluster amplitudes.

    Args:
        eris: Electron repulsion integrals.

    Returns:
        Initial cluster amplitudes.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.init_lams" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.init_lams(amplitudes=None)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Initialise the cluster lambda amplitudes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>
              –
              <div class="doc-md-description">
                <p>Initial cluster lambda amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def init_lams(
    self, amplitudes: Optional[Namespace[SpinArrayType]] = None
) -&gt; Namespace[SpinArrayType]:
    """Initialise the cluster lambda amplitudes.

    Args:
        amplitudes: Cluster amplitudes.

    Returns:
        Initial cluster lambda amplitudes.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.energy" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.energy(eris=None, amplitudes=None)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the correlation energy.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Correlation energy.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def energy(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
) -&gt; float:
    """Calculate the correlation energy.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.

    Returns:
        Correlation energy.
    """
    func, kwargs = self._load_function(
        "energy",
        eris=eris,
        amplitudes=amplitudes,
    )
    res: float = np.real(ensure_scalar(func(**kwargs)))
    return astype(res, float)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.energy_perturbative" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.energy_perturbative(eris=None, amplitudes=None, lambdas=None)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the perturbative correction to the correlation energy.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Perturbative energy correction.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def energy_perturbative(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    lambdas: Optional[Namespace[SpinArrayType]] = None,
) -&gt; float:
    """Calculate the perturbative correction to the correlation energy.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.
        lambdas: Cluster lambda amplitudes.

    Returns:
        Perturbative energy correction.
    """
    func, kwargs = self._load_function(
        "energy_perturbative",
        eris=eris,
        amplitudes=amplitudes,
        lambdas=lambdas,
    )
    res: float = np.real(ensure_scalar(func(**kwargs)))
    return res</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.update_amps" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.update_amps(eris=None, amplitudes=None)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Update the cluster amplitudes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>
              –
              <div class="doc-md-description">
                <p>Updated cluster amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def update_amps(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
) -&gt; Namespace[SpinArrayType]:
    """Update the cluster amplitudes.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.

    Returns:
        Updated cluster amplitudes.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.update_lams" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.update_lams(eris=None, amplitudes=None, lambdas=None, lambdas_pert=None, perturbative=False)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Update the cluster lambda amplitudes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas_pert</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Perturbative cluster lambda amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>perturbative</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Flag to include perturbative correction.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>
              –
              <div class="doc-md-description">
                <p>Updated cluster lambda amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def update_lams(
    self,
    eris: ERIsInputType = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    lambdas: Optional[Namespace[SpinArrayType]] = None,
    lambdas_pert: Optional[Namespace[SpinArrayType]] = None,
    perturbative: bool = False,
) -&gt; Namespace[SpinArrayType]:
    """Update the cluster lambda amplitudes.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.
        lambdas: Cluster lambda amplitudes.
        lambdas_pert: Perturbative cluster lambda amplitudes.
        perturbative: Flag to include perturbative correction.

    Returns:
        Updated cluster lambda amplitudes.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.make_sing_b_dm" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.make_sing_b_dm(eris=None, amplitudes=None, lambdas=None)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Make the single boson density matrix :math:<code>\langle b \rangle</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>Single boson density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def make_sing_b_dm(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    lambdas: Optional[Namespace[SpinArrayType]] = None,
) -&gt; NDArray[T]:
    r"""Make the single boson density matrix :math:`\langle b \rangle`.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.
        lambdas: Cluster lambda amplitudes.

    Returns:
        Single boson density matrix.
    """
    func, kwargs = self._load_function(
        "make_sing_b_dm",
        eris=eris,
        amplitudes=amplitudes,
        lambdas=lambdas,
    )
    res: NDArray[T] = func(**kwargs)
    return res</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.make_rdm1_b" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.make_rdm1_b(eris=None, amplitudes=None, lambdas=None, unshifted=True, hermitise=True)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Make the one-particle boson reduced density matrix :math:<code>\langle b^+ c \rangle</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>unshifted</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>If <code>self.options.shift</code> is <code>True</code>, return the unshifted density matrix. Has
no effect if <code>self.options.shift</code> is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>hermitise</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Hermitise the density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>One-particle boson reduced density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def make_rdm1_b(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    lambdas: Optional[Namespace[SpinArrayType]] = None,
    unshifted: bool = True,
    hermitise: bool = True,
) -&gt; NDArray[T]:
    r"""Make the one-particle boson reduced density matrix :math:`\langle b^+ c \rangle`.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.
        lambdas: Cluster lambda amplitudes.
        unshifted: If `self.options.shift` is `True`, return the unshifted density matrix. Has
            no effect if `self.options.shift` is `False`.
        hermitise: Hermitise the density matrix.

    Returns:
        One-particle boson reduced density matrix.
    """
    func, kwargs = self._load_function(
        "make_rdm1_b",
        eris=eris,
        amplitudes=amplitudes,
        lambdas=lambdas,
    )
    dm: NDArray[T] = func(**kwargs)

    if hermitise:
        dm = (dm + np.transpose(dm)) * 0.5

    if unshifted and self.options.shift:
        xi = self.xi
        dm_b = util.einsum("ni-&gt;i", self.make_sing_b_dm())
        dm -= util.einsum("ij,i-&gt;ij", np.eye(dm.shape[0]), xi * dm_b - xi**2.0)

    return dm</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.make_rdm1_f" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.make_rdm1_f(eris=None, amplitudes=None, lambdas=None, hermitise=True)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Make the one-particle fermionic reduced density matrix :math:<code>\langle i^+ j \rangle</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>hermitise</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Hermitise the density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>One-particle fermion reduced density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def make_rdm1_f(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    lambdas: Optional[Namespace[SpinArrayType]] = None,
    hermitise: bool = True,
) -&gt; Any:
    r"""Make the one-particle fermionic reduced density matrix :math:`\langle i^+ j \rangle`.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.
        lambdas: Cluster lambda amplitudes.
        hermitise: Hermitise the density matrix.

    Returns:
        One-particle fermion reduced density matrix.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.make_rdm2_f" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.make_rdm2_f(eris=None, amplitudes=None, lambdas=None, hermitise=True)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Make the two-particle fermionic reduced density matrix :math:<code>\langle i^+j^+lk \rangle</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>hermitise</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Hermitise the density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>Two-particle fermion reduced density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def make_rdm2_f(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    lambdas: Optional[Namespace[SpinArrayType]] = None,
    hermitise: bool = True,
) -&gt; Any:
    r"""Make the two-particle fermionic reduced density matrix :math:`\langle i^+j^+lk \rangle`.

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.
        lambdas: Cluster lambda amplitudes.
        hermitise: Hermitise the density matrix.

    Returns:
        Two-particle fermion reduced density matrix.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.make_eb_coup_rdm" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.make_eb_coup_rdm(eris=None, amplitudes=None, lambdas=None, unshifted=True, hermitise=True)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Make the electron-boson coupling reduced density matrix.</p>
<p>.. math::
    \langle b^+ i^+ j \rangle</p>
<p>and</p>
<p>.. math::
    \langle b i^+ j \rangle</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
            <li>
              <b><code>amplitudes</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>lambdas</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
            <li>
              <b><code>unshifted</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>If <code>self.options.shift</code> is <code>True</code>, return the unshifted density matrix. Has
no effect if <code>self.options.shift</code> is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>hermitise</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Hermitise the density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>Electron-boson coupling reduced density matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def make_eb_coup_rdm(
    self,
    eris: Optional[ERIsInputType] = None,
    amplitudes: Optional[Namespace[SpinArrayType]] = None,
    lambdas: Optional[Namespace[SpinArrayType]] = None,
    unshifted: bool = True,
    hermitise: bool = True,
) -&gt; Any:
    r"""Make the electron-boson coupling reduced density matrix.

    .. math::
        \langle b^+ i^+ j \rangle

    and

    .. math::
        \langle b i^+ j \rangle

    Args:
        eris: Electron repulsion integrals.
        amplitudes: Cluster amplitudes.
        lambdas: Cluster lambda amplitudes.
        unshifted: If `self.options.shift` is `True`, return the unshifted density matrix. Has
            no effect if `self.options.shift` is `False`.
        hermitise: Hermitise the density matrix.

    Returns:
        Electron-boson coupling reduced density matrix.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.energy_sum" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.energy_sum(*args, signs_dict=None)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a direct sum of energies.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>*args</code></b>
                  (<code>str</code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>Energies to sum. Subclass should specify a subscript, and optionally spins.</p>
              </div>
            </li>
            <li>
              <b><code>signs_dict</code></b>
                  (<code><span title="typing.Optional">Optional</span>[dict[str, str]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Signs of the energies in the sum. Default sets <code>("o", "O", "i")</code> to be
positive, and <code>("v", "V", "a", "b")</code> to be negative.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>Sum of energies.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def energy_sum(self, *args: str, signs_dict: Optional[dict[str, str]] = None) -&gt; NDArray[T]:
    """Get a direct sum of energies.

    Args:
        *args: Energies to sum. Subclass should specify a subscript, and optionally spins.
        signs_dict: Signs of the energies in the sum. Default sets `("o", "O", "i")` to be
            positive, and `("v", "V", "a", "b")` to be negative.

    Returns:
        Sum of energies.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.amplitudes_to_vector" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.amplitudes_to_vector(amplitudes)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Construct a vector containing all of the amplitudes used in the given ansatz.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>amplitudes</code></b>
                  (<code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes as a vector.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def amplitudes_to_vector(self, amplitudes: Namespace[SpinArrayType]) -&gt; NDArray[T]:
    """Construct a vector containing all of the amplitudes used in the given ansatz.

    Args:
        amplitudes: Cluster amplitudes.

    Returns:
        Cluster amplitudes as a vector.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.vector_to_amplitudes" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.vector_to_amplitudes(vector)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Construct a namespace of amplitudes from a vector.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>vector</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>)
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes as a vector.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>
              –
              <div class="doc-md-description">
                <p>Cluster amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def vector_to_amplitudes(self, vector: NDArray[T]) -&gt; Namespace[SpinArrayType]:
    """Construct a namespace of amplitudes from a vector.

    Args:
        vector: Cluster amplitudes as a vector.

    Returns:
        Cluster amplitudes.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.lambdas_to_vector" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.lambdas_to_vector(lambdas)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Construct a vector containing all of the lambda amplitudes used in the given ansatz.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>lambdas</code></b>
                  (<code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes as a vector.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def lambdas_to_vector(self, lambdas: Namespace[SpinArrayType]) -&gt; NDArray[T]:
    """Construct a vector containing all of the lambda amplitudes used in the given ansatz.

    Args:
        lambdas: Cluster lambda amplitudes.

    Returns:
        Cluster lambda amplitudes as a vector.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.vector_to_lambdas" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.vector_to_lambdas(vector)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Construct a namespace of lambda amplitudes from a vector.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>vector</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.T" href="#ebcc.cc.base.T">T</a>]</code>)
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes as a vector.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.util.Namespace" href="../../util/misc/#ebcc.util.misc.Namespace">Namespace</a>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.SpinArrayType" href="#ebcc.cc.base.SpinArrayType">SpinArrayType</a>]</code>
              –
              <div class="doc-md-description">
                <p>Cluster lambda amplitudes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def vector_to_lambdas(self, vector: NDArray[T]) -&gt; Namespace[SpinArrayType]:
    """Construct a namespace of lambda amplitudes from a vector.

    Args:
        vector: Cluster lambda amplitudes as a vector.

    Returns:
        Cluster lambda amplitudes.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.init_space" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.init_space()</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Initialise the fermionic space.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ebcc.cc.base.SpaceType">SpaceType</span></code>
              –
              <div class="doc-md-description">
                <p>Fermionic space. All fermionic degrees of freedom are assumed to be correlated.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def init_space(self) -&gt; SpaceType:
    """Initialise the fermionic space.

    Returns:
        Fermionic space. All fermionic degrees of freedom are assumed to be correlated.
    """
    pass</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.get_fock" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.get_fock()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the Fock matrix.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.ham.base.BaseFock" href="../../ham/base/#ebcc.ham.base.BaseFock">BaseFock</a></code>
              –
              <div class="doc-md-description">
                <p>Fock matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def get_fock(self) -&gt; BaseFock:
    """Get the Fock matrix.

    Returns:
        Fock matrix.
    """
    return self.Fock(
        self.mf,
        space=(self.space, self.space),
        mo_coeff=(self.mo_coeff, self.mo_coeff),
        g=self.g,
        shift=self.options.shift,
        xi=self.xi if self.boson_ansatz else None,
    )</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.get_eris" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.get_eris(eris=None)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the electron repulsion integrals.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>eris</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ebcc.cc.base.ERIsInputType" href="#ebcc.cc.base.ERIsInputType">ERIsInputType</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Input electron repulsion integrals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.ham.base.BaseERIs" href="../../ham/base/#ebcc.ham.base.BaseERIs">BaseERIs</a></code>
              –
              <div class="doc-md-description">
                <p>Electron repulsion integrals.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def get_eris(self, eris: Optional[ERIsInputType] = None) -&gt; BaseERIs:
    """Get the electron repulsion integrals.

    Args:
        eris: Input electron repulsion integrals.

    Returns:
        Electron repulsion integrals.
    """
    use_df = getattr(self.mf, "with_df", None) is not None
    if isinstance(eris, BaseERIs):
        return eris
    elif eris is not None:
        raise TypeError(f"`eris` must be an `BaseERIs` object, got {eris.__class__.__name__}.")
    elif use_df:
        return self.CDERIs(
            self.mf,
            space=(self.space, self.space, self.space, self.space),
            mo_coeff=(self.mo_coeff, self.mo_coeff, self.mo_coeff, self.mo_coeff),
        )
    else:
        return self.ERIs(
            self.mf,
            space=(self.space, self.space, self.space, self.space),
            mo_coeff=(self.mo_coeff, self.mo_coeff, self.mo_coeff, self.mo_coeff),
        )</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.get_g" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.get_g()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the blocks of the electron-boson coupling matrix.</p>
<p>This matrix corresponds to the bosonic annihilation operator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="ebcc.ham.base.BaseElectronBoson" href="../../ham/base/#ebcc.ham.base.BaseElectronBoson">BaseElectronBoson</a></code>
              –
              <div class="doc-md-description">
                <p>Electron-boson coupling matrix.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">def get_g(self) -&gt; BaseElectronBoson:
    """Get the blocks of the electron-boson coupling matrix.

    This matrix corresponds to the bosonic annihilation operator.

    Returns:
        Electron-boson coupling matrix.
    """
    if self.bare_g is None:
        raise ValueError("Bare electron-boson coupling matrix not provided.")
    return self.ElectronBoson(
        self.mf,
        self.bare_g,
        (self.space, self.space),
        (self.mo_coeff, self.mo_coeff),
    )</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ebcc.cc.base.BaseEBCC.get_mean_field_G" class="doc doc-heading">
            <code class="highlight language-python">ebcc.cc.base.BaseEBCC.get_mean_field_G()</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the mean-field boson non-conserving term.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Any">Any</span></code>
              –
              <div class="doc-md-description">
                <p>Mean-field boson non-conserving term.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/cc/base.py</code></summary>
              <pre class="highlight"><code class="language-python">@abstractmethod
def get_mean_field_G(self) -&gt; Any:
    """Get the mean-field boson non-conserving term.

    Returns:
        Mean-field boson non-conserving term.
    """
    pass</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../gebcc/" class="btn btn-neutral float-left" title="Generalised"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../eom/reom/" class="btn btn-neutral float-right" title="Restricted">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../gebcc/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../eom/reom/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
