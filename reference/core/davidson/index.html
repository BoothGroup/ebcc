<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Davidson - ebcc</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Davidson";
        var mkdocs_page_input_path = "reference/core/davidson.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> ebcc
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../features/">Features</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Code Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Coupled cluster</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cc/rebcc/">Restricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cc/uebcc/">Unrestricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cc/gebcc/">Generalised</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cc/base/">Base</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Equation of motion</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/reom/">Restricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/ueom/">Unrestricted</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/geom/">Generalised</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../eom/base/">Base</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Orbital optimisation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Brueckner</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../opt/rbrueckner/">Restricted</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../opt/ubrueckner/">Unrestricted</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../opt/gbrueckner/">Generalised</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../opt/base/">Base</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../ansatz/">Ansatz</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../damping/">Damping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../dump/">Dumping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../logging/">Logging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../precision/">Precision</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Hamiltonian</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/space/">Space</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/fock/">Fock</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/eris/">ERIs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/cderis/">CDERIs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/elbos/">Bosonic</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../ham/base/">Base</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Utility</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../util/permutations/">Permutations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../util/einsumfunc/">Einstein summations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../util/misc/">Miscellaneous</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">ebcc</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Davidson</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="ebcc.core.davidson"></a>
    <div class="doc doc-contents first">

        <p>Davidson algorithm.</p>
<p>Adapted from PySCF.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="ebcc.core.davidson.make_diagonal_preconditioner" class="doc doc-heading">
            <code class="highlight language-python">ebcc.core.davidson.make_diagonal_preconditioner(diag, level_shift=0.0, tol=1e-08)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Generate the preconditioner function.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>diag</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The diagonal of the matrix.</p>
              </div>
            </li>
            <li>
              <b><code>level_shift</code></b>
                  (<code>float</code>, default:
                      <code>0.0</code>
)
              –
              <div class="doc-md-description">
                <p>The level shift to use.</p>
              </div>
            </li>
            <li>
              <b><code>tol</code></b>
                  (<code>float</code>, default:
                      <code>1e-08</code>
)
              –
              <div class="doc-md-description">
                <p>The tolerance to use to avoid division by zero.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ebcc.core.davidson.PreconditionerType">PreconditionerType</span>[<span title="ebcc.core.davidson.T">T</span>]</code>
              –
              <div class="doc-md-description">
                <p>The preconditioner function.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The default preconditioner approximates the inverse of the matrix by its diagonal. If the
basis generated by the preconditioner is not linearly dependent, a level shift can be
applied to break the correlation between the matrix and its diagonal.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>ebcc/core/davidson.py</code></summary>
              <pre class="highlight"><code class="language-python">def make_diagonal_preconditioner(
    diag: NDArray[floating], level_shift: float = 0.0, tol: float = 1e-8
) -&gt; PreconditionerType[T]:
    """Generate the preconditioner function.

    Args:
        diag: The diagonal of the matrix.
        level_shift: The level shift to use.
        tol: The tolerance to use to avoid division by zero.

    Returns:
        The preconditioner function.

    Notes:
        The default preconditioner approximates the inverse of the matrix by its diagonal. If the
        basis generated by the preconditioner is not linearly dependent, a level shift can be
        applied to break the correlation between the matrix and its diagonal.
    """

    def preconditioner(dx: NDArray[T], e: Union[NDArray[T], T]) -&gt; NDArray[T]:
        """Precondition the solver."""
        diag_shifted = diag - (e - level_shift)
        indices = np.ix_(np.abs(diag_shifted) &lt; tol)
        _put(
            diag_shifted,
            indices,  # type: ignore
            np.full(indices[0].shape, tol),
        )
        return dx / diag_shifted

    return preconditioner</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ebcc.core.davidson.pick_real_eigenvalues" class="doc doc-heading">
            <code class="highlight language-python">ebcc.core.davidson.pick_real_eigenvalues(w, v, nroots, basis_vectors=None)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Search for eigenvalues that are real or close to real.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>w</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="ebcc.core.davidson.T">T</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The eigenvalues.</p>
              </div>
            </li>
            <li>
              <b><code>v</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="ebcc.core.davidson.T">T</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The eigenvectors.</p>
              </div>
            </li>
            <li>
              <b><code>nroots</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>The number of roots to find.</p>
              </div>
            </li>
            <li>
              <b><code>basis_vectors</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="ebcc.core.davidson.T">T</span>]]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The basis vectors. Not used in this function.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>tuple[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="ebcc.core.davidson.T">T</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]]</code>
              –
              <div class="doc-md-description">
                <p>The eigenvalues, eigenvectors, and the indices of the chosen eigenvalues.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>ebcc/core/davidson.py</code></summary>
              <pre class="highlight"><code class="language-python">def pick_real_eigenvalues(
    w: NDArray[T],
    v: NDArray[T],
    nroots: int,
    basis_vectors: Optional[NDArray[T]] = None,
) -&gt; tuple[NDArray[floating], NDArray[T], NDArray[integer]]:
    """Search for eigenvalues that are real or close to real.

    Args:
        w: The eigenvalues.
        v: The eigenvectors.
        nroots: The number of roots to find.
        basis_vectors: The basis vectors. Not used in this function.

    Returns:
        The eigenvalues, eigenvectors, and the indices of the chosen eigenvalues.
    """
    imaginary_tol = 1e-3
    abs_imag = np.abs(np.imag(w))
    max_imag_tol = max(imaginary_tol, np.sort(abs_imag)[min(w.size, nroots) - 1])
    real_idx = np.where(abs_imag &lt; max_imag_tol)[0]
    return make_eigenvectors_real(w, v, real_idx, real_eigenvectors=True)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ebcc.core.davidson.make_eigenvectors_real" class="doc doc-heading">
            <code class="highlight language-python">ebcc.core.davidson.make_eigenvectors_real(w, v, real_idx, real_eigenvectors=True)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Transform the eigenvectors to be real-valued.</p>
<p>If a complex eigenvalue has a small imaginary part, both the real and imaginary parts of the
eigenvector can be used as the real eigenvector.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>w</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="ebcc.core.davidson.T">T</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The eigenvalues.</p>
              </div>
            </li>
            <li>
              <b><code>v</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="ebcc.core.davidson.T">T</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The eigenvectors.</p>
              </div>
            </li>
            <li>
              <b><code>real_idx</code></b>
                  (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The indices of the real eigenvalues.</p>
              </div>
            </li>
            <li>
              <b><code>real_eigenvectors</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to return real eigenvectors.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>tuple[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="ebcc.core.davidson.T">T</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]]</code>
              –
              <div class="doc-md-description">
                <p>The eigenvalues, eigenvectors, and the indices of the chosen eigenvalues.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>If <code>real_eigenvectors</code> is set to <code>True</code>, this function can only be used for real matrices
and real eigenvectors. It discards the imaginary part of the eigenvectors and returns only
the real part of the eigenvectors.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>ebcc/core/davidson.py</code></summary>
              <pre class="highlight"><code class="language-python">def make_eigenvectors_real(
    w: NDArray[T],
    v: NDArray[T],
    real_idx: NDArray[integer],
    real_eigenvectors: bool = True,
) -&gt; tuple[NDArray[floating], NDArray[T], NDArray[integer]]:
    """Transform the eigenvectors to be real-valued.

    If a complex eigenvalue has a small imaginary part, both the real and imaginary parts of the
    eigenvector can be used as the real eigenvector.

    Args:
        w: The eigenvalues.
        v: The eigenvectors.
        real_idx: The indices of the real eigenvalues.
        real_eigenvectors: Whether to return real eigenvectors.

    Returns:
        The eigenvalues, eigenvectors, and the indices of the chosen eigenvalues.

    Notes:
        If `real_eigenvectors` is set to `True`, this function can only be used for real matrices
        and real eigenvectors. It discards the imaginary part of the eigenvectors and returns only
        the real part of the eigenvectors.
    """
    idx = real_idx[np.argsort(np.real(w[real_idx]))]
    w = w[idx]
    v = v[:, idx]

    if real_eigenvectors:
        degen = np.where(np.imag(w) != 0)[0]
        if degen.size &gt; 0:
            indices = np.ix_(np.arange(v.shape[0]), degen[1::2])
            _put(v, indices, np.imag(v[indices]))
        v = np.real(v)

    return np.real(w), v, idx</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ebcc.core.davidson.davidson" class="doc doc-heading">
            <code class="highlight language-python">ebcc.core.davidson.davidson(matvec, vectors, diagonal, nroots=1, max_iter=50, max_space=20, max_trials=40, e_tol=1e-12, r_tol=None, lindep_tol=1e-14, left=False, pick=None, follow_state=False, level_shift=0.0, callback=None)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Davidson algorithm for finding eigenvalues and eigenvectors.</p>

            <details class="quote">
              <summary>Source code in <code>ebcc/core/davidson.py</code></summary>
              <pre class="highlight"><code class="language-python">def davidson(
    matvec: Callable[[NDArray[T]], NDArray[T]],
    vectors: NDArray[T],
    diagonal: NDArray[floating],
    nroots: int = 1,
    max_iter: int = 50,
    max_space: int = 20,
    max_trials: int = 40,
    e_tol: float = 1e-12,
    r_tol: Optional[float] = None,
    lindep_tol: float = 1e-14,
    left: bool = False,
    pick: Optional[PickType[T]] = None,
    follow_state: bool = False,
    level_shift: float = 0.0,
    callback: Optional[Callable[[dict[str, Any]], None]] = None,
) -&gt; tuple[list[bool], NDArray[floating], NDArray[T]]:
    """Davidson algorithm for finding eigenvalues and eigenvectors."""
    # Parse arguments
    loose_tol = r_tol if r_tol is not None else e_tol**0.5
    max_space += (nroots - 1) * 6
    preconditioner: PreconditionerType[T] = make_diagonal_preconditioner(diagonal)
    if pick is None:
        pick = pick_real_eigenvalues
    dim = diagonal.size

    def _empty_vector() -&gt; NDArray[T]:
        """Return an empty vector."""
        return np.empty((0, dim), dtype=types[complex])

    # Initialise variables
    w: NDArray[floating] = np.empty(0, dtype=types[float])
    v: NDArray[T] = _empty_vector()
    conv: list[bool] = [False] * nroots
    w_prev = np.copy(w)
    v_prev = np.copy(v)
    conv_prev = conv.copy()
    matrix: NDArray[T] = np.empty((max_space + nroots, max_space + nroots), dtype=types[complex])
    restart = True
    basis_vectors: NDArray[T] = _empty_vector()
    matrix_basis_vectors: NDArray[T] = _empty_vector()
    space = 0

    for cycle in range(max_iter):
        # Get the trial vectors
        if restart:
            basis_vectors = _empty_vector()
            matrix_basis_vectors = _empty_vector()
            space = 0
            trial_vectors = _orthonormalise_vectors(vectors, lindep_tol=lindep_tol)
            del vectors
        elif trial_vectors.shape[0] &gt; 1:
            trial_vectors = _orthonormalise_vectors(trial_vectors, lindep_tol=lindep_tol)
            trial_vectors = trial_vectors[:max_trials]

        # Find the matrix-vector products for the trial vectors
        matrix_trial_vectors = np.stack(
            [matvec(trial_vectors[i]) for i in range(trial_vectors.shape[0])]
        )

        # Add the trial vectors to the basis
        basis_vectors = np.concatenate((basis_vectors, trial_vectors))
        matrix_basis_vectors = np.concatenate((matrix_basis_vectors, matrix_trial_vectors))
        space += trial_vectors.shape[0]

        # Store the previous iteration results
        w_prev = w
        v_prev = v
        conv_prev = conv

        # Fill the matrix
        matrix = _fill_subspace_matrix(
            matrix, basis_vectors, matrix_basis_vectors, trial_vectors, matrix_trial_vectors
        )
        del trial_vectors, matrix_trial_vectors

        # Solve the eigenvalue problem
        w, v, idx = pick(
            *np.linalg.eig(matrix[:space, :space]), nroots, basis_vectors=basis_vectors
        )
        if not w.size:
            raise RuntimeError("Not enough eigenvalues found.")

        # Sort the eigenvalues and eigenvectors
        w = w[:nroots]
        v = v[:, :nroots]
        conv = [False] * nroots
        if not restart:
            w_prev, conv_prev = _sort_eigenvalues(w_prev, conv_prev, v_prev, v)
        dw = w - w_prev if w_prev.size == w.size else w

        # Find the subspace vectors and matrix-vector products
        vectors = _outer_product_to_subspace(v, basis_vectors)
        matrix_vectors = _outer_product_to_subspace(v, matrix_basis_vectors)

        # Check convergence
        trial_vectors = matrix_vectors - w[:, None] * vectors
        norms = np.real(np.linalg.norm(trial_vectors, axis=1, ord=2))
        conv = [np.abs(dw[k]) &lt; e_tol and norms[k] &lt; loose_tol for k in range(w.size)]
        del matrix_vectors
        if all(conv):
            break

        # Check for restart
        if follow_state and np.max(norms) &gt; 1 and space &gt; nroots + 4:
            vectors = _outer_product_to_subspace(v_prev, basis_vectors)
            restart = True
            continue

        # Remove subspace linear dependency and project out existing basis vectors
        trial_vectors = preconditioner(trial_vectors, w[0] - level_shift)
        trial_vectors = _project_vectors(trial_vectors, basis_vectors)
        trial_vectors = _normalise_vectors(trial_vectors, lindep_tol=lindep_tol)
        if trial_vectors.shape[0] == 0:
            conv = [conv[k] or (norm &lt; loose_tol) for k, norm in enumerate(norms)]
            break

        # Check for restart
        restart = space + nroots &gt; max_space

        # Call the callback
        if callback is not None:
            callback(locals())

    if left:
        # Get the left eigenvectors instead
        wl, vl, v = scipy.linalg.eig(matrix[:space, :space], left=True)
        w, v, idx = pick(wl, v, nroots, basis_vectors=basis_vectors)
        if not w.size:
            raise RuntimeError("Not enough eigenvalues found.")
        w = w[:nroots]
        vectors = _outer_product_to_subspace(vl[:, idx[:nroots]], basis_vectors)

    return conv, w, np.transpose(vectors)</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
