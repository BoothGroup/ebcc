# Code generated by qwick.

import numpy as np
from types import SimpleNamespace
from ebcc.util import pack_2e, einsum, einsum

def energy(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, **kwargs):
    # energy
    x0 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x0 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x0 += einsum("iajb->jiba", v.aaaa.ovov)
    x1 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x1 += einsum("ijab->jiba", t2.aaaa)
    x1 += einsum("ia,jb->ijba", t1.aa, t1.aa) * -1
    e_cc = 0
    e_cc += einsum("ijab,ijba->", x0, x1) * -0.5
    del x0
    del x1
    x2 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x2 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x2 += einsum("iajb->jiba", v.bbbb.ovov)
    x3 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x3 += einsum("ijab->jiba", t2.bbbb)
    x3 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    e_cc += einsum("ijab,ijba->", x2, x3) * -0.5
    del x2
    del x3
    x4 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x4 += einsum("ijab->ijab", t2.abab)
    x4 += einsum("ia,jb->ijab", t1.aa, t1.bb)
    e_cc += einsum("iajb,ijab->", v.aabb.ovov, x4)
    del x4
    e_cc += einsum("ia,ia->", f.aa.ov, t1.aa)
    e_cc += einsum("ia,ia->", f.bb.ov, t1.bb)

    return e_cc

def update_amps(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, **kwargs):
    t1new = SimpleNamespace()
    t2new = SimpleNamespace()

    # T1 and T2 amplitudes
    x0 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x0 += einsum("ia,jbka->ijkb", t1.aa, v.aaaa.ovov)
    x1 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x1 += einsum("ijka->ijka", x0)
    x1 += einsum("ijka->ikja", x0) * -1
    x45 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x45 += einsum("ia,jkla->jilk", t1.aa, x0)
    x46 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x46 += einsum("ia,jkli->jkla", t1.aa, x45)
    x47 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x47 += einsum("ia,jkib->jkab", t1.aa, x46)
    del x46
    x56 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x56 += einsum("ijab->ijab", x47)
    del x47
    x110 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x110 += einsum("ijkl->ijkl", x45)
    del x45
    x68 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x68 += einsum("ijka->ijka", x0)
    x68 -= einsum("ijka->ikja", x0)
    x227 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x227 += einsum("ijka->jkia", x0)
    x227 += einsum("ijka->kjia", x0) * -1
    del x0
    x1 += einsum("ijka->jika", v.aaaa.ooov) * -1
    x1 += einsum("ijka->jkia", v.aaaa.ooov)
    t1new_aa = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    t1new_aa += einsum("ijab,kjib->ka", t2.aaaa, x1) * -1
    del x1
    x2 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x2 += einsum("iabc->ibac", v.aaaa.ovvv)
    x2 += einsum("iabc->ibca", v.aaaa.ovvv) * -1
    x85 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x85 += einsum("ia,jbac->ijbc", t1.aa, x2)
    t1new_aa += einsum("ijab,icba->jc", t2.aaaa, x2) * -1
    del x2
    x3 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x3 += einsum("ia,jakb->ijkb", t1.aa, v.aabb.ovov)
    x4 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x4 += einsum("ijka->jika", x3)
    x98 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x98 += einsum("ijab,kljb->kila", t2.abab, x3)
    del x3
    x102 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x102 += einsum("ijka->ikja", x98)
    del x98
    x4 += einsum("ijka->ijka", v.aabb.ooov)
    x244 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x244 += einsum("ijab,iklb->kjla", t2.abab, x4)
    x248 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x248 += einsum("ijka->ikja", x244) * -1
    del x244
    t1new_aa += einsum("ijab,ikjb->ka", t2.abab, x4) * -1
    x5 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x5 += einsum("ia,jbia->jb", t1.bb, v.aabb.ovov)
    x8 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x8 += einsum("ia->ia", x5)
    x83 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x83 += einsum("ia,ja->ij", t1.aa, x5)
    x84 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x84 += einsum("ij,kjab->ikab", x83, t2.aaaa)
    del x83
    x106 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x106 += einsum("ijab->ijab", x84) * -1
    del x84
    x99 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x99 += einsum("ia,jkab->kjib", x5, t2.aaaa)
    del x5
    x102 += einsum("ijka->ikja", x99) * -1
    del x99
    x6 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x6 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x6 += einsum("iajb->jiba", v.aaaa.ovov)
    x7 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x7 += einsum("ia,ijba->jb", t1.aa, x6)
    x8 += einsum("ia->ia", x7) * -1
    del x7
    x90 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x90 += einsum("ijab,ijbc->ac", t2.aaaa, x6)
    x92 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x92 += einsum("ab->ab", x90) * -1
    del x90
    x198 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x198 += einsum("ijab,ikca->kjcb", t2.abab, x6)
    x199 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x199 += einsum("ijab->ijab", x198) * -1
    del x198
    x253 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x253 += einsum("ijab,ijcb->ac", t2.aaaa, x6)
    del x6
    x254 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x254 += einsum("ab->ab", x253) * -1
    del x253
    x8 += einsum("ia->ia", f.aa.ov)
    x21 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x21 += einsum("ia,ja->ij", t1.aa, x8)
    x22 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x22 += einsum("ij->ji", x21)
    del x21
    x231 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x231 += einsum("ia,jkab->jikb", x8, t2.abab)
    x237 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x237 += einsum("ijka->jika", x231) * -1
    del x231
    t1new_bb = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    t1new_bb += einsum("ia,ijab->jb", x8, t2.abab)
    x9 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x9 += einsum("ijab->jiab", t2.aaaa) * -1
    x9 += einsum("ijab->jiba", t2.aaaa)
    x86 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x86 += einsum("ijab,jkcb->kica", x85, x9) * -1
    del x85
    x106 += einsum("ijab->jiab", x86) * -1
    del x86
    t1new_aa += einsum("ia,ijba->jb", x8, x9) * -1
    del x8
    x10 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x10 += einsum("ia,iajb->jb", t1.aa, v.aabb.ovov)
    x13 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x13 += einsum("ia->ia", x10)
    x157 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x157 += einsum("ia,jkab->kjib", x10, t2.bbbb)
    x159 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x159 += einsum("ijka->ikja", x157) * -1
    del x157
    x171 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x171 += einsum("ia,ja->ij", t1.bb, x10)
    del x10
    x172 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x172 += einsum("ij->ij", x171)
    del x171
    x11 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x11 += einsum("iajb->jiab", v.bbbb.ovov)
    x11 += einsum("iajb->jiba", v.bbbb.ovov) * -1
    x12 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x12 += einsum("ia,ijab->jb", t1.bb, x11)
    x13 += einsum("ia->ia", x12) * -1
    del x12
    x36 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x36 += einsum("ijab,ikab->kj", t2.bbbb, x11)
    x40 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x40 += einsum("ij->ij", x36) * -1
    del x36
    x161 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x161 += einsum("ijab,ijcb->ca", t2.bbbb, x11)
    x163 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x163 += einsum("ab->ba", x161) * -1
    del x161
    x13 += einsum("ia->ia", f.bb.ov)
    x39 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x39 += einsum("ia,ja->ij", t1.bb, x13)
    x40 += einsum("ij->ji", x39)
    del x39
    x245 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x245 += einsum("ia,jkba->jkib", x13, t2.abab)
    x248 += einsum("ijka->ikja", x245)
    del x245
    t1new_aa += einsum("ia,jiba->jb", x13, t2.abab)
    x14 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x14 += einsum("iabj->ijba", v.aaaa.ovvo)
    x14 -= einsum("ijab->ijab", v.aaaa.oovv)
    x74 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x74 += einsum("ia,jkba->ijkb", t1.aa, x14)
    x75 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x75 -= einsum("ijka->jika", x74)
    del x74
    t1new_aa += einsum("ia,ijba->jb", t1.aa, x14)
    x15 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x15 += einsum("ia,jkia->jk", t1.bb, v.aabb.ooov)
    x22 += einsum("ij->ij", x15)
    x60 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x60 += einsum("ij,kiab->kjab", x15, t2.aaaa)
    del x15
    x80 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x80 -= einsum("ijab->ijab", x60)
    del x60
    x16 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x16 += einsum("ijab,kajb->ik", t2.abab, v.aabb.ovov)
    x22 += einsum("ij->ji", x16)
    x104 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x104 += einsum("ij->ji", x16)
    del x16
    x17 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x17 += einsum("iajb->jiab", v.aaaa.ovov)
    x17 += einsum("iajb->jiba", v.aaaa.ovov) * -1
    x18 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x18 += einsum("ijab,ikab->jk", t2.aaaa, x17)
    del x17
    x22 += einsum("ij->ji", x18) * -1
    x104 += einsum("ij->ji", x18) * -1
    del x18
    x19 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x19 += einsum("ijka->ikja", v.aaaa.ooov)
    x19 += einsum("ijka->kija", v.aaaa.ooov) * -1
    x20 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x20 += einsum("ia,ijka->jk", t1.aa, x19)
    del x19
    x22 += einsum("ij->ij", x20) * -1
    x104 += einsum("ij->ij", x20) * -1
    del x20
    x105 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x105 += einsum("ij,ikab->kjab", x104, t2.aaaa)
    del x104
    x106 += einsum("ijab->ijba", x105)
    del x105
    x22 += einsum("ij->ij", f.aa.oo)
    x256 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x256 += einsum("ij,ikab->jkab", x22, t2.abab)
    t2new_baba = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    t2new_baba += einsum("ijab->jiba", x256) * -1
    t2new_abab = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    t2new_abab += einsum("ijab->ijab", x256) * -1
    del x256
    t1new_aa += einsum("ia,ij->ja", t1.aa, x22) * -1
    del x22
    x23 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x23 += einsum("ia,iabc->bc", t1.bb, v.bbaa.ovvv)
    x26 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x26 += einsum("ab->ab", x23)
    x61 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x61 += einsum("ab,ijbc->jica", x23, t2.aaaa)
    x80 += einsum("ijab->ijab", x61)
    del x61
    x254 += einsum("ab->ab", x23)
    del x23
    x24 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x24 += einsum("iabc->ibac", v.aaaa.ovvv) * -1
    x24 += einsum("iabc->ibca", v.aaaa.ovvv)
    x25 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x25 += einsum("ia,ibac->bc", t1.aa, x24)
    x26 += einsum("ab->ab", x25) * -1
    x254 += einsum("ab->ab", x25) * -1
    del x25
    x91 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x91 += einsum("ia,ibca->bc", t1.aa, x24)
    del x24
    x92 += einsum("ab->ab", x91) * -1
    del x91
    x26 += einsum("ab->ab", f.aa.vv)
    t1new_aa += einsum("ia,ba->ib", t1.aa, x26)
    del x26
    x27 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x27 += einsum("ia,jbka->ijkb", t1.bb, v.bbbb.ovov)
    x28 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x28 += einsum("ijka->ijka", x27)
    x28 += einsum("ijka->ikja", x27) * -1
    x131 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x131 -= einsum("ijka->ijka", x27)
    x131 += einsum("ijka->ikja", x27)
    x177 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x177 += einsum("ia,jkla->jilk", t1.bb, x27)
    x178 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x178 += einsum("ia,jkli->jkla", t1.bb, x177)
    x179 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x179 += einsum("ia,jkib->jkab", t1.bb, x178)
    del x178
    x183 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x183 += einsum("ijab->ijab", x179)
    del x179
    x187 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x187 += einsum("ijkl->ijkl", x177)
    del x177
    x241 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x241 += einsum("ijka->jkia", x27) * -1
    x241 += einsum("ijka->kjia", x27)
    del x27
    x28 += einsum("ijka->jika", v.bbbb.ooov) * -1
    x28 += einsum("ijka->jkia", v.bbbb.ooov)
    t1new_bb += einsum("ijab,kjib->ka", t2.bbbb, x28) * -1
    del x28
    x29 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x29 += einsum("iabc->ibac", v.bbbb.ovvv) * -1
    x29 += einsum("iabc->ibca", v.bbbb.ovvv)
    x148 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x148 += einsum("ia,jbca->ijbc", t1.bb, x29)
    x203 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x203 += einsum("ijab->jiab", x148) * -1
    x162 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x162 += einsum("ia,ibca->bc", t1.bb, x29)
    x163 += einsum("ab->ab", x162) * -1
    del x162
    x164 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x164 += einsum("ab,ijbc->ijca", x163, t2.bbbb)
    del x163
    x174 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x174 += einsum("ijab->jiab", x164)
    del x164
    t1new_bb += einsum("ijab,icab->jc", t2.bbbb, x29) * -1
    del x29
    x30 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x30 += einsum("ia,jbka->jikb", t1.bb, v.aabb.ovov)
    x31 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x31 += einsum("ijka->ikja", x30)
    x156 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x156 += einsum("ijab,ikla->kjlb", t2.abab, x30)
    x159 += einsum("ijka->ikja", x156)
    del x156
    x218 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x218 += einsum("ijka->ikja", x30)
    del x30
    x31 += einsum("iajk->ijka", v.aabb.ovoo)
    x230 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x230 += einsum("ijab,kjla->iklb", t2.abab, x31)
    x237 += einsum("ijka->jika", x230)
    del x230
    x232 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x232 += einsum("ia,jkla->ijkl", t1.aa, x31)
    x233 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x233 += einsum("ijkl->jikl", x232)
    del x232
    x243 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x243 += einsum("ijka,ilba->ljkb", x31, x9)
    x248 += einsum("ijka->ijka", x243) * -1
    del x243
    t1new_bb += einsum("ijab,ijka->kb", t2.abab, x31) * -1
    del x31
    x32 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x32 += einsum("ijab->jiab", t2.bbbb) * -1
    x32 += einsum("ijab->jiba", t2.bbbb)
    x229 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x229 += einsum("ijab,klia->kljb", x32, x4)
    del x4
    x237 += einsum("ijka->ijka", x229) * -1
    del x229
    t1new_bb += einsum("ia,ijab->jb", x13, x32)
    del x32
    del x13
    x33 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x33 += einsum("iabj->ijba", v.bbbb.ovvo)
    x33 -= einsum("ijab->ijab", v.bbbb.oovv)
    x136 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x136 += einsum("ia,jkba->ijkb", t1.bb, x33)
    x137 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x137 -= einsum("ijka->jika", x136)
    del x136
    t1new_bb += einsum("ia,ijba->jb", t1.bb, x33)
    x34 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x34 += einsum("ia,iajk->jk", t1.aa, v.aabb.ovoo)
    x40 += einsum("ij->ij", x34)
    x122 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x122 += einsum("ij,kiab->kjab", x34, t2.bbbb)
    del x34
    x142 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x142 -= einsum("ijab->ijab", x122)
    del x122
    x35 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x35 += einsum("ijab,iakb->jk", t2.abab, v.aabb.ovov)
    x40 += einsum("ij->ji", x35)
    x172 += einsum("ij->ij", x35)
    del x35
    x173 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x173 += einsum("ij,jkab->kiab", x172, t2.bbbb)
    del x172
    x174 += einsum("ijab->jiba", x173) * -1
    del x173
    x37 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x37 += einsum("ijka->ikja", v.bbbb.ooov)
    x37 += einsum("ijka->kija", v.bbbb.ooov) * -1
    x38 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x38 += einsum("ia,ijka->jk", t1.bb, x37)
    x40 += einsum("ij->ij", x38) * -1
    del x38
    x40 += einsum("ij->ij", f.bb.oo)
    x257 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x257 += einsum("ij,kiab->kjab", x40, t2.abab)
    t2new_baba += einsum("ijab->jiba", x257) * -1
    t2new_abab += einsum("ijab->ijab", x257) * -1
    del x257
    t1new_bb += einsum("ia,ij->ja", t1.bb, x40) * -1
    del x40
    x41 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x41 += einsum("ia,iabc->bc", t1.aa, v.aabb.ovvv)
    x44 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x44 += einsum("ab->ab", x41)
    x123 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x123 += einsum("ab,ijbc->jica", x41, t2.bbbb)
    x142 += einsum("ijab->ijab", x123)
    del x123
    x251 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x251 += einsum("ab->ab", x41)
    del x41
    x42 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x42 += einsum("iabc->ibac", v.bbbb.ovvv)
    x42 += einsum("iabc->ibca", v.bbbb.ovvv) * -1
    x43 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x43 += einsum("ia,ibca->bc", t1.bb, x42)
    del x42
    x44 += einsum("ab->ab", x43) * -1
    x251 += einsum("ab->ab", x43) * -1
    del x43
    x44 += einsum("ab->ab", f.bb.vv)
    t1new_bb += einsum("ia,ba->ib", t1.bb, x44)
    del x44
    x48 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x48 += einsum("iajb->jiab", v.aaaa.ovov)
    x48 -= einsum("iajb->jiba", v.aaaa.ovov)
    x49 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x49 += einsum("ijab,ikac->jkbc", t2.aaaa, x48)
    x50 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x50 -= einsum("ijab,kica->jkbc", t2.aaaa, x49)
    del x49
    x56 += einsum("ijab->jiba", x50)
    del x50
    x51 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x51 += einsum("ijab,ikbc->jkac", t2.aaaa, x48)
    del x48
    x52 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x52 -= einsum("ijab,kicb->jkac", t2.aaaa, x51)
    x56 += einsum("ijab->ijab", x52)
    del x52
    x66 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x66 -= einsum("ijab,kica->jkbc", t2.aaaa, x51)
    del x51
    x80 -= einsum("ijab->ijab", x66)
    del x66
    x53 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x53 += einsum("iajb->jiab", v.bbbb.ovov)
    x53 -= einsum("iajb->jiba", v.bbbb.ovov)
    x54 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x54 += einsum("ijab,jkbc->ikac", t2.abab, x53)
    x55 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x55 -= einsum("ijab,kjcb->ikac", t2.abab, x54)
    del x54
    x56 += einsum("ijab->ijab", x55)
    del x55
    t2new_aaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    t2new_aaaa += einsum("ijab->ijab", x56)
    t2new_aaaa -= einsum("ijab->ijba", x56)
    del x56
    x128 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x128 += einsum("ijab,ikbc->jkac", t2.bbbb, x53)
    x129 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x129 -= einsum("ijab,kica->jkbc", t2.bbbb, x128)
    x142 -= einsum("ijab->ijab", x129)
    del x129
    x182 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x182 -= einsum("ijab,kicb->jkac", t2.bbbb, x128)
    del x128
    x183 += einsum("ijab->jiba", x182)
    del x182
    x133 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x133 += einsum("ia,ijab->jb", t1.bb, x53)
    x134 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x134 -= einsum("ia->ia", x133)
    del x133
    x180 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x180 += einsum("ijab,ikac->jkbc", t2.bbbb, x53)
    del x53
    x181 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x181 -= einsum("ijab,kica->jkbc", t2.bbbb, x180)
    del x180
    x183 += einsum("ijab->ijab", x181)
    del x181
    t2new_bbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    t2new_bbbb += einsum("ijab->ijab", x183)
    t2new_bbbb -= einsum("ijab->ijba", x183)
    del x183
    x57 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x57 += einsum("ab,ijbc->jiac", f.aa.vv, t2.aaaa)
    x80 -= einsum("ijab->ijab", x57)
    del x57
    x58 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x58 += einsum("ia,bjca->ijbc", t1.aa, v.aaaa.vovv)
    x80 -= einsum("ijab->ijab", x58)
    del x58
    x59 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x59 += einsum("ijab,jbck->ikac", t2.abab, v.bbaa.ovvo)
    x80 += einsum("ijab->ijab", x59)
    del x59
    x62 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x62 += einsum("ia,jbca->ijcb", t1.aa, v.bbaa.ovvv)
    x63 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x63 += einsum("ijab,kjcb->kiac", t2.abab, x62)
    x80 -= einsum("ijab->ijab", x63)
    del x63
    x206 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x206 += einsum("ijab->ijab", x62)
    del x62
    x64 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x64 += einsum("ijab->jiab", t2.aaaa)
    x64 -= einsum("ijab->jiba", t2.aaaa)
    x65 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x65 += einsum("ijab,ikbc->jkac", x14, x64)
    del x14
    x80 -= einsum("ijab->jiba", x65)
    del x65
    x69 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x69 += einsum("ijab,kila->jklb", x64, x68)
    del x68
    x75 += einsum("ijka->kjia", x69)
    del x69
    x67 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x67 += einsum("ijab,kljb->ikla", t2.abab, v.aabb.ooov)
    x75 += einsum("ijka->jika", x67)
    del x67
    x70 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x70 -= einsum("iajb->jiab", v.aaaa.ovov)
    x70 += einsum("iajb->jiba", v.aaaa.ovov)
    x71 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x71 += einsum("ia,ijba->jb", t1.aa, x70)
    x72 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x72 -= einsum("ia->ia", x71)
    del x71
    x175 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x175 += einsum("ijab,ikca->kjcb", t2.abab, x70)
    del x70
    x176 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x176 -= einsum("ijab,ikac->jkbc", t2.abab, x175)
    del x175
    t2new_bbbb -= einsum("ijab->jiab", x176)
    t2new_bbbb += einsum("ijab->ijab", x176)
    del x176
    x72 += einsum("ia->ia", f.aa.ov)
    x73 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x73 += einsum("ia,jkab->jkib", x72, t2.aaaa)
    x75 += einsum("ijka->kjia", x73)
    del x73
    x77 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x77 += einsum("ia,ja->ij", t1.aa, x72)
    del x72
    x78 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x78 += einsum("ij->ij", x77)
    del x77
    x75 -= einsum("ijak->ijka", v.aaaa.oovo)
    x76 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x76 += einsum("ia,ijkb->jkab", t1.aa, x75)
    del x75
    x80 += einsum("ijab->ijab", x76)
    del x76
    x78 += einsum("ij->ji", f.aa.oo)
    x79 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x79 += einsum("ij,jkab->kiab", x78, t2.aaaa)
    del x78
    x80 += einsum("ijab->jiba", x79)
    del x79
    t2new_aaaa += einsum("ijab->ijab", x80)
    t2new_aaaa -= einsum("ijab->ijba", x80)
    t2new_aaaa -= einsum("ijab->jiab", x80)
    t2new_aaaa += einsum("ijab->jiba", x80)
    del x80
    x81 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x81 += einsum("ia,jkla->ijlk", t1.aa, v.aaaa.ooov)
    x82 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x82 += einsum("ijab,kjil->klba", t2.aaaa, x81)
    x106 += einsum("ijab->ijab", x82)
    del x82
    x94 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x94 += einsum("ia,jkil->jkla", t1.aa, x81)
    del x81
    x102 += einsum("ijka->ijka", x94)
    del x94
    x87 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x87 += einsum("ijab,kcjb->ikac", t2.abab, v.aabb.ovov)
    x88 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x88 += einsum("ijab,jkbc->ikac", x87, x9)
    del x87
    x106 += einsum("ijab->jiba", x88) * -1
    del x88
    x89 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x89 += einsum("ijab,icjb->ac", t2.abab, v.aabb.ovov)
    x92 += einsum("ab->ab", x89)
    x93 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x93 += einsum("ab,ijbc->ijca", x92, t2.aaaa)
    del x92
    x106 += einsum("ijab->jiab", x93)
    del x93
    x254 += einsum("ab->ab", x89) * -1
    del x89
    x95 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x95 += einsum("ijab,kbca->jikc", t2.aaaa, v.aaaa.ovvv)
    x102 += einsum("ijka->ikja", x95)
    del x95
    x96 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x96 += einsum("ia,jbca->ijcb", t1.aa, v.aaaa.ovvv)
    x97 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x97 += einsum("ia,jkba->ijkb", t1.aa, x96)
    del x96
    x102 += einsum("ijka->ikja", x97)
    del x97
    x100 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x100 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x100 += einsum("ijka->kija", v.aaaa.ooov)
    x101 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x101 += einsum("ijka,ilba->ljkb", x100, x9)
    del x9
    del x100
    x102 += einsum("ijka->ijka", x101)
    del x101
    x103 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x103 += einsum("ia,jikb->jkab", t1.aa, x102)
    del x102
    x106 += einsum("ijab->ijab", x103)
    del x103
    t2new_aaaa += einsum("ijab->ijab", x106) * -1
    t2new_aaaa += einsum("ijab->ijba", x106)
    t2new_aaaa += einsum("ijab->jiab", x106)
    t2new_aaaa += einsum("ijab->jiba", x106) * -1
    del x106
    x107 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x107 += einsum("ia,bcda->ibdc", t1.aa, v.aaaa.vvvv)
    x108 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x108 += einsum("ia,jbca->ijbc", t1.aa, x107)
    del x107
    x115 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x115 += einsum("ijab->ijab", x108)
    del x108
    x109 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x109 += einsum("ijab,kalb->ijkl", t2.aaaa, v.aaaa.ovov)
    x110 += einsum("ijkl->jilk", x109)
    x111 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x111 += einsum("ijab,klij->klab", t2.aaaa, x110)
    del x110
    x115 += einsum("ijab->jiba", x111)
    del x111
    x112 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x112 += einsum("ijkl->lkji", x109)
    del x109
    x112 += einsum("ijkl->kilj", v.aaaa.oooo)
    x113 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x113 += einsum("ia,ijkl->jkla", t1.aa, x112)
    del x112
    x114 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x114 += einsum("ia,ijkb->kjab", t1.aa, x113)
    del x113
    x115 += einsum("ijab->jiba", x114)
    del x114
    t2new_aaaa += einsum("ijab->ijab", x115)
    t2new_aaaa += einsum("ijab->ijba", x115) * -1
    del x115
    x116 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x116 += einsum("ijab,ikjl->klab", t2.aaaa, v.aaaa.oooo)
    x118 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x118 += einsum("ijab->jiba", x116)
    del x116
    x117 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x117 += einsum("ijab,cadb->ijcd", t2.aaaa, v.aaaa.vvvv)
    x118 += einsum("ijab->jiba", x117)
    del x117
    t2new_aaaa += einsum("ijab->ijba", x118) * -1
    t2new_aaaa += einsum("ijab->ijab", x118)
    del x118
    x119 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x119 += einsum("ab,ijbc->jiac", f.bb.vv, t2.bbbb)
    x142 -= einsum("ijab->ijab", x119)
    del x119
    x120 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x120 += einsum("ia,bjca->ijbc", t1.bb, v.bbbb.vovv)
    x142 -= einsum("ijab->ijab", x120)
    del x120
    x121 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x121 += einsum("ijab,iack->jkbc", t2.abab, v.aabb.ovvo)
    x142 += einsum("ijab->ijab", x121)
    del x121
    x124 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x124 += einsum("ia,jbca->jibc", t1.bb, v.aabb.ovvv)
    x125 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x125 += einsum("ijab,ikac->kjbc", t2.abab, x124)
    x142 -= einsum("ijab->ijab", x125)
    del x125
    x199 += einsum("ijab->ijab", x124)
    x235 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x235 += einsum("ijab->ijab", x124)
    del x124
    x126 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x126 += einsum("ijab->jiab", t2.bbbb)
    x126 -= einsum("ijab->jiba", t2.bbbb)
    x127 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x127 += einsum("ijab,ikca->kjcb", x126, x33)
    del x33
    x142 -= einsum("ijab->jiba", x127)
    del x127
    x132 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x132 += einsum("ijab,klia->jklb", x126, x131)
    del x131
    del x126
    x137 += einsum("ijka->kjia", x132)
    del x132
    x130 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x130 += einsum("ijab,iakl->jklb", t2.abab, v.aabb.ovoo)
    x137 += einsum("ijka->jika", x130)
    del x130
    x134 += einsum("ia->ia", f.bb.ov)
    x135 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x135 += einsum("ia,jkab->jkib", x134, t2.bbbb)
    x137 += einsum("ijka->kjia", x135)
    del x135
    x139 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x139 += einsum("ia,ja->ij", t1.bb, x134)
    del x134
    x140 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x140 += einsum("ij->ij", x139)
    del x139
    x137 -= einsum("ijak->ijka", v.bbbb.oovo)
    x138 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x138 += einsum("ia,ijkb->jkab", t1.bb, x137)
    del x137
    x142 += einsum("ijab->ijab", x138)
    del x138
    x140 += einsum("ij->ji", f.bb.oo)
    x141 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x141 += einsum("ij,jkab->kiab", x140, t2.bbbb)
    del x140
    x142 += einsum("ijab->jiba", x141)
    del x141
    t2new_bbbb += einsum("ijab->ijab", x142)
    t2new_bbbb -= einsum("ijab->ijba", x142)
    t2new_bbbb -= einsum("ijab->jiab", x142)
    t2new_bbbb += einsum("ijab->jiba", x142)
    del x142
    x143 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x143 += einsum("ia,jkla->ijlk", t1.bb, v.bbbb.ooov)
    x144 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x144 += einsum("ijab,kjil->klba", t2.bbbb, x143)
    x174 += einsum("ijab->ijab", x144)
    del x144
    x152 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x152 += einsum("ia,jkil->jkla", t1.bb, x143)
    del x143
    x159 += einsum("ijka->ijka", x152)
    del x152
    x145 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x145 += einsum("ijab,iajc->bc", t2.abab, v.aabb.ovov)
    x146 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x146 += einsum("ab,ijbc->jiac", x145, t2.bbbb)
    x174 += einsum("ijab->ijab", x146) * -1
    del x146
    x251 += einsum("ab->ab", x145) * -1
    del x145
    x147 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x147 += einsum("ijab->jiab", t2.bbbb)
    x147 += einsum("ijab->jiba", t2.bbbb) * -1
    x149 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x149 += einsum("ijab,kica->jkbc", x147, x148) * -1
    del x148
    x174 += einsum("ijab->jiab", x149) * -1
    del x149
    x150 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x150 += einsum("iajb,jkbc->ikac", v.aabb.ovov, x147)
    x151 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x151 += einsum("ijab,ikac->jkbc", t2.abab, x150) * -1
    x174 += einsum("ijab->ijab", x151) * -1
    del x151
    x199 += einsum("ijab->ijab", x150) * -1
    del x150
    x158 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x158 += einsum("ijab,kila->kljb", x147, x37)
    del x37
    x159 += einsum("ijka->kija", x158)
    del x158
    x202 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x202 += einsum("ijab,ikac->jkbc", x11, x147)
    del x11
    del x147
    x203 += einsum("ijab->ijba", x202)
    del x202
    x153 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x153 += einsum("ijab,kbca->jikc", t2.bbbb, v.bbbb.ovvv)
    x159 += einsum("ijka->ikja", x153)
    del x153
    x154 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x154 += einsum("ia,jbca->ijcb", t1.bb, v.bbbb.ovvv)
    x155 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x155 += einsum("ia,jkba->ijkb", t1.bb, x154)
    del x154
    x159 += einsum("ijka->ikja", x155)
    del x155
    x160 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x160 += einsum("ia,jikb->jkab", t1.bb, x159)
    del x159
    x174 += einsum("ijab->ijab", x160)
    del x160
    x165 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x165 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x165 += einsum("iajb->jiba", v.bbbb.ovov)
    x166 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x166 += einsum("ijab,ikab->jk", t2.bbbb, x165)
    x169 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x169 += einsum("ij->ji", x166) * -1
    del x166
    x250 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x250 += einsum("ijab,ijcb->ac", t2.bbbb, x165)
    del x165
    x251 += einsum("ab->ab", x250) * -1
    del x250
    x167 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x167 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x167 += einsum("ijka->kija", v.bbbb.ooov)
    x168 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x168 += einsum("ia,ijka->jk", t1.bb, x167)
    del x167
    x169 += einsum("ij->ij", x168) * -1
    del x168
    x170 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x170 += einsum("ij,ikab->kjab", x169, t2.bbbb)
    del x169
    x174 += einsum("ijab->ijba", x170) * -1
    del x170
    t2new_bbbb += einsum("ijab->ijab", x174) * -1
    t2new_bbbb += einsum("ijab->ijba", x174)
    t2new_bbbb += einsum("ijab->jiab", x174)
    t2new_bbbb += einsum("ijab->jiba", x174) * -1
    del x174
    x184 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x184 += einsum("ia,bacd->icbd", t1.bb, v.bbbb.vvvv)
    x185 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x185 += einsum("ia,jbca->ijbc", t1.bb, x184)
    del x184
    x192 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x192 += einsum("ijab->ijab", x185)
    del x185
    x186 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x186 += einsum("ijab,kalb->ijkl", t2.bbbb, v.bbbb.ovov)
    x187 += einsum("ijkl->jilk", x186)
    x188 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x188 += einsum("ijab,klij->klab", t2.bbbb, x187)
    del x187
    x192 += einsum("ijab->jiba", x188)
    del x188
    x189 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x189 += einsum("ijkl->lkji", x186)
    del x186
    x189 += einsum("ijkl->kilj", v.bbbb.oooo)
    x190 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x190 += einsum("ia,ijkl->jkla", t1.bb, x189)
    del x189
    x191 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x191 += einsum("ia,ijkb->kjab", t1.bb, x190)
    del x190
    x192 += einsum("ijab->jiba", x191)
    del x191
    t2new_bbbb += einsum("ijab->ijab", x192)
    t2new_bbbb += einsum("ijab->ijba", x192) * -1
    del x192
    x193 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x193 += einsum("ijab,ikjl->klab", t2.bbbb, v.bbbb.oooo)
    x195 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x195 += einsum("ijab->jiba", x193)
    del x193
    x194 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x194 += einsum("ijab,cbda->ijdc", t2.bbbb, v.bbbb.vvvv)
    x195 += einsum("ijab->jiba", x194)
    del x194
    t2new_bbbb += einsum("ijab->ijba", x195) * -1
    t2new_bbbb += einsum("ijab->ijab", x195)
    del x195
    x196 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x196 += einsum("ia,bjca->jibc", t1.bb, v.aabb.vovv)
    t2new_baba += einsum("ijab->jiba", x196)
    t2new_abab += einsum("ijab->ijab", x196)
    del x196
    x197 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x197 += einsum("ijab,cadb->ijcd", t2.abab, v.aabb.vvvv)
    t2new_baba += einsum("ijab->jiba", x197)
    t2new_abab += einsum("ijab->ijab", x197)
    del x197
    x199 += einsum("iabj->ijab", v.aabb.ovvo)
    x200 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x200 += einsum("ijab,ikca->kjcb", x199, x64)
    del x64
    del x199
    t2new_baba += einsum("ijab->jiba", x200)
    t2new_abab += einsum("ijab->ijab", x200)
    del x200
    x201 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x201 += einsum("ijab,iakc->jkbc", t2.abab, v.aabb.ovov)
    x203 += einsum("ijab->jiab", x201)
    del x201
    x203 += einsum("iabj->ijba", v.bbbb.ovvo)
    x203 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x204 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x204 += einsum("ijab,jkcb->ikac", t2.abab, x203)
    del x203
    t2new_baba += einsum("ijab->jiba", x204)
    t2new_abab += einsum("ijab->ijab", x204)
    del x204
    x205 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x205 -= einsum("ijab->jiab", t2.bbbb)
    x205 += einsum("ijab->jiba", t2.bbbb)
    x206 += einsum("iabj->jiba", v.bbaa.ovvo)
    x207 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x207 += einsum("ijab,kica->kjcb", x205, x206)
    del x205
    del x206
    t2new_baba += einsum("ijab->jiba", x207)
    t2new_abab += einsum("ijab->ijab", x207)
    del x207
    x208 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x208 -= einsum("iabc->ibac", v.aaaa.ovvv)
    x208 += einsum("iabc->ibca", v.aaaa.ovvv)
    x209 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x209 += einsum("ia,jbca->ijbc", t1.aa, x208)
    del x208
    x210 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x210 -= einsum("ijab->jiab", x209)
    del x209
    x210 += einsum("iabj->ijba", v.aaaa.ovvo)
    x210 -= einsum("ijab->ijab", v.aaaa.oovv)
    x211 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x211 += einsum("ijab,ikca->kjcb", t2.abab, x210)
    del x210
    t2new_baba += einsum("ijab->jiba", x211)
    t2new_abab += einsum("ijab->ijab", x211)
    del x211
    x212 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x212 += einsum("ia,jabc->ijbc", t1.bb, v.bbaa.ovvv)
    x214 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x214 += einsum("ijab->jiab", x212)
    x246 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x246 += einsum("ijab->jiab", x212)
    del x212
    x213 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x213 += einsum("ijab,ickb->jkac", t2.abab, v.aabb.ovov)
    x214 -= einsum("ijab->jiab", x213)
    del x213
    x214 += einsum("ijab->ijab", v.bbaa.oovv)
    x215 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x215 += einsum("ijab,jkca->ikcb", t2.abab, x214)
    del x214
    t2new_baba -= einsum("ijab->jiba", x215)
    t2new_abab -= einsum("ijab->ijab", x215)
    del x215
    x216 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x216 += einsum("ia,jkla->jkil", t1.bb, v.aabb.ooov)
    x220 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x220 += einsum("ijkl->ijlk", x216)
    x233 += einsum("ijkl->ijlk", x216)
    del x216
    x217 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x217 += einsum("ijab,kalb->ikjl", t2.abab, v.aabb.ovov)
    x220 += einsum("ijkl->jilk", x217)
    x233 += einsum("ijkl->jilk", x217)
    del x217
    x218 += einsum("iajk->ijka", v.aabb.ovoo)
    x219 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x219 += einsum("ia,jkla->ijkl", t1.aa, x218)
    del x218
    x220 += einsum("ijkl->jikl", x219)
    del x219
    x220 += einsum("ijkl->ijkl", v.aabb.oooo)
    x221 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x221 += einsum("ijab,ikjl->klab", t2.abab, x220)
    del x220
    t2new_baba += einsum("ijab->jiba", x221)
    t2new_abab += einsum("ijab->ijab", x221)
    del x221
    x222 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x222 += einsum("ia,jabc->ijbc", t1.aa, v.aabb.ovvv)
    x223 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x223 += einsum("ijab->jiab", x222)
    del x222
    x223 += einsum("ijab->ijab", v.aabb.oovv)
    x224 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x224 += einsum("ijab,ikcb->kjac", t2.abab, x223)
    del x223
    t2new_baba -= einsum("ijab->jiba", x224)
    t2new_abab -= einsum("ijab->ijab", x224)
    del x224
    x225 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x225 += einsum("ia,jkba->jkib", t1.bb, v.aabb.oovv)
    x237 += einsum("ijka->ijka", x225) * -1
    del x225
    x226 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x226 += einsum("ijab,kacb->ikjc", t2.abab, v.aabb.ovvv)
    x237 += einsum("ijka->jika", x226) * -1
    del x226
    x227 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x227 += einsum("ijka->kija", v.aaaa.ooov)
    x228 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x228 += einsum("ijab,ikla->kljb", t2.abab, x227)
    del x227
    x237 += einsum("ijka->ijka", x228) * -1
    del x228
    x233 += einsum("ijkl->ijkl", v.aabb.oooo)
    x234 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x234 += einsum("ia,jkil->jkla", t1.bb, x233)
    del x233
    x237 += einsum("ijka->ijka", x234)
    del x234
    x235 += einsum("iabj->ijab", v.aabb.ovvo)
    x236 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x236 += einsum("ia,jkab->ijkb", t1.aa, x235)
    del x235
    x237 += einsum("ijka->jika", x236) * -1
    del x236
    x237 += einsum("ijak->ijka", v.aabb.oovo) * -1
    x238 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x238 += einsum("ia,ijkb->jkab", t1.aa, x237)
    del x237
    t2new_baba += einsum("ijab->jiba", x238)
    t2new_abab += einsum("ijab->ijab", x238)
    del x238
    x239 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x239 += einsum("ia,jabk->kijb", t1.bb, v.bbaa.ovvo)
    x248 += einsum("ijka->ikja", x239)
    del x239
    x240 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x240 += einsum("ijab,kbca->ijkc", t2.abab, v.bbaa.ovvv)
    x248 += einsum("ijka->ikja", x240)
    del x240
    x241 += einsum("ijka->ikja", v.bbbb.ooov)
    x241 += einsum("ijka->kija", v.bbbb.ooov) * -1
    x242 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x242 += einsum("ijab,jklb->ikla", t2.abab, x241)
    del x241
    x248 += einsum("ijka->ijka", x242) * -1
    del x242
    x246 += einsum("ijab->ijab", v.bbaa.oovv)
    x247 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x247 += einsum("ia,jkba->ijkb", t1.aa, x246)
    del x246
    x248 += einsum("ijka->ijka", x247)
    del x247
    x248 += einsum("ijak->kija", v.bbaa.oovo)
    x249 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x249 += einsum("ia,jikb->jkba", t1.bb, x248)
    del x248
    t2new_baba += einsum("ijab->jiba", x249) * -1
    t2new_abab += einsum("ijab->ijab", x249) * -1
    del x249
    x251 += einsum("ab->ab", f.bb.vv)
    x252 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x252 += einsum("ab,ijcb->ijca", x251, t2.abab)
    del x251
    t2new_baba += einsum("ijab->jiba", x252)
    t2new_abab += einsum("ijab->ijab", x252)
    del x252
    x254 += einsum("ab->ab", f.aa.vv)
    x255 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x255 += einsum("ab,ijbc->ijac", x254, t2.abab)
    del x254
    t2new_baba += einsum("ijab->jiba", x255)
    t2new_abab += einsum("ijab->ijab", x255)
    del x255
    x258 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x258 += einsum("ia,bcda->ibcd", t1.bb, v.aabb.vvvv)
    x259 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x259 += einsum("iabc->iabc", x258)
    del x258
    x259 += einsum("abci->iabc", v.aabb.vvvo)
    x260 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x260 += einsum("ia,jbac->ijbc", t1.aa, x259)
    del x259
    t2new_baba += einsum("ijab->jiba", x260)
    t2new_abab += einsum("ijab->ijab", x260)
    del x260
    t1new_aa += einsum("ijab,jbca->ic", t2.abab, v.bbaa.ovvv)
    t1new_aa += einsum("ia,iabj->jb", t1.bb, v.bbaa.ovvo)
    t1new_aa += einsum("ai->ia", f.aa.vo)
    t1new_bb += einsum("ijab,iacb->jc", t2.abab, v.aabb.ovvv)
    t1new_bb += einsum("ai->ia", f.bb.vo)
    t1new_bb += einsum("ia,iabj->jb", t1.aa, v.aabb.ovvo)
    t2new_aaaa -= einsum("aibj->jiab", v.aaaa.vovo)
    t2new_aaaa += einsum("aibj->jiba", v.aaaa.vovo)
    t2new_bbbb -= einsum("aibj->jiab", v.bbbb.vovo)
    t2new_bbbb += einsum("aibj->jiba", v.bbbb.vovo)
    t2new_baba += einsum("aibj->jiba", v.aabb.vovo)
    t2new_abab += einsum("aibj->ijab", v.aabb.vovo)

    t1new.aa = t1new_aa
    t1new.bb = t1new_bb
    t2new.abab = t2new_abab
    t2new.baba = t2new_baba
    t2new.aaaa = t2new_aaaa
    t2new.bbbb = t2new_bbbb

    return {"t1new": t1new, "t2new": t2new}

def update_lams(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    l1new = SimpleNamespace()
    l2new = SimpleNamespace()

    # L1 and L2 amplitudes
    x0 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x0 += einsum("abij,kjac->ikbc", l2.abab, t2.abab)
    l1new_aa = np.zeros((nvir[0], nocc[0]), dtype=np.float64)
    l1new_aa += einsum("iabc,jibc->aj", v.aabb.ovvv, x0) * -1
    del x0
    x1 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x1 += einsum("abij,klab->ikjl", l2.abab, t2.abab)
    x58 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x58 += einsum("ijkl->ijkl", x1)
    x369 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x369 += einsum("ijkl->ijkl", x1)
    l1new_aa += einsum("iajk,likj->al", v.aabb.ovoo, x1)
    l1new_bb = np.zeros((nvir[1], nocc[1]), dtype=np.float64)
    l1new_bb += einsum("ijka,jilk->al", v.aabb.ooov, x1)
    del x1
    x2 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x2 += einsum("ia,bajk->jkib", t1.bb, l2.abab)
    x3 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x3 += einsum("ia,jkla->jikl", t1.aa, x2)
    x58 += einsum("ijkl->ijkl", x3)
    x59 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x59 += einsum("ia,jkil->jkla", t1.bb, x58)
    x198 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x198 += einsum("ia,ijkl->jkla", t1.aa, x58)
    del x58
    x369 += einsum("ijkl->ijkl", x3)
    x370 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x370 += einsum("iajb,kilj->klab", v.aabb.ovov, x369)
    del x369
    l2new_baba = np.zeros((nvir[1], nvir[0], nocc[1], nocc[0]), dtype=np.float64)
    l2new_baba += einsum("ijab->baji", x370)
    l2new_abab = np.zeros((nvir[0], nvir[1], nocc[0], nocc[1]), dtype=np.float64)
    l2new_abab += einsum("ijab->abij", x370)
    del x370
    l1new_aa += einsum("iajk,likj->al", v.aabb.ovoo, x3)
    l1new_bb += einsum("ijka,jilk->al", v.aabb.ooov, x3)
    del x3
    x44 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x44 += einsum("ia,jikb->jkba", t1.bb, x2)
    x59 += einsum("ijab,kjla->kilb", t2.abab, x2)
    x142 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x142 += einsum("ijab,ijka->kb", t2.abab, x2)
    x151 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x151 += einsum("ia->ia", x142)
    del x142
    x192 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x192 += einsum("ijab,ikla->kljb", t2.abab, x2)
    x220 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x220 += einsum("iajk,lkjb->liba", v.aabb.ovoo, x2)
    x248 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x248 -= einsum("ijab->ijab", x220)
    del x220
    x341 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x341 += einsum("iabc,jkib->jkca", v.bbaa.ovvv, x2)
    l2new_baba -= einsum("ijab->baji", x341)
    l2new_abab -= einsum("ijab->abij", x341)
    del x341
    l1new_aa -= einsum("ijab,kjia->bk", v.bbaa.oovv, x2)
    x4 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x4 += einsum("ia,jbka->ijkb", t1.aa, v.aaaa.ovov)
    x5 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x5 += einsum("ijka->ikja", x4) * -1
    x5 += einsum("ijka->ijka", x4)
    x14 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x14 += einsum("ijka->jkia", x4)
    x14 += einsum("ijka->kjia", x4) * -1
    x62 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x62 += einsum("ia,jkla->ijkl", t1.aa, x4)
    x63 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x63 += einsum("ia,jkil->kjla", t1.aa, x62)
    x64 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x64 += einsum("ijka->ijka", x63)
    del x63
    x272 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x272 += einsum("abij,jikl->klba", l2.aaaa, x62)
    del x62
    x273 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x273 += einsum("ijab->ijab", x272)
    del x272
    x74 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x74 += einsum("ijka->jkia", x4) * -1
    x79 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x79 += einsum("ijka->jkia", x4) * -1
    x79 += einsum("ijka->kjia", x4)
    x243 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x243 += einsum("ijka->ijka", x4)
    x253 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x253 += einsum("ijka->ikja", x4) * -1
    x253 += einsum("ijka->ijka", x4)
    del x4
    x5 += einsum("ijka->jkia", v.aaaa.ooov)
    x5 += einsum("ijka->jika", v.aaaa.ooov) * -1
    x6 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x6 += einsum("ijab->jiba", t2.aaaa)
    x6 += einsum("ijab->jiab", t2.aaaa) * -1
    x12 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x12 += einsum("ijka,jlab->iklb", x5, x6)
    del x5
    x212 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x212 += einsum("iabc,ijca->jb", v.aaaa.ovvv, x6) * -1
    x7 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x7 += einsum("ia,jakb->ijkb", t1.aa, v.aabb.ovov)
    x8 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x8 += einsum("ijka->jika", x7)
    x391 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x391 += einsum("ijka->jika", x7)
    x8 += einsum("ijka->ijka", v.aabb.ooov)
    x12 += einsum("ijab,kljb->lkia", t2.abab, x8)
    x81 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x81 += einsum("ijab,ikjb->ka", t2.abab, x8)
    x102 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x102 += einsum("ia->ia", x81)
    x212 += einsum("ia->ia", x81) * -1
    del x81
    x180 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x180 += einsum("ijab,iklb->klja", t2.abab, x8)
    x372 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x372 += einsum("ijka,likb->ljab", x2, x8)
    l2new_baba += einsum("ijab->baji", x372)
    l2new_abab += einsum("ijab->abij", x372)
    del x372
    x9 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x9 += einsum("iabj->ijba", v.aaaa.ovvo)
    x9 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x12 += einsum("ia,jkba->ijkb", t1.aa, x9)
    x87 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x87 += einsum("ia,ijba->jb", t1.aa, x9)
    x102 += einsum("ia->ia", x87) * -1
    x212 += einsum("ia->ia", x87)
    del x87
    x10 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x10 += einsum("ia,jkla->ijlk", t1.aa, v.aaaa.ooov)
    x11 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x11 += einsum("ijkl->ikjl", x10)
    x11 += einsum("ijkl->ijkl", x10) * -1
    x12 += einsum("ia,jkil->jkla", t1.aa, x11) * -1
    del x11
    x218 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x218 += einsum("abij,jkli->klba", l2.aaaa, x10)
    del x10
    x248 -= einsum("ijab->ijab", x218)
    del x218
    x13 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x13 += einsum("abij->jiba", l2.aaaa) * -1
    x13 += einsum("abij->jiab", l2.aaaa)
    x44 += einsum("ijab,ikca->kjcb", t2.abab, x13) * -1
    l1new_aa += einsum("ijka,ikab->bj", x12, x13) * -1
    del x12
    x14 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x14 += einsum("ijka->kija", v.aaaa.ooov)
    x29 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x29 += einsum("ijab,ikla->kljb", t2.abab, x14) * -1
    del x14
    x15 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x15 += einsum("ijab->jiba", t2.bbbb)
    x15 += einsum("ijab->jiab", t2.bbbb) * -1
    x29 += einsum("ijab,klia->kljb", x15, x8) * -1
    x44 += einsum("abij,jkbc->ikac", l2.abab, x15) * -1
    l1new_aa += einsum("iabc,jiba->cj", v.bbaa.ovvv, x44) * -1
    del x44
    x128 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x128 += einsum("iabc,ijca->jb", v.bbbb.ovvv, x15) * -1
    x145 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x145 += einsum("ai,ijab->jb", l1.bb, x15)
    x151 += einsum("ia->ia", x145) * -1
    del x145
    x148 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x148 += einsum("abij,ikba->jk", l2.bbbb, x15)
    x149 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x149 += einsum("ij->ij", x148) * -1
    x191 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x191 += einsum("ij->ij", x148) * -1
    del x148
    x154 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x154 += einsum("abij,ijca->bc", l2.bbbb, x15)
    x155 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x155 += einsum("ab->ab", x154) * -1
    x329 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x329 += einsum("ab->ab", x154) * -1
    del x154
    x211 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x211 += einsum("iabc,ijac->jb", v.bbbb.ovvv, x15) * -1
    x16 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x16 += einsum("ia,jbka->jikb", t1.bb, v.aabb.ovov)
    x17 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x17 += einsum("ijka->ikja", x16)
    x24 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x24 += einsum("ijka->ikja", x16)
    x221 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x221 += einsum("ijka,ljkb->liba", x16, x2)
    x248 -= einsum("ijab->ijab", x221)
    del x221
    x389 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x389 += einsum("ijka->ikja", x16)
    del x16
    x17 += einsum("iajk->ijka", v.aabb.ovoo)
    x29 += einsum("ijab,kjla->kilb", t2.abab, x17)
    x110 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x110 += einsum("ijab,ijka->kb", t2.abab, x17)
    x128 += einsum("ia->ia", x110) * -1
    x211 += einsum("ia->ia", x110)
    del x110
    x172 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x172 += einsum("ijab,ikla->jklb", t2.abab, x17)
    x176 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x176 += einsum("ijka->kjia", x172)
    x187 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x187 += einsum("ijka->kjia", x172)
    del x172
    x366 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x366 += einsum("ia,jkla->ijkl", t1.aa, x17)
    x367 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x367 += einsum("ijkl->jikl", x366)
    del x366
    x18 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x18 += einsum("ia,jbia->jb", t1.bb, v.aabb.ovov)
    x21 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x21 += einsum("ia->ia", x18)
    x40 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x40 += einsum("ia->ia", x18)
    x247 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x247 += einsum("ia->ia", x18)
    x393 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x393 += einsum("ia->ia", x18)
    del x18
    x19 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x19 += einsum("iajb->jiba", v.aaaa.ovov) * -1
    x19 += einsum("iajb->jiab", v.aaaa.ovov)
    x20 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x20 += einsum("ia,ijab->jb", t1.aa, x19)
    x21 += einsum("ia->ia", x20) * -1
    x40 += einsum("ia->ia", x20) * -1
    del x20
    x41 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x41 += einsum("ia,jkab->jkib", x40, t2.aaaa)
    x42 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x42 += einsum("ijka->jika", x41)
    del x41
    x257 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x257 += einsum("ia,ja->ij", t1.aa, x40)
    x258 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x258 += einsum("ij->ij", x257)
    del x257
    x256 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x256 += einsum("ijab,ikab->jk", t2.aaaa, x19)
    x258 += einsum("ij->ij", x256) * -1
    del x256
    x347 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x347 += einsum("ijab,ikac->kjcb", t2.abab, x19)
    x349 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x349 += einsum("ijab->ijab", x347) * -1
    del x347
    x375 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x375 += einsum("ijab,ijbc->ac", t2.aaaa, x19)
    x376 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x376 += einsum("ab->ab", x375) * -1
    del x375
    x21 += einsum("ia->ia", f.aa.ov)
    x29 += einsum("ia,jkab->ijkb", x21, t2.abab) * -1
    x94 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x94 += einsum("ia,ja->ij", t1.aa, x21)
    x95 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x95 += einsum("ij->ji", x94)
    del x94
    x112 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x112 += einsum("ia,ijab->jb", x21, t2.abab)
    x128 += einsum("ia->ia", x112)
    x211 += einsum("ia->ia", x112) * -1
    del x112
    x22 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x22 += einsum("ia,jkla->jkil", t1.bb, v.aabb.ooov)
    x26 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x26 += einsum("ijkl->ijlk", x22)
    x367 += einsum("ijkl->ijlk", x22)
    del x22
    x23 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x23 += einsum("ijab,kalb->ikjl", t2.abab, v.aabb.ovov)
    x26 += einsum("ijkl->jilk", x23)
    x367 += einsum("ijkl->jilk", x23)
    del x23
    x24 += einsum("iajk->ijka", v.aabb.ovoo)
    x25 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x25 += einsum("ia,jkla->ijkl", t1.aa, x24)
    del x24
    x26 += einsum("ijkl->jikl", x25)
    del x25
    x26 += einsum("ijkl->ijkl", v.aabb.oooo)
    x29 += einsum("ia,jkil->jkla", t1.bb, x26)
    x180 += einsum("ia,ijkl->jkla", t1.aa, x26)
    del x26
    x27 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x27 += einsum("ia,jbca->jibc", t1.bb, v.aabb.ovvv)
    x28 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x28 += einsum("ijab->ijab", x27)
    x229 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x229 += einsum("ijab->ijab", x27)
    x349 += einsum("ijab->ijab", x27)
    del x27
    x28 += einsum("iabj->ijab", v.aabb.ovvo)
    x29 += einsum("ia,jkab->jikb", t1.aa, x28) * -1
    x29 += einsum("ijak->ijka", v.aabb.oovo) * -1
    x29 += einsum("ia,jkba->jkib", t1.bb, v.aabb.oovv) * -1
    x29 += einsum("ijab,kacb->kijc", t2.abab, v.aabb.ovvv) * -1
    l1new_aa += einsum("abij,kijb->ak", l2.abab, x29)
    del x29
    x30 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x30 += einsum("abij,kjcb->ikac", l2.abab, t2.abab)
    x32 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x32 += einsum("ijab->ijab", x30)
    x255 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x255 += einsum("ijab,kica->kjcb", x19, x30)
    del x30
    x268 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x268 += einsum("ijab->ijab", x255)
    del x255
    x31 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x31 += einsum("abij->jiba", l2.aaaa)
    x31 += einsum("abij->jiab", l2.aaaa) * -1
    x32 += einsum("ijab,ikac->jkbc", x31, x6)
    x33 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x33 += einsum("iabc->ibac", v.aaaa.ovvv)
    x33 += einsum("iabc->ibca", v.aaaa.ovvv) * -1
    x351 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x351 += einsum("ia,jbac->ijbc", t1.aa, x33)
    x352 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x352 += einsum("ijab->jiab", x351) * -1
    del x351
    l1new_aa += einsum("ijab,jacb->ci", x32, x33) * -1
    del x32
    x34 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x34 += einsum("ia,jkil->jkla", t1.aa, v.aaaa.oooo)
    x36 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x36 += einsum("ijka->ijka", x34)
    del x34
    x35 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x35 += einsum("ia,jkab->ikjb", f.aa.ov, t2.aaaa)
    x36 += einsum("ijka->ijka", x35)
    del x35
    x36 += einsum("ijak->ijka", v.aaaa.oovo) * -1
    x43 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x43 += einsum("ijka->ikja", x36) * -1
    x43 += einsum("ijka->ijka", x36)
    del x36
    x37 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x37 += einsum("ijab,kacb->ijkc", t2.aaaa, v.aaaa.ovvv)
    x42 += einsum("ijka->ijka", x37) * -1
    del x37
    x38 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x38 += einsum("ijab,kbla->ijlk", t2.aaaa, v.aaaa.ovov)
    x39 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x39 += einsum("ia,jkil->kjla", t1.aa, x38)
    x42 += einsum("ijka->ijka", x39)
    del x39
    x43 += einsum("ijka->kjia", x42) * -1
    x43 += einsum("ijka->kija", x42)
    del x42
    l1new_aa += einsum("abij,kjib->ak", l2.aaaa, x43) * -1
    del x43
    x270 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x270 += einsum("abij,ijkl->klab", l2.aaaa, x38)
    del x38
    x273 += einsum("ijab->ijab", x270)
    del x270
    x45 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x45 += einsum("ia,abjk->jikb", t1.aa, l2.abab)
    x52 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x52 += einsum("ijab,kljb->klia", t2.abab, x45)
    x59 += einsum("ijab,klia->kljb", x15, x45) * -1
    x130 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x130 += einsum("ijab,ikjb->ka", t2.abab, x45)
    x136 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x136 += einsum("ia->ia", x130)
    del x130
    x189 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x189 += einsum("ia,ijkb->jkab", t1.aa, x45)
    x198 += einsum("ijab,iklb->klja", t2.abab, x45)
    x281 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x281 += einsum("ijka,jilb->lkba", v.aabb.ooov, x45)
    x311 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x311 -= einsum("ijab->ijab", x281)
    del x281
    x284 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x284 += einsum("ijka,ijlb->klab", x45, x7)
    del x7
    x311 -= einsum("ijab->ijab", x284)
    del x284
    x343 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x343 += einsum("iabc,jikb->jkac", v.aabb.ovvv, x45)
    l2new_baba -= einsum("ijab->baji", x343)
    l2new_abab -= einsum("ijab->abij", x343)
    del x343
    x371 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x371 += einsum("ijka,likb->ljab", x17, x45)
    l2new_baba += einsum("ijab->baji", x371)
    l2new_abab += einsum("ijab->abij", x371)
    del x371
    x388 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x388 += einsum("ia,jikb->jkab", x21, x45)
    l2new_baba += einsum("ijab->baji", x388) * -1
    l2new_abab += einsum("ijab->abij", x388) * -1
    del x388
    l1new_aa += einsum("ijab,kijb->ak", x28, x45) * -1
    del x28
    l1new_bb -= einsum("ijab,jika->bk", v.aabb.oovv, x45)
    l2new_baba += einsum("ijka,iklb->balj", x253, x45) * -1
    l2new_abab += einsum("ijka,ijlb->abkl", x253, x45)
    x46 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x46 += einsum("ia,bajk->jkib", t1.aa, l2.aaaa)
    x47 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x47 += einsum("ijka->ijka", x46)
    x47 += einsum("ijka->jika", x46) * -1
    x52 += einsum("ijka,jlba->iklb", x47, x6)
    x254 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x254 += einsum("ijka,likb->ljba", x253, x47)
    del x253
    x268 += einsum("ijab->ijab", x254)
    del x254
    l1new_aa += einsum("ijka,kjab->bi", x47, x9)
    del x9
    del x47
    x53 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x53 += einsum("ijka->ijka", x46) * -1
    x53 += einsum("ijka->jika", x46)
    x54 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x54 += einsum("ia,ijkb->jkba", t1.aa, x53) * -1
    l1new_aa += einsum("iabc,jiab->cj", x33, x54)
    del x54
    x59 += einsum("ijab,kila->kljb", t2.abab, x53) * -1
    l2new_baba += einsum("ijka,kilb->balj", x53, x8) * -1
    del x53
    x67 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x67 += einsum("ia,jkla->kjli", t1.aa, x46)
    x68 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x68 += einsum("ia,jikl->jkla", t1.aa, x67)
    x69 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x69 += einsum("ijka->ijka", x68)
    del x68
    x75 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x75 += einsum("ijkl->ijkl", x67) * -1
    x75 += einsum("ijkl->ijlk", x67)
    l1new_aa += einsum("ijka,ljik->al", v.aaaa.ooov, x75)
    del x75
    x271 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x271 += einsum("iajb,klji->lkab", v.aaaa.ovov, x67)
    del x67
    x273 += einsum("ijab->ijab", x271)
    del x271
    x216 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x216 += einsum("ia,jkib->jkab", f.aa.ov, x46)
    x248 += einsum("ijab->ijab", x216)
    del x216
    x219 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x219 += einsum("iabc,jkib->kjac", v.aaaa.ovvv, x46)
    x248 -= einsum("ijab->ijab", x219)
    del x219
    x231 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x231 += einsum("ijka->ijka", x46)
    x231 -= einsum("ijka->jika", x46)
    x267 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x267 += einsum("ia,jkib->jkba", x40, x46)
    del x40
    x268 += einsum("ijab->ijab", x267)
    del x267
    x395 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x395 -= einsum("ijka->ijka", x46)
    x395 += einsum("ijka->jika", x46)
    l2new_abab += einsum("ijka,kilb->abjl", x395, x8) * -1
    del x8
    del x395
    x48 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x48 += einsum("abij,kjab->ik", l2.abab, t2.abab)
    x51 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x51 += einsum("ij->ij", x48)
    x134 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x134 += einsum("ij->ij", x48)
    del x48
    x49 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x49 += einsum("ijab->jiba", t2.aaaa) * -1
    x49 += einsum("ijab->jiab", t2.aaaa)
    x50 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x50 += einsum("abij,ikab->jk", l2.aaaa, x49)
    x51 += einsum("ij->ij", x50) * -1
    x52 += einsum("ia,jk->jkia", t1.aa, x51)
    l1new_aa += einsum("ijab,kija->bk", x19, x52) * -1
    del x52
    x59 += einsum("ia,jk->jkia", t1.bb, x51) * -1
    x266 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x266 += einsum("ij,jakb->ikab", x51, v.aaaa.ovov)
    x268 += einsum("ijab->ijba", x266) * -1
    del x266
    l1new_aa += einsum("ia,ji->aj", f.aa.ov, x51) * -1
    del x51
    x134 += einsum("ij->ij", x50) * -1
    del x50
    x102 += einsum("iabc,ijca->jb", v.aaaa.ovvv, x49) * -1
    x102 += einsum("ia,ijba->jb", x21, x49) * -1
    x131 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x131 += einsum("ijka,jiba->kb", x46, x49)
    del x46
    x136 += einsum("ia->ia", x131) * -1
    del x131
    x132 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x132 += einsum("ai,ijba->jb", l1.aa, x49)
    x136 += einsum("ia->ia", x132) * -1
    del x132
    x139 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x139 += einsum("abij,ijac->bc", l2.aaaa, x49)
    x140 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x140 += einsum("ab->ab", x139) * -1
    x260 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x260 += einsum("ab->ab", x139) * -1
    del x139
    x180 += einsum("ijka,ilba->ljkb", x17, x49) * -1
    x189 += einsum("abij,ikca->kjcb", l2.abab, x49) * -1
    x198 += einsum("ijka,ilba->ljkb", x2, x49) * -1
    x212 += einsum("ia,ijab->jb", x21, x49) * -1
    x344 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x344 += einsum("iajb,ikac->kjcb", v.aabb.ovov, x49)
    x346 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x346 += einsum("ijab->ijab", x344) * -1
    del x344
    x350 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x350 += einsum("ijab,ikcb->jkac", x19, x49)
    del x49
    x352 += einsum("ijab->ijba", x350)
    del x350
    x55 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x55 += einsum("ia,bacd->icbd", t1.aa, v.aaaa.vvvv)
    x56 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x56 += einsum("iabc->iabc", x55) * -1
    del x55
    x56 += einsum("aibc->iabc", v.aaaa.vovv)
    x57 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x57 += einsum("iabc->ibac", x56) * -1
    x57 += einsum("iabc->iabc", x56)
    del x56
    l1new_aa += einsum("abij,ibac->cj", l2.aaaa, x57) * -1
    del x57
    x59 += einsum("ai,jkab->ijkb", l1.aa, t2.abab) * -1
    l1new_aa += einsum("iajb,kijb->ak", v.aabb.ovov, x59)
    del x59
    x60 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x60 += einsum("ia,jbca->ijcb", t1.aa, v.aaaa.ovvv)
    x61 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x61 += einsum("ia,jkba->ijkb", t1.aa, x60)
    del x60
    x64 += einsum("ijka->ijka", x61) * -0.9999999999999993
    del x61
    x65 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x65 += einsum("ijka->ijka", x64)
    x65 += einsum("ijka->jika", x64) * -1
    del x64
    l1new_aa += einsum("abij,ijka->bk", l2.aaaa, x65) * -1
    del x65
    x66 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x66 += einsum("ai,jkab->ikjb", l1.aa, t2.aaaa)
    x69 += einsum("ijka->ijka", x66) * 0.9999999999999993
    del x66
    x70 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x70 += einsum("ijka->ikja", x69) * -1
    x70 += einsum("ijka->ijka", x69)
    del x69
    l1new_aa += einsum("iajb,kjib->ak", v.aaaa.ovov, x70) * -1
    del x70
    x71 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x71 += einsum("abci->iabc", v.aabb.vvvo)
    x71 += einsum("ia,bcda->ibcd", t1.bb, v.aabb.vvvv)
    l1new_aa += einsum("abij,jacb->ci", l2.abab, x71)
    del x71
    x72 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x72 += einsum("abij,klba->ijlk", l2.aaaa, t2.aaaa)
    x73 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x73 += einsum("ijkl->jikl", x72)
    x73 += einsum("ijkl->jilk", x72) * -1
    x269 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x269 += einsum("iajb,klij->lkba", v.aaaa.ovov, x72)
    del x72
    x273 += einsum("ijab->ijab", x269)
    del x269
    l2new_aaaa = np.zeros((nvir[0], nvir[0], nocc[0], nocc[0]), dtype=np.float64)
    l2new_aaaa += einsum("ijab->baij", x273) * -1
    l2new_aaaa += einsum("ijab->abij", x273)
    del x273
    x74 += einsum("ijka->ikja", v.aaaa.ooov)
    l1new_aa += einsum("ijkl,klia->aj", x73, x74) * -1
    del x73
    del x74
    x76 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x76 += einsum("ia,iabj->jb", t1.bb, v.bbaa.ovvo)
    x102 += einsum("ia->ia", x76) * -1
    x212 += einsum("ia->ia", x76)
    del x76
    x77 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x77 += einsum("ijab,ikja->kb", t2.aaaa, v.aaaa.ooov)
    x102 += einsum("ia->ia", x77) * -1
    x212 += einsum("ia->ia", x77)
    del x77
    x78 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x78 += einsum("ijab,jbca->ic", t2.abab, v.bbaa.ovvv)
    x102 += einsum("ia->ia", x78) * -1
    x212 += einsum("ia->ia", x78)
    del x78
    x79 += einsum("ijka->ikja", v.aaaa.ooov)
    x80 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x80 += einsum("ijab,jika->kb", t2.aaaa, x79)
    del x79
    x102 += einsum("ia->ia", x80)
    x212 += einsum("ia->ia", x80) * -1
    del x80
    x82 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x82 += einsum("ia,iajb->jb", t1.aa, v.aabb.ovov)
    x85 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x85 += einsum("ia->ia", x82)
    x163 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x163 += einsum("ia->ia", x82)
    x310 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x310 += einsum("ia->ia", x82)
    x394 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x394 += einsum("ia->ia", x82)
    del x82
    x83 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x83 += einsum("iajb->jiba", v.bbbb.ovov) * -1
    x83 += einsum("iajb->jiab", v.bbbb.ovov)
    x84 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x84 += einsum("ia,ijab->jb", t1.bb, x83)
    x85 += einsum("ia->ia", x84) * -1
    x163 += einsum("ia->ia", x84) * -1
    del x84
    x164 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x164 += einsum("ia,jkab->jkib", x163, t2.bbbb)
    x169 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x169 += einsum("ijka->jika", x164)
    del x164
    x322 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x322 += einsum("ia,ja->ij", t1.bb, x163)
    x323 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x323 += einsum("ij->ij", x322)
    del x322
    x117 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x117 += einsum("ijab,ikab->jk", t2.bbbb, x83)
    x121 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x121 += einsum("ij->ji", x117) * -1
    del x117
    x345 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x345 += einsum("ijab,jkbc->ikac", t2.abab, x83)
    x346 += einsum("ijab->ijab", x345) * -1
    del x345
    x355 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x355 += einsum("ijab,ikca->jkbc", x15, x83)
    x357 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x357 += einsum("ijab->jiab", x355)
    del x355
    x85 += einsum("ia->ia", f.bb.ov)
    x86 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x86 += einsum("ia,jiba->jb", x85, t2.abab)
    x102 += einsum("ia->ia", x86) * -1
    x212 += einsum("ia->ia", x86)
    del x86
    x120 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x120 += einsum("ia,ja->ij", t1.bb, x85)
    x121 += einsum("ij->ji", x120)
    del x120
    x180 += einsum("ia,jkba->jikb", x85, t2.abab) * -1
    x211 += einsum("ia,ijab->jb", x85, x15) * -1
    x387 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x387 += einsum("ia,jkib->jkba", x85, x2)
    l2new_baba += einsum("ijab->baji", x387) * -1
    l2new_abab += einsum("ijab->abij", x387) * -1
    del x387
    x88 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x88 += einsum("ia,jkia->jk", t1.bb, v.aabb.ooov)
    x95 += einsum("ij->ij", x88)
    x238 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x238 += einsum("ij->ij", x88)
    del x88
    x89 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x89 += einsum("ijab,kajb->ik", t2.abab, v.aabb.ovov)
    x95 += einsum("ij->ji", x89)
    x258 += einsum("ij->ij", x89)
    del x89
    x259 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x259 += einsum("ij,abik->kjab", x258, l2.aaaa)
    del x258
    x268 += einsum("ijab->ijba", x259)
    del x259
    x90 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x90 += einsum("iajb->jiba", v.aaaa.ovov)
    x90 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x91 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x91 += einsum("ijab,ikba->jk", t2.aaaa, x90)
    x95 += einsum("ij->ji", x91) * -1
    del x91
    x250 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x250 += einsum("ijab,ikac->jkbc", x6, x90)
    del x6
    x251 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x251 += einsum("ijab->ijab", x250)
    del x250
    x263 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x263 += einsum("ijab,ijbc->ac", t2.aaaa, x90)
    del x90
    x264 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x264 += einsum("ab->ab", x263) * -1
    del x263
    x92 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x92 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x92 += einsum("ijka->kija", v.aaaa.ooov)
    x93 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x93 += einsum("ia,jika->jk", t1.aa, x92)
    x95 += einsum("ij->ij", x93) * -1
    del x93
    x95 += einsum("ij->ij", f.aa.oo)
    x96 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x96 += einsum("ia,ij->ja", t1.aa, x95)
    x102 += einsum("ia->ia", x96)
    x212 += einsum("ia->ia", x96) * -1
    del x96
    x381 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x381 += einsum("ij,abjk->ikab", x95, l2.abab)
    l2new_baba += einsum("ijab->baji", x381) * -1
    l2new_abab += einsum("ijab->abij", x381) * -1
    del x381
    l1new_aa += einsum("ai,ji->aj", l1.aa, x95) * -1
    del x95
    x97 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x97 += einsum("ia,iabc->bc", t1.bb, v.bbaa.ovvv)
    x100 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x100 += einsum("ab->ab", x97)
    x235 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x235 += einsum("ab->ab", x97)
    x376 += einsum("ab->ab", x97)
    del x97
    x98 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x98 += einsum("iabc->ibac", v.aaaa.ovvv) * -1
    x98 += einsum("iabc->ibca", v.aaaa.ovvv)
    x99 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x99 += einsum("ia,ibac->bc", t1.aa, x98)
    del x98
    x100 += einsum("ab->ab", x99) * -1
    x376 += einsum("ab->ab", x99) * -1
    del x99
    x100 += einsum("ab->ab", f.aa.vv)
    x101 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x101 += einsum("ia,ba->ib", t1.aa, x100)
    x102 += einsum("ia->ia", x101) * -1
    x212 += einsum("ia->ia", x101)
    del x101
    l1new_aa += einsum("ai,ab->bi", l1.aa, x100)
    del x100
    x102 += einsum("ai->ia", f.aa.vo) * -1
    x103 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x103 -= einsum("abij->jiba", l2.aaaa)
    x103 += einsum("abij->jiab", l2.aaaa)
    l1new_aa += einsum("ia,ijba->bj", x102, x103) * -1
    del x102
    x104 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x104 += einsum("ia,iabj->jb", t1.aa, v.aabb.ovvo)
    x128 += einsum("ia->ia", x104)
    x211 += einsum("ia->ia", x104) * -1
    del x104
    x105 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x105 += einsum("ijab,iacb->jc", t2.abab, v.aabb.ovvv)
    x128 += einsum("ia->ia", x105)
    x211 += einsum("ia->ia", x105) * -1
    del x105
    x106 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x106 += einsum("ijab,ikja->kb", t2.bbbb, v.bbbb.ooov)
    x128 += einsum("ia->ia", x106)
    x211 += einsum("ia->ia", x106) * -1
    del x106
    x107 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x107 += einsum("ia,jbka->ijkb", t1.bb, v.bbbb.ovov)
    x108 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x108 += einsum("ijka->jkia", x107) * -1
    x108 += einsum("ijka->kjia", x107)
    x166 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x166 += einsum("ia,jkla->ijkl", t1.bb, x107)
    x167 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x167 += einsum("ijkl->ijkl", x166)
    x336 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x336 += einsum("ijkl->ijkl", x166)
    del x166
    x170 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x170 += einsum("ijka->ikja", x107) * -1
    x170 += einsum("ijka->ijka", x107)
    x177 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x177 += einsum("ijka->jkia", x107)
    x177 += einsum("ijka->kjia", x107) * -1
    x306 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x306 += einsum("ijka->ijka", x107)
    x317 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x317 += einsum("ijka->ikja", x107)
    x317 += einsum("ijka->ijka", x107) * -1
    del x107
    x374 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x374 += einsum("ijka,jklb->ilab", x2, x317)
    l2new_baba += einsum("ijab->baji", x374) * -1
    l2new_abab += einsum("ijab->abij", x374) * -1
    del x374
    x108 += einsum("ijka->ikja", v.bbbb.ooov)
    x109 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x109 += einsum("ijab,jika->kb", t2.bbbb, x108)
    del x108
    x128 += einsum("ia->ia", x109) * -1
    x211 += einsum("ia->ia", x109)
    del x109
    x111 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x111 += einsum("ijab->jiba", t2.bbbb) * -1
    x111 += einsum("ijab->jiab", t2.bbbb)
    x128 += einsum("ia,ijab->jb", x85, x111) * -1
    del x85
    x348 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x348 += einsum("iajb,jkbc->ikac", v.aabb.ovov, x111)
    x349 += einsum("ijab->ijab", x348) * -1
    del x348
    x113 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x113 += einsum("iabj->ijba", v.bbbb.ovvo)
    x113 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x114 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x114 += einsum("ia,ijba->jb", t1.bb, x113)
    x128 += einsum("ia->ia", x114)
    x211 += einsum("ia->ia", x114) * -1
    del x114
    x173 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x173 += einsum("ia,jkba->ijkb", t1.bb, x113)
    x176 += einsum("ijka->ijka", x173)
    x187 += einsum("ijka->ijka", x173)
    del x173
    x115 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x115 += einsum("ia,iajk->jk", t1.aa, v.aabb.ovoo)
    x121 += einsum("ij->ij", x115)
    x301 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x301 += einsum("ij->ij", x115)
    del x115
    x116 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x116 += einsum("ijab,iakb->jk", t2.abab, v.aabb.ovov)
    x121 += einsum("ij->ji", x116)
    x323 += einsum("ij->ij", x116)
    del x116
    x118 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x118 += einsum("ijka->ikja", v.bbbb.ooov)
    x118 += einsum("ijka->kija", v.bbbb.ooov) * -1
    x119 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x119 += einsum("ia,ijka->jk", t1.bb, x118)
    x121 += einsum("ij->ij", x119) * -1
    del x119
    x121 += einsum("ij->ij", f.bb.oo)
    x122 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x122 += einsum("ia,ij->ja", t1.bb, x121)
    x128 += einsum("ia->ia", x122) * -1
    x211 += einsum("ia->ia", x122)
    del x122
    x382 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x382 += einsum("ij,abkj->kiab", x121, l2.abab)
    l2new_baba += einsum("ijab->baji", x382) * -1
    l2new_abab += einsum("ijab->abij", x382) * -1
    del x382
    l1new_bb += einsum("ai,ji->aj", l1.bb, x121) * -1
    del x121
    x123 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x123 += einsum("ia,iabc->bc", t1.aa, v.aabb.ovvv)
    x126 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x126 += einsum("ab->ab", x123)
    x298 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x298 += einsum("ab->ab", x123)
    x379 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x379 += einsum("ab->ab", x123)
    del x123
    x124 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x124 += einsum("iabc->ibac", v.bbbb.ovvv)
    x124 += einsum("iabc->ibca", v.bbbb.ovvv) * -1
    x125 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x125 += einsum("ia,ibca->bc", t1.bb, x124)
    x126 += einsum("ab->ab", x125) * -1
    x379 += einsum("ab->ab", x125) * -1
    del x125
    x356 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x356 += einsum("ia,jbac->ijbc", t1.bb, x124)
    x357 += einsum("ijab->jiab", x356) * -1
    del x356
    x126 += einsum("ab->ab", f.bb.vv)
    x127 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x127 += einsum("ia,ba->ib", t1.bb, x126)
    x128 += einsum("ia->ia", x127)
    x211 += einsum("ia->ia", x127) * -1
    del x127
    l1new_bb += einsum("ai,ab->bi", l1.bb, x126)
    del x126
    x128 += einsum("ai->ia", f.bb.vo)
    l1new_aa += einsum("ia,baji->bj", x128, l2.abab)
    del x128
    x129 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x129 += einsum("ai,jiba->jb", l1.bb, t2.abab)
    x136 += einsum("ia->ia", x129) * -1
    del x129
    x133 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x133 += einsum("ai,ja->ij", l1.aa, t1.aa)
    x134 += einsum("ij->ij", x133)
    x135 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x135 += einsum("ia,ij->ja", t1.aa, x134)
    x136 += einsum("ia->ia", x135)
    del x135
    x385 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x385 += einsum("ij,jakb->ikab", x134, v.aabb.ovov)
    l2new_baba += einsum("ijab->baji", x385) * -1
    l2new_abab += einsum("ijab->abij", x385) * -1
    del x385
    l1new_aa += einsum("ij,kjia->ak", x134, x92) * -1
    del x92
    l1new_bb += einsum("ij,jika->ak", x134, v.aabb.ooov) * -1
    del x134
    x217 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x217 += einsum("ij,kajb->ikab", x133, v.aaaa.ovov)
    x248 += einsum("ijab->ijab", x217)
    del x217
    l1new_aa += einsum("ij,ja->ai", x133, x21) * -1
    del x21
    del x133
    x136 += einsum("ia->ia", t1.aa) * -1
    l1new_aa += einsum("ia,ijba->bj", x136, x19) * -1
    del x19
    l1new_bb += einsum("ia,iajb->bj", x136, v.aabb.ovov) * -1
    del x136
    x137 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x137 += einsum("ai,ib->ab", l1.aa, t1.aa)
    x140 += einsum("ab->ab", x137)
    del x137
    x138 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x138 += einsum("abij,ijcb->ac", l2.abab, t2.abab)
    x140 += einsum("ab->ab", x138)
    l1new_aa += einsum("ab,iabc->ci", x140, x33) * -1
    del x33
    l1new_bb += einsum("ab,icab->ci", x140, v.bbaa.ovvv)
    del x140
    x260 += einsum("ab->ab", x138)
    del x138
    x261 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x261 += einsum("ab,ibjc->ijac", x260, v.aaaa.ovov)
    x268 += einsum("ijab->jiab", x261) * -1
    del x261
    x383 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x383 += einsum("ab,ibjc->ijac", x260, v.aabb.ovov)
    del x260
    l2new_baba += einsum("ijab->baji", x383) * -1
    l2new_abab += einsum("ijab->abij", x383) * -1
    del x383
    x141 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x141 += einsum("ai,ijab->jb", l1.aa, t2.abab)
    x151 += einsum("ia->ia", x141) * -1
    del x141
    x143 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x143 += einsum("ia,bajk->jkib", t1.bb, l2.bbbb)
    x144 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x144 += einsum("ijka,jiab->kb", x143, x15)
    x151 += einsum("ia->ia", x144) * -1
    del x144
    x190 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x190 += einsum("ijka->ijka", x143)
    x190 += einsum("ijka->jika", x143) * -1
    x192 += einsum("ijab,kila->kljb", x111, x190)
    del x111
    x198 += einsum("ijab,jklb->ikla", t2.abab, x190) * -1
    l2new_baba += einsum("ijka,kljb->bali", x17, x190)
    del x190
    x193 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x193 += einsum("ijka->ijka", x143) * -1
    x193 += einsum("ijka->jika", x143)
    x194 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x194 += einsum("ia,ijkb->jkba", t1.bb, x193) * -1
    l1new_bb += einsum("iabc,jiab->cj", x124, x194)
    del x194
    x318 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x318 += einsum("ijka,iklb->jlab", x193, x317)
    del x317
    x333 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x333 += einsum("ijab->ijab", x318)
    del x318
    l1new_bb += einsum("ijab,jkia->bk", x113, x193)
    del x113
    l2new_abab += einsum("ijka,kljb->abil", x17, x193) * -1
    del x17
    del x193
    x200 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x200 += einsum("ia,jkla->jkil", t1.bb, x143)
    x201 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x201 += einsum("ijkl->ijkl", x200)
    x209 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x209 += einsum("ijkl->ijkl", x200)
    x209 += einsum("ijkl->ijlk", x200) * -1
    l1new_bb += einsum("ijka,ljki->al", v.bbbb.ooov, x209)
    del x209
    x334 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x334 += einsum("ijkl->ijkl", x200)
    del x200
    x279 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x279 += einsum("ia,jkib->jkab", f.bb.ov, x143)
    x311 += einsum("ijab->ijab", x279)
    del x279
    x283 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x283 += einsum("iabc,jkib->kjac", v.bbbb.ovvv, x143)
    x311 -= einsum("ijab->ijab", x283)
    del x283
    x294 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x294 -= einsum("ijka->ijka", x143)
    x294 += einsum("ijka->jika", x143)
    x332 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x332 += einsum("ia,jkib->jkba", x163, x143)
    del x143
    x333 += einsum("ijab->ijab", x332)
    del x332
    x146 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x146 += einsum("ai,ja->ij", l1.bb, t1.bb)
    x149 += einsum("ij->ij", x146)
    x280 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x280 += einsum("ij,kajb->ikab", x146, v.bbbb.ovov)
    x311 += einsum("ijab->ijab", x280)
    del x280
    l1new_bb += einsum("ij,ja->ai", x146, x163) * -1
    del x146
    del x163
    x147 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x147 += einsum("abij,ikab->jk", l2.abab, t2.abab)
    x149 += einsum("ij->ij", x147)
    x150 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x150 += einsum("ia,ij->ja", t1.bb, x149)
    x151 += einsum("ia->ia", x150)
    del x150
    x386 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x386 += einsum("ij,kajb->kiab", x149, v.aabb.ovov)
    l2new_baba += einsum("ijab->baji", x386) * -1
    l2new_abab += einsum("ijab->abij", x386) * -1
    del x386
    l1new_aa += einsum("ij,kaji->ak", x149, v.aabb.ovoo) * -1
    l1new_bb += einsum("ij,jkia->ak", x149, x118) * -1
    del x118
    l1new_bb += einsum("ia,ji->aj", f.bb.ov, x149) * -1
    del x149
    x191 += einsum("ij->ij", x147)
    del x147
    x192 += einsum("ia,jk->jkia", t1.bb, x191)
    l1new_bb += einsum("ijka,jkab->bi", x192, x83) * -1
    del x192
    x198 += einsum("ia,jk->ijka", t1.aa, x191) * -1
    x331 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x331 += einsum("ij,jakb->ikab", x191, v.bbbb.ovov)
    del x191
    x333 += einsum("ijab->ijba", x331) * -1
    del x331
    x151 += einsum("ia->ia", t1.bb) * -1
    l1new_aa += einsum("ia,jbia->bj", x151, v.aabb.ovov) * -1
    l1new_bb += einsum("ia,ijab->bj", x151, x83)
    del x83
    del x151
    x152 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x152 += einsum("ai,ib->ab", l1.bb, t1.bb)
    x155 += einsum("ab->ab", x152)
    del x152
    x153 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x153 += einsum("abij,ijac->bc", l2.abab, t2.abab)
    x155 += einsum("ab->ab", x153)
    l1new_aa += einsum("ab,icab->ci", x155, v.aabb.ovvv)
    l1new_bb += einsum("ab,iabc->ci", x155, x124) * -1
    del x155
    del x124
    x329 += einsum("ab->ab", x153)
    del x153
    x330 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x330 += einsum("ab,ibjc->ijac", x329, v.bbbb.ovov)
    x333 += einsum("ijab->jiab", x330) * -1
    del x330
    x384 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x384 += einsum("ab,icjb->ijca", x329, v.aabb.ovov)
    del x329
    l2new_baba += einsum("ijab->baji", x384) * -1
    l2new_abab += einsum("ijab->abij", x384) * -1
    del x384
    x156 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x156 += einsum("iabj->ijba", v.aaaa.ovvo)
    x156 -= einsum("ijab->ijab", v.aaaa.oovv)
    l1new_aa += einsum("ai,jiab->bj", l1.aa, x156)
    del x156
    x157 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x157 += einsum("abij,ikcb->jkac", l2.abab, t2.abab)
    l1new_bb += einsum("iabc,jibc->aj", v.bbaa.ovvv, x157) * -1
    del x157
    x158 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x158 += einsum("ia,jkba->ijkb", f.bb.ov, t2.bbbb)
    x159 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x159 += einsum("ijka->ijka", x158) * -1
    del x158
    x159 += einsum("ijak->ijka", v.bbbb.oovo)
    x176 += einsum("ijka->kija", x159) * -1
    x176 += einsum("ijka->jika", x159)
    del x159
    x160 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x160 += einsum("ijab,kbca->jikc", t2.bbbb, v.bbbb.ovvv)
    x169 += einsum("ijka->ijka", x160) * -1
    del x160
    x161 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x161 += einsum("ia,jbca->ijcb", t1.bb, v.bbbb.ovvv)
    x162 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x162 += einsum("ia,jkba->ijkb", t1.bb, x161)
    del x161
    x169 += einsum("ijka->ijka", x162) * -1
    del x162
    x165 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x165 += einsum("ijab,kalb->ijkl", t2.bbbb, v.bbbb.ovov)
    x167 += einsum("ijkl->jilk", x165)
    x168 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x168 += einsum("ia,jkil->jkla", t1.bb, x167)
    del x167
    x169 += einsum("ijka->jika", x168)
    del x168
    x176 += einsum("ijka->jkia", x169)
    x176 += einsum("ijka->ikja", x169) * -1
    del x169
    x336 += einsum("ijkl->jilk", x165)
    del x165
    x337 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x337 += einsum("abij,ijkl->klab", l2.bbbb, x336)
    del x336
    x338 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x338 += einsum("ijab->jiba", x337)
    del x337
    x170 += einsum("ijka->jkia", v.bbbb.ooov)
    x170 += einsum("ijka->jika", v.bbbb.ooov) * -1
    x171 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x171 += einsum("ijab,kila->jklb", x15, x170)
    del x170
    x176 += einsum("ijka->jkia", x171)
    x187 += einsum("ijka->jkia", x171)
    del x171
    x174 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x174 += einsum("ia,jkla->ijlk", t1.bb, v.bbbb.ooov)
    x175 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x175 += einsum("ijkl->jkli", x174)
    x175 += einsum("ijkl->kjli", x174) * -1
    x186 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x186 += einsum("ijkl->ikjl", x174)
    x186 += einsum("ijkl->ijkl", x174) * -1
    x187 += einsum("ia,jkil->jkla", t1.bb, x186) * -1
    del x186
    l1new_bb += einsum("abij,ikjb->ak", l2.bbbb, x187) * -1
    del x187
    x282 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x282 += einsum("abij,jkli->klba", l2.bbbb, x174)
    del x174
    x311 -= einsum("ijab->ijab", x282)
    del x282
    x175 += einsum("ijkl->kijl", v.bbbb.oooo) * -1
    x175 += einsum("ijkl->kilj", v.bbbb.oooo)
    x176 += einsum("ia,ijkl->ljka", t1.bb, x175) * -1
    del x175
    l1new_bb += einsum("abij,ikja->bk", l2.bbbb, x176)
    del x176
    x177 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x177 += einsum("ijka->kija", v.bbbb.ooov)
    x180 += einsum("ijab,jklb->ikla", t2.abab, x177) * -1
    del x177
    x178 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x178 += einsum("ia,jabc->ijbc", t1.bb, v.bbaa.ovvv)
    x179 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x179 += einsum("ijab->jiab", x178)
    x364 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x364 += einsum("ijab->jiab", x178)
    del x178
    x179 += einsum("ijab->ijab", v.bbaa.oovv)
    x180 += einsum("ia,jkba->ijkb", t1.aa, x179) * -1
    del x179
    x180 += einsum("ijak->kija", v.bbaa.oovo) * -1
    x180 += einsum("ia,jabk->kjib", t1.bb, v.bbaa.ovvo) * -1
    x180 += einsum("ijab,kbca->ikjc", t2.abab, v.bbaa.ovvv) * -1
    l1new_bb += einsum("abij,ikja->bk", l2.abab, x180)
    del x180
    x181 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x181 += einsum("abij,ikac->jkbc", l2.abab, t2.abab)
    x184 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x184 += einsum("ijab->ijab", x181)
    del x181
    x182 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x182 += einsum("abij->jiba", l2.bbbb) * -1
    x182 += einsum("abij->jiab", l2.bbbb)
    x183 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x183 += einsum("ijab,ikca->jkbc", x15, x182)
    del x15
    x184 += einsum("ijab->jiba", x183)
    del x183
    x319 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x319 += einsum("ijab,jkbc->ikac", t2.abab, x182)
    x320 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x320 += einsum("iajb,ikac->kjcb", v.aabb.ovov, x319) * -1
    del x319
    x333 += einsum("ijab->ijab", x320) * -1
    del x320
    x185 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x185 += einsum("iabc->ibac", v.bbbb.ovvv) * -1
    x185 += einsum("iabc->ibca", v.bbbb.ovvv)
    l1new_bb += einsum("ijab,jabc->ci", x184, x185) * -1
    del x185
    x188 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x188 += einsum("abij->jiba", l2.bbbb)
    x188 += einsum("abij->jiab", l2.bbbb) * -1
    x189 += einsum("ijab,jkbc->ikac", t2.abab, x188) * -1
    l1new_bb += einsum("iabc,ijab->cj", v.aabb.ovvv, x189) * -1
    del x189
    x195 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x195 += einsum("ia,bcda->ibdc", t1.bb, v.bbbb.vvvv)
    x196 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x196 += einsum("iabc->iabc", x195) * -1
    del x195
    x196 += einsum("aibc->iabc", v.bbbb.vovv)
    x197 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x197 += einsum("iabc->ibac", x196)
    x197 += einsum("iabc->iabc", x196) * -1
    del x196
    l1new_bb += einsum("abij,iabc->cj", l2.bbbb, x197) * -1
    del x197
    x198 += einsum("ai,jkba->jikb", l1.bb, t2.abab) * -1
    l1new_bb += einsum("iajb,ikja->bk", v.aabb.ovov, x198)
    del x198
    x199 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x199 += einsum("abij,klba->ijlk", l2.bbbb, t2.bbbb)
    x201 += einsum("ijkl->jilk", x199)
    x202 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x202 += einsum("ia,ijkl->jkla", t1.bb, x201) * 0.9999999999999993
    del x201
    x203 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x203 += einsum("ijka->ijka", x202) * -1
    x203 += einsum("ijka->ikja", x202)
    del x202
    l1new_bb += einsum("iajb,kjib->ak", v.bbbb.ovov, x203) * -1
    del x203
    x210 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x210 += einsum("ijkl->jikl", x199)
    x210 += einsum("ijkl->jilk", x199) * -1
    l1new_bb += einsum("ijka,jlik->al", v.bbbb.ooov, x210) * -1
    del x210
    x334 += einsum("ijkl->jilk", x199)
    del x199
    x335 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x335 += einsum("iajb,klji->klab", v.bbbb.ovov, x334)
    del x334
    x338 += einsum("ijab->jiab", x335)
    del x335
    l2new_bbbb = np.zeros((nvir[1], nvir[1], nocc[1], nocc[1]), dtype=np.float64)
    l2new_bbbb += einsum("ijab->baij", x338) * -1
    l2new_bbbb += einsum("ijab->abij", x338)
    del x338
    x204 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x204 += einsum("aibc->iabc", v.aabb.vovv)
    x204 += einsum("ia,bacd->ibcd", t1.aa, v.aabb.vvvv)
    l1new_bb += einsum("abij,iabc->cj", l2.abab, x204)
    del x204
    x205 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x205 += einsum("ai,jkba->ijkb", l1.bb, t2.bbbb)
    x206 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x206 += einsum("ijka->ikja", x205) * -1
    x206 += einsum("ijka->ijka", x205)
    del x205
    l1new_bb += einsum("iajb,kjia->bk", v.bbbb.ovov, x206)
    del x206
    x207 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x207 += einsum("ia,jbca->ijcb", t1.aa, v.bbaa.ovvv)
    x208 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x208 += einsum("ijab->ijab", x207)
    x292 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x292 += einsum("ijab->ijab", x207)
    x346 += einsum("ijab->ijab", x207)
    del x207
    x208 += einsum("iabj->jiba", v.bbaa.ovvo)
    l1new_bb += einsum("ijka,ikab->bj", x2, x208) * -1
    del x208
    x211 += einsum("ai->ia", f.bb.vo) * -1
    l1new_bb += einsum("ia,ijab->bj", x211, x182)
    del x211
    x212 += einsum("ai->ia", f.aa.vo)
    l1new_bb += einsum("ia,abij->bj", x212, l2.abab)
    del x212
    x213 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x213 += einsum("iabj->ijba", v.bbbb.ovvo)
    x213 -= einsum("ijab->ijab", v.bbbb.oovv)
    l1new_bb += einsum("ai,jiab->bj", l1.bb, x213)
    del x213
    x214 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x214 += einsum("ab,caij->ijbc", f.aa.vv, l2.aaaa)
    x248 -= einsum("ijab->ijab", x214)
    del x214
    x215 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x215 += einsum("ai,jbac->ijbc", l1.aa, v.aaaa.ovvv)
    x248 -= einsum("ijab->ijab", x215)
    del x215
    x222 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x222 += einsum("abij->jiba", l2.aaaa)
    x222 -= einsum("abij->jiab", l2.aaaa)
    x223 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x223 -= einsum("iabc->ibac", v.aaaa.ovvv)
    x223 += einsum("iabc->ibca", v.aaaa.ovvv)
    x224 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x224 += einsum("ia,jbca->ijbc", t1.aa, x223)
    x225 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x225 -= einsum("ijab->ijab", x224)
    del x224
    x234 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x234 += einsum("ia,ibac->bc", t1.aa, x223)
    del x223
    x235 -= einsum("ab->ab", x234)
    del x234
    x236 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x236 += einsum("ab,acij->ijcb", x235, l2.aaaa)
    del x235
    x248 += einsum("ijab->jiab", x236)
    del x236
    x225 += einsum("iabj->jiba", v.aaaa.ovvo)
    x225 -= einsum("ijab->jiab", v.aaaa.oovv)
    x226 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x226 += einsum("ijab,ikac->jkbc", x222, x225)
    del x225
    del x222
    x248 += einsum("ijab->ijab", x226)
    del x226
    x227 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x227 -= einsum("ijab->jiba", t2.bbbb)
    x227 += einsum("ijab->jiab", t2.bbbb)
    x228 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x228 += einsum("iajb,jkbc->ikac", v.aabb.ovov, x227)
    del x227
    x229 -= einsum("ijab->ijab", x228)
    del x228
    x229 += einsum("iabj->ijab", v.aabb.ovvo)
    x230 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x230 += einsum("abij,kjcb->ikac", l2.abab, x229)
    del x229
    x248 += einsum("ijab->ijab", x230)
    del x230
    x232 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x232 -= einsum("ijka->ikja", v.aaaa.ooov)
    x232 += einsum("ijka->kija", v.aaaa.ooov)
    x233 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x233 += einsum("ijka,kljb->ilab", x231, x232)
    del x231
    x248 += einsum("ijab->ijab", x233)
    del x233
    x237 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x237 += einsum("ia,jika->jk", t1.aa, x232)
    x238 -= einsum("ij->ij", x237)
    del x237
    x239 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x239 += einsum("ij,abjk->kiab", x238, l2.aaaa)
    del x238
    x248 -= einsum("ijab->ijba", x239)
    del x239
    l2new_baba -= einsum("ijka,kjlb->bali", x232, x45)
    del x232
    x240 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x240 += einsum("ia,ja->ij", f.aa.ov, t1.aa)
    x241 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x241 += einsum("ij->ij", x240)
    del x240
    x241 += einsum("ij->ij", f.aa.oo)
    x242 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x242 += einsum("ij,abjk->kiab", x241, l2.aaaa)
    del x241
    x248 += einsum("ijab->jiba", x242)
    del x242
    x243 -= einsum("ijka->jika", v.aaaa.ooov)
    x244 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x244 += einsum("ai,ijkb->jkab", l1.aa, x243)
    del x243
    x248 += einsum("ijab->ijab", x244)
    del x244
    x245 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x245 -= einsum("iajb->jiba", v.aaaa.ovov)
    x245 += einsum("iajb->jiab", v.aaaa.ovov)
    x246 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x246 += einsum("ia,ijab->jb", t1.aa, x245)
    del x245
    x247 -= einsum("ia->ia", x246)
    x248 += einsum("ai,jb->ijab", l1.aa, x247)
    del x247
    x393 -= einsum("ia->ia", x246)
    del x246
    x248 += einsum("ia,bj->ijab", f.aa.ov, l1.aa)
    l2new_aaaa -= einsum("ijab->baij", x248)
    l2new_aaaa += einsum("ijab->abij", x248)
    l2new_aaaa += einsum("ijab->baji", x248)
    l2new_aaaa -= einsum("ijab->abji", x248)
    del x248
    x249 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x249 += einsum("ijab,kcjb->ikac", t2.abab, v.aabb.ovov)
    x251 += einsum("ijab->ijab", x249)
    x252 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x252 += einsum("ijab,ikac->kjcb", x251, x31)
    del x251
    del x31
    x268 += einsum("ijab->ijab", x252) * -1
    del x252
    x352 += einsum("ijab->jiab", x249)
    del x249
    x262 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x262 += einsum("ijab,icjb->ac", t2.abab, v.aabb.ovov)
    x264 += einsum("ab->ab", x262)
    x265 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x265 += einsum("ab,acij->ijcb", x264, l2.aaaa)
    del x264
    x268 += einsum("ijab->jiab", x265)
    del x265
    l2new_aaaa += einsum("ijab->baij", x268)
    l2new_aaaa += einsum("ijab->abij", x268) * -1
    l2new_aaaa += einsum("ijab->baji", x268) * -1
    l2new_aaaa += einsum("ijab->abji", x268)
    del x268
    x376 += einsum("ab->ab", x262) * -1
    del x262
    x274 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x274 += einsum("abij,kjli->klba", l2.aaaa, v.aaaa.oooo)
    x276 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x276 += einsum("ijab->jiba", x274)
    del x274
    x275 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x275 += einsum("abij,bcad->ijdc", l2.aaaa, v.aaaa.vvvv)
    x276 += einsum("ijab->jiba", x275)
    del x275
    l2new_aaaa += einsum("ijab->abij", x276)
    l2new_aaaa += einsum("ijab->baij", x276) * -1
    del x276
    x277 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x277 += einsum("ab,caij->ijbc", f.bb.vv, l2.bbbb)
    x311 -= einsum("ijab->ijab", x277)
    del x277
    x278 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x278 += einsum("ai,jbac->ijbc", l1.bb, v.bbbb.ovvv)
    x311 -= einsum("ijab->ijab", x278)
    del x278
    x285 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x285 -= einsum("abij->jiba", l2.bbbb)
    x285 += einsum("abij->jiab", l2.bbbb)
    x286 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x286 += einsum("iabc->ibac", v.bbbb.ovvv)
    x286 -= einsum("iabc->ibca", v.bbbb.ovvv)
    x287 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x287 += einsum("ia,jbac->ijbc", t1.bb, x286)
    x288 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x288 -= einsum("ijab->ijab", x287)
    del x287
    x297 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x297 += einsum("ia,ibca->bc", t1.bb, x286)
    del x286
    x298 -= einsum("ab->ab", x297)
    del x297
    x299 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x299 += einsum("ab,acij->ijcb", x298, l2.bbbb)
    del x298
    x311 += einsum("ijab->jiab", x299)
    del x299
    x288 += einsum("iabj->jiba", v.bbbb.ovvo)
    x288 -= einsum("ijab->jiab", v.bbbb.oovv)
    x289 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x289 += einsum("ijab,ikbc->jkac", x285, x288)
    del x288
    del x285
    x311 += einsum("ijab->ijab", x289)
    del x289
    x290 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x290 -= einsum("ijab->jiba", t2.aaaa)
    x290 += einsum("ijab->jiab", t2.aaaa)
    x291 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x291 += einsum("iajb,ikac->kjcb", v.aabb.ovov, x290)
    del x290
    x292 -= einsum("ijab->ijab", x291)
    del x291
    x292 += einsum("iabj->jiba", v.bbaa.ovvo)
    x293 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x293 += einsum("abij,ikac->jkbc", l2.abab, x292)
    del x292
    x311 += einsum("ijab->ijab", x293)
    del x293
    x295 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x295 += einsum("ijka->ikja", v.bbbb.ooov)
    x295 -= einsum("ijka->kija", v.bbbb.ooov)
    x296 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x296 += einsum("ijka,lkib->jlab", x294, x295)
    del x294
    x311 += einsum("ijab->ijab", x296)
    del x296
    x300 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x300 += einsum("ia,ijka->jk", t1.bb, x295)
    x301 -= einsum("ij->ij", x300)
    del x300
    x302 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x302 += einsum("ij,abjk->kiab", x301, l2.bbbb)
    del x301
    x311 -= einsum("ijab->ijba", x302)
    del x302
    l2new_abab -= einsum("ijka,kljb->abil", x2, x295)
    del x295
    x303 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x303 += einsum("ia,ja->ij", f.bb.ov, t1.bb)
    x304 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x304 += einsum("ij->ij", x303)
    del x303
    x304 += einsum("ij->ij", f.bb.oo)
    x305 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x305 += einsum("ij,abjk->kiab", x304, l2.bbbb)
    del x304
    x311 += einsum("ijab->jiba", x305)
    del x305
    x306 -= einsum("ijka->jika", v.bbbb.ooov)
    x307 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x307 += einsum("ai,ijkb->jkab", l1.bb, x306)
    del x306
    x311 += einsum("ijab->ijab", x307)
    del x307
    x308 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x308 -= einsum("iajb->jiba", v.bbbb.ovov)
    x308 += einsum("iajb->jiab", v.bbbb.ovov)
    x309 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x309 += einsum("ia,ijab->jb", t1.bb, x308)
    del x308
    x310 -= einsum("ia->ia", x309)
    x311 += einsum("ai,jb->ijab", l1.bb, x310)
    del x310
    x394 -= einsum("ia->ia", x309)
    del x309
    x311 += einsum("ia,bj->ijab", f.bb.ov, l1.bb)
    l2new_bbbb -= einsum("ijab->baij", x311)
    l2new_bbbb += einsum("ijab->abij", x311)
    l2new_bbbb += einsum("ijab->baji", x311)
    l2new_bbbb -= einsum("ijab->abji", x311)
    del x311
    x312 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x312 += einsum("abij,kilj->klab", l2.bbbb, v.bbbb.oooo)
    x314 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x314 += einsum("ijab->jiba", x312)
    del x312
    x313 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x313 += einsum("abij,acbd->ijcd", l2.bbbb, v.bbbb.vvvv)
    x314 += einsum("ijab->jiba", x313)
    del x313
    l2new_bbbb += einsum("ijab->abij", x314)
    l2new_bbbb += einsum("ijab->baij", x314) * -1
    del x314
    x315 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x315 += einsum("iajb->jiba", v.bbbb.ovov)
    x315 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x316 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x316 += einsum("ijab,jkbc->ikac", x184, x315)
    del x184
    x333 += einsum("ijab->ijab", x316) * -1
    del x316
    x321 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x321 += einsum("ijab,ikba->jk", t2.bbbb, x315)
    x323 += einsum("ij->ij", x321) * -1
    del x321
    x324 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x324 += einsum("ij,abik->kjab", x323, l2.bbbb)
    del x323
    x333 += einsum("ijab->ijba", x324)
    del x324
    x326 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x326 += einsum("ijab,ijbc->ac", t2.bbbb, x315)
    x327 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x327 += einsum("ab->ab", x326) * -1
    del x326
    x378 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x378 += einsum("ijab,ijcb->ac", t2.bbbb, x315)
    del x315
    x379 += einsum("ab->ab", x378) * -1
    del x378
    x325 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x325 += einsum("ijab,iajc->bc", t2.abab, v.aabb.ovov)
    x327 += einsum("ab->ab", x325)
    x328 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x328 += einsum("ab,acij->ijcb", x327, l2.bbbb)
    del x327
    x333 += einsum("ijab->jiab", x328)
    del x328
    l2new_bbbb += einsum("ijab->baij", x333)
    l2new_bbbb += einsum("ijab->abij", x333) * -1
    l2new_bbbb += einsum("ijab->baji", x333) * -1
    l2new_bbbb += einsum("ijab->abji", x333)
    del x333
    x379 += einsum("ab->ab", x325) * -1
    del x325
    x339 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x339 += einsum("abij,acbd->ijcd", l2.abab, v.aabb.vvvv)
    l2new_baba += einsum("ijab->baji", x339)
    l2new_abab += einsum("ijab->abij", x339)
    del x339
    x340 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x340 += einsum("ai,jbac->ijcb", l1.aa, v.bbaa.ovvv)
    l2new_baba += einsum("ijab->baji", x340)
    l2new_abab += einsum("ijab->abij", x340)
    del x340
    x342 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x342 += einsum("ai,jbac->jibc", l1.bb, v.aabb.ovvv)
    l2new_baba += einsum("ijab->baji", x342)
    l2new_abab += einsum("ijab->abij", x342)
    del x342
    x346 += einsum("iabj->jiba", v.bbaa.ovvo)
    l2new_baba += einsum("ijab,ikac->cbkj", x103, x346) * -1
    del x103
    l2new_abab += einsum("ijab,ikac->bcjk", x13, x346) * -1
    del x346
    del x13
    x349 += einsum("iabj->ijab", v.aabb.ovvo)
    l2new_baba += einsum("ijab,kica->bcjk", x188, x349)
    del x188
    l2new_abab += einsum("ijab,kica->cbkj", x182, x349) * -1
    del x349
    del x182
    x352 += einsum("iabj->ijba", v.aaaa.ovvo)
    x352 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x353 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x353 += einsum("abij,kiac->kjcb", l2.abab, x352)
    del x352
    l2new_baba += einsum("ijab->baji", x353)
    l2new_abab += einsum("ijab->abij", x353)
    del x353
    x354 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x354 += einsum("ijab,iakc->jkbc", t2.abab, v.aabb.ovov)
    x357 += einsum("ijab->jiab", x354)
    del x354
    x357 += einsum("iabj->ijba", v.bbbb.ovvo)
    x357 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x358 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x358 += einsum("abij,kjbc->ikac", l2.abab, x357)
    del x357
    l2new_baba += einsum("ijab->baji", x358)
    l2new_abab += einsum("ijab->abij", x358)
    del x358
    x359 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x359 += einsum("ia,jabc->ijbc", t1.aa, v.aabb.ovvv)
    x361 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x361 += einsum("ijab->jiab", x359)
    del x359
    x360 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x360 += einsum("ijab,kajc->ikbc", t2.abab, v.aabb.ovov)
    x361 += einsum("ijab->jiab", x360) * -1
    del x360
    x361 += einsum("ijab->ijab", v.aabb.oovv)
    x362 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x362 += einsum("abij,kibc->kjac", l2.abab, x361)
    del x361
    l2new_baba += einsum("ijab->baji", x362) * -1
    l2new_abab += einsum("ijab->abij", x362) * -1
    del x362
    x363 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x363 += einsum("ijab,ickb->jkac", t2.abab, v.aabb.ovov)
    x364 += einsum("ijab->jiab", x363) * -1
    del x363
    x364 += einsum("ijab->ijab", v.bbaa.oovv)
    x365 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x365 += einsum("abij,kjac->ikcb", l2.abab, x364)
    del x364
    l2new_baba += einsum("ijab->baji", x365) * -1
    l2new_abab += einsum("ijab->abij", x365) * -1
    del x365
    x367 += einsum("ijkl->ijkl", v.aabb.oooo)
    x368 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x368 += einsum("abij,kilj->klab", l2.abab, x367)
    del x367
    l2new_baba += einsum("ijab->baji", x368)
    l2new_abab += einsum("ijab->abij", x368)
    del x368
    x373 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x373 -= einsum("ijka->ikja", v.bbbb.ooov)
    x373 += einsum("ijka->kija", v.bbbb.ooov)
    l2new_baba += einsum("ijka,kljb->bali", x2, x373)
    del x2
    del x373
    x376 += einsum("ab->ab", f.aa.vv)
    x377 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x377 += einsum("ab,acij->ijbc", x376, l2.abab)
    del x376
    l2new_baba += einsum("ijab->baji", x377)
    l2new_abab += einsum("ijab->abij", x377)
    del x377
    x379 += einsum("ab->ab", f.bb.vv)
    x380 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x380 += einsum("ab,caij->ijcb", x379, l2.abab)
    del x379
    l2new_baba += einsum("ijab->baji", x380)
    l2new_abab += einsum("ijab->abij", x380)
    del x380
    x389 += einsum("iajk->ijka", v.aabb.ovoo)
    x390 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x390 += einsum("ai,jkib->jkba", l1.bb, x389)
    del x389
    l2new_baba -= einsum("ijab->baji", x390)
    l2new_abab -= einsum("ijab->abij", x390)
    del x390
    x391 += einsum("ijka->ijka", v.aabb.ooov)
    x392 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x392 += einsum("ai,jikb->jkab", l1.aa, x391)
    del x391
    l2new_baba -= einsum("ijab->baji", x392)
    l2new_abab -= einsum("ijab->abij", x392)
    del x392
    x393 += einsum("ia->ia", f.aa.ov)
    l2new_baba += einsum("ai,jb->abij", l1.bb, x393)
    l2new_abab += einsum("ai,jb->baji", l1.bb, x393)
    del x393
    x394 += einsum("ia->ia", f.bb.ov)
    l2new_baba += einsum("ai,jb->baji", l1.aa, x394)
    l2new_abab += einsum("ai,jb->abij", l1.aa, x394)
    del x394
    x396 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x396 += einsum("ijka->ikja", v.aaaa.ooov)
    x396 -= einsum("ijka->kija", v.aaaa.ooov)
    l2new_abab += einsum("ijka,kjlb->abil", x396, x45)
    del x396
    del x45
    l1new_aa += einsum("ia->ai", f.aa.ov)
    l1new_aa += einsum("ai,jbai->bj", l1.bb, v.aabb.ovvo)
    l1new_bb += einsum("ia->ai", f.bb.ov)
    l1new_bb += einsum("ai,jbai->bj", l1.aa, v.bbaa.ovvo)
    l2new_aaaa += einsum("iajb->baji", v.aaaa.ovov)
    l2new_aaaa -= einsum("iajb->abji", v.aaaa.ovov)
    l2new_bbbb += einsum("iajb->baji", v.bbbb.ovov)
    l2new_bbbb -= einsum("iajb->abji", v.bbbb.ovov)
    l2new_baba += einsum("iajb->baji", v.aabb.ovov)
    l2new_abab += einsum("iajb->abij", v.aabb.ovov)

    l1new.aa = l1new_aa
    l1new.bb = l1new_bb
    l2new.abab = l2new_abab
    l2new.baba = l2new_baba
    l2new.aaaa = l2new_aaaa
    l2new.bbbb = l2new_bbbb

    return {"l1new": l1new, "l2new": l2new}

def make_rdm1_f(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    rdm1_f = SimpleNamespace()

    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    # 1RDM
    x0 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x0 += einsum("abij,kjab->ik", l2.abab, t2.abab)
    x10 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x10 += einsum("ij->ij", x0)
    rdm1_f_oo_aa = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    rdm1_f_oo_aa += einsum("ij->ij", x0) * -1
    del x0
    x1 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x1 += einsum("ai,ja->ij", l1.aa, t1.aa)
    x10 += einsum("ij->ij", x1)
    rdm1_f_oo_aa -= einsum("ij->ij", x1)
    del x1
    x2 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x2 += einsum("ijab->jiab", t2.aaaa)
    x2 += einsum("ijab->jiba", t2.aaaa) * -1
    x10 += einsum("abij,ikab->jk", l2.aaaa, x2) * -1
    rdm1_f_vo_aa = np.zeros((nvir[0], nocc[0]), dtype=np.float64)
    rdm1_f_vo_aa += einsum("ia,ij->aj", t1.aa, x10) * -1
    del x10
    rdm1_f_oo_aa += einsum("abij,ikba->jk", l2.aaaa, x2) * -1
    del x2
    x3 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x3 += einsum("abij,ikab->jk", l2.abab, t2.abab)
    x16 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x16 += einsum("ij->ij", x3)
    rdm1_f_oo_bb = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    rdm1_f_oo_bb += einsum("ij->ij", x3) * -1
    del x3
    x4 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x4 += einsum("ai,ja->ij", l1.bb, t1.bb)
    x16 += einsum("ij->ij", x4)
    rdm1_f_oo_bb -= einsum("ij->ij", x4)
    del x4
    x5 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x5 += einsum("ijab->jiab", t2.bbbb) * -1
    x5 += einsum("ijab->jiba", t2.bbbb)
    rdm1_f_oo_bb += einsum("abij,ikab->jk", l2.bbbb, x5) * -1
    del x5
    x6 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x6 += einsum("ia,abjk->jikb", t1.aa, l2.abab)
    rdm1_f_vo_aa += einsum("ijab,ikjb->ak", t2.abab, x6) * -1
    del x6
    x7 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x7 += einsum("ia,abjk->kjib", t1.aa, l2.aaaa)
    x8 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x8 += einsum("ijka->ijka", x7) * -1
    x8 += einsum("ijka->jika", x7)
    del x7
    rdm1_f_vo_aa += einsum("ijab,jika->bk", t2.aaaa, x8) * -1
    del x8
    x9 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x9 += einsum("ijab->jiab", t2.aaaa)
    x9 -= einsum("ijab->jiba", t2.aaaa)
    rdm1_f_vo_aa -= einsum("ai,ijab->bj", l1.aa, x9)
    del x9
    x11 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x11 += einsum("ia,bajk->jkib", t1.bb, l2.abab)
    rdm1_f_vo_bb = np.zeros((nvir[1], nocc[1]), dtype=np.float64)
    rdm1_f_vo_bb += einsum("ijab,ijka->bk", t2.abab, x11) * -1
    del x11
    x12 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x12 += einsum("ia,abjk->kjib", t1.bb, l2.bbbb)
    x13 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x13 += einsum("ijka->ijka", x12)
    x13 += einsum("ijka->jika", x12) * -1
    del x12
    rdm1_f_vo_bb += einsum("ijab,ijka->bk", t2.bbbb, x13) * -1
    del x13
    x14 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x14 -= einsum("ijab->jiab", t2.bbbb)
    x14 += einsum("ijab->jiba", t2.bbbb)
    rdm1_f_vo_bb -= einsum("ai,ijba->bj", l1.bb, x14)
    del x14
    x15 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x15 += einsum("ijab->jiab", t2.bbbb)
    x15 += einsum("ijab->jiba", t2.bbbb) * -1
    x16 += einsum("abij,ikab->jk", l2.bbbb, x15) * -1
    del x15
    rdm1_f_vo_bb += einsum("ia,ij->aj", t1.bb, x16) * -1
    del x16
    x17 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x17 += einsum("abij->jiab", l2.aaaa)
    x17 += einsum("abij->jiba", l2.aaaa) * -1
    rdm1_f_vv_aa = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    rdm1_f_vv_aa += einsum("ijab,ijac->bc", t2.aaaa, x17) * -1
    del x17
    x18 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x18 += einsum("abij->jiab", l2.bbbb) * -1
    x18 += einsum("abij->jiba", l2.bbbb)
    rdm1_f_vv_bb = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    rdm1_f_vv_bb += einsum("ijab,ijca->bc", t2.bbbb, x18) * -1
    del x18
    rdm1_f_oo_aa += einsum("ij->ji", delta_oo.aa)
    rdm1_f_oo_bb += einsum("ij->ji", delta_oo.bb)
    rdm1_f_ov_aa = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    rdm1_f_ov_aa += einsum("ai->ia", l1.aa)
    rdm1_f_ov_bb = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    rdm1_f_ov_bb += einsum("ai->ia", l1.bb)
    rdm1_f_vo_aa += einsum("ia->ai", t1.aa)
    rdm1_f_vo_aa += einsum("ai,jiba->bj", l1.bb, t2.abab)
    rdm1_f_vo_bb += einsum("ia->ai", t1.bb)
    rdm1_f_vo_bb += einsum("ai,ijab->bj", l1.aa, t2.abab)
    rdm1_f_vv_aa += einsum("abij,ijcb->ca", l2.abab, t2.abab)
    rdm1_f_vv_aa += einsum("ai,ib->ba", l1.aa, t1.aa)
    rdm1_f_vv_bb += einsum("ai,ib->ba", l1.bb, t1.bb)
    rdm1_f_vv_bb += einsum("abij,ijac->cb", l2.abab, t2.abab)

    rdm1_f_aa = np.block([[rdm1_f_oo_aa, rdm1_f_ov_aa], [rdm1_f_vo_aa, rdm1_f_vv_aa]])
    rdm1_f_bb = np.block([[rdm1_f_oo_bb, rdm1_f_ov_bb], [rdm1_f_vo_bb, rdm1_f_vv_bb]])

    rdm1_f.aa = rdm1_f_aa
    rdm1_f.bb = rdm1_f_bb

    return rdm1_f

def make_rdm2_f(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    rdm2_f = SimpleNamespace()

    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    # 2RDM
    x0 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x0 += einsum("abij,kjab->ik", l2.abab, t2.abab)
    x3 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x3 += einsum("ij->ij", x0)
    x22 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x22 += einsum("ij->ij", x0)
    x173 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x173 += einsum("ij->ij", x0)
    del x0
    x1 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x1 += einsum("ijab->jiab", t2.aaaa)
    x1 += einsum("ijab->jiba", t2.aaaa) * -1
    x2 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x2 += einsum("abij,ikab->jk", l2.aaaa, x1)
    x3 += einsum("ij->ij", x2) * -1
    x32 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x32 += einsum("ia,ij->ja", t1.aa, x3)
    x33 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x33 += einsum("ia->ia", x32)
    del x32
    x38 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x38 += einsum("ia,jk->jika", t1.aa, x3)
    x96 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x96 += einsum("ij,ikab->kjab", x3, t2.aaaa)
    x97 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x97 += einsum("ijab->ijba", x96)
    del x96
    rdm2_f_oooo_aaaa = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_oooo_aaaa += einsum("ij,kl->jilk", delta_oo.aa, x3) * -1
    rdm2_f_oooo_aaaa += einsum("ij,kl->jkli", delta_oo.aa, x3)
    rdm2_f_oooo_aaaa += einsum("ij,kl->ljik", delta_oo.aa, x3)
    rdm2_f_oooo_aaaa += einsum("ij,kl->lkij", delta_oo.aa, x3) * -1
    del x3
    x22 += einsum("ij->ij", x2) * -1
    x173 += einsum("ij->ij", x2) * -1
    del x2
    x74 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x74 += einsum("ai,ijba->jb", l1.aa, x1)
    x76 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x76 += einsum("ia->ia", x74) * -1
    x77 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x77 += einsum("ia->ia", x74) * -1
    x175 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x175 += einsum("ia->ia", x74) * -1
    del x74
    x174 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x174 += einsum("ai,ijba->jb", l1.aa, x1) * -0.9999999999999993
    x225 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x225 += einsum("abij,ikca->kjcb", l2.abab, x1)
    x227 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x227 += einsum("ijab->ijab", x225) * -1
    del x225
    x4 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x4 += einsum("abij,klba->ijlk", l2.aaaa, t2.aaaa)
    x7 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x7 += einsum("ijkl->jilk", x4)
    x109 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x109 += einsum("ijab,ijkl->klab", t2.aaaa, x4)
    x113 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x113 += einsum("ijab->ijab", x109)
    del x109
    x111 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x111 += einsum("ia,jikl->jkla", t1.aa, x4)
    del x4
    x112 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x112 += einsum("ia,ijkb->jkab", t1.aa, x111)
    del x111
    x113 += einsum("ijab->ijab", x112)
    del x112
    x5 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x5 += einsum("ia,abjk->kjib", t1.aa, l2.aaaa)
    x6 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x6 += einsum("ia,jkla->jkil", t1.aa, x5)
    x7 += einsum("ijkl->ijkl", x6)
    x37 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x37 += einsum("ia,ijkl->jkla", t1.aa, x7)
    x38 += einsum("ijka->ikja", x37)
    del x37
    rdm2_f_oooo_aaaa += einsum("ijkl->likj", x7) * -1
    rdm2_f_oooo_aaaa += einsum("ijkl->kilj", x7)
    del x7
    x98 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x98 += einsum("ia,ijkl->jlka", t1.aa, x6)
    x99 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x99 += einsum("ia,ijkb->jkab", t1.aa, x98)
    del x98
    x107 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x107 += einsum("ijab->ijab", x99)
    del x99
    x110 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x110 += einsum("ijab,jikl->klba", t2.aaaa, x6)
    del x6
    x113 += einsum("ijab->ijab", x110)
    del x110
    rdm2_f_ovov_aaaa = np.zeros((nocc[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_ovov_aaaa += einsum("ijab->iajb", x113)
    rdm2_f_ovov_aaaa += einsum("ijab->ibja", x113) * -1
    del x113
    x30 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x30 += einsum("ijka->ijka", x5) * -1
    x30 += einsum("ijka->jika", x5)
    x31 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x31 += einsum("ijab,jikb->ka", t2.aaaa, x30)
    x33 += einsum("ia->ia", x31) * -1
    x76 += einsum("ia->ia", x31) * -1
    x77 += einsum("ia->ia", x31) * -1
    x174 += einsum("ia->ia", x31) * -1
    del x31
    x61 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x61 += einsum("ijab,kila->kljb", t2.abab, x30)
    rdm2_f_ooov_aabb = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_ooov_aabb += einsum("ijka->jika", x61) * -1
    rdm2_f_ovoo_bbaa = np.zeros((nocc[1], nvir[1], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_ovoo_bbaa += einsum("ijka->kaji", x61) * -1
    del x61
    x175 += einsum("ijab,jikb->ka", t2.aaaa, x30) * -1
    del x30
    x35 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x35 += einsum("ijka->ijka", x5)
    x35 += einsum("ijka->jika", x5) * -1
    x36 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x36 += einsum("ijab,kilb->jkla", x1, x35)
    del x35
    x38 += einsum("ijka->jkia", x36)
    del x36
    x86 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x86 += einsum("ijka->ijka", x5)
    x86 -= einsum("ijka->jika", x5)
    x160 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x160 += einsum("ijab,kila->kljb", t2.abab, x86)
    x162 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x162 -= einsum("ijka->ijka", x160)
    del x160
    x190 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x190 += einsum("ia,jikb->jkab", t1.aa, x86)
    rdm2_f_ovvo_aaaa = np.zeros((nocc[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_ovvo_aaaa -= einsum("ijab->jabi", x190)
    rdm2_f_voov_aaaa = np.zeros((nvir[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_voov_aaaa -= einsum("ijab->bija", x190)
    del x190
    x177 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x177 -= einsum("ijka->ijka", x5)
    x177 += einsum("ijka->jika", x5)
    x178 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x178 += einsum("ia,jikb->jkab", t1.aa, x177)
    del x177
    rdm2_f_oovv_aaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_oovv_aaaa -= einsum("ijab->jiba", x178)
    rdm2_f_vvoo_aaaa = np.zeros((nvir[0], nvir[0], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_vvoo_aaaa -= einsum("ijab->baji", x178)
    del x178
    x198 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x198 += einsum("ijab,jikc->kcba", t2.aaaa, x5)
    x203 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x203 += einsum("iabc->iabc", x198)
    del x198
    x199 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x199 += einsum("ia,jikb->jkba", t1.aa, x5)
    x201 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x201 += einsum("ijab->ijab", x199) * -1
    del x199
    rdm2_f_oovo_aaaa = np.zeros((nocc[0], nocc[0], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_oovo_aaaa += einsum("ijka->kiaj", x5)
    rdm2_f_oovo_aaaa -= einsum("ijka->kjai", x5)
    rdm2_f_vooo_aaaa = np.zeros((nvir[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_vooo_aaaa -= einsum("ijka->aikj", x5)
    rdm2_f_vooo_aaaa += einsum("ijka->ajki", x5)
    del x5
    x8 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x8 += einsum("ai,ja->ij", l1.aa, t1.aa)
    x22 += einsum("ij->ij", x8)
    x75 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x75 += einsum("ia,ij->ja", t1.aa, x22)
    x76 += einsum("ia->ia", x75)
    x77 += einsum("ia->ia", x75)
    del x75
    x168 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x168 += einsum("ij,ikab->jkab", x22, t2.abab)
    rdm2_f_ovov_bbaa = np.zeros((nocc[1], nvir[1], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x168) * -1
    rdm2_f_ovov_aabb = np.zeros((nocc[0], nvir[0], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x168) * -1
    del x168
    rdm2_f_oooo_aabb = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_oooo_aabb += einsum("ij,kl->lkji", delta_oo.bb, x22) * -1
    rdm2_f_oooo_bbaa = np.zeros((nocc[1], nocc[1], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_oooo_bbaa += einsum("ij,kl->jilk", delta_oo.bb, x22) * -1
    rdm2_f_ooov_aabb += einsum("ia,jk->kjia", t1.bb, x22) * -1
    rdm2_f_ovoo_bbaa += einsum("ia,jk->iakj", t1.bb, x22) * -1
    del x22
    x23 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x23 += einsum("ia,ij->ja", t1.aa, x8)
    x27 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x27 -= einsum("ia->ia", x23)
    del x23
    x40 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x40 += einsum("ia,jk->ijka", t1.aa, x8)
    x78 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x78 += einsum("ij,kiab->jkab", x8, t2.aaaa)
    x90 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x90 += einsum("ijab->ijab", x78)
    del x78
    x173 += einsum("ij->ij", x8) * 0.9999999999999993
    x174 += einsum("ia,ij->ja", t1.aa, x173)
    x175 += einsum("ia,ij->ja", t1.aa, x173)
    del x173
    rdm2_f_oooo_aaaa -= einsum("ij,kl->jilk", delta_oo.aa, x8)
    rdm2_f_oooo_aaaa += einsum("ij,kl->lijk", delta_oo.aa, x8)
    rdm2_f_oooo_aaaa += einsum("ij,kl->jkli", delta_oo.aa, x8)
    rdm2_f_oooo_aaaa -= einsum("ij,kl->lkji", delta_oo.aa, x8)
    del x8
    x9 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x9 += einsum("ai,ja->ij", l1.bb, t1.bb)
    x21 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x21 += einsum("ij->ij", x9)
    x47 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x47 += einsum("ia,jk->ijka", t1.bb, x9)
    x55 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x55 += einsum("ia,ij->ja", t1.bb, x9)
    x58 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x58 -= einsum("ia->ia", x55)
    del x55
    x66 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x66 += einsum("ij->ij", x9)
    x121 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x121 += einsum("ij,kiab->jkab", x9, t2.bbbb)
    x130 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x130 += einsum("ijab->ijab", x121)
    del x121
    x170 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x170 += einsum("ij->ij", x9) * 0.9999999999999993
    rdm2_f_oooo_bbbb = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_oooo_bbbb -= einsum("ij,kl->jilk", delta_oo.bb, x9)
    rdm2_f_oooo_bbbb += einsum("ij,kl->lijk", delta_oo.bb, x9)
    rdm2_f_oooo_bbbb += einsum("ij,kl->jkli", delta_oo.bb, x9)
    rdm2_f_oooo_bbbb -= einsum("ij,kl->lkji", delta_oo.bb, x9)
    del x9
    x10 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x10 += einsum("abij,ikab->jk", l2.abab, t2.abab)
    x13 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x13 += einsum("ij->ij", x10)
    x21 += einsum("ij->ij", x10)
    x66 += einsum("ij->ij", x10)
    x131 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x131 += einsum("ij,kiab->jkab", x10, t2.bbbb)
    x138 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x138 += einsum("ijab->ijab", x131) * -1
    del x131
    x170 += einsum("ij->ij", x10)
    del x10
    x11 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x11 += einsum("ijab->jiab", t2.bbbb)
    x11 += einsum("ijab->jiba", t2.bbbb) * -1
    x12 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x12 += einsum("abij,ikab->jk", l2.bbbb, x11)
    del x11
    x13 += einsum("ij->ij", x12) * -1
    x44 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x44 += einsum("ia,ij->ja", t1.bb, x13)
    x45 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x45 += einsum("ia->ia", x44)
    del x44
    x53 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x53 += einsum("ia,jk->jika", t1.bb, x13)
    rdm2_f_oooo_bbbb += einsum("ij,kl->jilk", delta_oo.bb, x13) * -1
    rdm2_f_oooo_bbbb += einsum("ij,kl->jkli", delta_oo.bb, x13)
    rdm2_f_oooo_bbbb += einsum("ij,kl->ljik", delta_oo.bb, x13)
    rdm2_f_oooo_bbbb += einsum("ij,kl->lkij", delta_oo.bb, x13) * -1
    del x13
    x21 += einsum("ij->ij", x12) * -1
    x66 += einsum("ij->ij", x12) * -1
    x67 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x67 += einsum("ia,ij->ja", t1.bb, x66)
    x68 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x68 += einsum("ia->ia", x67)
    del x67
    x167 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x167 += einsum("ij,kiab->kjab", x66, t2.abab)
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x167) * -1
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x167) * -1
    del x167
    rdm2_f_ooov_bbaa = np.zeros((nocc[1], nocc[1], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_ooov_bbaa += einsum("ia,jk->kjia", t1.aa, x66) * -1
    del x66
    x137 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x137 += einsum("ij,ikab->kjab", x12, t2.bbbb) * -1
    x138 += einsum("ijab->ijba", x137)
    del x137
    x170 += einsum("ij->ij", x12) * -1
    del x12
    x171 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x171 += einsum("ia,ij->ja", t1.bb, x170)
    del x170
    x172 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x172 += einsum("ia->ia", x171)
    del x171
    x14 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x14 += einsum("abij,klba->ijlk", l2.bbbb, t2.bbbb)
    x17 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x17 += einsum("ijkl->jilk", x14)
    x15 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x15 += einsum("ia,abjk->kjib", t1.bb, l2.bbbb)
    x16 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x16 += einsum("ia,jkla->jkil", t1.bb, x15)
    x17 += einsum("ijkl->ijkl", x16)
    x52 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x52 += einsum("ia,ijkl->jkla", t1.bb, x17)
    x53 += einsum("ijka->ikja", x52)
    del x52
    rdm2_f_oooo_bbbb += einsum("ijkl->likj", x17) * -1
    rdm2_f_oooo_bbbb += einsum("ijkl->kilj", x17)
    del x17
    x114 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x114 += einsum("ia,ijkl->jlka", t1.bb, x16)
    x115 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x115 += einsum("ia,ijkb->jkab", t1.bb, x114)
    del x114
    x120 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x120 += einsum("ijab->ijab", x115)
    del x115
    x139 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x139 += einsum("ijab,jikl->lkab", t2.bbbb, x16)
    del x16
    x142 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x142 += einsum("ijab->ijab", x139)
    del x139
    x42 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x42 += einsum("ijka->ijka", x15) * -1
    x42 += einsum("ijka->jika", x15)
    x43 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x43 += einsum("ijab,jikb->ka", t2.bbbb, x42)
    del x42
    x45 += einsum("ia->ia", x43) * -1
    x68 += einsum("ia->ia", x43) * -1
    x172 += einsum("ia->ia", x43) * -1
    del x43
    x49 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x49 += einsum("ijka->ijka", x15)
    x49 += einsum("ijka->jika", x15) * -1
    x71 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x71 += einsum("ijab,jklb->ikla", t2.abab, x49)
    x158 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x158 += einsum("ijka->ijka", x71) * -1
    rdm2_f_ooov_bbaa += einsum("ijka->kjia", x71) * -1
    rdm2_f_ovoo_aabb = np.zeros((nocc[0], nvir[0], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_ovoo_aabb += einsum("ijka->iakj", x71) * -1
    del x71
    x126 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x126 += einsum("ijka->ijka", x15)
    x126 -= einsum("ijka->jika", x15)
    x183 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x183 += einsum("ia,ijkb->jkab", t1.bb, x126)
    rdm2_f_oovv_bbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_oovv_bbbb -= einsum("ijab->jiba", x183)
    rdm2_f_vvoo_bbbb = np.zeros((nvir[1], nvir[1], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_vvoo_bbbb -= einsum("ijab->baji", x183)
    del x183
    x196 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x196 -= einsum("ijka->ijka", x15)
    x196 += einsum("ijka->jika", x15)
    x197 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x197 += einsum("ia,ijkb->jkab", t1.bb, x196)
    del x196
    rdm2_f_ovvo_bbbb = np.zeros((nocc[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_ovvo_bbbb -= einsum("ijab->jabi", x197)
    rdm2_f_voov_bbbb = np.zeros((nvir[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_voov_bbbb -= einsum("ijab->bija", x197)
    del x197
    x208 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x208 += einsum("ijab,ijkc->kcab", t2.bbbb, x15)
    x213 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x213 += einsum("iabc->iabc", x208)
    del x208
    x209 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x209 += einsum("ia,jikb->jkba", t1.bb, x15)
    x211 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x211 += einsum("ijab->ijab", x209) * -1
    del x209
    rdm2_f_oovo_bbbb = np.zeros((nocc[1], nocc[1], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_oovo_bbbb += einsum("ijka->kiaj", x15)
    rdm2_f_oovo_bbbb -= einsum("ijka->kjai", x15)
    rdm2_f_vooo_bbbb = np.zeros((nvir[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_vooo_bbbb -= einsum("ijka->aikj", x15)
    rdm2_f_vooo_bbbb += einsum("ijka->ajki", x15)
    del x15
    x18 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x18 += einsum("abij,klab->ikjl", l2.abab, t2.abab)
    x63 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x63 += einsum("ijkl->ijkl", x18)
    x154 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x154 += einsum("ijkl->ijkl", x18)
    x156 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x156 += einsum("ijkl->ijkl", x18)
    rdm2_f_oooo_aabb += einsum("ijkl->jilk", x18)
    rdm2_f_oooo_bbaa += einsum("ijkl->lkji", x18)
    del x18
    x19 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x19 += einsum("ia,bajk->jkib", t1.bb, l2.abab)
    x20 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x20 += einsum("ia,jkla->jikl", t1.aa, x19)
    x63 += einsum("ijkl->ijkl", x20)
    x64 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x64 += einsum("ia,jkil->jkla", t1.bb, x63)
    rdm2_f_ooov_aabb += einsum("ijka->jika", x64)
    rdm2_f_ovoo_bbaa += einsum("ijka->kaji", x64)
    del x64
    x73 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x73 += einsum("ia,ijkl->jkla", t1.aa, x63)
    del x63
    rdm2_f_ooov_bbaa += einsum("ijka->kjia", x73)
    rdm2_f_ovoo_aabb += einsum("ijka->iakj", x73)
    del x73
    x154 += einsum("ijkl->ijkl", x20)
    x155 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x155 += einsum("ijab,ikjl->klab", t2.abab, x154)
    del x154
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x155)
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x155)
    del x155
    x156 += einsum("ijkl->ijkl", x20) * 0.9999999999999993
    x157 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x157 += einsum("ia,ijkl->jkla", t1.aa, x156)
    del x156
    x158 += einsum("ijka->ijka", x157)
    del x157
    rdm2_f_oooo_aabb += einsum("ijkl->jilk", x20)
    rdm2_f_oooo_bbaa += einsum("ijkl->lkji", x20)
    del x20
    x41 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x41 += einsum("ijab,ijka->kb", t2.abab, x19)
    x45 += einsum("ia->ia", x41)
    x138 += einsum("ia,jb->ijab", t1.bb, x45)
    rdm2_f_ooov_bbbb = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_ooov_bbbb += einsum("ij,ka->jika", delta_oo.bb, x45) * -1
    rdm2_f_ooov_bbbb += einsum("ij,ka->kjia", delta_oo.bb, x45)
    rdm2_f_ovoo_bbbb = np.zeros((nocc[1], nvir[1], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_ovoo_bbbb += einsum("ij,ka->jaki", delta_oo.bb, x45)
    rdm2_f_ovoo_bbbb += einsum("ij,ka->kaij", delta_oo.bb, x45) * -1
    del x45
    x68 += einsum("ia->ia", x41)
    x172 += einsum("ia->ia", x41)
    del x41
    x48 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x48 += einsum("ijab,ikla->kljb", t2.abab, x19)
    x53 += einsum("ijka->ijka", x48) * -1
    x128 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x128 -= einsum("ijka->ijka", x48)
    del x48
    x60 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x60 += einsum("ijab,kjla->kilb", t2.abab, x19)
    x162 -= einsum("ijka->ijka", x60)
    rdm2_f_ooov_aabb += einsum("ijka->jika", x60)
    rdm2_f_ovoo_bbaa += einsum("ijka->kaji", x60)
    del x60
    x72 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x72 += einsum("ijab,iklb->jkla", x1, x19)
    x158 += einsum("ijka->ijka", x72) * -1
    rdm2_f_ooov_bbaa += einsum("ijka->kjia", x72) * -1
    rdm2_f_ovoo_aabb += einsum("ijka->iakj", x72) * -1
    del x72
    x187 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x187 += einsum("ia,ijkb->jkba", t1.aa, x19)
    rdm2_f_oovv_bbaa = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_oovv_bbaa -= einsum("ijab->jiab", x187)
    rdm2_f_vvoo_aabb = np.zeros((nvir[0], nvir[0], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_vvoo_aabb -= einsum("ijab->abji", x187)
    del x187
    x191 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x191 += einsum("ia,jikb->jkba", t1.bb, x19)
    x220 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x220 += einsum("ijab->ijab", x191)
    rdm2_f_ovvo_bbaa = np.zeros((nocc[1], nvir[1], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_ovvo_bbaa -= einsum("ijab->jbai", x191)
    rdm2_f_voov_aabb = np.zeros((nvir[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_voov_aabb -= einsum("ijab->aijb", x191)
    del x191
    x214 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x214 += einsum("ijab,ijkc->kcab", t2.abab, x19)
    rdm2_f_ovvv_bbaa = np.zeros((nocc[1], nvir[1], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_ovvv_bbaa += einsum("iabc->icab", x214) * -1
    rdm2_f_vvov_aabb = np.zeros((nvir[0], nvir[0], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_vvov_aabb += einsum("iabc->abic", x214) * -1
    del x214
    rdm2_f_oovo_bbaa = np.zeros((nocc[1], nocc[1], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_oovo_bbaa -= einsum("ijka->kjai", x19)
    rdm2_f_vooo_aabb = np.zeros((nvir[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    rdm2_f_vooo_aabb -= einsum("ijka->aikj", x19)
    del x19
    x21 += einsum("ij->ji", delta_oo.bb) * -1
    rdm2_f_oooo_aabb += einsum("ij,kl->jilk", delta_oo.aa, x21) * -1
    rdm2_f_oooo_bbaa += einsum("ij,kl->lkji", delta_oo.aa, x21) * -1
    rdm2_f_ovoo_aabb += einsum("ia,jk->iakj", t1.aa, x21) * -1
    del x21
    x24 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x24 += einsum("ai,jiba->jb", l1.bb, t2.abab)
    x27 += einsum("ia->ia", x24)
    x76 += einsum("ia->ia", x24) * -1
    x77 += einsum("ia->ia", x24) * -1
    x174 += einsum("ia->ia", x24) * -0.9999999999999993
    x175 += einsum("ia->ia", x24) * -1
    del x24
    x25 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x25 += einsum("ijab->jiab", t2.aaaa)
    x25 -= einsum("ijab->jiba", t2.aaaa)
    x26 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x26 += einsum("ai,ijab->jb", l1.aa, x25)
    x27 -= einsum("ia->ia", x26)
    del x26
    x90 += einsum("ia,jb->ijab", t1.aa, x27)
    rdm2_f_ooov_aaaa = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_ooov_aaaa += einsum("ij,ka->jika", delta_oo.aa, x27)
    rdm2_f_ooov_aaaa -= einsum("ij,ka->kjia", delta_oo.aa, x27)
    rdm2_f_ovoo_aaaa = np.zeros((nocc[0], nvir[0], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_ovoo_aaaa -= einsum("ij,ka->jaki", delta_oo.aa, x27)
    rdm2_f_ovoo_aaaa += einsum("ij,ka->kaij", delta_oo.aa, x27)
    del x27
    x87 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x87 += einsum("ijab,kilb->jkla", x25, x86)
    del x86
    x88 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x88 += einsum("ijka->jkia", x87)
    del x87
    x149 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x149 += einsum("abij,ikac->kjcb", l2.abab, x25)
    x150 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x150 -= einsum("ijab->ijab", x149)
    rdm2_f_ovvo_aabb = np.zeros((nocc[0], nvir[0], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_ovvo_aabb -= einsum("ijab->iabj", x149)
    rdm2_f_voov_bbaa = np.zeros((nvir[1], nocc[1], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_voov_bbaa -= einsum("ijab->bjia", x149)
    del x149
    x28 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x28 += einsum("ia,abjk->jikb", t1.aa, l2.abab)
    x29 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x29 += einsum("ijab,ikjb->ka", t2.abab, x28)
    x33 += einsum("ia->ia", x29)
    x97 += einsum("ia,jb->ijab", t1.aa, x33)
    rdm2_f_ooov_aaaa += einsum("ij,ka->jika", delta_oo.aa, x33) * -1
    rdm2_f_ooov_aaaa += einsum("ij,ka->kjia", delta_oo.aa, x33)
    rdm2_f_ovoo_aaaa += einsum("ij,ka->jaki", delta_oo.aa, x33)
    rdm2_f_ovoo_aaaa += einsum("ij,ka->kaij", delta_oo.aa, x33) * -1
    del x33
    x76 += einsum("ia->ia", x29)
    x77 += einsum("ia->ia", x29)
    rdm2_f_ovoo_aabb += einsum("ij,ka->kaji", delta_oo.bb, x77) * -1
    del x77
    x174 += einsum("ia->ia", x29)
    rdm2_f_ovov_bbaa += einsum("ia,jb->iajb", t1.bb, x174) * -1
    del x174
    x175 += einsum("ia->ia", x29)
    del x29
    rdm2_f_ovov_aabb += einsum("ia,jb->jbia", t1.bb, x175) * -1
    del x175
    x34 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x34 += einsum("ijab,kljb->klia", t2.abab, x28)
    x38 += einsum("ijka->ijka", x34) * -1
    rdm2_f_ooov_aaaa += einsum("ijka->jika", x38)
    rdm2_f_ooov_aaaa += einsum("ijka->kija", x38) * -1
    rdm2_f_ovoo_aaaa += einsum("ijka->jaki", x38) * -1
    rdm2_f_ovoo_aaaa += einsum("ijka->kaji", x38)
    del x38
    x88 -= einsum("ijka->ijka", x34)
    del x34
    x70 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x70 += einsum("ijab,iklb->klja", t2.abab, x28)
    x158 += einsum("ijka->ijka", x70)
    rdm2_f_ooov_bbaa += einsum("ijka->kjia", x70)
    rdm2_f_ovoo_aabb += einsum("ijka->iakj", x70)
    del x70
    x188 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x188 += einsum("ia,jkib->jkba", t1.bb, x28)
    rdm2_f_oovv_aabb = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_oovv_aabb -= einsum("ijab->jiab", x188)
    rdm2_f_vvoo_bbaa = np.zeros((nvir[1], nvir[1], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_vvoo_bbaa -= einsum("ijab->abji", x188)
    del x188
    x193 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x193 += einsum("ia,ijkb->jkab", t1.aa, x28)
    x227 += einsum("ijab->ijab", x193)
    rdm2_f_ovvo_aabb -= einsum("ijab->iabj", x193)
    rdm2_f_voov_bbaa -= einsum("ijab->bjia", x193)
    del x193
    x223 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x223 += einsum("ijab,ikjc->kacb", t2.abab, x28)
    rdm2_f_ovvv_aabb = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_ovvv_aabb += einsum("iabc->iabc", x223) * -1
    rdm2_f_vvov_bbaa = np.zeros((nvir[1], nvir[1], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_vvov_bbaa += einsum("iabc->bcia", x223) * -1
    del x223
    rdm2_f_oovo_aabb = np.zeros((nocc[0], nocc[0], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_oovo_aabb -= einsum("ijka->jiak", x28)
    rdm2_f_vooo_bbaa = np.zeros((nvir[1], nocc[1], nocc[0], nocc[0]), dtype=np.float64)
    rdm2_f_vooo_bbaa -= einsum("ijka->akji", x28)
    x39 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x39 += einsum("ai,jkab->ikjb", l1.aa, t2.aaaa)
    x40 += einsum("ijka->jika", x39)
    x88 += einsum("ijka->ijka", x39)
    del x39
    x89 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x89 += einsum("ia,ijkb->jkab", t1.aa, x88)
    del x88
    x90 += einsum("ijab->ijab", x89)
    del x89
    x40 += einsum("ij,ka->jika", delta_oo.aa, t1.aa)
    rdm2_f_ooov_aaaa += einsum("ijka->ijka", x40)
    rdm2_f_ooov_aaaa -= einsum("ijka->kjia", x40)
    rdm2_f_ovoo_aaaa -= einsum("ijka->iakj", x40)
    rdm2_f_ovoo_aaaa += einsum("ijka->kaij", x40)
    del x40
    x46 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x46 += einsum("ai,jkab->ikjb", l1.bb, t2.bbbb)
    x47 += einsum("ijka->jika", x46)
    x128 += einsum("ijka->ijka", x46)
    del x46
    x47 += einsum("ij,ka->jika", delta_oo.bb, t1.bb)
    rdm2_f_ooov_bbbb += einsum("ijka->ijka", x47)
    rdm2_f_ooov_bbbb -= einsum("ijka->kjia", x47)
    rdm2_f_ovoo_bbbb -= einsum("ijka->iakj", x47)
    rdm2_f_ovoo_bbbb += einsum("ijka->kaij", x47)
    del x47
    x50 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x50 += einsum("ijab->jiab", t2.bbbb) * -1
    x50 += einsum("ijab->jiba", t2.bbbb)
    x51 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x51 += einsum("ijka,jlab->iklb", x49, x50)
    del x49
    x53 += einsum("ijka->ijka", x51)
    del x51
    rdm2_f_ooov_bbbb += einsum("ijka->jika", x53)
    rdm2_f_ooov_bbbb += einsum("ijka->kija", x53) * -1
    rdm2_f_ovoo_bbbb += einsum("ijka->jaki", x53) * -1
    rdm2_f_ovoo_bbbb += einsum("ijka->kaji", x53)
    del x53
    x62 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x62 += einsum("ijka,klab->ijlb", x28, x50)
    rdm2_f_ooov_aabb += einsum("ijka->jika", x62) * -1
    rdm2_f_ovoo_bbaa += einsum("ijka->kaji", x62) * -1
    del x62
    x65 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x65 += einsum("ai,ijab->jb", l1.bb, x50)
    x68 += einsum("ia->ia", x65) * -1
    del x65
    x169 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x169 += einsum("ai,ijab->jb", l1.bb, x50) * 0.9999999999999993
    x172 += einsum("ia->ia", x169) * -1
    del x169
    x219 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x219 += einsum("abij,jkbc->ikac", l2.abab, x50)
    x220 += einsum("ijab->ijab", x219) * -1
    del x219
    x54 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x54 += einsum("ai,ijab->jb", l1.aa, t2.abab)
    x58 += einsum("ia->ia", x54)
    x68 += einsum("ia->ia", x54) * -1
    x172 += einsum("ia->ia", x54) * -0.9999999999999993
    del x54
    x56 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x56 -= einsum("ijab->jiab", t2.bbbb)
    x56 += einsum("ijab->jiba", t2.bbbb)
    x57 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x57 += einsum("ai,ijba->jb", l1.bb, x56)
    x58 -= einsum("ia->ia", x57)
    del x57
    x130 += einsum("ia,jb->ijab", t1.bb, x58)
    rdm2_f_ooov_bbbb += einsum("ij,ka->jika", delta_oo.bb, x58)
    rdm2_f_ooov_bbbb -= einsum("ij,ka->kjia", delta_oo.bb, x58)
    rdm2_f_ovoo_bbbb -= einsum("ij,ka->jaki", delta_oo.bb, x58)
    rdm2_f_ovoo_bbbb += einsum("ij,ka->kaij", delta_oo.bb, x58)
    del x58
    x127 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x127 += einsum("ijka,jlab->likb", x126, x56)
    del x126
    x128 += einsum("ijka->jkia", x127)
    del x127
    x129 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x129 += einsum("ia,ijkb->jkab", t1.bb, x128)
    del x128
    x130 += einsum("ijab->ijab", x129)
    del x129
    x161 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x161 += einsum("ijka,klba->ijlb", x28, x56)
    del x28
    x162 -= einsum("ijka->ijka", x161)
    del x161
    x192 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x192 += einsum("abij,jkcb->ikac", l2.abab, x56)
    rdm2_f_ovvo_bbaa -= einsum("ijab->jbai", x192)
    rdm2_f_voov_aabb -= einsum("ijab->aijb", x192)
    del x192
    x59 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x59 += einsum("ai,jkab->ijkb", l1.aa, t2.abab)
    x162 += einsum("ijka->ijka", x59)
    x163 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x163 += einsum("ia,ijkb->jkab", t1.aa, x162)
    del x162
    rdm2_f_ovov_bbaa -= einsum("ijab->jbia", x163)
    rdm2_f_ovov_aabb -= einsum("ijab->iajb", x163)
    del x163
    rdm2_f_ooov_aabb -= einsum("ijka->jika", x59)
    rdm2_f_ovoo_bbaa -= einsum("ijka->kaji", x59)
    del x59
    x68 += einsum("ia->ia", t1.bb) * -1
    rdm2_f_ooov_aabb += einsum("ij,ka->jika", delta_oo.aa, x68) * -1
    rdm2_f_ovoo_bbaa += einsum("ij,ka->kaji", delta_oo.aa, x68) * -1
    del x68
    x69 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x69 += einsum("ai,jkba->jikb", l1.bb, t2.abab)
    x158 += einsum("ijka->ijka", x69) * -1
    x159 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x159 += einsum("ia,jikb->jkba", t1.bb, x158)
    del x158
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x159)
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x159)
    del x159
    rdm2_f_ooov_bbaa -= einsum("ijka->kjia", x69)
    rdm2_f_ovoo_aabb -= einsum("ijka->iakj", x69)
    del x69
    x76 += einsum("ia->ia", t1.aa) * -1
    rdm2_f_ooov_bbaa += einsum("ij,ka->jika", delta_oo.bb, x76) * -1
    del x76
    x79 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x79 += einsum("abij,kiac->kjcb", l2.abab, t2.aaaa)
    x80 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x80 += einsum("ijab,kjcb->kica", t2.abab, x79)
    del x79
    x90 -= einsum("ijab->ijab", x80)
    del x80
    x81 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x81 += einsum("abij,kjcb->ikac", l2.abab, t2.abab)
    x84 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x84 += einsum("ijab->ijab", x81)
    x152 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x152 += einsum("ijab->ijab", x81)
    x201 += einsum("ijab->ijab", x81)
    rdm2_f_oovv_aaaa -= einsum("ijab->jiab", x81)
    rdm2_f_ovvo_aaaa += einsum("ijab->jbai", x81)
    rdm2_f_voov_aaaa += einsum("ijab->aijb", x81)
    rdm2_f_vvoo_aaaa -= einsum("ijab->abji", x81)
    del x81
    x82 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x82 -= einsum("abij->jiab", l2.aaaa)
    x82 += einsum("abij->jiba", l2.aaaa)
    x83 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x83 += einsum("ijab,ikbc->jkac", t2.aaaa, x82)
    x84 -= einsum("ijab->jiba", x83)
    del x83
    x85 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x85 += einsum("ijab,ikac->jkbc", t2.aaaa, x84)
    del x84
    x90 += einsum("ijab->ijab", x85)
    del x85
    rdm2_f_ovov_aaaa += einsum("ijab->iajb", x90)
    rdm2_f_ovov_aaaa -= einsum("ijab->ibja", x90)
    rdm2_f_ovov_aaaa -= einsum("ijab->jaib", x90)
    rdm2_f_ovov_aaaa += einsum("ijab->jbia", x90)
    del x90
    x100 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x100 += einsum("ijab,ikca->jkbc", t2.aaaa, x82)
    x101 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x101 -= einsum("ijab,kica->jkbc", t2.aaaa, x100)
    del x100
    x107 += einsum("ijab->jiba", x101)
    del x101
    x102 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x102 += einsum("ijab,ikcb->jkac", t2.aaaa, x82)
    x103 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x103 -= einsum("ijab,kicb->jkac", t2.aaaa, x102)
    del x102
    x107 += einsum("ijab->ijab", x103)
    del x103
    x151 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x151 += einsum("ijab,ikca->jkbc", x25, x82)
    del x82
    x152 += einsum("ijab->jiba", x151)
    del x151
    x153 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x153 += einsum("ijab,ikac->kjcb", t2.abab, x152)
    del x152
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x153)
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x153)
    del x153
    x91 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x91 += einsum("abij,ijcb->ac", l2.abab, t2.abab)
    x94 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x94 += einsum("ab->ab", x91)
    x180 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x180 += einsum("ab->ab", x91)
    del x91
    x92 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x92 += einsum("abij->jiab", l2.aaaa) * -1
    x92 += einsum("abij->jiba", l2.aaaa)
    x93 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x93 += einsum("ijab,ijbc->ac", t2.aaaa, x92)
    x94 += einsum("ab->ba", x93) * -1
    x95 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x95 += einsum("ab,ijac->ijcb", x94, t2.aaaa)
    x97 += einsum("ijab->jiab", x95)
    del x95
    rdm2_f_ovov_aaaa += einsum("ijab->iajb", x97) * -1
    rdm2_f_ovov_aaaa += einsum("ijab->ibja", x97)
    rdm2_f_ovov_aaaa += einsum("ijab->jaib", x97)
    rdm2_f_ovov_aaaa += einsum("ijab->jbia", x97) * -1
    del x97
    x166 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x166 += einsum("ab,ijac->ijbc", x94, t2.abab)
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x166) * -1
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x166) * -1
    del x166
    x203 += einsum("ia,bc->ibac", t1.aa, x94)
    del x94
    x180 += einsum("ab->ba", x93) * -1
    del x93
    x200 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x200 += einsum("ijab,ikca->jkbc", x1, x92)
    del x1
    del x92
    x201 += einsum("ijab->jiba", x200)
    del x200
    x202 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x202 += einsum("ia,ijbc->jabc", t1.aa, x201)
    del x201
    x203 += einsum("iabc->ibac", x202) * -1
    del x202
    rdm2_f_ovvv_aaaa = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_ovvv_aaaa += einsum("iabc->ibac", x203)
    rdm2_f_ovvv_aaaa += einsum("iabc->icab", x203) * -1
    rdm2_f_vvov_aaaa = np.zeros((nvir[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    rdm2_f_vvov_aaaa += einsum("iabc->abic", x203) * -1
    rdm2_f_vvov_aaaa += einsum("iabc->acib", x203)
    del x203
    x104 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x104 -= einsum("abij->jiab", l2.bbbb)
    x104 += einsum("abij->jiba", l2.bbbb)
    x105 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x105 += einsum("ijab,jkcb->ikac", t2.abab, x104)
    x106 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x106 -= einsum("ijab,kjcb->ikac", t2.abab, x105)
    x107 += einsum("ijab->ijab", x106)
    del x106
    rdm2_f_ovov_aaaa += einsum("ijab->iajb", x107)
    rdm2_f_ovov_aaaa -= einsum("ijab->ibja", x107)
    del x107
    x150 -= einsum("ijab->ijab", x105)
    rdm2_f_ovov_bbaa += einsum("ijab,jkbc->kcia", x150, x56)
    rdm2_f_ovov_aabb -= einsum("ijab,jkcb->iakc", x150, x56)
    del x150
    rdm2_f_ovvo_aabb -= einsum("ijab->iabj", x105)
    rdm2_f_voov_bbaa -= einsum("ijab->bjia", x105)
    del x105
    x116 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x116 += einsum("ijab,ikca->jkbc", t2.bbbb, x104)
    x117 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x117 -= einsum("ijab,kica->jkbc", t2.bbbb, x116)
    x120 += einsum("ijab->ijab", x117)
    del x117
    x124 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x124 -= einsum("ijab->jiba", x116)
    del x116
    x118 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x118 += einsum("ijab,ikcb->jkac", t2.bbbb, x104)
    del x104
    x119 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x119 -= einsum("ijab,kicb->jkac", t2.bbbb, x118)
    del x118
    x120 += einsum("ijab->jiba", x119)
    del x119
    rdm2_f_ovov_bbbb = np.zeros((nocc[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_ovov_bbbb += einsum("ijab->iajb", x120)
    rdm2_f_ovov_bbbb -= einsum("ijab->ibja", x120)
    del x120
    x108 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x108 += einsum("ijab->jiba", t2.aaaa)
    x108 += einsum("ia,jb->ijab", t1.aa, t1.aa)
    rdm2_f_ovov_aaaa -= einsum("ijab->ibja", x108)
    rdm2_f_ovov_aaaa += einsum("ijab->iajb", x108)
    del x108
    x122 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x122 += einsum("abij,ikac->jkbc", l2.abab, t2.abab)
    x123 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x123 += einsum("ijab,jkbc->kica", t2.bbbb, x122)
    x130 += einsum("ijab->ijab", x123)
    del x123
    x124 += einsum("ijab->ijab", x122)
    x125 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x125 += einsum("ijab,ikbc->jkac", t2.bbbb, x124)
    del x124
    x130 -= einsum("ijab->jiba", x125)
    del x125
    rdm2_f_ovov_bbbb += einsum("ijab->iajb", x130)
    rdm2_f_ovov_bbbb -= einsum("ijab->ibja", x130)
    rdm2_f_ovov_bbbb -= einsum("ijab->jaib", x130)
    rdm2_f_ovov_bbbb += einsum("ijab->jbia", x130)
    del x130
    x211 += einsum("ijab->ijab", x122)
    rdm2_f_oovv_bbbb -= einsum("ijab->jiab", x122)
    rdm2_f_ovvo_bbbb += einsum("ijab->jbai", x122)
    rdm2_f_voov_bbbb += einsum("ijab->aijb", x122)
    rdm2_f_vvoo_bbbb -= einsum("ijab->abji", x122)
    del x122
    x132 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x132 += einsum("abij,ijac->bc", l2.abab, t2.abab)
    x133 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x133 += einsum("ab,ijca->ijbc", x132, t2.bbbb)
    x138 += einsum("ijab->ijab", x133) * -1
    del x133
    x164 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x164 += einsum("ab->ab", x132)
    x185 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x185 += einsum("ab->ab", x132)
    del x132
    x134 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x134 += einsum("abij->jiab", l2.bbbb) * -1
    x134 += einsum("abij->jiba", l2.bbbb)
    x135 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x135 += einsum("ijab,ijbc->ac", t2.bbbb, x134)
    x136 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x136 += einsum("ab,ijbc->ijca", x135, t2.bbbb) * -1
    x138 += einsum("ijab->jiab", x136)
    del x136
    rdm2_f_ovov_bbbb += einsum("ijab->iajb", x138) * -1
    rdm2_f_ovov_bbbb += einsum("ijab->ibja", x138)
    rdm2_f_ovov_bbbb += einsum("ijab->jaib", x138)
    rdm2_f_ovov_bbbb += einsum("ijab->jbia", x138) * -1
    del x138
    x164 += einsum("ab->ba", x135) * -1
    x165 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x165 += einsum("ab,ijca->ijcb", x164, t2.abab)
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x165) * -1
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x165) * -1
    del x165
    x213 += einsum("ia,bc->ibac", t1.bb, x164)
    del x164
    x185 += einsum("ab->ba", x135) * -1
    del x135
    x210 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x210 += einsum("ijab,ikcb->kjca", x134, x50)
    del x50
    x211 += einsum("ijab->jiba", x210)
    del x210
    x212 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x212 += einsum("ia,ijbc->jabc", t1.bb, x211)
    del x211
    x213 += einsum("iabc->ibac", x212) * -1
    del x212
    rdm2_f_ovvv_bbbb = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_ovvv_bbbb += einsum("iabc->ibac", x213)
    rdm2_f_ovvv_bbbb += einsum("iabc->icab", x213) * -1
    rdm2_f_vvov_bbbb = np.zeros((nvir[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    rdm2_f_vvov_bbbb += einsum("iabc->abic", x213) * -1
    rdm2_f_vvov_bbbb += einsum("iabc->acib", x213)
    del x213
    x226 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x226 += einsum("ijab,jkbc->ikac", t2.abab, x134)
    del x134
    x227 += einsum("ijab->ijab", x226) * -1
    del x226
    x228 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x228 += einsum("ia,jibc->jbac", t1.bb, x227)
    del x227
    rdm2_f_ovvv_aabb += einsum("iabc->iacb", x228) * -1
    rdm2_f_vvov_bbaa += einsum("iabc->cbia", x228) * -1
    del x228
    x140 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x140 += einsum("ijab->jiba", t2.bbbb)
    x140 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    x141 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x141 += einsum("ijkl,ijab->klab", x14, x140)
    del x140
    del x14
    x142 += einsum("ijab->jiba", x141)
    del x141
    rdm2_f_ovov_bbbb += einsum("ijab->iajb", x142)
    rdm2_f_ovov_bbbb += einsum("ijab->ibja", x142) * -1
    del x142
    x143 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x143 += einsum("ijab->jiba", t2.bbbb)
    x143 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    rdm2_f_ovov_bbbb -= einsum("ijab->ibja", x143)
    rdm2_f_ovov_bbbb += einsum("ijab->iajb", x143)
    del x143
    x144 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x144 += einsum("abij->jiab", l2.aaaa)
    x144 -= einsum("abij->jiba", l2.aaaa)
    x145 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x145 += einsum("ijab,ikac->kjcb", t2.abab, x144)
    x146 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x146 -= einsum("ijab,ikac->jkbc", t2.abab, x145)
    rdm2_f_ovov_bbbb -= einsum("ijab->jaib", x146)
    rdm2_f_ovov_bbbb += einsum("ijab->iajb", x146)
    del x146
    rdm2_f_ovvo_bbaa -= einsum("ijab->jbai", x145)
    rdm2_f_voov_aabb -= einsum("ijab->aijb", x145)
    del x145
    x176 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x176 += einsum("ijab,ikca->kjcb", x144, x25)
    rdm2_f_oovv_aaaa += einsum("ijab->ijba", x176)
    rdm2_f_vvoo_aaaa += einsum("ijab->baij", x176)
    del x176
    x189 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x189 += einsum("ijab,ikac->kjcb", x144, x25)
    del x144
    del x25
    rdm2_f_ovvo_aaaa += einsum("ijab->iabj", x189)
    rdm2_f_voov_aaaa += einsum("ijab->bjia", x189)
    del x189
    x147 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x147 += einsum("abij,kjac->ikbc", l2.abab, t2.abab)
    x148 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x148 += einsum("ijab,ikbc->kjac", t2.abab, x147)
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", x148)
    rdm2_f_ovov_aabb += einsum("ijab->iajb", x148)
    del x148
    x224 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x224 += einsum("ia,ijbc->jabc", t1.aa, x147)
    rdm2_f_ovvv_aabb += einsum("iabc->iabc", x224) * -1
    rdm2_f_vvov_bbaa += einsum("iabc->bcia", x224) * -1
    del x224
    rdm2_f_oovv_aabb -= einsum("ijab->jiab", x147)
    rdm2_f_vvoo_bbaa -= einsum("ijab->abji", x147)
    del x147
    x172 += einsum("ia->ia", t1.bb) * -0.9999999999999993
    rdm2_f_ovov_bbaa += einsum("ia,jb->jbia", t1.aa, x172) * -1
    rdm2_f_ovov_aabb += einsum("ia,jb->iajb", t1.aa, x172) * -1
    del x172
    x179 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x179 += einsum("ai,ib->ab", l1.aa, t1.aa)
    x180 += einsum("ab->ab", x179)
    rdm2_f_oovv_aaaa += einsum("ij,ab->jiab", delta_oo.aa, x180)
    rdm2_f_oovv_bbaa += einsum("ij,ab->jiab", delta_oo.bb, x180)
    rdm2_f_ovvo_aaaa += einsum("ij,ab->jbai", delta_oo.aa, x180) * -1
    rdm2_f_voov_aaaa += einsum("ij,ab->aijb", delta_oo.aa, x180) * -1
    rdm2_f_vvoo_aaaa += einsum("ij,ab->abji", delta_oo.aa, x180)
    rdm2_f_vvoo_aabb += einsum("ij,ab->abji", delta_oo.bb, x180)
    rdm2_f_ovvv_bbaa += einsum("ia,bc->iabc", t1.bb, x180)
    rdm2_f_vvov_aabb += einsum("ia,bc->bcia", t1.bb, x180)
    del x180
    x205 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x205 += einsum("ia,bc->ibac", t1.aa, x179)
    del x179
    x181 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x181 += einsum("abij->jiab", l2.bbbb)
    x181 -= einsum("abij->jiba", l2.bbbb)
    x182 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x182 += einsum("ijab,ikac->kjcb", x181, x56)
    del x56
    rdm2_f_oovv_bbbb += einsum("ijab->ijba", x182)
    rdm2_f_vvoo_bbbb += einsum("ijab->baij", x182)
    del x182
    x184 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x184 += einsum("ai,ib->ab", l1.bb, t1.bb)
    x185 += einsum("ab->ab", x184)
    rdm2_f_oovv_bbbb += einsum("ij,ab->jiab", delta_oo.bb, x185)
    rdm2_f_oovv_aabb += einsum("ij,ab->jiab", delta_oo.aa, x185)
    rdm2_f_ovvo_bbbb += einsum("ij,ab->jbai", delta_oo.bb, x185) * -1
    rdm2_f_voov_bbbb += einsum("ij,ab->aijb", delta_oo.bb, x185) * -1
    rdm2_f_vvoo_bbbb += einsum("ij,ab->abji", delta_oo.bb, x185)
    rdm2_f_vvoo_bbaa += einsum("ij,ab->abji", delta_oo.aa, x185)
    rdm2_f_ovvv_aabb += einsum("ia,bc->iabc", t1.aa, x185)
    rdm2_f_vvov_bbaa += einsum("ia,bc->bcia", t1.aa, x185)
    del x185
    x207 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x207 += einsum("ia,bc->ibac", t1.bb, x184)
    del x184
    x186 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x186 += einsum("abij,ikcb->jkac", l2.abab, t2.abab)
    x215 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x215 += einsum("ia,ijbc->jbca", t1.bb, x186)
    rdm2_f_ovvv_bbaa += einsum("iabc->icab", x215) * -1
    rdm2_f_vvov_aabb += einsum("iabc->abic", x215) * -1
    del x215
    rdm2_f_oovv_bbaa -= einsum("ijab->jiab", x186)
    rdm2_f_vvoo_aabb -= einsum("ijab->abji", x186)
    del x186
    x194 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x194 += einsum("ijab->jiab", t2.bbbb)
    x194 -= einsum("ijab->jiba", t2.bbbb)
    x195 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x195 += einsum("ijab,ikac->jkbc", x181, x194)
    del x194
    del x181
    rdm2_f_ovvo_bbbb += einsum("ijab->jbai", x195)
    rdm2_f_voov_bbbb += einsum("ijab->aijb", x195)
    del x195
    x204 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x204 += einsum("ai,jibc->jabc", l1.aa, t2.aaaa)
    x205 += einsum("iabc->iabc", x204)
    del x204
    rdm2_f_ovvv_aaaa += einsum("iabc->ibac", x205)
    rdm2_f_ovvv_aaaa -= einsum("iabc->icab", x205)
    rdm2_f_vvov_aaaa -= einsum("iabc->abic", x205)
    rdm2_f_vvov_aaaa += einsum("iabc->acib", x205)
    del x205
    x206 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x206 += einsum("ai,jibc->jabc", l1.bb, t2.bbbb)
    x207 += einsum("iabc->iabc", x206)
    del x206
    rdm2_f_ovvv_bbbb += einsum("iabc->ibac", x207)
    rdm2_f_ovvv_bbbb -= einsum("iabc->icab", x207)
    rdm2_f_vvov_bbbb -= einsum("iabc->abic", x207)
    rdm2_f_vvov_bbbb += einsum("iabc->acib", x207)
    del x207
    x216 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x216 += einsum("ai,ijbc->jabc", l1.aa, t2.abab)
    rdm2_f_ovvv_bbaa += einsum("iabc->icab", x216)
    rdm2_f_vvov_aabb += einsum("iabc->abic", x216)
    del x216
    x217 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x217 += einsum("abij->jiab", l2.aaaa)
    x217 += einsum("abij->jiba", l2.aaaa) * -1
    x218 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x218 += einsum("ijab,ikca->kjcb", t2.abab, x217)
    del x217
    x220 += einsum("ijab->ijab", x218) * -1
    del x218
    x221 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x221 += einsum("ia,ijbc->jabc", t1.aa, x220)
    del x220
    rdm2_f_ovvv_bbaa += einsum("iabc->icba", x221) * -1
    rdm2_f_vvov_aabb += einsum("iabc->baic", x221) * -1
    del x221
    x222 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x222 += einsum("ai,jibc->jbac", l1.bb, t2.abab)
    rdm2_f_ovvv_aabb += einsum("iabc->iabc", x222)
    rdm2_f_vvov_bbaa += einsum("iabc->bcia", x222)
    del x222
    x229 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x229 += einsum("ia,bcji->jbca", t1.aa, l2.aaaa)
    x234 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x234 += einsum("ia,ibcd->cbda", t1.aa, x229)
    x235 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x235 += einsum("abcd->badc", x234)
    del x234
    rdm2_f_vovv_aaaa = np.zeros((nvir[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_vovv_aaaa += einsum("iabc->aibc", x229)
    rdm2_f_vovv_aaaa -= einsum("iabc->biac", x229)
    rdm2_f_vvvo_aaaa = np.zeros((nvir[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_vvvo_aaaa -= einsum("iabc->acbi", x229)
    rdm2_f_vvvo_aaaa += einsum("iabc->bcai", x229)
    del x229
    x230 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x230 += einsum("ia,bcji->jbca", t1.bb, l2.bbbb)
    x239 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x239 += einsum("ia,ibcd->cbda", t1.bb, x230)
    x240 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x240 += einsum("abcd->badc", x239)
    del x239
    rdm2_f_vovv_bbbb = np.zeros((nvir[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_vovv_bbbb += einsum("iabc->aibc", x230)
    rdm2_f_vovv_bbbb -= einsum("iabc->biac", x230)
    rdm2_f_vvvo_bbbb = np.zeros((nvir[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_vvvo_bbbb -= einsum("iabc->acbi", x230)
    rdm2_f_vvvo_bbbb += einsum("iabc->bcai", x230)
    del x230
    x231 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x231 += einsum("ia,bcij->jbac", t1.aa, l2.abab)
    rdm2_f_vovv_bbaa = np.zeros((nvir[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_vovv_bbaa += einsum("iabc->ciab", x231)
    rdm2_f_vvvo_aabb = np.zeros((nvir[0], nvir[0], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_vvvo_aabb += einsum("iabc->abci", x231)
    del x231
    x232 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x232 += einsum("ia,bcji->jbca", t1.bb, l2.abab)
    x237 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x237 += einsum("ia,ibcd->bacd", t1.aa, x232)
    rdm2_f_vvvv_bbaa = np.zeros((nvir[1], nvir[1], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_vvvv_bbaa += einsum("abcd->cdab", x237)
    rdm2_f_vvvv_aabb = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_vvvv_aabb += einsum("abcd->abcd", x237)
    del x237
    rdm2_f_vovv_aabb = np.zeros((nvir[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_vovv_aabb += einsum("iabc->aibc", x232)
    rdm2_f_vvvo_bbaa = np.zeros((nvir[1], nvir[1], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_vvvo_bbaa += einsum("iabc->bcai", x232)
    del x232
    x233 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x233 += einsum("abij,ijcd->abcd", l2.aaaa, t2.aaaa)
    x235 += einsum("abcd->badc", x233)
    del x233
    rdm2_f_vvvv_aaaa = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    rdm2_f_vvvv_aaaa += einsum("abcd->adbc", x235) * -1
    rdm2_f_vvvv_aaaa += einsum("abcd->acbd", x235)
    del x235
    x236 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x236 += einsum("abij,ijcd->acbd", l2.abab, t2.abab)
    rdm2_f_vvvv_bbaa += einsum("abcd->cdab", x236)
    rdm2_f_vvvv_aabb += einsum("abcd->abcd", x236)
    del x236
    x238 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x238 += einsum("abij,ijcd->abcd", l2.bbbb, t2.bbbb)
    x240 += einsum("abcd->badc", x238)
    del x238
    rdm2_f_vvvv_bbbb = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    rdm2_f_vvvv_bbbb += einsum("abcd->adbc", x240) * -1
    rdm2_f_vvvv_bbbb += einsum("abcd->acbd", x240)
    del x240
    rdm2_f_oooo_aaaa += einsum("ij,kl->jilk", delta_oo.aa, delta_oo.aa)
    rdm2_f_oooo_aaaa -= einsum("ij,kl->ljik", delta_oo.aa, delta_oo.aa)
    rdm2_f_oooo_bbbb += einsum("ij,kl->jilk", delta_oo.bb, delta_oo.bb)
    rdm2_f_oooo_bbbb -= einsum("ij,kl->ljik", delta_oo.bb, delta_oo.bb)
    rdm2_f_oovo_aaaa += einsum("ij,ak->jiak", delta_oo.aa, l1.aa)
    rdm2_f_oovo_aaaa -= einsum("ij,ak->jkai", delta_oo.aa, l1.aa)
    rdm2_f_oovo_bbbb += einsum("ij,ak->jiak", delta_oo.bb, l1.bb)
    rdm2_f_oovo_bbbb -= einsum("ij,ak->jkai", delta_oo.bb, l1.bb)
    rdm2_f_oovo_aabb += einsum("ij,ak->jiak", delta_oo.aa, l1.bb)
    rdm2_f_oovo_bbaa += einsum("ij,ak->jiak", delta_oo.bb, l1.aa)
    rdm2_f_vooo_aaaa -= einsum("ij,ak->aijk", delta_oo.aa, l1.aa)
    rdm2_f_vooo_aaaa += einsum("ij,ak->akji", delta_oo.aa, l1.aa)
    rdm2_f_vooo_bbaa += einsum("ij,ak->akji", delta_oo.aa, l1.bb)
    rdm2_f_vooo_aabb += einsum("ij,ak->akji", delta_oo.bb, l1.aa)
    rdm2_f_vooo_bbbb -= einsum("ij,ak->aijk", delta_oo.bb, l1.bb)
    rdm2_f_vooo_bbbb += einsum("ij,ak->akji", delta_oo.bb, l1.bb)
    rdm2_f_ovov_bbaa += einsum("ijab->jbia", t2.abab)
    rdm2_f_ovov_aabb += einsum("ijab->iajb", t2.abab)
    rdm2_f_oovv_aaaa -= einsum("ai,jb->jiab", l1.aa, t1.aa)
    rdm2_f_oovv_bbbb -= einsum("ai,jb->jiab", l1.bb, t1.bb)
    rdm2_f_ovvo_aaaa += einsum("ai,jb->jbai", l1.aa, t1.aa)
    rdm2_f_ovvo_bbaa += einsum("ai,jb->jbai", l1.aa, t1.bb)
    rdm2_f_ovvo_aabb += einsum("ai,jb->jbai", l1.bb, t1.aa)
    rdm2_f_ovvo_bbbb += einsum("ai,jb->jbai", l1.bb, t1.bb)
    rdm2_f_voov_aaaa += einsum("ai,jb->aijb", l1.aa, t1.aa)
    rdm2_f_voov_aabb += einsum("ai,jb->aijb", l1.aa, t1.bb)
    rdm2_f_voov_bbaa += einsum("ai,jb->aijb", l1.bb, t1.aa)
    rdm2_f_voov_bbbb += einsum("ai,jb->aijb", l1.bb, t1.bb)
    rdm2_f_vvoo_aaaa -= einsum("ai,jb->abji", l1.aa, t1.aa)
    rdm2_f_vvoo_bbbb -= einsum("ai,jb->abji", l1.bb, t1.bb)
    rdm2_f_vovo_aaaa = np.zeros((nvir[0], nocc[0], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_vovo_aaaa -= einsum("abij->ajbi", l2.aaaa)
    rdm2_f_vovo_aaaa += einsum("abij->bjai", l2.aaaa)
    rdm2_f_vovo_bbbb = np.zeros((nvir[1], nocc[1], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_vovo_bbbb -= einsum("abij->ajbi", l2.bbbb)
    rdm2_f_vovo_bbbb += einsum("abij->bjai", l2.bbbb)
    rdm2_f_vovo_bbaa = np.zeros((nvir[1], nocc[1], nvir[0], nocc[0]), dtype=np.float64)
    rdm2_f_vovo_bbaa += einsum("abij->bjai", l2.abab)
    rdm2_f_vovo_aabb = np.zeros((nvir[0], nocc[0], nvir[1], nocc[1]), dtype=np.float64)
    rdm2_f_vovo_aabb += einsum("abij->aibj", l2.abab)

    rdm2_f_aaaa = pack_2e(rdm2_f_oooo_aaaa, rdm2_f_ooov_aaaa, rdm2_f_oovo_aaaa, rdm2_f_ovoo_aaaa, rdm2_f_vooo_aaaa, rdm2_f_oovv_aaaa, rdm2_f_ovov_aaaa, rdm2_f_ovvo_aaaa, rdm2_f_voov_aaaa, rdm2_f_vovo_aaaa, rdm2_f_vvoo_aaaa, rdm2_f_ovvv_aaaa, rdm2_f_vovv_aaaa, rdm2_f_vvov_aaaa, rdm2_f_vvvo_aaaa, rdm2_f_vvvv_aaaa)
    rdm2_f_aabb = pack_2e(rdm2_f_oooo_aabb, rdm2_f_ooov_aabb, rdm2_f_oovo_aabb, rdm2_f_ovoo_aabb, rdm2_f_vooo_aabb, rdm2_f_oovv_aabb, rdm2_f_ovov_aabb, rdm2_f_ovvo_aabb, rdm2_f_voov_aabb, rdm2_f_vovo_aabb, rdm2_f_vvoo_aabb, rdm2_f_ovvv_aabb, rdm2_f_vovv_aabb, rdm2_f_vvov_aabb, rdm2_f_vvvo_aabb, rdm2_f_vvvv_aabb)
    rdm2_f_bbaa = pack_2e(rdm2_f_oooo_bbaa, rdm2_f_ooov_bbaa, rdm2_f_oovo_bbaa, rdm2_f_ovoo_bbaa, rdm2_f_vooo_bbaa, rdm2_f_oovv_bbaa, rdm2_f_ovov_bbaa, rdm2_f_ovvo_bbaa, rdm2_f_voov_bbaa, rdm2_f_vovo_bbaa, rdm2_f_vvoo_bbaa, rdm2_f_ovvv_bbaa, rdm2_f_vovv_bbaa, rdm2_f_vvov_bbaa, rdm2_f_vvvo_bbaa, rdm2_f_vvvv_bbaa)
    rdm2_f_bbbb = pack_2e(rdm2_f_oooo_bbbb, rdm2_f_ooov_bbbb, rdm2_f_oovo_bbbb, rdm2_f_ovoo_bbbb, rdm2_f_vooo_bbbb, rdm2_f_oovv_bbbb, rdm2_f_ovov_bbbb, rdm2_f_ovvo_bbbb, rdm2_f_voov_bbbb, rdm2_f_vovo_bbbb, rdm2_f_vvoo_bbbb, rdm2_f_ovvv_bbbb, rdm2_f_vovv_bbbb, rdm2_f_vvov_bbbb, rdm2_f_vvvo_bbbb, rdm2_f_vvvv_bbbb)

    rdm2_f.aaaa = rdm2_f_aaaa
    rdm2_f.aabb = rdm2_f_aabb
    rdm2_f.bbaa = rdm2_f_bbaa
    rdm2_f.bbbb = rdm2_f_bbbb

    return rdm2_f

def make_ip_mom_kets(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    ket1 = SimpleNamespace()
    ket2 = SimpleNamespace()

    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    ket2_o_aaaa = np.zeros((nocc[0], nocc[0], nvir[0], nocc[0]), dtype=np.float64)
    ket2_o_abab = np.zeros((nocc[0], nocc[1], nvir[0], nocc[1]), dtype=np.float64)
    ket2_o_baba = np.zeros((nocc[1], nocc[0], nvir[1], nocc[0]), dtype=np.float64)
    ket2_o_bbbb = np.zeros((nocc[1], nocc[1], nvir[1], nocc[1]), dtype=np.float64)
    ket1_o_aa = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    ket1_o_aa += einsum("ij->ji", delta_oo.aa)
    ket1_o_bb = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    ket1_o_bb += einsum("ij->ji", delta_oo.bb)
    ket1_v_aa = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    ket1_v_aa += einsum("ia->ia", t1.aa)
    ket1_v_bb = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    ket1_v_bb += einsum("ia->ia", t1.bb)
    ket2_v_aaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    ket2_v_aaaa += einsum("ijab->jiab", t2.aaaa)
    ket2_v_aaaa -= einsum("ijab->jiba", t2.aaaa)
    ket2_v_bbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    ket2_v_bbbb += einsum("ijab->jiab", t2.bbbb)
    ket2_v_bbbb -= einsum("ijab->jiba", t2.bbbb)
    ket2_v_baba = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    ket2_v_baba -= einsum("ijab->jiba", t2.abab)
    ket2_v_abab = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    ket2_v_abab -= einsum("ijab->ijab", t2.abab)

    ket1_aa = np.concatenate([ket1_o_aa, ket1_v_aa], axis=1)
    ket1_bb = np.concatenate([ket1_o_bb, ket1_v_bb], axis=1)
    ket2_aaaa = np.concatenate([ket2_o_aaaa, ket2_v_aaaa], axis=3)
    ket2_abab = np.concatenate([ket2_o_abab, ket2_v_abab], axis=3)
    ket2_baba = np.concatenate([ket2_o_baba, ket2_v_baba], axis=3)
    ket2_bbbb = np.concatenate([ket2_o_bbbb, ket2_v_bbbb], axis=3)

    ket1.aa = ket1_aa
    ket1.bb = ket1_bb
    ket2.aaaa = ket2_aaaa
    ket2.abab = ket2_abab
    ket2.baba = ket2_baba
    ket2.bbbb = ket2_bbbb

    return ket1, ket2

def make_ea_mom_kets(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    ket1 = SimpleNamespace()
    ket2 = SimpleNamespace()

    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    ket2_v_aaaa = np.zeros((nvir[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    ket2_v_abab = np.zeros((nvir[0], nvir[1], nocc[0], nvir[1]), dtype=np.float64)
    ket2_v_baba = np.zeros((nvir[1], nvir[0], nocc[1], nvir[0]), dtype=np.float64)
    ket2_v_bbbb = np.zeros((nvir[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    ket1_o_aa = np.zeros((nvir[0], nocc[0]), dtype=np.float64)
    ket1_o_aa -= einsum("ia->ai", t1.aa)
    ket1_o_bb = np.zeros((nvir[1], nocc[1]), dtype=np.float64)
    ket1_o_bb -= einsum("ia->ai", t1.bb)
    ket1_v_aa = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    ket1_v_aa += einsum("ab->ba", delta_vv.aa)
    ket1_v_bb = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    ket1_v_bb += einsum("ab->ba", delta_vv.bb)
    ket2_o_aaaa = np.zeros((nvir[0], nvir[0], nocc[0], nocc[0]), dtype=np.float64)
    ket2_o_aaaa -= einsum("ijab->abji", t2.aaaa)
    ket2_o_aaaa += einsum("ijab->baji", t2.aaaa)
    ket2_o_bbbb = np.zeros((nvir[1], nvir[1], nocc[1], nocc[1]), dtype=np.float64)
    ket2_o_bbbb -= einsum("ijab->abji", t2.bbbb)
    ket2_o_bbbb += einsum("ijab->baji", t2.bbbb)
    ket2_o_baba = np.zeros((nvir[1], nvir[0], nocc[1], nocc[0]), dtype=np.float64)
    ket2_o_baba += einsum("ijab->baji", t2.abab)
    ket2_o_abab = np.zeros((nvir[0], nvir[1], nocc[0], nocc[1]), dtype=np.float64)
    ket2_o_abab += einsum("ijab->abij", t2.abab)

    ket1_aa = np.concatenate([ket1_o_aa, ket1_v_aa], axis=1)
    ket1_bb = np.concatenate([ket1_o_bb, ket1_v_bb], axis=1)
    ket2_aaaa = np.concatenate([ket2_o_aaaa, ket2_v_aaaa], axis=3)
    ket2_abab = np.concatenate([ket2_o_abab, ket2_v_abab], axis=3)
    ket2_baba = np.concatenate([ket2_o_baba, ket2_v_baba], axis=3)
    ket2_bbbb = np.concatenate([ket2_o_bbbb, ket2_v_bbbb], axis=3)

    ket2_aaaa *= -1
    ket2_abab *= -1
    ket2_baba *= -1
    ket2_bbbb *= -1

    ket1.aa = ket1_aa
    ket1.bb = ket1_bb
    ket2.aaaa = ket2_aaaa
    ket2.abab = ket2_abab
    ket2.baba = ket2_baba
    ket2.bbbb = ket2_bbbb

    return ket1, ket2

def make_ip_mom_bras(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    bra1 = SimpleNamespace()
    bra2 = SimpleNamespace()

    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    x0 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x0 += einsum("ijab->jiab", t2.aaaa)
    x0 += einsum("ijab->jiba", t2.aaaa) * -1
    bra1_o_aa = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    bra1_o_aa += einsum("abij,ikba->kj", l2.aaaa, x0) * -1
    del x0
    x1 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x1 += einsum("ijab->jiab", t2.bbbb) * -1
    x1 += einsum("ijab->jiba", t2.bbbb)
    bra1_o_bb = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    bra1_o_bb += einsum("abij,ikab->kj", l2.bbbb, x1) * -1
    del x1
    x2 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x2 += einsum("ia,abjk->kjib", t1.aa, l2.aaaa)
    bra2_o_aaaa = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    bra2_o_aaaa += einsum("ijka->kija", x2)
    bra2_o_aaaa -= einsum("ijka->kjia", x2)
    del x2
    x3 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x3 += einsum("ia,abjk->kjib", t1.bb, l2.bbbb)
    bra2_o_bbbb = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    bra2_o_bbbb += einsum("ijka->kija", x3)
    bra2_o_bbbb -= einsum("ijka->kjia", x3)
    del x3
    bra1_o_aa -= einsum("ai,ja->ji", l1.aa, t1.aa)
    bra1_o_aa += einsum("ij->ji", delta_oo.aa)
    bra1_o_aa += einsum("abij,kjab->ki", l2.abab, t2.abab) * -1
    bra1_o_bb += einsum("ij->ji", delta_oo.bb)
    bra1_o_bb -= einsum("ai,ja->ji", l1.bb, t1.bb)
    bra1_o_bb += einsum("abij,ikab->kj", l2.abab, t2.abab) * -1
    bra1_v_aa = np.zeros((nvir[0], nocc[0]), dtype=np.float64)
    bra1_v_aa += einsum("ai->ai", l1.aa)
    bra1_v_bb = np.zeros((nvir[1], nocc[1]), dtype=np.float64)
    bra1_v_bb += einsum("ai->ai", l1.bb)
    bra2_o_aaaa += einsum("ij,ak->jika", delta_oo.aa, l1.aa)
    bra2_o_aaaa -= einsum("ij,ak->jkia", delta_oo.aa, l1.aa)
    bra2_o_abab = np.zeros((nocc[0], nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    bra2_o_abab += einsum("ia,abjk->ikjb", t1.aa, l2.abab)
    bra2_o_abab -= einsum("ij,ak->jkia", delta_oo.aa, l1.bb)
    bra2_o_baba = np.zeros((nocc[1], nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    bra2_o_baba -= einsum("ij,ak->jkia", delta_oo.bb, l1.aa)
    bra2_o_baba += einsum("ia,bajk->ijkb", t1.bb, l2.abab)
    bra2_o_bbbb += einsum("ij,ak->jika", delta_oo.bb, l1.bb)
    bra2_o_bbbb -= einsum("ij,ak->jkia", delta_oo.bb, l1.bb)
    bra2_v_aaaa = np.zeros((nvir[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    bra2_v_aaaa -= einsum("abij->ajib", l2.aaaa)
    bra2_v_aaaa += einsum("abij->bjia", l2.aaaa)
    bra2_v_baba = np.zeros((nvir[1], nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    bra2_v_baba -= einsum("abij->bija", l2.abab)
    bra2_v_abab = np.zeros((nvir[0], nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    bra2_v_abab -= einsum("abij->ajib", l2.abab)
    bra2_v_bbbb = np.zeros((nvir[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    bra2_v_bbbb -= einsum("abij->ajib", l2.bbbb)
    bra2_v_bbbb += einsum("abij->bjia", l2.bbbb)

    bra1_aa = np.concatenate([bra1_o_aa, bra1_v_aa], axis=0)
    bra1_bb = np.concatenate([bra1_o_bb, bra1_v_bb], axis=0)
    bra2_aaaa = np.concatenate([bra2_o_aaaa, bra2_v_aaaa], axis=0)
    bra2_abab = np.concatenate([bra2_o_abab, bra2_v_abab], axis=0)
    bra2_baba = np.concatenate([bra2_o_baba, bra2_v_baba], axis=0)
    bra2_bbbb = np.concatenate([bra2_o_bbbb, bra2_v_bbbb], axis=0)

    bra1.aa = bra1_aa
    bra1.bb = bra1_bb
    bra2.aaaa = bra2_aaaa
    bra2.abab = bra2_abab
    bra2.baba = bra2_baba
    bra2.bbbb = bra2_bbbb

    return bra1, bra2

def make_ea_mom_bras(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    bra1 = SimpleNamespace()
    bra2 = SimpleNamespace()

    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    x0 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x0 += einsum("ijab->jiab", t2.aaaa) * -1
    x0 += einsum("ijab->jiba", t2.aaaa)
    bra1_v_aa = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    bra1_v_aa += einsum("abij,ijac->cb", l2.aaaa, x0) * -1
    del x0
    x1 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x1 += einsum("ijab->jiab", t2.bbbb)
    x1 += einsum("ijab->jiba", t2.bbbb) * -1
    bra1_v_bb = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    bra1_v_bb += einsum("abij,ijbc->ca", l2.bbbb, x1) * -1
    del x1
    x2 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x2 += einsum("ia,bcji->jbca", t1.aa, l2.aaaa)
    bra2_v_aaaa = np.zeros((nvir[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    bra2_v_aaaa += einsum("iabc->cabi", x2)
    bra2_v_aaaa -= einsum("iabc->cbai", x2)
    del x2
    x3 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x3 += einsum("ia,bcji->jbca", t1.bb, l2.bbbb)
    bra2_v_bbbb = np.zeros((nvir[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    bra2_v_bbbb += einsum("iabc->cabi", x3)
    bra2_v_bbbb -= einsum("iabc->cbai", x3)
    del x3
    bra1_o_aa = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    bra1_o_aa -= einsum("ai->ia", l1.aa)
    bra1_o_bb = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    bra1_o_bb -= einsum("ai->ia", l1.bb)
    bra1_v_aa += einsum("ab->ba", delta_vv.aa)
    bra1_v_aa -= einsum("ai,ib->ba", l1.aa, t1.aa)
    bra1_v_aa += einsum("abij,ijcb->ca", l2.abab, t2.abab) * -1
    bra1_v_bb += einsum("abij,ijac->cb", l2.abab, t2.abab) * -1
    bra1_v_bb += einsum("ab->ba", delta_vv.bb)
    bra1_v_bb -= einsum("ai,ib->ba", l1.bb, t1.bb)
    bra2_o_aaaa = np.zeros((nocc[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    bra2_o_aaaa += einsum("abij->jabi", l2.aaaa)
    bra2_o_aaaa -= einsum("abij->jbai", l2.aaaa)
    bra2_o_abab = np.zeros((nocc[0], nvir[1], nvir[0], nocc[1]), dtype=np.float64)
    bra2_o_abab += einsum("abij->ibaj", l2.abab)
    bra2_o_baba = np.zeros((nocc[1], nvir[0], nvir[1], nocc[0]), dtype=np.float64)
    bra2_o_baba += einsum("abij->jabi", l2.abab)
    bra2_o_bbbb = np.zeros((nocc[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    bra2_o_bbbb += einsum("abij->jabi", l2.bbbb)
    bra2_o_bbbb -= einsum("abij->jbai", l2.bbbb)
    bra2_v_aaaa += einsum("ab,ci->baci", delta_vv.aa, l1.aa)
    bra2_v_aaaa -= einsum("ab,ci->bcai", delta_vv.aa, l1.aa)
    bra2_v_abab = np.zeros((nvir[0], nvir[1], nvir[0], nocc[1]), dtype=np.float64)
    bra2_v_abab -= einsum("ab,ci->bcai", delta_vv.aa, l1.bb)
    bra2_v_abab += einsum("ia,bcij->acbj", t1.aa, l2.abab)
    bra2_v_baba = np.zeros((nvir[1], nvir[0], nvir[1], nocc[0]), dtype=np.float64)
    bra2_v_baba -= einsum("ab,ci->bcai", delta_vv.bb, l1.aa)
    bra2_v_baba += einsum("ia,bcji->abcj", t1.bb, l2.abab)
    bra2_v_bbbb += einsum("ab,ci->baci", delta_vv.bb, l1.bb)
    bra2_v_bbbb -= einsum("ab,ci->bcai", delta_vv.bb, l1.bb)

    bra1_aa = np.concatenate([bra1_o_aa, bra1_v_aa], axis=0)
    bra1_bb = np.concatenate([bra1_o_bb, bra1_v_bb], axis=0)
    bra2_aaaa = np.concatenate([bra2_o_aaaa, bra2_v_aaaa], axis=0)
    bra2_abab = np.concatenate([bra2_o_abab, bra2_v_abab], axis=0)
    bra2_baba = np.concatenate([bra2_o_baba, bra2_v_baba], axis=0)
    bra2_bbbb = np.concatenate([bra2_o_bbbb, bra2_v_bbbb], axis=0)

    bra2_aaaa *= -1
    bra2_abab *= -1
    bra2_baba *= -1
    bra2_bbbb *= -1

    bra1.aa = bra1_aa
    bra1.bb = bra1_bb
    bra2.aaaa = bra2_aaaa
    bra2.abab = bra2_abab
    bra2.baba = bra2_baba
    bra2.bbbb = bra2_bbbb

    return bra1, bra2

def hbar_diag_ip(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    r1_aa = np.zeros((nocc[0]), dtype=np.float64)
    r1_aa -= einsum("ia,ja->j", f.aa.ov, t1.aa)
    r1_aa += einsum("ijab,iakb->j", t2.baba, v.bbaa.ovov) * -1
    r1_aa -= einsum("ia,jb,jbka->i", t1.aa, t1.bb, v.bbaa.ovov)
    r1_aa -= einsum("ia,iajk->k", t1.bb, v.bbaa.ovoo)
    r1_aa += einsum("ia,ijka->j", t1.aa, v.aaaa.ooov)
    r1_aa -= einsum("ia,iajk->k", t1.aa, v.aaaa.ovoo)
    r1_aa += einsum("ijab,ibka->j", t2.aaaa, v.aaaa.ovov)
    r1_aa += einsum("ijab,iakb->j", t2.aaaa, v.aaaa.ovov) * -1
    r1_aa += einsum("ia,jb,jakb->i", t1.aa, t1.aa, v.aaaa.ovov)
    r1_aa += einsum("ia,jb,jbka->i", t1.aa, t1.aa, v.aaaa.ovov) * -1
    r1_aa -= einsum("ij->j", f.aa.oo)
    r1_bb = np.zeros((nocc[1]), dtype=np.float64)
    r1_bb += einsum("ia,ijka->j", t1.bb, v.bbbb.ooov)
    r1_bb -= einsum("ia,iajk->k", t1.bb, v.bbbb.ovoo)
    r1_bb -= einsum("ia,ja->j", f.bb.ov, t1.bb)
    r1_bb += einsum("ijab,ibka->j", t2.bbbb, v.bbbb.ovov)
    r1_bb += einsum("ijab,iakb->j", t2.bbbb, v.bbbb.ovov) * -1
    r1_bb += einsum("ia,jb,jakb->i", t1.bb, t1.bb, v.bbbb.ovov)
    r1_bb += einsum("ia,jb,jbka->i", t1.bb, t1.bb, v.bbbb.ovov) * -1
    r1_bb -= einsum("ij->j", f.bb.oo)
    r1_bb -= einsum("ia,iajk->k", t1.aa, v.aabb.ovoo)
    r1_bb += einsum("ijab,iakb->j", t2.abab, v.aabb.ovov) * -1
    r1_bb -= einsum("ia,jb,iakb->j", t1.aa, t1.bb, v.aabb.ovov)

    r2_aaaaaa = np.zeros((nocc[0],  nocc[0],  nvir[0]), dtype=np.float64)
    r2_aaaaaa += einsum("ij,ka,lmkb->jma", delta_oo.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa += einsum("ij,ka,lbkm->mja", delta_oo.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ij,ka,lbkm->jma", delta_oo.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ij,ka,lmkb->mja", delta_oo.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ij,ka,lbkm->jma", delta_oo.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa -= einsum("ij,ka,lmkb->mja", delta_oo.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ij,ka,lmkb->jma", delta_oo.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ij,ka,lbkm->mja", delta_oo.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ij,kl,ma,mb->ljb", delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    r2_aaaaaa -= einsum("ij,kl,ma,mb->jlb", delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    r2_aaaaaa += einsum("ij,klab,mcka->jlb", delta_oo.aa, t2.baba, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,klab,mcka->ljb", delta_oo.aa, t2.baba, v.aabb.ovov)
    r2_aaaaaa -= einsum("ij,klab,mcka->ljb", delta_oo.aa, t2.baba, v.aabb.ovov)
    r2_aaaaaa -= einsum("ij,klab,mcka->jlb", delta_oo.aa, t2.baba, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,kl,ma,bcma->jlb", delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_aaaaaa += einsum("ij,ab,kc,lmkc->mja", delta_oo.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    r2_aaaaaa += einsum("ij,ab,kc,lmkc->jma", delta_oo.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    r2_aaaaaa -= einsum("ij,ab,kc,lmkc->jma", delta_oo.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    r2_aaaaaa -= einsum("ij,kl,ma,bcma->ljb", delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_aaaaaa -= einsum("ij,ab,kc,lmkc->mja", delta_oo.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    r2_aaaaaa += einsum("ij,kl,mnab,mcnb->lja", delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,kl,mnab,mcnb->jla", delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ij,kl,ma,nb,mcnb->lja", delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,kl,ma,nb,mcnb->jla", delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ijab,kblc->ija", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ijab,kcla->ijb", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ijab,kclb->ija", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ijab,kalc->ijb", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ka,lbca->jkc", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa += einsum("ij,ka,labc->kjb", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa += einsum("ij,ka,labc->jkb", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa += einsum("ij,ka,lbca->kjc", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa += einsum("ab,ic,jckl->ila", delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ab,ic,jklc->kia", delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ij,ka,labc->jkb", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa -= einsum("ij,ka,lbca->kjc", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa -= einsum("ij,ka,lbca->jkc", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa -= einsum("ij,ka,labc->kjb", delta_oo.aa, t1.aa, v.aaaa.ovvv)
    r2_aaaaaa -= einsum("ab,ic,jklc->ika", delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ab,ic,jckl->lia", delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ij,ab,kc,lc->lja", delta_oo.aa, delta_vv.aa, f.aa.ov, t1.aa)
    r2_aaaaaa += einsum("ij,ab,kc,lc->jla", delta_oo.aa, delta_vv.aa, f.aa.ov, t1.aa)
    r2_aaaaaa -= einsum("ij,ab,kc,lc->jla", delta_oo.aa, delta_vv.aa, f.aa.ov, t1.aa)
    r2_aaaaaa -= einsum("ij,ab,kc,lc->lja", delta_oo.aa, delta_vv.aa, f.aa.ov, t1.aa)
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->lja", delta_oo.aa, delta_vv.aa, t2.baba, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->jla", delta_oo.aa, delta_vv.aa, t2.baba, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->jla", delta_oo.aa, delta_vv.aa, t2.baba, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->lja", delta_oo.aa, delta_vv.aa, t2.baba, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,kc,ld,mcld->kja", delta_oo.aa, delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.aa, delta_vv.aa, t1.bb, t1.aa, v.aabb.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.aa, delta_vv.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,kc,ld,mcld->kja", delta_oo.aa, delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ij,kabl->jlb", delta_oo.aa, v.aaaa.ovvo)
    r2_aaaaaa += einsum("ij,klab->lja", delta_oo.aa, v.aaaa.oovv)
    r2_aaaaaa += einsum("ij,klab->jla", delta_oo.aa, v.aaaa.oovv)
    r2_aaaaaa += einsum("ij,kabl->ljb", delta_oo.aa, v.aaaa.ovvo)
    r2_aaaaaa += einsum("ab,ijkl->jla", delta_vv.aa, v.aaaa.oooo)
    r2_aaaaaa -= einsum("ij,klab->jla", delta_oo.aa, v.aaaa.oovv)
    r2_aaaaaa -= einsum("ij,kabl->ljb", delta_oo.aa, v.aaaa.ovvo)
    r2_aaaaaa -= einsum("ij,kabl->jlb", delta_oo.aa, v.aaaa.ovvo)
    r2_aaaaaa -= einsum("ij,klab->lja", delta_oo.aa, v.aaaa.oovv)
    r2_aaaaaa -= einsum("ab,ijkl->lja", delta_vv.aa, v.aaaa.oooo)
    r2_aaaaaa += einsum("ij,kl,ab->jla", delta_oo.aa, delta_oo.aa, f.aa.vv)
    r2_aaaaaa += einsum("ij,ab,kl->lja", delta_oo.aa, delta_vv.aa, f.aa.oo)
    r2_aaaaaa += einsum("ij,ab,kl->jla", delta_oo.aa, delta_vv.aa, f.aa.oo)
    r2_aaaaaa -= einsum("ij,ab,kl->jla", delta_oo.aa, delta_vv.aa, f.aa.oo)
    r2_aaaaaa -= einsum("ij,kl,ab->lja", delta_oo.aa, delta_oo.aa, f.aa.vv)
    r2_aaaaaa -= einsum("ij,ab,kl->lja", delta_oo.aa, delta_vv.aa, f.aa.oo)
    r2_aaaaaa += einsum("ij,ab,klcd,mckd->jla", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->lja", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->jla", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,klcd,mckd->lja", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->jla", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,klcd,mckd->lja", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,klcd,mckd->jla", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,klcd,mdkc->lja", delta_oo.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,kc,ld,mckd->jla", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,ld,mdkc->lja", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,ld,mckd->lja", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,kc,ld,mckd->lja", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,kc,ld,mckd->jla", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ab,kc,ld,mdkc->lja", delta_oo.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,klab,mbkc->jla", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,mcka->jlb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,mckb->lja", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,makc->ljb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,mckb->jla", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,makc->jlb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,mbkc->lja", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,mcka->ljb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,mckb->jla", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,makc->jlb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,mbkc->lja", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,mcka->ljb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,mbkc->jla", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,mcka->jlb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,mckb->lja", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,klab,makc->ljb", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,kl,ma,bcma->jlb", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ij,ab,kc,lckm->jma", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ij,ka,lb,mbkc->jla", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,kl,ma,bamc->ljb", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ij,ab,kc,lmkc->mja", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa += einsum("ij,ka,lb,mckb->lja", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,lmkc->jma", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa += einsum("ij,ka,lb,mckb->jla", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ab,kc,lckm->mja", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ij,ka,lb,mbkc->lja", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,kl,ma,bamc->jlb", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ij,ab,kc,lmkc->jma", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ij,ka,lb,mckb->jla", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,kl,ma,bcma->ljb", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ij,ab,kc,lckm->mja", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa -= einsum("ij,ka,lb,mbkc->lja", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,ab,kc,lckm->jma", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa -= einsum("ij,ka,lb,mbkc->jla", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ij,ab,kc,lmkc->mja", delta_oo.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ij,ka,lb,mckb->lja", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,kl,mnab,ncmb->jla", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,kl,mnab,mcnb->lja", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,kl,mnab,mcnb->jla", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,kl,mnab,ncmb->lja", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,kl,ma,nb,ncmb->jla", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,kl,ma,nb,mcnb->lja", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,kl,ma,nb,mcnb->jla", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,kl,ma,nb,ncmb->lja", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ijcd,kcld->ija", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,kdlc->ija", delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ic,jd,kcld->ija", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ic,jd,kdlc->ija", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_babbab = np.zeros((nocc[1],  nocc[0],  nvir[1]), dtype=np.float64)
    r2_babbab += einsum("ij,kl,mnab,ncmb->kia", delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ij,kl,mnab,mcnb->kia", delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ij,kl,ma,nb,ncmb->kia", delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab += einsum("ij,kl,ma,nb,mcnb->kia", delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ij,klab,kcmb->ila", delta_oo.bb, t2.baba, v.bbaa.ovov)
    r2_babbab += einsum("ij,ka,lb,kcmb->ila", delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    r2_babbab += einsum("ab,ij,klcd,kdmc->lia", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ab,ij,klcd,kcmd->lia", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ab,ij,kc,ld,kdmc->lia", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab += einsum("ab,ij,kc,ld,kcmd->lia", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ab,ic,jklc->ika", delta_vv.bb, t1.bb, v.aabb.ooov)
    r2_babbab += einsum("ij,ka,balc->kib", delta_oo.aa, t1.bb, v.bbbb.vvov)
    r2_babbab -= einsum("ij,ka,bcla->kib", delta_oo.aa, t1.bb, v.bbbb.vvov)
    r2_babbab -= einsum("ab,ij,kc,lc->lia", delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    r2_babbab += einsum("ij,klab,kcmb->lia", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ij,klab,kamc->lib", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab -= einsum("ij,klab,kbmc->lia", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab -= einsum("ij,klab,kcma->lib", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ab,ij,kc,klmc->lia", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    r2_babbab += einsum("ij,kl,ma,bcma->kib", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_babbab += einsum("ij,ka,lb,kcmb->lia", delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab -= einsum("ab,ij,kc,kclm->mia", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    r2_babbab -= einsum("ab,ij,kc,kclm->ima", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    r2_babbab -= einsum("ij,kl,ma,bamc->kib", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_babbab -= einsum("ij,ka,lb,kbmc->lia", delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab += einsum("ij,kl,mnab,mcnb->kia", delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    r2_babbab -= einsum("ij,kl,ma,nb,ncma->kib", delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    r2_babbab += einsum("ab,ijkl->lja", delta_vv.bb, v.aabb.oooo)
    r2_babbab += einsum("ij,aklb->kia", delta_oo.aa, v.bbbb.voov)
    r2_babbab -= einsum("ij,abkl->lia", delta_oo.aa, v.bbbb.vvoo)
    r2_babbab -= einsum("ij,abkl->ila", delta_oo.bb, v.bbaa.vvoo)
    r2_babbab += einsum("ij,kl,ab->kia", delta_oo.aa, delta_oo.bb, f.bb.vv)
    r2_babbab -= einsum("ab,ij,kl->lia", delta_vv.bb, delta_oo.aa, f.bb.oo)
    r2_babbab -= einsum("ab,ij,kl->ila", delta_vv.bb, delta_oo.bb, f.aa.oo)
    r2_babbab += einsum("ab,ij,klcd,kcmd->ila", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    r2_babbab -= einsum("ab,ij,kc,ld,kcmd->ila", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    r2_babbab += einsum("ab,ij,klcd,kdmc->ila", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_babbab += einsum("ab,ij,klcd,kcmd->ila", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    r2_babbab += einsum("ab,ij,kc,ld,kdmc->ila", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_babbab += einsum("ab,ij,kc,ld,kcmd->ila", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_babbab += einsum("ab,ij,klcd,kcmd->lia", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    r2_babbab -= einsum("ab,ij,kc,ld,kcmd->lia", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    r2_babbab += einsum("ij,klab,kamc->lib", delta_oo.aa, t2.abab, v.aabb.ovov)
    r2_babbab += einsum("ab,ij,kc,klmc->ila", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    r2_babbab += einsum("ij,kl,ma,bcma->kib", delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_babbab -= einsum("ab,ij,kc,kclm->mia", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    r2_babbab -= einsum("ab,ij,kc,kclm->ima", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    r2_babbab -= einsum("ijab,kalc->jib", t2.abab, v.aabb.ovov)
    r2_babbab += einsum("ab,ic,jckl->lia", delta_vv.bb, t1.aa, v.aabb.ovoo)
    r2_babbab -= einsum("ij,ka,bcla->ikb", delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_babbab -= einsum("ab,ij,kc,lc->ila", delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    r2_babbab += einsum("ij,ka,kblm->mia", delta_oo.aa, t1.bb, v.bbbb.ovoo)
    r2_babbab += einsum("ij,ka,kblm->ima", delta_oo.bb, t1.bb, v.bbaa.ovoo)
    r2_babbab -= einsum("ij,ka,klmb->lia", delta_oo.aa, t1.bb, v.bbbb.ooov)
    r2_babbab -= einsum("ij,kl,ma,mb->kib", delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    r2_babbab += einsum("ab,ijcd,kcld->jia", delta_vv.bb, t2.abab, v.aabb.ovov)
    r2_babbab += einsum("ab,ic,jd,kcld->jia", delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    r2_abaaba = np.zeros((nocc[0],  nocc[1],  nvir[0]), dtype=np.float64)
    r2_abaaba += einsum("ij,kl,mnab,ncmb->ika", delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ij,kl,mnab,mcnb->ika", delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ij,kl,ma,nb,ncmb->ika", delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba += einsum("ij,kl,ma,nb,mcnb->ika", delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ij,klab,kcmb->ila", delta_oo.aa, t2.abab, v.aabb.ovov)
    r2_abaaba += einsum("ij,ka,lb,kcmb->ila", delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    r2_abaaba += einsum("ab,ic,jckl->ila", delta_vv.aa, t1.aa, v.aabb.ovoo)
    r2_abaaba += einsum("ij,ka,balc->kib", delta_oo.bb, t1.aa, v.aaaa.vvov)
    r2_abaaba -= einsum("ij,ka,bcla->kib", delta_oo.bb, t1.aa, v.aaaa.vvov)
    r2_abaaba -= einsum("ab,ij,kc,lc->lia", delta_vv.aa, delta_oo.bb, f.aa.ov, t1.aa)
    r2_abaaba += einsum("ab,ij,klcd,kcmd->ila", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    r2_abaaba -= einsum("ab,ij,kc,ld,kcmd->ila", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    r2_abaaba += einsum("ab,ij,klcd,kcmd->lia", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    r2_abaaba -= einsum("ab,ij,kc,ld,kcmd->lia", delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    r2_abaaba += einsum("ab,ijkl->jla", delta_vv.aa, v.aabb.oooo)
    r2_abaaba += einsum("ij,aklb->kia", delta_oo.bb, v.aaaa.voov)
    r2_abaaba -= einsum("ij,abkl->ila", delta_oo.aa, v.aabb.vvoo)
    r2_abaaba -= einsum("ij,abkl->lia", delta_oo.bb, v.aaaa.vvoo)
    r2_abaaba += einsum("ij,kl,ab->ika", delta_oo.aa, delta_oo.bb, f.aa.vv)
    r2_abaaba -= einsum("ab,ij,kl->ila", delta_vv.aa, delta_oo.aa, f.bb.oo)
    r2_abaaba -= einsum("ab,ij,kl->lia", delta_vv.aa, delta_oo.bb, f.aa.oo)
    r2_abaaba += einsum("ij,klab,kcmb->lia", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ij,klab,kamc->lib", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba -= einsum("ij,klab,kbmc->lia", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba -= einsum("ij,klab,kcma->lib", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,ij,kc,klmc->lia", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    r2_abaaba += einsum("ij,kl,ma,bcma->ikb", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    r2_abaaba += einsum("ij,ka,lb,kcmb->lia", delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba -= einsum("ab,ij,kc,kclm->ima", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    r2_abaaba -= einsum("ab,ij,kc,kclm->mia", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    r2_abaaba -= einsum("ij,kl,ma,bamc->ikb", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    r2_abaaba -= einsum("ij,ka,lb,kbmc->lia", delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba += einsum("ij,klab,kamc->lib", delta_oo.bb, t2.baba, v.bbaa.ovov)
    r2_abaaba += einsum("ab,ij,kc,klmc->ila", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    r2_abaaba += einsum("ij,kl,ma,bcma->ikb", delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    r2_abaaba -= einsum("ab,ij,kc,kclm->ima", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    r2_abaaba -= einsum("ab,ij,kc,kclm->mia", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    r2_abaaba += einsum("ij,kl,mnab,mcnb->ika", delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    r2_abaaba -= einsum("ij,kl,ma,nb,mcnb->ika", delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    r2_abaaba += einsum("ab,ij,klcd,kdmc->lia", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,ij,klcd,kcmd->lia", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ab,ij,kc,ld,kdmc->lia", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,ij,kc,ld,kcmd->lia", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ij,ka,kblm->ima", delta_oo.aa, t1.aa, v.aabb.ovoo)
    r2_abaaba += einsum("ij,ka,kblm->mia", delta_oo.bb, t1.aa, v.aaaa.ovoo)
    r2_abaaba -= einsum("ij,ka,klmb->lia", delta_oo.bb, t1.aa, v.aaaa.ooov)
    r2_abaaba -= einsum("ij,kl,ma,mb->ikb", delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    r2_abaaba += einsum("ab,ijcd,kcld->ija", delta_vv.aa, t2.abab, v.aabb.ovov)
    r2_abaaba += einsum("ab,ic,jd,kcld->ija", delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov)
    r2_abaaba += einsum("ab,ij,klcd,kdmc->ila", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    r2_abaaba += einsum("ab,ij,klcd,kcmd->ila", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    r2_abaaba += einsum("ab,ij,kc,ld,kdmc->ila", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    r2_abaaba += einsum("ab,ij,kc,ld,kcmd->ila", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_abaaba -= einsum("ijab,kclb->ija", t2.abab, v.aabb.ovov)
    r2_abaaba += einsum("ab,ic,jklc->kia", delta_vv.aa, t1.bb, v.aabb.ooov)
    r2_abaaba -= einsum("ij,ka,bcla->ikb", delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_abaaba -= einsum("ab,ij,kc,lc->ila", delta_vv.aa, delta_oo.aa, f.bb.ov, t1.bb)
    r2_bbbbbb = np.zeros((nocc[1],  nocc[1],  nvir[1]), dtype=np.float64)
    r2_bbbbbb += einsum("ij,ab,klcd,mckd->jla", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->lja", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->jla", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,klcd,mckd->lja", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->jla", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,klcd,mckd->lja", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,klcd,mckd->jla", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->lja", delta_oo.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,kc,ld,mckd->jla", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->lja", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,ld,mckd->lja", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,kc,ld,mckd->lja", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,kc,ld,mckd->jla", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->lja", delta_oo.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ijab,kblc->ija", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ijab,kcla->ijb", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ijab,kclb->ija", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ijab,kalc->ijb", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ka,lbca->jkc", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb += einsum("ij,ka,labc->kjb", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb += einsum("ij,ka,labc->jkb", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb += einsum("ij,ka,lbca->kjc", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb += einsum("ab,ic,jckl->ila", delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ab,ic,jklc->kia", delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ij,ka,labc->jkb", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb -= einsum("ij,ka,lbca->kjc", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb -= einsum("ij,ka,lbca->jkc", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb -= einsum("ij,ka,labc->kjb", delta_oo.bb, t1.bb, v.bbbb.ovvv)
    r2_bbbbbb -= einsum("ab,ic,jklc->ika", delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ab,ic,jckl->lia", delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ij,ab,kc,lc->lja", delta_oo.bb, delta_vv.bb, f.bb.ov, t1.bb)
    r2_bbbbbb += einsum("ij,ab,kc,lc->jla", delta_oo.bb, delta_vv.bb, f.bb.ov, t1.bb)
    r2_bbbbbb -= einsum("ij,ab,kc,lc->jla", delta_oo.bb, delta_vv.bb, f.bb.ov, t1.bb)
    r2_bbbbbb -= einsum("ij,ab,kc,lc->lja", delta_oo.bb, delta_vv.bb, f.bb.ov, t1.bb)
    r2_bbbbbb += einsum("ij,kabl->jlb", delta_oo.bb, v.bbbb.ovvo)
    r2_bbbbbb += einsum("ij,klab->lja", delta_oo.bb, v.bbbb.oovv)
    r2_bbbbbb += einsum("ij,klab->jla", delta_oo.bb, v.bbbb.oovv)
    r2_bbbbbb += einsum("ij,kabl->ljb", delta_oo.bb, v.bbbb.ovvo)
    r2_bbbbbb += einsum("ab,ijkl->jla", delta_vv.bb, v.bbbb.oooo)
    r2_bbbbbb -= einsum("ij,klab->jla", delta_oo.bb, v.bbbb.oovv)
    r2_bbbbbb -= einsum("ij,kabl->ljb", delta_oo.bb, v.bbbb.ovvo)
    r2_bbbbbb -= einsum("ij,kabl->jlb", delta_oo.bb, v.bbbb.ovvo)
    r2_bbbbbb -= einsum("ij,klab->lja", delta_oo.bb, v.bbbb.oovv)
    r2_bbbbbb -= einsum("ab,ijkl->lja", delta_vv.bb, v.bbbb.oooo)
    r2_bbbbbb += einsum("ij,kl,ab->jla", delta_oo.bb, delta_oo.bb, f.bb.vv)
    r2_bbbbbb += einsum("ij,ab,kl->lja", delta_oo.bb, delta_vv.bb, f.bb.oo)
    r2_bbbbbb += einsum("ij,ab,kl->jla", delta_oo.bb, delta_vv.bb, f.bb.oo)
    r2_bbbbbb -= einsum("ij,ab,kl->jla", delta_oo.bb, delta_vv.bb, f.bb.oo)
    r2_bbbbbb -= einsum("ij,kl,ab->lja", delta_oo.bb, delta_oo.bb, f.bb.vv)
    r2_bbbbbb -= einsum("ij,ab,kl->lja", delta_oo.bb, delta_vv.bb, f.bb.oo)
    r2_bbbbbb += einsum("ij,klab,mbkc->jla", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,mcka->jlb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,mckb->lja", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,makc->ljb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,mckb->jla", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,makc->jlb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,mbkc->lja", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,mcka->ljb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,mckb->jla", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,makc->jlb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,mbkc->lja", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,mcka->ljb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,mbkc->jla", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,mcka->jlb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,mckb->lja", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,klab,makc->ljb", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,kl,ma,bcma->jlb", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ij,ab,kc,lckm->jma", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ij,ka,lb,mbkc->jla", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,kl,ma,bamc->ljb", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ij,ab,kc,lmkc->mja", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb += einsum("ij,ka,lb,mckb->lja", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,lmkc->jma", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb += einsum("ij,ka,lb,mckb->jla", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,lckm->mja", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ij,ka,lb,mbkc->lja", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,kl,ma,bamc->jlb", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ij,ab,kc,lmkc->jma", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ij,ka,lb,mckb->jla", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,kl,ma,bcma->ljb", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ij,ab,kc,lckm->mja", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb -= einsum("ij,ka,lb,mbkc->lja", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,ab,kc,lckm->jma", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb -= einsum("ij,ka,lb,mbkc->jla", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ij,ab,kc,lmkc->mja", delta_oo.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ij,ka,lb,mckb->lja", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->lja", delta_oo.bb, delta_vv.bb, t2.abab, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->jla", delta_oo.bb, delta_vv.bb, t2.abab, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->jla", delta_oo.bb, delta_vv.bb, t2.abab, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,klcd,mdkc->lja", delta_oo.bb, delta_vv.bb, t2.abab, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->lja", delta_oo.bb, delta_vv.bb, t1.aa, t1.bb, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.bb, delta_vv.bb, t1.aa, t1.bb, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->jla", delta_oo.bb, delta_vv.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ij,ab,kc,ld,mdkc->lja", delta_oo.bb, delta_vv.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ij,ka,lmkb->jma", delta_oo.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb += einsum("ij,ka,lbkm->mja", delta_oo.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ij,ka,lbkm->jma", delta_oo.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ij,ka,lmkb->mja", delta_oo.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ij,ka,lbkm->jma", delta_oo.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb -= einsum("ij,ka,lmkb->mja", delta_oo.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ij,ka,lmkb->jma", delta_oo.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ij,ka,lbkm->mja", delta_oo.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ij,kl,ma,mb->ljb", delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    r2_bbbbbb -= einsum("ij,kl,ma,mb->jlb", delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    r2_bbbbbb += einsum("ij,kl,mnab,ncmb->jla", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,kl,mnab,mcnb->lja", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,kl,mnab,mcnb->jla", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,kl,mnab,ncmb->lja", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,kl,ma,nb,ncmb->jla", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,kl,ma,nb,mcnb->lja", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,kl,ma,nb,mcnb->jla", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,kl,ma,nb,ncmb->lja", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ijcd,kcld->ija", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,kdlc->ija", delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ic,jd,kcld->ija", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ic,jd,kdlc->ija", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,kl,mnab,mcnb->lja", delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,kl,mnab,mcnb->jla", delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ij,kl,ma,nb,mcnb->lja", delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,kl,ma,nb,mcnb->jla", delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ij,klab,mcka->jlb", delta_oo.bb, t2.abab, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,klab,mcka->ljb", delta_oo.bb, t2.abab, v.bbaa.ovov)
    r2_bbbbbb -= einsum("ij,klab,mcka->ljb", delta_oo.bb, t2.abab, v.bbaa.ovov)
    r2_bbbbbb -= einsum("ij,klab,mcka->jlb", delta_oo.bb, t2.abab, v.bbaa.ovov)
    r2_bbbbbb += einsum("ij,kl,ma,bcma->jlb", delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_bbbbbb += einsum("ij,ab,kc,lmkc->mja", delta_oo.bb, delta_vv.bb, t1.aa, v.bbaa.ooov)
    r2_bbbbbb += einsum("ij,ab,kc,lmkc->jma", delta_oo.bb, delta_vv.bb, t1.aa, v.bbaa.ooov)
    r2_bbbbbb -= einsum("ij,ab,kc,lmkc->jma", delta_oo.bb, delta_vv.bb, t1.aa, v.bbaa.ooov)
    r2_bbbbbb -= einsum("ij,kl,ma,bcma->ljb", delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_bbbbbb -= einsum("ij,ab,kc,lmkc->mja", delta_oo.bb, delta_vv.bb, t1.aa, v.bbaa.ooov)
    r2_aaabab = np.zeros((nocc[0],  nocc[0],  nvir[0]), dtype=np.float64)
    r2_aaabab += einsum("ij,klab,kbmc->jla", delta_oo.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab += einsum("ij,klab,kamc->ljb", delta_oo.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab -= einsum("ij,klab,kamc->jlb", delta_oo.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab -= einsum("ij,klab,kbmc->lja", delta_oo.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab += einsum("ij,ka,lb,kbmc->jla", delta_oo.aa, t1.aa, t1.aa, v.aabb.ovov)
    r2_aaabab -= einsum("ij,ka,lb,kbmc->lja", delta_oo.aa, t1.aa, t1.aa, v.aabb.ovov)
    r2_aaabab += einsum("ijab,kalc->ijb", t2.aaaa, v.aabb.ovov)
    r2_aaabab -= einsum("ijab,kblc->ija", t2.aaaa, v.aabb.ovov)
    r2_aaabab += einsum("ij,ka,balc->kjb", delta_oo.aa, t1.aa, v.aabb.vvov)
    r2_aaabab -= einsum("ij,ka,balc->jkb", delta_oo.aa, t1.aa, v.aabb.vvov)
    r2_aaabab += einsum("ij,aklb->kja", delta_oo.aa, v.aabb.voov)
    r2_aaabab -= einsum("ij,aklb->jka", delta_oo.aa, v.aabb.voov)
    r2_aaabab += einsum("ij,ka,klmb->jla", delta_oo.aa, t1.aa, v.aabb.ooov)
    r2_aaabab -= einsum("ij,ka,klmb->lja", delta_oo.aa, t1.aa, v.aabb.ooov)
    r2_aaabab += einsum("ij,klab,kcma->jlb", delta_oo.aa, t2.baba, v.bbbb.ovov)
    r2_aaabab += einsum("ij,klab,kamc->ljb", delta_oo.aa, t2.baba, v.bbbb.ovov)
    r2_aaabab -= einsum("ij,klab,kamc->jlb", delta_oo.aa, t2.baba, v.bbbb.ovov)
    r2_aaabab -= einsum("ij,klab,kcma->ljb", delta_oo.aa, t2.baba, v.bbbb.ovov)
    r2_babaaa = np.zeros((nocc[1],  nocc[0],  nvir[1]), dtype=np.float64)
    r2_babaaa += einsum("ij,ka,balc->kjb", delta_oo.aa, t1.bb, v.bbaa.vvov)
    r2_babaaa -= einsum("ij,ka,lbca->kic", delta_oo.aa, t1.bb, v.aabb.ovvv)
    r2_babaaa += einsum("ij,klab,kamc->ljb", delta_oo.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa += einsum("ij,klab,makc->lib", delta_oo.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa -= einsum("ij,klab,kcma->ljb", delta_oo.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa -= einsum("ij,klab,mcka->lib", delta_oo.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa += einsum("ijab,kcla->jib", t2.abab, v.aaaa.ovov)
    r2_babaaa -= einsum("ijab,kalc->jib", t2.abab, v.aaaa.ovov)
    r2_babaaa += einsum("ij,aklb->kja", delta_oo.aa, v.bbaa.voov)
    r2_babaaa -= einsum("ij,kabl->lib", delta_oo.aa, v.aabb.ovvo)
    r2_babaaa += einsum("ij,ka,lbkm->mia", delta_oo.aa, t1.bb, v.aabb.ovoo)
    r2_babaaa -= einsum("ij,ka,klmb->lja", delta_oo.aa, t1.bb, v.bbaa.ooov)
    r2_babaaa += einsum("ij,klab,kamc->ljb", delta_oo.aa, t2.bbbb, v.bbaa.ovov)
    r2_babaaa += einsum("ij,klab,mckb->lia", delta_oo.aa, t2.bbbb, v.aabb.ovov)
    r2_babaaa -= einsum("ij,klab,kbmc->lja", delta_oo.aa, t2.bbbb, v.bbaa.ovov)
    r2_babaaa -= einsum("ij,klab,mcka->lib", delta_oo.aa, t2.bbbb, v.aabb.ovov)
    r2_babaaa += einsum("ij,ka,lb,mcla->kib", delta_oo.aa, t1.bb, t1.bb, v.aabb.ovov)
    r2_babaaa -= einsum("ij,ka,lb,lamc->kjb", delta_oo.aa, t1.bb, t1.bb, v.bbaa.ovov)
    r2_ababbb = np.zeros((nocc[0],  nocc[1],  nvir[0]), dtype=np.float64)
    r2_ababbb += einsum("ijab,kclb->ija", t2.abab, v.bbbb.ovov)
    r2_ababbb -= einsum("ijab,kblc->ija", t2.abab, v.bbbb.ovov)
    r2_ababbb += einsum("ij,ka,lbkm->mia", delta_oo.bb, t1.aa, v.bbaa.ovoo)
    r2_ababbb -= einsum("ij,ka,klmb->lja", delta_oo.bb, t1.aa, v.aabb.ooov)
    r2_ababbb += einsum("ij,ka,balc->kjb", delta_oo.bb, t1.aa, v.aabb.vvov)
    r2_ababbb -= einsum("ij,ka,lbca->kic", delta_oo.bb, t1.aa, v.bbaa.ovvv)
    r2_ababbb += einsum("ij,aklb->kja", delta_oo.bb, v.aabb.voov)
    r2_ababbb -= einsum("ij,kabl->lib", delta_oo.bb, v.bbaa.ovvo)
    r2_ababbb += einsum("ij,klab,kamc->ljb", delta_oo.bb, t2.baba, v.bbbb.ovov)
    r2_ababbb += einsum("ij,klab,makc->lib", delta_oo.bb, t2.baba, v.bbbb.ovov)
    r2_ababbb -= einsum("ij,klab,kcma->ljb", delta_oo.bb, t2.baba, v.bbbb.ovov)
    r2_ababbb -= einsum("ij,klab,mcka->lib", delta_oo.bb, t2.baba, v.bbbb.ovov)
    r2_ababbb += einsum("ij,klab,kamc->ljb", delta_oo.bb, t2.aaaa, v.aabb.ovov)
    r2_ababbb += einsum("ij,klab,mckb->lia", delta_oo.bb, t2.aaaa, v.bbaa.ovov)
    r2_ababbb -= einsum("ij,klab,kbmc->lja", delta_oo.bb, t2.aaaa, v.aabb.ovov)
    r2_ababbb -= einsum("ij,klab,mcka->lib", delta_oo.bb, t2.aaaa, v.bbaa.ovov)
    r2_ababbb += einsum("ij,ka,lb,mcla->kib", delta_oo.bb, t1.aa, t1.aa, v.bbaa.ovov)
    r2_ababbb -= einsum("ij,ka,lb,lamc->kjb", delta_oo.bb, t1.aa, t1.aa, v.aabb.ovov)
    r2_bbbaba = np.zeros((nocc[1],  nocc[1],  nvir[1]), dtype=np.float64)
    r2_bbbaba += einsum("ijab,kalc->ijb", t2.bbbb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ijab,kblc->ija", t2.bbbb, v.bbaa.ovov)
    r2_bbbaba += einsum("ij,ka,balc->kjb", delta_oo.bb, t1.bb, v.bbaa.vvov)
    r2_bbbaba -= einsum("ij,ka,balc->jkb", delta_oo.bb, t1.bb, v.bbaa.vvov)
    r2_bbbaba += einsum("ij,aklb->kja", delta_oo.bb, v.bbaa.voov)
    r2_bbbaba -= einsum("ij,aklb->jka", delta_oo.bb, v.bbaa.voov)
    r2_bbbaba += einsum("ij,klab,kbmc->jla", delta_oo.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba += einsum("ij,klab,kamc->ljb", delta_oo.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ij,klab,kamc->jlb", delta_oo.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ij,klab,kbmc->lja", delta_oo.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba += einsum("ij,ka,lb,kbmc->jla", delta_oo.bb, t1.bb, t1.bb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ij,ka,lb,kbmc->lja", delta_oo.bb, t1.bb, t1.bb, v.bbaa.ovov)
    r2_bbbaba += einsum("ij,ka,klmb->jla", delta_oo.bb, t1.bb, v.bbaa.ooov)
    r2_bbbaba -= einsum("ij,ka,klmb->lja", delta_oo.bb, t1.bb, v.bbaa.ooov)
    r2_bbbaba += einsum("ij,klab,kcma->jlb", delta_oo.bb, t2.abab, v.aaaa.ovov)
    r2_bbbaba += einsum("ij,klab,kamc->ljb", delta_oo.bb, t2.abab, v.aaaa.ovov)
    r2_bbbaba -= einsum("ij,klab,kamc->jlb", delta_oo.bb, t2.abab, v.aaaa.ovov)
    r2_bbbaba -= einsum("ij,klab,kcma->ljb", delta_oo.bb, t2.abab, v.aaaa.ovov)

    r1 = SimpleNamespace(a=r1_aa, b=r1_bb)
    r2 = SimpleNamespace(aaa=r2_aaaaaa, aba=r2_abaaba, bab=r2_babbab, bbb=r2_bbbbbb)

    return r1, r2

def hbar_diag_ea(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    r1_aa = np.zeros((nvir[0]), dtype=np.float64)
    r1_aa -= einsum("ia,ib->b", f.aa.ov, t1.aa)
    r1_aa += einsum("ijab,icjb->a", t2.abab, v.aabb.ovov) * -1
    r1_aa -= einsum("ia,jb,icjb->a", t1.aa, t1.bb, v.aabb.ovov)
    r1_aa += einsum("ijab,jcib->a", t2.aaaa, v.aaaa.ovov)
    r1_aa += einsum("ijab,icjb->a", t2.aaaa, v.aaaa.ovov) * -1
    r1_aa += einsum("ia,jb,jcib->a", t1.aa, t1.aa, v.aaaa.ovov)
    r1_aa += einsum("ia,jb,icjb->a", t1.aa, t1.aa, v.aaaa.ovov) * -1
    r1_aa += einsum("ab->a", f.aa.vv)
    r1_aa += einsum("ia,bcia->b", t1.bb, v.aabb.vvov)
    r1_aa += einsum("ia,bcia->b", t1.aa, v.aaaa.vvov)
    r1_aa -= einsum("ia,baic->b", t1.aa, v.aaaa.vvov)
    r1_bb = np.zeros((nvir[1]), dtype=np.float64)
    r1_bb += einsum("ijab,jcib->a", t2.bbbb, v.bbbb.ovov)
    r1_bb += einsum("ijab,icjb->a", t2.bbbb, v.bbbb.ovov) * -1
    r1_bb += einsum("ia,jb,jcib->a", t1.bb, t1.bb, v.bbbb.ovov)
    r1_bb += einsum("ia,jb,icjb->a", t1.bb, t1.bb, v.bbbb.ovov) * -1
    r1_bb -= einsum("ia,ib->b", f.bb.ov, t1.bb)
    r1_bb += einsum("ia,bcia->b", t1.bb, v.bbbb.vvov)
    r1_bb -= einsum("ia,baic->b", t1.bb, v.bbbb.vvov)
    r1_bb += einsum("ab->a", f.bb.vv)
    r1_bb += einsum("ia,bcia->b", t1.aa, v.bbaa.vvov)
    r1_bb += einsum("ijab,icjb->a", t2.baba, v.bbaa.ovov) * -1
    r1_bb -= einsum("ia,jb,jcia->b", t1.aa, t1.bb, v.bbaa.ovov)

    r2_aaaaaa = np.zeros((nvir[0],  nvir[0],  nocc[0]), dtype=np.float64)
    r2_aaaaaa += einsum("ab,cd,ijef,iekf->daj", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ijef,ifke->daj", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ijef,ifke->daj", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,cd,ijef,iekf->daj", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,cd,ie,jf,jfke->dai", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ie,jf,jekf->dai", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ie,jf,jekf->dai", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,cd,ie,jf,jfke->dai", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,klcd,keld->cai", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    r2_aaaaaa += einsum("ab,ij,klcd,keld->bci", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    r2_aaaaaa += einsum("ab,ij,klcd,keld->cai", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,klcd,keld->bci", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekc->dai", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekc->bdi", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekc->dai", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekc->bdi", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    r2_aaaaaa += einsum("ab,ic,dejc->dai", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ic,dcje->dai", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ic,dcje->bdi", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ic,dejc->bdi", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,dcje->dai", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,dejc->dai", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,dejc->bdi", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,dcje->bdi", delta_vv.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,cd,ie,je->daj", delta_vv.aa, delta_vv.aa, f.aa.ov, t1.aa)
    r2_aaaaaa -= einsum("ab,cd,ie,je->daj", delta_vv.aa, delta_vv.aa, f.aa.ov, t1.aa)
    r2_aaaaaa += einsum("ab,ijcd,icke->daj", delta_vv.aa, t2.baba, v.bbaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,icke->bdj", delta_vv.aa, t2.baba, v.bbaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,icke->daj", delta_vv.aa, t2.baba, v.bbaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,icke->bdj", delta_vv.aa, t2.baba, v.bbaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ie,iejk->dak", delta_vv.aa, delta_vv.aa, t1.bb, v.bbaa.ovoo)
    r2_aaaaaa += einsum("ab,ij,kc,dekc->dai", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_aaaaaa += einsum("ab,ij,kc,dekc->bdi", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_aaaaaa -= einsum("ab,ij,kc,dekc->dai", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_aaaaaa -= einsum("ab,cd,ie,iejk->dak", delta_vv.aa, delta_vv.aa, t1.bb, v.bbaa.ovoo)
    r2_aaaaaa -= einsum("ab,ij,kc,dekc->bdi", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_aaaaaa += einsum("ab,ijcd,iekc->daj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,idke->caj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,icke->daj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,iekd->caj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,iekd->bcj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,icke->bdj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,idke->bcj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ijcd,iekc->bdj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,icke->daj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,iekd->caj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,iekc->daj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,idke->caj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,idke->bcj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,iekc->bdj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,iekd->bcj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ijcd,icke->bdj", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ie,iejk->dak", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ab,ij,kc,dcke->dai", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ic,jd,jcke->dai", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ie,ijke->daj", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa += einsum("ab,ij,kc,dekc->dai", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ic,jd,jekc->dai", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,dekc->bdi", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ic,jd,jekc->bdi", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,dcke->bdi", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ic,jd,jcke->bdi", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,cd,ie,ijke->daj", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ab,ij,kc,dekc->dai", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,jd,jekc->dai", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,cd,ie,iejk->dak", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa -= einsum("ab,ij,kc,dcke->dai", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,jd,jcke->dai", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ij,kc,dcke->bdi", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,jd,jcke->bdi", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ab,ij,kc,dekc->bdi", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,jd,jekc->bdi", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,klcd,keld->cai", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,klcd,lekd->cai", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,klcd,lekd->bci", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,klcd,keld->bci", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,klcd,lekd->cai", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,klcd,keld->cai", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,klcd,keld->bci", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,klcd,lekd->bci", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,kc,ld,keld->cai", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekd->cai", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekd->bci", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,ld,keld->bci", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekd->cai", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,kc,ld,keld->cai", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,kc,ld,keld->bci", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ab,ij,kc,ld,lekd->bci", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ijab,ickd->baj", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ijab,ickd->abj", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ijab,ickd->baj", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa -= einsum("ijab,ickd->abj", t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ab,ic,ijkd->caj", delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa += einsum("ab,ic,idjk->cak", delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ab,ic,idjk->bck", delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa += einsum("ab,ic,ijkd->bcj", delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa += einsum("ij,ka,bckd->bai", delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ij,ka,bckd->abi", delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ab,ic,idjk->cak", delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa -= einsum("ab,ic,ijkd->caj", delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ab,ic,ijkd->bcj", delta_vv.aa, t1.aa, v.aaaa.ooov)
    r2_aaaaaa -= einsum("ab,ic,idjk->bck", delta_vv.aa, t1.aa, v.aaaa.ovoo)
    r2_aaaaaa -= einsum("ij,ka,bckd->bai", delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa -= einsum("ij,ka,bckd->abi", delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_aaaaaa += einsum("ab,ij,kc,kd->dai", delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    r2_aaaaaa += einsum("ab,ij,kc,kd->bdi", delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    r2_aaaaaa -= einsum("ab,ij,kc,kd->dai", delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    r2_aaaaaa -= einsum("ab,ij,kc,kd->bdi", delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    r2_aaaaaa += einsum("ab,cd,ijef,iekf->daj", delta_vv.aa, delta_vv.aa, t2.baba, v.bbaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ijef,iekf->daj", delta_vv.aa, delta_vv.aa, t2.baba, v.bbaa.ovov) * -1
    r2_aaaaaa += einsum("ab,cd,ie,jf,jfke->dai", delta_vv.aa, delta_vv.aa, t1.aa, t1.bb, v.bbaa.ovov)
    r2_aaaaaa += einsum("ab,cd,ie,jf,jfke->dai", delta_vv.aa, delta_vv.aa, t1.aa, t1.bb, v.bbaa.ovov) * -1
    r2_aaaaaa += einsum("ab,cdij->caj", delta_vv.aa, v.aaaa.vvoo)
    r2_aaaaaa += einsum("ab,cijd->cai", delta_vv.aa, v.aaaa.voov)
    r2_aaaaaa += einsum("ab,cijd->bci", delta_vv.aa, v.aaaa.voov)
    r2_aaaaaa += einsum("ab,cdij->bcj", delta_vv.aa, v.aaaa.vvoo)
    r2_aaaaaa += einsum("ij,abcd->cai", delta_oo.aa, v.aaaa.vvvv)
    r2_aaaaaa -= einsum("ab,cijd->cai", delta_vv.aa, v.aaaa.voov)
    r2_aaaaaa -= einsum("ab,cdij->caj", delta_vv.aa, v.aaaa.vvoo)
    r2_aaaaaa -= einsum("ab,cdij->bcj", delta_vv.aa, v.aaaa.vvoo)
    r2_aaaaaa -= einsum("ab,cijd->bci", delta_vv.aa, v.aaaa.voov)
    r2_aaaaaa -= einsum("ij,abcd->cai", delta_oo.aa, v.aaaa.vvvv)
    r2_aaaaaa += einsum("ab,cd,ij->daj", delta_vv.aa, delta_vv.aa, f.aa.oo)
    r2_aaaaaa += einsum("ab,ij,cd->cai", delta_vv.aa, delta_oo.aa, f.aa.vv)
    r2_aaaaaa += einsum("ab,ij,cd->bci", delta_vv.aa, delta_oo.aa, f.aa.vv)
    r2_aaaaaa -= einsum("ab,ij,cd->cai", delta_vv.aa, delta_oo.aa, f.aa.vv)
    r2_aaaaaa -= einsum("ab,cd,ij->daj", delta_vv.aa, delta_vv.aa, f.aa.oo)
    r2_aaaaaa -= einsum("ab,ij,cd->bci", delta_vv.aa, delta_oo.aa, f.aa.vv)
    r2_aaaaaa += einsum("ij,klab,lckd->bai", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,klab,kcld->bai", delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_aaaaaa += einsum("ij,ka,lb,lckd->bai", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_aaaaaa += einsum("ij,ka,lb,kcld->bai", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_babbab = np.zeros((nvir[1],  nvir[0],  nocc[1]), dtype=np.float64)
    r2_babbab += einsum("ab,ic,idjk->cbk", delta_vv.aa, t1.bb, v.bbbb.ovoo)
    r2_babbab -= einsum("ab,ic,ijkd->cbj", delta_vv.aa, t1.bb, v.bbbb.ooov)
    r2_babbab -= einsum("ij,ka,bckd->abi", delta_oo.bb, t1.bb, v.aabb.vvov)
    r2_babbab -= einsum("ab,ij,kc,kd->dbi", delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    r2_babbab += einsum("ij,klab,kcld->bai", delta_oo.bb, t2.abab, v.aabb.ovov)
    r2_babbab += einsum("ij,ka,lb,kcld->bai", delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    r2_babbab += einsum("ab,ij,klcd,lekd->cbi", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ab,ij,klcd,keld->cbi", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ab,ij,kc,ld,lekd->cbi", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab += einsum("ab,ij,kc,ld,keld->cbi", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ab,ijcd,icke->dbj", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ab,ijcd,iekd->cbj", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab -= einsum("ab,ijcd,iekc->dbj", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab -= einsum("ab,ijcd,idke->cbj", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ab,cd,ie,ijke->dbj", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_babbab += einsum("ab,ij,kc,dekc->dbi", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_babbab += einsum("ab,ic,jd,jekc->dbi", delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab += einsum("ab,ij,kc,dekc->bdi", delta_vv.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    r2_babbab -= einsum("ab,cd,ie,iejk->dbk", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_babbab -= einsum("ab,ij,kc,dcke->dbi", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_babbab -= einsum("ab,ic,jd,jcke->dbi", delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab += einsum("ab,cd,ijef,ifke->dbj", delta_vv.aa, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_babbab += einsum("ab,cd,ijef,iekf->dbj", delta_vv.aa, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ab,cd,ie,jf,jekf->dbi", delta_vv.aa, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_babbab += einsum("ab,cd,ie,jf,jfke->dbi", delta_vv.aa, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_babbab += einsum("ab,cd,ijef,iekf->dbj", delta_vv.aa, delta_vv.bb, t2.abab, v.aabb.ovov) * -1
    r2_babbab -= einsum("ab,cd,ie,jf,iekf->dbj", delta_vv.aa, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    r2_babbab += einsum("ab,ij,klcd,lekd->bci", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    r2_babbab += einsum("ab,ij,klcd,keld->bci", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    r2_babbab += einsum("ab,ij,kc,ld,lekd->bci", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_babbab += einsum("ab,ij,kc,ld,keld->bci", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_babbab += einsum("ab,ijcd,icke->dbj", delta_vv.aa, t2.abab, v.aabb.ovov)
    r2_babbab += einsum("ab,ij,kc,dekc->dbi", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_babbab += einsum("ab,ij,kc,dekc->bdi", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    r2_babbab -= einsum("ab,cd,ie,iejk->dbk", delta_vv.aa, delta_vv.bb, t1.aa, v.aabb.ovoo)
    r2_babbab -= einsum("ab,ij,kc,dcke->bdi", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    r2_babbab += einsum("ab,ijcd,iekd->bcj", delta_vv.bb, t2.abab, v.aabb.ovov)
    r2_babbab += einsum("ab,ic,jd,iekd->bcj", delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    r2_babbab += einsum("ab,ij,klcd,keld->bci", delta_vv.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    r2_babbab -= einsum("ab,ij,kc,ld,keld->bci", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    r2_babbab += einsum("ab,cijd->cbi", delta_vv.aa, v.bbbb.voov)
    r2_babbab += einsum("ij,abcd->cai", delta_oo.bb, v.aabb.vvvv)
    r2_babbab -= einsum("ab,cdij->cbj", delta_vv.aa, v.bbbb.vvoo)
    r2_babbab -= einsum("ab,cdij->bcj", delta_vv.bb, v.aabb.vvoo)
    r2_babbab += einsum("ab,ij,cd->cbi", delta_vv.aa, delta_oo.bb, f.bb.vv)
    r2_babbab += einsum("ab,ij,cd->bci", delta_vv.bb, delta_oo.bb, f.aa.vv)
    r2_babbab -= einsum("ab,cd,ij->dbj", delta_vv.aa, delta_vv.bb, f.bb.oo)
    r2_babbab -= einsum("ijab,ickd->baj", t2.abab, v.aabb.ovov)
    r2_babbab += einsum("ab,ic,idjk->bck", delta_vv.bb, t1.aa, v.aabb.ovoo)
    r2_babbab -= einsum("ij,ka,bckd->bai", delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_babbab -= einsum("ab,ij,kc,kd->bdi", delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    r2_babbab += einsum("ab,ic,dcje->dbi", delta_vv.aa, t1.bb, v.bbbb.vvov)
    r2_babbab -= einsum("ab,ic,dejc->dbi", delta_vv.aa, t1.bb, v.bbbb.vvov)
    r2_babbab -= einsum("ab,ic,dejc->bdi", delta_vv.bb, t1.bb, v.aabb.vvov)
    r2_babbab -= einsum("ab,cd,ie,je->dbj", delta_vv.aa, delta_vv.bb, f.bb.ov, t1.bb)
    r2_babbab += einsum("ab,ij,klcd,keld->cbi", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    r2_babbab -= einsum("ab,ij,kc,ld,lekc->dbi", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    r2_abaaba = np.zeros((nvir[0],  nvir[1],  nocc[0]), dtype=np.float64)
    r2_abaaba += einsum("ij,klab,kcld->abi", delta_oo.aa, t2.abab, v.aabb.ovov)
    r2_abaaba += einsum("ij,ka,lb,lckd->bai", delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    r2_abaaba += einsum("ab,ijcd,icke->dbj", delta_vv.bb, t2.baba, v.bbaa.ovov)
    r2_abaaba += einsum("ab,ij,kc,dekc->bdi", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    r2_abaaba += einsum("ab,ij,kc,dekc->dbi", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_abaaba -= einsum("ab,cd,ie,iejk->bdk", delta_vv.aa, delta_vv.bb, t1.bb, v.bbaa.ovoo)
    r2_abaaba -= einsum("ab,ij,kc,dcke->bdi", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    r2_abaaba += einsum("ab,ij,klcd,keld->bci", delta_vv.aa, delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    r2_abaaba -= einsum("ab,ij,kc,ld,keld->bci", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.bbaa.ovov)
    r2_abaaba += einsum("ab,ic,dcje->dbi", delta_vv.bb, t1.aa, v.aaaa.vvov)
    r2_abaaba -= einsum("ab,ic,dejc->bdi", delta_vv.aa, t1.aa, v.bbaa.vvov)
    r2_abaaba -= einsum("ab,ic,dejc->dbi", delta_vv.bb, t1.aa, v.aaaa.vvov)
    r2_abaaba -= einsum("ab,cd,ie,je->bdj", delta_vv.aa, delta_vv.bb, f.aa.ov, t1.aa)
    r2_abaaba += einsum("ab,ic,idjk->cbk", delta_vv.bb, t1.aa, v.aaaa.ovoo)
    r2_abaaba -= einsum("ab,ic,ijkd->cbj", delta_vv.bb, t1.aa, v.aaaa.ooov)
    r2_abaaba -= einsum("ij,ka,bckd->abi", delta_oo.aa, t1.aa, v.bbaa.vvov)
    r2_abaaba -= einsum("ab,ij,kc,kd->dbi", delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    r2_abaaba += einsum("ab,ijcd,icke->dbj", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,ijcd,iekd->cbj", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba -= einsum("ab,ijcd,iekc->dbj", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba -= einsum("ab,ijcd,idke->cbj", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,cd,ie,ijke->bdj", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ooov)
    r2_abaaba += einsum("ab,ij,kc,dekc->bdi", delta_vv.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    r2_abaaba += einsum("ab,ij,kc,dekc->dbi", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_abaaba += einsum("ab,ic,jd,jekc->dbi", delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba -= einsum("ab,cd,ie,iejk->bdk", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    r2_abaaba -= einsum("ab,ij,kc,dcke->dbi", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.vvov)
    r2_abaaba -= einsum("ab,ic,jd,jcke->dbi", delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,cd,ijef,ifke->bdj", delta_vv.aa, delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,cd,ijef,iekf->bdj", delta_vv.aa, delta_vv.bb, t2.aaaa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ab,cd,ie,jf,jekf->bdi", delta_vv.aa, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,cd,ie,jf,jfke->bdi", delta_vv.aa, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ab,ij,klcd,lekd->cbi", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,ij,klcd,keld->cbi", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ab,ij,kc,ld,lekd->cbi", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    r2_abaaba += einsum("ab,ij,kc,ld,keld->cbi", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    r2_abaaba += einsum("ab,cijd->cbi", delta_vv.bb, v.aaaa.voov)
    r2_abaaba += einsum("ij,abcd->aci", delta_oo.aa, v.aabb.vvvv)
    r2_abaaba -= einsum("ab,cdij->bcj", delta_vv.aa, v.bbaa.vvoo)
    r2_abaaba -= einsum("ab,cdij->cbj", delta_vv.bb, v.aaaa.vvoo)
    r2_abaaba += einsum("ab,ij,cd->bci", delta_vv.aa, delta_oo.aa, f.bb.vv)
    r2_abaaba += einsum("ab,ij,cd->cbi", delta_vv.bb, delta_oo.aa, f.aa.vv)
    r2_abaaba -= einsum("ab,cd,ij->bdj", delta_vv.aa, delta_vv.bb, f.aa.oo)
    r2_abaaba += einsum("ab,ij,klcd,keld->cbi", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    r2_abaaba -= einsum("ab,ij,kc,ld,lekc->dbi", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    r2_abaaba += einsum("ab,ijcd,iekd->bcj", delta_vv.aa, t2.baba, v.bbaa.ovov)
    r2_abaaba += einsum("ab,ic,jd,jekc->bdi", delta_vv.aa, t1.aa, t1.bb, v.bbaa.ovov)
    r2_abaaba += einsum("ab,cd,ijef,iekf->bdj", delta_vv.aa, delta_vv.bb, t2.baba, v.bbaa.ovov) * -1
    r2_abaaba -= einsum("ab,cd,ie,jf,jfke->bdi", delta_vv.aa, delta_vv.bb, t1.aa, t1.bb, v.bbaa.ovov)
    r2_abaaba += einsum("ab,ij,klcd,lekd->bci", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    r2_abaaba += einsum("ab,ij,klcd,keld->bci", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    r2_abaaba += einsum("ab,ij,kc,ld,lekd->bci", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    r2_abaaba += einsum("ab,ij,kc,ld,keld->bci", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_abaaba -= einsum("ijab,ickd->baj", t2.baba, v.bbaa.ovov)
    r2_abaaba += einsum("ab,ic,idjk->bck", delta_vv.aa, t1.bb, v.bbaa.ovoo)
    r2_abaaba -= einsum("ij,ka,bckd->bai", delta_oo.aa, t1.bb, v.aabb.vvov)
    r2_abaaba -= einsum("ab,ij,kc,kd->bdi", delta_vv.aa, delta_oo.aa, f.bb.ov, t1.bb)
    r2_bbbbbb = np.zeros((nvir[1],  nvir[1],  nocc[1]), dtype=np.float64)
    r2_bbbbbb += einsum("ijab,ickd->baj", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ijab,ickd->abj", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ijab,ickd->baj", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ijab,ickd->abj", t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ic,ijkd->caj", delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb += einsum("ab,ic,idjk->cak", delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ab,ic,idjk->bck", delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ab,ic,ijkd->bcj", delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb += einsum("ij,ka,bckd->bai", delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ij,ka,bckd->abi", delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,idjk->cak", delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb -= einsum("ab,ic,ijkd->caj", delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ab,ic,ijkd->bcj", delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ab,ic,idjk->bck", delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb -= einsum("ij,ka,bckd->bai", delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ij,ka,bckd->abi", delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ij,kc,kd->dai", delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    r2_bbbbbb += einsum("ab,ij,kc,kd->bdi", delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    r2_bbbbbb -= einsum("ab,ij,kc,kd->dai", delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    r2_bbbbbb -= einsum("ab,ij,kc,kd->bdi", delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    r2_bbbbbb += einsum("ab,cd,ijef,iekf->daj", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,cd,ijef,ifke->daj", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,cd,ijef,ifke->daj", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,cd,ijef,iekf->daj", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,cd,ie,jf,jfke->dai", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,cd,ie,jf,jekf->dai", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,cd,ie,jf,jekf->dai", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,cd,ie,jf,jfke->dai", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,klab,lckd->bai", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,klab,kcld->bai", delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ij,ka,lb,lckd->bai", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ij,ka,lb,kcld->bai", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ic,dejc->dai", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ic,dcje->dai", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ic,dcje->bdi", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ic,dejc->bdi", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,dcje->dai", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,dejc->dai", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,dejc->bdi", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,dcje->bdi", delta_vv.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,cd,ie,je->daj", delta_vv.bb, delta_vv.bb, f.bb.ov, t1.bb)
    r2_bbbbbb -= einsum("ab,cd,ie,je->daj", delta_vv.bb, delta_vv.bb, f.bb.ov, t1.bb)
    r2_bbbbbb += einsum("ab,ij,klcd,keld->cai", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,klcd,lekd->cai", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,klcd,lekd->bci", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,klcd,keld->bci", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,klcd,lekd->cai", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,klcd,keld->cai", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,klcd,keld->bci", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,klcd,lekd->bci", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,kc,ld,keld->cai", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekd->cai", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekd->bci", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,ld,keld->bci", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekd->cai", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,kc,ld,keld->cai", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,kc,ld,keld->bci", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekd->bci", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    r2_bbbbbb += einsum("ab,cdij->caj", delta_vv.bb, v.bbbb.vvoo)
    r2_bbbbbb += einsum("ab,cijd->cai", delta_vv.bb, v.bbbb.voov)
    r2_bbbbbb += einsum("ab,cijd->bci", delta_vv.bb, v.bbbb.voov)
    r2_bbbbbb += einsum("ab,cdij->bcj", delta_vv.bb, v.bbbb.vvoo)
    r2_bbbbbb += einsum("ij,abcd->cai", delta_oo.bb, v.bbbb.vvvv)
    r2_bbbbbb -= einsum("ab,cijd->cai", delta_vv.bb, v.bbbb.voov)
    r2_bbbbbb -= einsum("ab,cdij->caj", delta_vv.bb, v.bbbb.vvoo)
    r2_bbbbbb -= einsum("ab,cdij->bcj", delta_vv.bb, v.bbbb.vvoo)
    r2_bbbbbb -= einsum("ab,cijd->bci", delta_vv.bb, v.bbbb.voov)
    r2_bbbbbb -= einsum("ij,abcd->cai", delta_oo.bb, v.bbbb.vvvv)
    r2_bbbbbb += einsum("ab,cd,ij->daj", delta_vv.bb, delta_vv.bb, f.bb.oo)
    r2_bbbbbb += einsum("ab,ij,cd->cai", delta_vv.bb, delta_oo.bb, f.bb.vv)
    r2_bbbbbb += einsum("ab,ij,cd->bci", delta_vv.bb, delta_oo.bb, f.bb.vv)
    r2_bbbbbb -= einsum("ab,ij,cd->cai", delta_vv.bb, delta_oo.bb, f.bb.vv)
    r2_bbbbbb -= einsum("ab,cd,ij->daj", delta_vv.bb, delta_vv.bb, f.bb.oo)
    r2_bbbbbb -= einsum("ab,ij,cd->bci", delta_vv.bb, delta_oo.bb, f.bb.vv)
    r2_bbbbbb += einsum("ab,ij,klcd,keld->cai", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    r2_bbbbbb += einsum("ab,ij,klcd,keld->bci", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    r2_bbbbbb += einsum("ab,ij,klcd,keld->cai", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,klcd,keld->bci", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekc->dai", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekc->bdi", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekc->dai", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ab,ij,kc,ld,lekc->bdi", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    r2_bbbbbb += einsum("ab,ijcd,iekc->daj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,idke->caj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,icke->daj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,iekd->caj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,iekd->bcj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,icke->bdj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,idke->bcj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,iekc->bdj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,icke->daj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,iekd->caj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,iekc->daj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,idke->caj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,idke->bcj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,iekc->bdj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,iekd->bcj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,icke->bdj", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,cd,ie,iejk->dak", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb += einsum("ab,ij,kc,dcke->dai", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ic,jd,jcke->dai", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,cd,ie,ijke->daj", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb += einsum("ab,ij,kc,dekc->dai", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ic,jd,jekc->dai", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,dekc->bdi", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ic,jd,jekc->bdi", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,ij,kc,dcke->bdi", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb += einsum("ab,ic,jd,jcke->bdi", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,cd,ie,ijke->daj", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    r2_bbbbbb -= einsum("ab,ij,kc,dekc->dai", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,jd,jekc->dai", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,cd,ie,iejk->dak", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    r2_bbbbbb -= einsum("ab,ij,kc,dcke->dai", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,jd,jcke->dai", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ij,kc,dcke->bdi", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,jd,jcke->bdi", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb -= einsum("ab,ij,kc,dekc->bdi", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    r2_bbbbbb -= einsum("ab,ic,jd,jekc->bdi", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    r2_bbbbbb += einsum("ab,cd,ijef,iekf->daj", delta_vv.bb, delta_vv.bb, t2.abab, v.aabb.ovov)
    r2_bbbbbb += einsum("ab,cd,ijef,iekf->daj", delta_vv.bb, delta_vv.bb, t2.abab, v.aabb.ovov) * -1
    r2_bbbbbb += einsum("ab,cd,ie,jf,iekf->daj", delta_vv.bb, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    r2_bbbbbb += einsum("ab,cd,ie,jf,iekf->daj", delta_vv.bb, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov) * -1
    r2_bbbbbb += einsum("ab,ijcd,icke->daj", delta_vv.bb, t2.abab, v.aabb.ovov)
    r2_bbbbbb += einsum("ab,ijcd,icke->bdj", delta_vv.bb, t2.abab, v.aabb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,icke->daj", delta_vv.bb, t2.abab, v.aabb.ovov)
    r2_bbbbbb -= einsum("ab,ijcd,icke->bdj", delta_vv.bb, t2.abab, v.aabb.ovov)
    r2_bbbbbb += einsum("ab,cd,ie,iejk->dak", delta_vv.bb, delta_vv.bb, t1.aa, v.aabb.ovoo)
    r2_bbbbbb += einsum("ab,ij,kc,dekc->dai", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_bbbbbb += einsum("ab,ij,kc,dekc->bdi", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_bbbbbb -= einsum("ab,ij,kc,dekc->dai", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_bbbbbb -= einsum("ab,cd,ie,iejk->dak", delta_vv.bb, delta_vv.bb, t1.aa, v.aabb.ovoo)
    r2_bbbbbb -= einsum("ab,ij,kc,dekc->bdi", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    r2_aaabab = np.zeros((nvir[0],  nvir[0],  nocc[0]), dtype=np.float64)
    r2_aaabab += einsum("ab,ijcd,icke->daj", delta_vv.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab += einsum("ab,ijcd,idke->bcj", delta_vv.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab -= einsum("ab,ijcd,idke->caj", delta_vv.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab -= einsum("ab,ijcd,icke->bdj", delta_vv.aa, t2.aaaa, v.aabb.ovov)
    r2_aaabab += einsum("ab,ic,jd,jcke->bdi", delta_vv.aa, t1.aa, t1.aa, v.aabb.ovov)
    r2_aaabab -= einsum("ab,ic,jd,jcke->dai", delta_vv.aa, t1.aa, t1.aa, v.aabb.ovov)
    r2_aaabab += einsum("ab,ic,dcje->dai", delta_vv.aa, t1.aa, v.aabb.vvov)
    r2_aaabab -= einsum("ab,ic,dcje->bdi", delta_vv.aa, t1.aa, v.aabb.vvov)
    r2_aaabab += einsum("ab,ijcd,icke->daj", delta_vv.aa, t2.baba, v.bbbb.ovov)
    r2_aaabab += einsum("ab,ijcd,iekc->bdj", delta_vv.aa, t2.baba, v.bbbb.ovov)
    r2_aaabab -= einsum("ab,ijcd,iekc->daj", delta_vv.aa, t2.baba, v.bbbb.ovov)
    r2_aaabab -= einsum("ab,ijcd,icke->bdj", delta_vv.aa, t2.baba, v.bbbb.ovov)
    r2_aaabab += einsum("ab,cijd->cai", delta_vv.aa, v.aabb.voov)
    r2_aaabab -= einsum("ab,cijd->bci", delta_vv.aa, v.aabb.voov)
    r2_aaabab += einsum("ijab,ickd->abj", t2.aaaa, v.aabb.ovov)
    r2_aaabab -= einsum("ijab,ickd->baj", t2.aaaa, v.aabb.ovov)
    r2_aaabab += einsum("ab,ic,ijkd->bcj", delta_vv.aa, t1.aa, v.aabb.ooov)
    r2_aaabab -= einsum("ab,ic,ijkd->caj", delta_vv.aa, t1.aa, v.aabb.ooov)
    r2_babaaa = np.zeros((nvir[1],  nvir[0],  nocc[1]), dtype=np.float64)
    r2_babaaa += einsum("ab,ijcd,iekc->dbj", delta_vv.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa += einsum("ab,ijcd,icke->dbj", delta_vv.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa -= einsum("ab,ijcd,icke->dbj", delta_vv.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa -= einsum("ab,ijcd,iekc->dbj", delta_vv.aa, t2.abab, v.aaaa.ovov)
    r2_babaaa += einsum("ab,ijcd,idke->cbj", delta_vv.aa, t2.bbbb, v.bbaa.ovov)
    r2_babaaa += einsum("ab,ijcd,icke->dbj", delta_vv.aa, t2.bbbb, v.bbaa.ovov)
    r2_babaaa -= einsum("ab,ijcd,icke->dbj", delta_vv.aa, t2.bbbb, v.bbaa.ovov)
    r2_babaaa -= einsum("ab,ijcd,idke->cbj", delta_vv.aa, t2.bbbb, v.bbaa.ovov)
    r2_babaaa += einsum("ab,ic,jd,jcke->dbi", delta_vv.aa, t1.bb, t1.bb, v.bbaa.ovov)
    r2_babaaa -= einsum("ab,ic,jd,jcke->dbi", delta_vv.aa, t1.bb, t1.bb, v.bbaa.ovov)
    r2_babaaa += einsum("ab,ic,ijkd->cbj", delta_vv.aa, t1.bb, v.bbaa.ooov)
    r2_babaaa -= einsum("ab,ic,ijkd->cbj", delta_vv.aa, t1.bb, v.bbaa.ooov)
    r2_babaaa += einsum("ab,ic,dcje->dbi", delta_vv.aa, t1.bb, v.bbaa.vvov)
    r2_babaaa -= einsum("ab,ic,dcje->dbi", delta_vv.aa, t1.bb, v.bbaa.vvov)
    r2_babaaa += einsum("ab,cijd->cbi", delta_vv.aa, v.bbaa.voov)
    r2_babaaa -= einsum("ab,cijd->cbi", delta_vv.aa, v.bbaa.voov)
    r2_babaaa += einsum("ijab,ickd->baj", t2.abab, v.aaaa.ovov)
    r2_babaaa -= einsum("ijab,ickd->baj", t2.abab, v.aaaa.ovov)
    r2_ababbb = np.zeros((nvir[0],  nvir[1],  nocc[0]), dtype=np.float64)
    r2_ababbb += einsum("ab,ijcd,idke->cbj", delta_vv.bb, t2.aaaa, v.aabb.ovov)
    r2_ababbb += einsum("ab,ijcd,icke->dbj", delta_vv.bb, t2.aaaa, v.aabb.ovov)
    r2_ababbb -= einsum("ab,ijcd,icke->dbj", delta_vv.bb, t2.aaaa, v.aabb.ovov)
    r2_ababbb -= einsum("ab,ijcd,idke->cbj", delta_vv.bb, t2.aaaa, v.aabb.ovov)
    r2_ababbb += einsum("ab,ic,jd,jcke->dbi", delta_vv.bb, t1.aa, t1.aa, v.aabb.ovov)
    r2_ababbb -= einsum("ab,ic,jd,jcke->dbi", delta_vv.bb, t1.aa, t1.aa, v.aabb.ovov)
    r2_ababbb += einsum("ijab,ickd->baj", t2.baba, v.bbbb.ovov)
    r2_ababbb -= einsum("ijab,ickd->baj", t2.baba, v.bbbb.ovov)
    r2_ababbb += einsum("ab,cijd->cbi", delta_vv.bb, v.aabb.voov)
    r2_ababbb -= einsum("ab,cijd->cbi", delta_vv.bb, v.aabb.voov)
    r2_ababbb += einsum("ab,ic,ijkd->cbj", delta_vv.bb, t1.aa, v.aabb.ooov)
    r2_ababbb -= einsum("ab,ic,ijkd->cbj", delta_vv.bb, t1.aa, v.aabb.ooov)
    r2_ababbb += einsum("ab,ic,dcje->dbi", delta_vv.bb, t1.aa, v.aabb.vvov)
    r2_ababbb -= einsum("ab,ic,dcje->dbi", delta_vv.bb, t1.aa, v.aabb.vvov)
    r2_ababbb += einsum("ab,ijcd,iekc->dbj", delta_vv.bb, t2.baba, v.bbbb.ovov)
    r2_ababbb += einsum("ab,ijcd,icke->dbj", delta_vv.bb, t2.baba, v.bbbb.ovov)
    r2_ababbb -= einsum("ab,ijcd,icke->dbj", delta_vv.bb, t2.baba, v.bbbb.ovov)
    r2_ababbb -= einsum("ab,ijcd,iekc->dbj", delta_vv.bb, t2.baba, v.bbbb.ovov)
    r2_bbbaba = np.zeros((nvir[1],  nvir[1],  nocc[1]), dtype=np.float64)
    r2_bbbaba += einsum("ab,ic,dcje->dai", delta_vv.bb, t1.bb, v.bbaa.vvov)
    r2_bbbaba -= einsum("ab,ic,dcje->bdi", delta_vv.bb, t1.bb, v.bbaa.vvov)
    r2_bbbaba += einsum("ab,ijcd,icke->daj", delta_vv.bb, t2.abab, v.aaaa.ovov)
    r2_bbbaba += einsum("ab,ijcd,iekc->bdj", delta_vv.bb, t2.abab, v.aaaa.ovov)
    r2_bbbaba -= einsum("ab,ijcd,iekc->daj", delta_vv.bb, t2.abab, v.aaaa.ovov)
    r2_bbbaba -= einsum("ab,ijcd,icke->bdj", delta_vv.bb, t2.abab, v.aaaa.ovov)
    r2_bbbaba += einsum("ijab,ickd->abj", t2.bbbb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ijab,ickd->baj", t2.bbbb, v.bbaa.ovov)
    r2_bbbaba += einsum("ab,ic,ijkd->bcj", delta_vv.bb, t1.bb, v.bbaa.ooov)
    r2_bbbaba -= einsum("ab,ic,ijkd->caj", delta_vv.bb, t1.bb, v.bbaa.ooov)
    r2_bbbaba += einsum("ab,cijd->cai", delta_vv.bb, v.bbaa.voov)
    r2_bbbaba -= einsum("ab,cijd->bci", delta_vv.bb, v.bbaa.voov)
    r2_bbbaba += einsum("ab,ijcd,icke->daj", delta_vv.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba += einsum("ab,ijcd,idke->bcj", delta_vv.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ab,ijcd,idke->caj", delta_vv.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ab,ijcd,icke->bdj", delta_vv.bb, t2.bbbb, v.bbaa.ovov)
    r2_bbbaba += einsum("ab,ic,jd,jcke->bdi", delta_vv.bb, t1.bb, t1.bb, v.bbaa.ovov)
    r2_bbbaba -= einsum("ab,ic,jd,jcke->dai", delta_vv.bb, t1.bb, t1.bb, v.bbaa.ovov)

    r1 = SimpleNamespace(a=r1_aa, b=r1_bb)
    r2 = SimpleNamespace(aaa=r2_aaaaaa, aba=r2_abaaba, bab=r2_babbab, bbb=r2_bbbbbb)

    r2.aaa *= -1
    r2.aba *= -1
    r2.bab *= -1
    r2.bbb *= -1

    return r1, r2

def hbar_matvec_ip(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, r1=None, r2=None, **kwargs):
    x0 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x0 += einsum("i,iajb->jab", r1.a, v.aabb.ovov)
    r1new_a = np.zeros((nocc[0]), dtype=np.float64)
    r1new_a += einsum("iab,jiab->j", x0, t2.abab) * -1
    del x0
    x1 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x1 += einsum("i,jaib->jab", r1.a, v.aaaa.ovov)
    x2 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x2 += einsum("iab->iab", x1)
    x2 += einsum("iab->iba", x1) * -1
    r1new_a += einsum("iab,ijab->j", x2, t2.aaaa) * -1
    del x2
    x92 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x92 += einsum("ia,jba->ijb", t1.aa, x1)
    del x1
    x93 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x93 += einsum("ija->ija", x92)
    del x92
    x3 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x3 += einsum("ija->ija", r2.aaa)
    x3 += einsum("i,ja->jia", r1.a, t1.aa) * -1
    x4 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x4 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x4 += einsum("ijka->kija", v.aaaa.ooov)
    x76 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x76 += einsum("ia,jika->jk", t1.aa, x4)
    x78 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x78 += einsum("ij->ij", x76) * -1
    x133 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x133 += einsum("ij->ij", x76) * -1
    del x76
    x171 = np.zeros((nocc[0], nocc[0], nocc[1]), dtype=np.float64)
    x171 += einsum("ija,kila->klj", r2.aba, x4) * -1
    r1new_a += einsum("ija,jika->k", x3, x4) * -1
    del x4
    x5 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x5 += einsum("ija->jia", r2.bab)
    x5 += einsum("i,ja->ija", r1.a, t1.bb) * -1
    x17 = np.zeros((nvir[0]), dtype=np.float64)
    x17 += einsum("ija,ibja->b", x5, v.aabb.ovov)
    x18 = np.zeros((nvir[0]), dtype=np.float64)
    x18 += einsum("a->a", x17) * -1
    del x17
    x116 = np.zeros((nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x116 += einsum("ija,ibjc->bac", x5, v.aabb.ovov)
    x117 = np.zeros((nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x117 += einsum("ija,ibka->kjb", x5, v.aabb.ovov) * -1
    x142 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x142 += einsum("ija,ibca->jbc", x5, v.aabb.ovvv) * -1
    r1new_a += einsum("ija,ikja->k", x5, v.aabb.ooov)
    r2new_bab = np.zeros((nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    r2new_bab += einsum("ija,ikba->jkb", x5, v.aabb.oovv) * -1
    del x5
    x6 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x6 += einsum("ia,jbia->jb", t1.bb, v.aabb.ovov)
    x9 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x9 += einsum("ia->ia", x6)
    del x6
    x7 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x7 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x7 += einsum("iajb->jiba", v.aaaa.ovov)
    x8 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x8 += einsum("ia,ijba->jb", t1.aa, x7)
    x9 += einsum("ia->ia", x8) * -1
    del x8
    x16 = np.zeros((nvir[0]), dtype=np.float64)
    x16 += einsum("ija,ijab->b", x3, x7)
    del x3
    x18 += einsum("a->a", x16) * -1
    del x16
    x160 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x160 += einsum("ija,ikba->kjb", r2.aba, x7)
    x161 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x161 += einsum("ija->ija", x160) * -1
    x180 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x180 += einsum("ija->ija", x160) * -1
    del x160
    x9 += einsum("ia->ia", f.aa.ov)
    x152 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x152 += einsum("ia,ijab->jb", x9, t2.abab)
    x156 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x156 += einsum("ia->ia", x152)
    x214 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x214 += einsum("ia->ia", x152)
    del x152
    r1new_b = np.zeros((nocc[1]), dtype=np.float64)
    r1new_b += einsum("ia,ija->j", x9, r2.aba) * -1
    x10 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x10 += einsum("ija->ija", r2.aaa) * -1
    x10 += einsum("ija->jia", r2.aaa)
    r1new_a += einsum("ia,jia->j", x9, x10) * -1
    x11 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x11 += einsum("ia,iajb->jb", t1.aa, v.aabb.ovov)
    x14 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x14 += einsum("ia->ia", x11)
    del x11
    x12 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x12 += einsum("iajb->jiab", v.bbbb.ovov)
    x12 += einsum("iajb->jiba", v.bbbb.ovov) * -1
    x13 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x13 += einsum("ia,ijab->jb", t1.bb, x12)
    x14 += einsum("ia->ia", x13) * -1
    del x13
    x44 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x44 += einsum("ija,ikab->jkb", r2.bab, x12)
    x45 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x45 += einsum("ija->ija", x44) * -1
    x113 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x113 += einsum("ija->ija", x44) * -1
    del x44
    x14 += einsum("ia->ia", f.bb.ov)
    x107 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x107 += einsum("ia,jiba->jb", x14, t2.abab)
    x111 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x111 += einsum("ia->ia", x107)
    x173 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x173 += einsum("ia->ia", x107)
    del x107
    r1new_a += einsum("ia,ija->j", x14, r2.bab) * -1
    x15 = np.zeros((nvir[0]), dtype=np.float64)
    x15 += einsum("i,ia->a", r1.a, f.aa.ov)
    x18 += einsum("a->a", x15)
    del x15
    x80 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x80 += einsum("a,ijab->ijb", x18, t2.aaaa)
    x112 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x112 += einsum("ija->jia", x80)
    del x80
    r1new_a += einsum("a,ia->i", x18, t1.aa) * -1
    r2new_bab += einsum("a,ijab->jib", x18, t2.abab)
    del x18
    x19 = np.zeros((nocc[0], nvir[0], nvir[1]), dtype=np.float64)
    x19 += einsum("i,jaib->jab", r1.b, v.aabb.ovov)
    r1new_b += einsum("iab,ijab->j", x19, t2.abab) * -1
    del x19
    x20 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x20 += einsum("i,jaib->jab", r1.b, v.bbbb.ovov)
    x21 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x21 += einsum("iab->iab", x20)
    x21 += einsum("iab->iba", x20) * -1
    r1new_b += einsum("iab,ijab->j", x21, t2.bbbb) * -1
    del x21
    x207 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x207 += einsum("ia,jba->ijb", t1.bb, x20)
    del x20
    x208 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x208 += einsum("ija->ija", x207)
    del x207
    x22 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x22 += einsum("ija->ija", r2.bbb)
    x22 += einsum("i,ja->jia", r1.b, t1.bb) * -1
    x23 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x23 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x23 += einsum("ijka->kija", v.bbbb.ooov)
    x138 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x138 += einsum("ia,jika->jk", t1.bb, x23)
    x140 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x140 += einsum("ij->ij", x138) * -1
    x194 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x194 += einsum("ij->ij", x138) * -1
    del x138
    x141 = np.zeros((nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x141 += einsum("ija,kila->jkl", r2.bab, x23) * -1
    r1new_b += einsum("ija,jika->k", x22, x23) * -1
    del x23
    x24 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x24 += einsum("ija->ija", r2.aba)
    x24 += einsum("i,ja->jia", r1.b, t1.aa) * -1
    x29 = np.zeros((nvir[1]), dtype=np.float64)
    x29 += einsum("ija,iajb->b", x24, v.aabb.ovov)
    x30 = np.zeros((nvir[1]), dtype=np.float64)
    x30 += einsum("a->a", x29) * -1
    del x29
    x167 = np.zeros((nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x167 += einsum("ija,ibjc->abc", x24, v.aabb.ovov)
    x168 = np.zeros((nocc[0], nocc[0], nvir[1]), dtype=np.float64)
    x168 += einsum("ija,kajb->kib", x24, v.aabb.ovov) * -1
    r1new_b += einsum("ija,iajk->k", x24, v.aabb.ovoo)
    del x24
    x25 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x25 += einsum("ija->ija", r2.bbb)
    x25 += einsum("ija->jia", r2.bbb) * -1
    r1new_b += einsum("ia,ija->j", x14, x25) * -1
    x26 = np.zeros((nvir[1]), dtype=np.float64)
    x26 += einsum("i,ia->a", r1.b, f.bb.ov)
    x30 += einsum("a->a", x26)
    del x26
    x27 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x27 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x27 += einsum("iajb->jiba", v.bbbb.ovov)
    x28 = np.zeros((nvir[1]), dtype=np.float64)
    x28 += einsum("ija,ijab->b", x22, x27)
    del x22
    x30 += einsum("a->a", x28) * -1
    del x28
    x196 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x196 += einsum("a,ijab->ijb", x30, t2.bbbb)
    x215 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x215 += einsum("ija->jia", x196)
    del x196
    r1new_b += einsum("a,ia->i", x30, t1.bb) * -1
    r2new_aba = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    r2new_aba += einsum("a,ijba->ijb", x30, t2.abab)
    del x30
    x31 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x31 += einsum("i,ijak->jka", r1.a, v.aaaa.oovo)
    x112 += einsum("ija->ija", x31) * -1
    del x31
    x32 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x32 += einsum("ij,ia->ja", f.aa.oo, t1.aa)
    x112 += einsum("i,ja->jia", r1.a, x32)
    del x32
    x33 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x33 += einsum("ija,iabk->jkb", r2.bab, v.bbaa.ovvo)
    x112 += einsum("ija->ija", x33) * -1
    del x33
    x34 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x34 += einsum("i,ijka->jka", r1.a, v.aabb.ooov)
    x35 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x35 += einsum("ija,kjba->kib", x34, t2.abab)
    x112 += einsum("ija->ija", x35)
    del x35
    x113 += einsum("ija->ija", x34)
    del x34
    x36 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x36 += einsum("ija,kbia->jkb", r2.bab, v.aabb.ovov)
    x40 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x40 += einsum("ija->ija", x36)
    x93 += einsum("ija->ija", x36)
    x94 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x94 += einsum("ia,jka->jki", t1.aa, x93)
    del x93
    x95 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x95 += einsum("ijk->jki", x94)
    del x94
    x115 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x115 += einsum("ija->jia", x36)
    del x36
    x37 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x37 += einsum("i,ja->ija", r1.a, t1.aa)
    x37 += einsum("ija->ija", r2.aaa)
    x37 += einsum("ija->jia", r2.aaa) * -1
    x43 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x43 += einsum("ija,iakb->jkb", x37, v.aabb.ovov)
    x45 += einsum("ija->ija", x43)
    x46 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x46 += einsum("ija,kjba->kib", x45, t2.abab)
    del x45
    x112 += einsum("ija->jia", x46) * -1
    del x46
    x113 += einsum("ija->ija", x43)
    del x43
    x115 += einsum("ija,ikab->kjb", x37, x7)
    x141 += einsum("ija,iakl->jkl", x37, v.aabb.ovoo)
    x38 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x38 += einsum("iajb->jiab", v.aaaa.ovov)
    x38 += einsum("iajb->jiba", v.aaaa.ovov) * -1
    x39 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x39 += einsum("ija,ikba->jkb", x37, x38)
    del x38
    x40 += einsum("ija->ija", x39)
    del x39
    x41 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x41 += einsum("ijab->jiab", t2.aaaa) * -1
    x41 += einsum("ijab->jiba", t2.aaaa)
    x42 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x42 += einsum("ija,jkba->ikb", x40, x41)
    del x40
    x112 += einsum("ija->ija", x42)
    del x42
    x106 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x106 += einsum("ia,ijba->jb", x9, x41)
    del x9
    del x41
    x111 += einsum("ia->ia", x106) * -1
    x173 += einsum("ia->ia", x106) * -1
    del x106
    x47 = np.zeros((nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x47 += einsum("i,iabc->bac", r1.a, v.aaaa.ovvv)
    x50 = np.zeros((nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x50 += einsum("abc->abc", x47) * -1
    x81 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x81 += einsum("ia,bac->ibc", t1.aa, x47)
    del x47
    x85 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x85 += einsum("iab->iab", x81)
    del x81
    x48 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x48 += einsum("ija->ija", r2.aaa)
    x48 += einsum("i,ja->ija", r1.a, t1.aa)
    x49 = np.zeros((nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x49 += einsum("ija,jbic->bca", x48, v.aaaa.ovov)
    del x48
    x50 += einsum("abc->cba", x49)
    del x49
    x51 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x51 += einsum("abc,ijcb->ija", x50, t2.aaaa)
    del x50
    x112 += einsum("ija->jia", x51)
    del x51
    x52 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x52 += einsum("iabj->ijba", v.aaaa.ovvo)
    x52 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x53 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x53 += einsum("ija,ikba->jkb", x37, x52)
    del x37
    x112 += einsum("ija->ija", x53) * -1
    del x53
    x109 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x109 += einsum("ia,ijba->jb", t1.aa, x52)
    del x52
    x111 += einsum("ia->ia", x109)
    x173 += einsum("ia->ia", x109)
    del x109
    x54 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x54 += einsum("ijka->ikja", v.aaaa.ooov)
    x54 += einsum("ijka->kija", v.aaaa.ooov) * -1
    x55 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x55 += einsum("i,jika->jka", r1.a, x54)
    del x54
    x115 += einsum("ija->ija", x55) * -1
    r2new_bab += einsum("ija,ikab->kjb", x115, t2.abab)
    del x115
    x56 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x56 += einsum("ia,jb->ijab", t1.aa, t1.aa)
    x56 += einsum("ijab->jiab", t2.aaaa) * -1
    x56 += einsum("ijab->jiba", t2.aaaa)
    x57 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x57 += einsum("ija,ikba->jkb", x55, x56) * -1
    del x55
    x112 += einsum("ija->jia", x57) * -1
    del x57
    x58 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x58 += einsum("ia,jbka->ijkb", t1.aa, v.aaaa.ovov)
    x59 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x59 += einsum("ia,jkla->jilk", t1.aa, x58)
    x61 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x61 += einsum("ijkl->lkji", x59)
    del x59
    x90 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x90 += einsum("ijka->jkia", x58)
    x90 += einsum("ijka->kjia", x58) * -1
    x100 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x100 += einsum("ijka->ijka", x58) * -1
    x100 += einsum("ijka->ikja", x58)
    del x58
    x60 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x60 += einsum("ia,jkla->ijlk", t1.aa, v.aaaa.ooov)
    x61 += einsum("ijkl->jkli", x60)
    x61 += einsum("ijkl->kjli", x60) * -1
    del x60
    x61 += einsum("ijkl->kilj", v.aaaa.oooo)
    x62 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x62 += einsum("ija,jikl->kla", r2.aaa, x61)
    del x61
    x112 += einsum("ija->jia", x62)
    del x62
    x63 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x63 += einsum("ia,ib->ab", f.aa.ov, t1.aa)
    x71 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x71 += einsum("ab->ba", x63)
    del x63
    x64 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x64 += einsum("ia,iabc->bc", t1.bb, v.bbaa.ovvv)
    x71 += einsum("ab->ab", x64) * -1
    del x64
    x65 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x65 += einsum("ijab->jiba", t2.aaaa)
    x65 += einsum("ia,jb->ijab", t1.aa, t1.aa)
    x66 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x66 += einsum("ijab,ijca->bc", x65, x7)
    x71 += einsum("ab->ab", x66) * -1
    del x66
    x75 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x75 += einsum("ijab,ikba->jk", x65, x7)
    del x7
    x78 += einsum("ij->ji", x75) * -1
    x133 += einsum("ij->ji", x75) * -1
    del x75
    x67 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x67 += einsum("iabc->ibac", v.aaaa.ovvv)
    x67 += einsum("iabc->ibca", v.aaaa.ovvv) * -1
    x68 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x68 += einsum("ia,ibac->bc", t1.aa, x67)
    x71 += einsum("ab->ab", x68) * -1
    del x68
    x102 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x102 += einsum("ijab,icba->jc", x65, x67)
    del x65
    x111 += einsum("ia->ia", x102) * -1
    x173 += einsum("ia->ia", x102) * -1
    del x102
    x169 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x169 += einsum("ia,jbac->jibc", t1.aa, x67) * -1
    del x67
    x69 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x69 += einsum("ijab->ijab", t2.abab)
    x69 += einsum("ia,jb->ijab", t1.aa, t1.bb)
    x70 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x70 += einsum("iajb,ijcb->ca", v.aabb.ovov, x69)
    x71 += einsum("ab->ab", x70)
    del x70
    x77 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x77 += einsum("iajb,kjab->ki", v.aabb.ovov, x69)
    x78 += einsum("ij->ji", x77)
    x133 += einsum("ij->ji", x77)
    del x77
    x108 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x108 += einsum("iabc,jica->jb", v.bbaa.ovvv, x69)
    x111 += einsum("ia->ia", x108)
    x173 += einsum("ia->ia", x108)
    del x108
    x131 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x131 += einsum("iajb,ijac->cb", v.aabb.ovov, x69)
    x132 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x132 += einsum("ab->ab", x131)
    del x131
    x139 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x139 += einsum("iajb,ikab->kj", v.aabb.ovov, x69)
    x140 += einsum("ij->ji", x139)
    x194 += einsum("ij->ji", x139)
    del x139
    x153 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x153 += einsum("iabc,ijac->jb", v.aabb.ovvv, x69)
    del x69
    x156 += einsum("ia->ia", x153)
    x214 += einsum("ia->ia", x153)
    del x153
    x71 += einsum("ab->ab", f.aa.vv) * -1
    x72 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x72 += einsum("ab,ijb->ija", x71, r2.aaa)
    x112 += einsum("ija->ija", x72) * -1
    del x72
    r2new_aba += einsum("ab,ijb->ija", x71, r2.aba) * -1
    del x71
    x73 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x73 += einsum("ia,ja->ij", f.aa.ov, t1.aa)
    x78 += einsum("ij->ij", x73)
    x133 += einsum("ij->ij", x73)
    del x73
    x74 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x74 += einsum("ia,jkia->jk", t1.bb, v.aabb.ooov)
    x78 += einsum("ij->ij", x74)
    x79 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x79 += einsum("ij,ika->jka", x78, x10)
    x112 += einsum("ija->jia", x79) * -1
    del x79
    x110 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x110 += einsum("ia,ij->ja", t1.aa, x78)
    del x78
    x111 += einsum("ia->ia", x110) * -1
    del x110
    x133 += einsum("ij->ij", x74)
    del x74
    x82 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x82 += einsum("ija,iabc->jbc", r2.bab, v.bbaa.ovvv)
    x85 += einsum("iab->iab", x82)
    del x82
    x83 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x83 += einsum("iabc->ibac", v.aaaa.ovvv) * -1
    x83 += einsum("iabc->ibca", v.aaaa.ovvv)
    x84 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x84 += einsum("ija,jbca->ibc", x10, x83)
    del x83
    x85 += einsum("iab->iab", x84)
    del x84
    x86 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x86 += einsum("ia,jba->jib", t1.aa, x85)
    del x85
    x112 += einsum("ija->ija", x86) * -1
    del x86
    x87 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x87 += einsum("i,jkil->jkl", r1.a, v.aaaa.oooo)
    x95 += einsum("ijk->ijk", x87)
    del x87
    x88 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x88 += einsum("ija,klia->jkl", r2.bab, v.aabb.ooov)
    x95 += einsum("ijk->jki", x88)
    del x88
    x89 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x89 += einsum("ija->ija", r2.aaa)
    x89 += einsum("ija->jia", r2.aaa) * -1
    x97 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x97 += einsum("ij,ika->kja", f.aa.oo, x89)
    x112 += einsum("ija->jia", x97) * -1
    del x97
    x90 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x90 += einsum("ijka->kija", v.aaaa.ooov)
    x91 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x91 += einsum("ija,ikla->klj", x89, x90)
    del x89
    del x90
    x95 += einsum("ijk->ijk", x91)
    del x91
    x96 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x96 += einsum("ia,ijk->jka", t1.aa, x95)
    del x95
    x112 += einsum("ija->jia", x96)
    del x96
    x98 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x98 += einsum("ab,ib->ia", f.aa.vv, t1.aa)
    x111 += einsum("ia->ia", x98)
    x173 += einsum("ia->ia", x98)
    del x98
    x99 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x99 += einsum("ia,iabj->jb", t1.bb, v.bbaa.ovvo)
    x111 += einsum("ia->ia", x99)
    x173 += einsum("ia->ia", x99)
    del x99
    x100 += einsum("ijka->jika", v.aaaa.ooov)
    x100 += einsum("ijka->jkia", v.aaaa.ooov) * -1
    x101 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x101 += einsum("ijab,kjia->kb", t2.aaaa, x100)
    del x100
    x111 += einsum("ia->ia", x101) * -1
    x173 += einsum("ia->ia", x101) * -1
    del x101
    x103 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x103 += einsum("ia,jakb->ijkb", t1.aa, v.aabb.ovov)
    x104 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x104 += einsum("ijka->jika", x103)
    del x103
    x104 += einsum("ijka->ijka", v.aabb.ooov)
    x105 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x105 += einsum("ijab,ikjb->ka", t2.abab, x104)
    x111 += einsum("ia->ia", x105) * -1
    x112 += einsum("i,ja->ija", r1.a, x111)
    del x111
    r2new_aaa = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    r2new_aaa += einsum("ija->ija", x112)
    r2new_aaa += einsum("ija->jia", x112) * -1
    del x112
    x173 += einsum("ia->ia", x105) * -1
    del x105
    x141 += einsum("ija,jkla->kli", r2.bab, x104) * -1
    del x104
    x114 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x114 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    x114 += einsum("ijab->jiab", t2.bbbb) * -1
    x114 += einsum("ijab->jiba", t2.bbbb)
    r2new_bab += einsum("ija,jkba->kib", x113, x114) * -1
    del x113
    x116 += einsum("i,iabc->abc", r1.a, v.aabb.ovvv)
    r2new_bab += einsum("abc,ijac->jib", x116, t2.abab)
    del x116
    x117 += einsum("i,iajk->jka", r1.a, v.aabb.ovoo)
    r2new_bab += einsum("ija,kiab->jkb", x117, t2.abab) * -1
    del x117
    x118 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x118 += einsum("ia,jkla->jkil", t1.bb, v.aabb.ooov)
    x122 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x122 += einsum("ijkl->ijlk", x118)
    del x118
    x119 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x119 += einsum("ia,jbka->jikb", t1.bb, v.aabb.ovov)
    x120 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x120 += einsum("ijka->ikja", x119)
    del x119
    x120 += einsum("iajk->ijka", v.aabb.ovoo)
    x121 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x121 += einsum("ia,jkla->jikl", t1.aa, x120)
    x122 += einsum("ijkl->ijkl", x121)
    del x121
    x149 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x149 += einsum("ijab,ijka->kb", t2.abab, x120)
    x156 += einsum("ia->ia", x149) * -1
    x214 += einsum("ia->ia", x149) * -1
    del x149
    x171 += einsum("ija,kjla->kil", r2.aba, x120) * -1
    del x120
    x122 += einsum("ijkl->ijkl", v.aabb.oooo)
    r2new_bab += einsum("ija,jkil->lka", r2.bab, x122)
    r2new_aba += einsum("ija,ikjl->kla", r2.aba, x122)
    del x122
    x123 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x123 += einsum("iabj->ijab", v.aabb.ovvo)
    x123 += einsum("ia,jbca->jibc", t1.bb, v.aabb.ovvv)
    r2new_bab += einsum("ija,jkab->kib", x10, x123)
    del x10
    del x123
    x124 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x124 += einsum("iabc->ibac", v.bbbb.ovvv)
    x124 += einsum("iabc->ibca", v.bbbb.ovvv) * -1
    x125 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x125 += einsum("ia,jbac->jibc", t1.bb, x124) * -1
    x130 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x130 += einsum("ia,ibac->bc", t1.bb, x124)
    x132 += einsum("ab->ab", x130) * -1
    del x130
    x125 += einsum("iabj->ijba", v.bbbb.ovvo)
    x125 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    r2new_bab += einsum("ija,ikba->kjb", r2.bab, x125)
    del x125
    x126 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x126 += einsum("ia,ib->ab", f.bb.ov, t1.bb)
    x132 += einsum("ab->ba", x126)
    del x126
    x127 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x127 += einsum("ia,iabc->bc", t1.aa, v.aabb.ovvv)
    x132 += einsum("ab->ab", x127) * -1
    del x127
    x128 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x128 += einsum("ijab->jiba", t2.bbbb)
    x128 += einsum("ia,jb->ijba", t1.bb, t1.bb) * -1
    x129 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x129 += einsum("ijab,ijbc->ac", x128, x27)
    x132 += einsum("ab->ab", x129) * -1
    del x129
    x148 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x148 += einsum("iabc,ijcb->ja", x124, x128)
    del x128
    x156 += einsum("ia->ia", x148) * -1
    x214 += einsum("ia->ia", x148) * -1
    del x148
    x132 += einsum("ab->ab", f.bb.vv) * -1
    x193 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x193 += einsum("ab,ijb->ija", x132, r2.bbb)
    x215 += einsum("ija->ija", x193) * -1
    del x193
    r2new_bab += einsum("ab,ijb->ija", x132, r2.bab) * -1
    del x132
    x133 += einsum("ij->ij", f.aa.oo)
    x173 += einsum("ia,ij->ja", t1.aa, x133) * -1
    r2new_bab += einsum("ij,kia->kja", x133, r2.bab) * -1
    r2new_aba += einsum("ij,ika->jka", x133, r2.aba) * -1
    del x133
    x134 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x134 += einsum("ia,ja->ij", f.bb.ov, t1.bb)
    x140 += einsum("ij->ij", x134)
    x194 += einsum("ij->ij", x134)
    del x134
    x135 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x135 += einsum("ia,iajk->jk", t1.aa, v.aabb.ovoo)
    x140 += einsum("ij->ij", x135)
    x194 += einsum("ij->ij", x135)
    del x135
    x136 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x136 += einsum("ijab->jiba", t2.bbbb)
    x136 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    x137 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x137 += einsum("ijab,ikba->jk", x136, x27)
    del x136
    del x27
    x140 += einsum("ij->ji", x137) * -1
    x194 += einsum("ij->ji", x137) * -1
    del x137
    x195 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x195 += einsum("ij,kia->jka", x194, x25)
    del x25
    x215 += einsum("ija->jia", x195) * -1
    del x195
    x213 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x213 += einsum("ia,ij->ja", t1.bb, x194)
    del x194
    x214 += einsum("ia->ia", x213) * -1
    del x213
    x140 += einsum("ij->ij", f.bb.oo)
    x156 += einsum("ia,ij->ja", t1.bb, x140) * -1
    r2new_bab += einsum("ij,ika->jka", x140, r2.bab) * -1
    r2new_aba += einsum("ij,kia->kja", x140, r2.aba) * -1
    del x140
    x141 += einsum("i,ijkl->jkl", r1.a, v.aabb.oooo)
    r2new_bab += einsum("ia,jik->kja", t1.bb, x141) * -1
    del x141
    x142 += einsum("i,iabj->jab", r1.a, v.aabb.ovvo)
    r2new_bab += einsum("ia,jab->jib", t1.aa, x142)
    del x142
    x143 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x143 += einsum("ab,ib->ia", f.bb.vv, t1.bb)
    x156 += einsum("ia->ia", x143)
    x214 += einsum("ia->ia", x143)
    del x143
    x144 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x144 += einsum("ia,iabj->jb", t1.aa, v.aabb.ovvo)
    x156 += einsum("ia->ia", x144)
    x214 += einsum("ia->ia", x144)
    del x144
    x145 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x145 += einsum("ia,jbka->ijkb", t1.bb, v.bbbb.ovov)
    x146 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x146 += einsum("ijka->ijka", x145)
    x146 += einsum("ijka->ikja", x145) * -1
    x189 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x189 += einsum("ia,jkla->jilk", t1.bb, x145)
    x191 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x191 += einsum("ijkl->lkji", x189)
    del x189
    x205 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x205 += einsum("ijka->jkia", x145)
    x205 += einsum("ijka->kjia", x145) * -1
    del x145
    x146 += einsum("ijka->jika", v.bbbb.ooov) * -1
    x146 += einsum("ijka->jkia", v.bbbb.ooov)
    x147 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x147 += einsum("ijab,kjib->ka", t2.bbbb, x146)
    del x146
    x156 += einsum("ia->ia", x147) * -1
    x214 += einsum("ia->ia", x147) * -1
    del x147
    x150 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x150 += einsum("ijab->jiab", t2.bbbb)
    x150 += einsum("ijab->jiba", t2.bbbb) * -1
    x151 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x151 += einsum("ia,ijab->jb", x14, x150)
    del x14
    x156 += einsum("ia->ia", x151) * -1
    x214 += einsum("ia->ia", x151) * -1
    del x151
    x154 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x154 += einsum("iabj->ijba", v.bbbb.ovvo)
    x154 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x155 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x155 += einsum("ia,ijba->jb", t1.bb, x154)
    x156 += einsum("ia->ia", x155)
    x214 += einsum("ia->ia", x155)
    del x155
    x215 += einsum("i,ja->ija", r1.b, x214)
    del x214
    x156 += einsum("ai->ia", f.bb.vo)
    r2new_bab += einsum("i,ja->jia", r1.a, x156) * -1
    del x156
    x157 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x157 += einsum("i,jaik->jka", r1.b, v.aabb.ovoo)
    x161 += einsum("ija->ija", x157)
    x177 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x177 += einsum("ija,ikab->kjb", x157, t2.abab)
    del x157
    x215 += einsum("ija->ija", x177)
    del x177
    x158 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x158 += einsum("i,ja->ija", r1.b, t1.bb)
    x158 += einsum("ija->ija", r2.bbb)
    x158 += einsum("ija->jia", r2.bbb) * -1
    x159 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x159 += einsum("ija,kbia->kjb", x158, v.aabb.ovov)
    x161 += einsum("ija->ija", x159)
    r2new_aba += einsum("ija,ikba->kjb", x161, x56) * -1
    del x56
    del x161
    x180 += einsum("ija->ija", x159)
    del x159
    x181 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x181 += einsum("ija,ikab->jkb", x180, t2.abab)
    del x180
    x215 += einsum("ija->ija", x181) * -1
    del x181
    x163 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x163 += einsum("ija,ikba->jkb", x158, x12)
    del x12
    x166 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x166 += einsum("ija->jia", x163)
    x178 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x178 += einsum("ija->ija", x163)
    del x163
    x170 = np.zeros((nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x170 += einsum("ija,iabc->jbc", x158, v.bbaa.ovvv)
    x171 += einsum("ija,klia->klj", x158, v.aabb.ooov)
    x187 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x187 += einsum("ija,ikba->kjb", x158, x154)
    del x154
    x215 += einsum("ija->jia", x187) * -1
    del x187
    r2new_aba += einsum("ija,iabk->kjb", x158, v.bbaa.ovvo)
    del x158
    x162 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x162 += einsum("ija,iakb->jkb", r2.aba, v.aabb.ovov)
    x166 += einsum("ija->jia", x162)
    x178 += einsum("ija->ija", x162)
    x179 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x179 += einsum("ija,jkba->kib", x178, x150)
    del x178
    del x150
    x215 += einsum("ija->jia", x179) * -1
    del x179
    x208 += einsum("ija->ija", x162)
    del x162
    x209 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x209 += einsum("ia,jka->jki", t1.bb, x208)
    del x208
    x210 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x210 += einsum("ijk->jki", x209)
    del x209
    x164 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x164 += einsum("ijka->ikja", v.bbbb.ooov)
    x164 += einsum("ijka->kija", v.bbbb.ooov) * -1
    x165 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x165 += einsum("i,jika->jka", r1.b, x164)
    del x164
    x166 += einsum("ija->ija", x165) * -1
    r2new_aba += einsum("ija,kiba->kjb", x166, t2.abab)
    del x166
    x188 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x188 += einsum("ija,ikba->kjb", x165, x114) * -1
    del x114
    del x165
    x215 += einsum("ija->ija", x188) * -1
    del x188
    x167 += einsum("i,iabc->bca", r1.b, v.bbaa.ovvv)
    r2new_aba += einsum("abc,ijbc->ija", x167, t2.abab)
    del x167
    x168 += einsum("i,jkia->jka", r1.b, v.aabb.ooov)
    r2new_aba += einsum("ija,ikba->jkb", x168, t2.abab) * -1
    del x168
    x169 += einsum("iabj->ijba", v.aaaa.ovvo)
    x169 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    r2new_aba += einsum("ija,ikba->kjb", r2.aba, x169)
    del x169
    x170 += einsum("i,ijab->jab", r1.b, v.bbaa.oovv)
    r2new_aba += einsum("ia,jba->ijb", t1.aa, x170)
    del x170
    x171 += einsum("i,jkil->jkl", r1.b, v.aabb.oooo)
    r2new_aba += einsum("ia,ijk->jka", t1.aa, x171) * -1
    del x171
    x172 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x172 += einsum("ijab->ijab", v.bbaa.oovv)
    x172 += einsum("ia,jabc->jibc", t1.bb, v.bbaa.ovvv)
    r2new_aba += einsum("ija,jkba->ikb", r2.aba, x172) * -1
    del x172
    x173 += einsum("ai->ia", f.aa.vo)
    r2new_aba += einsum("i,ja->jia", r1.b, x173) * -1
    del x173
    x174 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x174 += einsum("i,ijak->jka", r1.b, v.bbbb.oovo)
    x215 += einsum("ija->ija", x174) * -1
    del x174
    x175 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x175 += einsum("ij,ia->ja", f.bb.oo, t1.bb)
    x215 += einsum("i,ja->jia", r1.b, x175)
    del x175
    x176 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x176 += einsum("ija,iabk->jkb", r2.aba, v.aabb.ovvo)
    x215 += einsum("ija->ija", x176) * -1
    del x176
    x182 = np.zeros((nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x182 += einsum("i,iabc->bac", r1.b, v.bbbb.ovvv)
    x185 = np.zeros((nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x185 += einsum("abc->abc", x182) * -1
    x198 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x198 += einsum("ia,bac->ibc", t1.bb, x182)
    del x182
    x201 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x201 += einsum("iab->iab", x198)
    del x198
    x183 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x183 += einsum("ija->ija", r2.bbb)
    x183 += einsum("i,ja->ija", r1.b, t1.bb)
    x184 = np.zeros((nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x184 += einsum("ija,jbic->abc", x183, v.bbbb.ovov)
    del x183
    x185 += einsum("abc->acb", x184)
    del x184
    x186 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x186 += einsum("abc,ijcb->ija", x185, t2.bbbb)
    del x185
    x215 += einsum("ija->jia", x186)
    del x186
    x190 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x190 += einsum("ia,jkla->ijlk", t1.bb, v.bbbb.ooov)
    x191 += einsum("ijkl->jkli", x190)
    x191 += einsum("ijkl->kjli", x190) * -1
    del x190
    x191 += einsum("ijkl->kilj", v.bbbb.oooo)
    x192 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x192 += einsum("ija,jikl->kla", r2.bbb, x191)
    del x191
    x215 += einsum("ija->jia", x192)
    del x192
    x197 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x197 += einsum("ija,iabc->jbc", r2.aba, v.aabb.ovvv)
    x201 += einsum("iab->iab", x197)
    del x197
    x199 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x199 += einsum("ija->ija", r2.bbb) * -1
    x199 += einsum("ija->jia", r2.bbb)
    x200 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x200 += einsum("ija,jbac->ibc", x199, x124)
    del x124
    x201 += einsum("iab->iab", x200)
    del x200
    x202 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x202 += einsum("ia,jba->jib", t1.bb, x201)
    del x201
    x215 += einsum("ija->ija", x202) * -1
    del x202
    x212 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x212 += einsum("ij,kia->kja", f.bb.oo, x199)
    x215 += einsum("ija->jia", x212) * -1
    del x212
    x203 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x203 += einsum("i,jkil->jkl", r1.b, v.bbbb.oooo)
    x210 += einsum("ijk->ijk", x203)
    del x203
    x204 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x204 += einsum("ija,iakl->jkl", r2.aba, v.aabb.ovoo)
    x210 += einsum("ijk->jki", x204)
    del x204
    x205 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x205 += einsum("ijka->kija", v.bbbb.ooov)
    x206 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x206 += einsum("ija,jkla->ikl", x199, x205)
    del x205
    del x199
    x210 += einsum("ijk->jki", x206)
    del x206
    x211 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x211 += einsum("ia,ijk->jka", t1.bb, x210)
    del x210
    x215 += einsum("ija->jia", x211)
    del x211
    r2new_bbb = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    r2new_bbb += einsum("ija->ija", x215)
    r2new_bbb += einsum("ija->jia", x215) * -1
    del x215
    r1new_a -= einsum("i,ij->j", r1.a, f.aa.oo)
    r1new_b -= einsum("i,ij->j", r1.b, f.bb.oo)
    r2new_aaa -= einsum("i,aj->jia", r1.a, f.aa.vo)
    r2new_aaa += einsum("i,aj->ija", r1.a, f.aa.vo)
    r2new_bab += einsum("i,ijak->kja", r1.a, v.aabb.oovo)
    r2new_aba += einsum("i,ijak->kja", r1.b, v.bbaa.oovo)
    r2new_bbb -= einsum("i,aj->jia", r1.b, f.bb.vo)
    r2new_bbb += einsum("i,aj->ija", r1.b, f.bb.vo)

    r1new = SimpleNamespace(a=r1new_a, b=r1new_b)
    r2new = SimpleNamespace(aaa=r2new_aaa, aba=r2new_aba, bab=r2new_bab, bbb=r2new_bbb)

    return r1new, r2new

def hbar_matvec_ea(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, r1=None, r2=None, **kwargs):
    x0 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x0 += einsum("a,iajb->ijb", r1.a, v.aabb.ovov)
    r1new_a = np.zeros((nvir[0]), dtype=np.float64)
    r1new_a += einsum("ija,ijba->b", x0, t2.abab) * -1
    del x0
    x1 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x1 += einsum("abi->iab", r2.aaa)
    x1 += einsum("a,ib->iab", r1.a, t1.aa) * -1
    x2 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x2 += einsum("iabc->ibac", v.aaaa.ovvv) * -1
    x2 += einsum("iabc->ibca", v.aaaa.ovvv)
    x48 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x48 += einsum("ia,jbca->ijbc", t1.aa, x2)
    x49 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x49 += einsum("ijab->ijab", x48) * -1
    x159 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x159 += einsum("ijab->jiab", x48) * -1
    del x48
    x55 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x55 += einsum("a,ibca->ibc", r1.a, x2)
    x107 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x107 += einsum("iab->iab", x55) * -1
    x73 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x73 += einsum("ia,ibca->bc", t1.aa, x2)
    x76 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x76 += einsum("ab->ab", x73) * -1
    x120 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x120 += einsum("ab->ab", x73) * -1
    del x73
    x87 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x87 += einsum("abi,jcba->ijc", r2.aaa, x2)
    x90 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x90 += einsum("ija->jia", x87) * -1
    del x87
    r1new_a += einsum("iab,icab->c", x1, x2) * -1
    x3 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x3 += einsum("abi->iba", r2.bab)
    x3 += einsum("a,ib->iab", r1.a, t1.bb)
    x18 = np.zeros((nocc[0]), dtype=np.float64)
    x18 += einsum("iab,jaib->j", x3, v.aabb.ovov)
    x19 = np.zeros((nocc[0]), dtype=np.float64)
    x19 += einsum("i->i", x18)
    del x18
    x117 = np.zeros((nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x117 += einsum("iab,jaic->jbc", x3, v.aabb.ovov)
    x119 = np.zeros((nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x119 += einsum("iab,jakb->jki", x3, v.aabb.ovov)
    x136 = np.zeros((nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x136 += einsum("iab,jacb->jic", x3, v.aabb.ovvv)
    x137 = np.zeros((nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x137 += einsum("iab,jbca->jic", x3, v.bbaa.ovvv)
    r1new_a += einsum("iab,ibca->c", x3, v.bbaa.ovvv)
    r2new_bab = np.zeros((nvir[1], nvir[0], nocc[1]), dtype=np.float64)
    r2new_bab += einsum("iab,cadb->dci", x3, v.aabb.vvvv) * -1
    del x3
    x4 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x4 += einsum("a,iajb->jib", r1.a, v.aaaa.ovov)
    x5 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x5 += einsum("ija->ija", x4)
    x5 += einsum("ija->jia", x4) * -1
    r1new_a += einsum("ija,ijab->b", x5, t2.aaaa) * -1
    del x5
    x66 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x66 += einsum("ia,jka->ikj", t1.aa, x4)
    del x4
    x67 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x67 += einsum("ijk->jki", x66) * -1
    del x66
    x6 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x6 += einsum("ia,jbia->jb", t1.bb, v.aabb.ovov)
    x9 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x9 += einsum("ia->ia", x6)
    del x6
    x7 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x7 += einsum("iajb->jiab", v.aaaa.ovov)
    x7 += einsum("iajb->jiba", v.aaaa.ovov) * -1
    x8 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x8 += einsum("ia,ijab->jb", t1.aa, x7)
    x9 += einsum("ia->ia", x8) * -1
    del x8
    x153 = np.zeros((nocc[0], nvir[0], nvir[1]), dtype=np.float64)
    x153 += einsum("abi,ijac->jcb", r2.aba, x7) * -1
    x9 += einsum("ia->ia", f.aa.ov)
    x144 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x144 += einsum("ia,ijab->jb", x9, t2.abab)
    x149 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x149 += einsum("ia->ia", x144)
    x197 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x197 += einsum("ia->ia", x144) * -1
    del x144
    r1new_b = np.zeros((nvir[1]), dtype=np.float64)
    r1new_b += einsum("ia,abi->b", x9, r2.aba)
    x10 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x10 += einsum("abi->iab", r2.aaa)
    x10 += einsum("abi->iba", r2.aaa) * -1
    x92 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x92 += einsum("ab,ibc->iac", f.aa.vv, x10)
    x104 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x104 += einsum("iab->iab", x92) * -1
    del x92
    r1new_a += einsum("ia,iba->b", x9, x10) * -1
    x11 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x11 += einsum("ia,iajb->jb", t1.aa, v.aabb.ovov)
    x14 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x14 += einsum("ia->ia", x11)
    del x11
    x12 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x12 += einsum("iajb->jiab", v.bbbb.ovov)
    x12 += einsum("iajb->jiba", v.bbbb.ovov) * -1
    x13 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x13 += einsum("ia,ijab->jb", t1.bb, x12)
    x14 += einsum("ia->ia", x13) * -1
    del x13
    x105 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x105 += einsum("abi,ijac->jbc", r2.bab, x12) * -1
    x14 += einsum("ia->ia", f.bb.ov)
    x99 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x99 += einsum("ia,jiba->jb", x14, t2.abab)
    x103 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x103 += einsum("ia->ia", x99) * -1
    x165 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x165 += einsum("ia->ia", x99)
    del x99
    r1new_a += einsum("ia,abi->b", x14, r2.bab)
    x15 = np.zeros((nocc[0]), dtype=np.float64)
    x15 += einsum("a,ia->i", r1.a, f.aa.ov)
    x19 += einsum("i->i", x15)
    del x15
    x16 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x16 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x16 += einsum("iajb->jiba", v.aaaa.ovov)
    x17 = np.zeros((nocc[0]), dtype=np.float64)
    x17 += einsum("iab,ijba->j", x1, x16)
    del x1
    x19 += einsum("i->i", x17) * -1
    del x17
    x86 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x86 += einsum("i,ijab->jab", x19, t2.aaaa)
    x104 += einsum("iab->iba", x86)
    del x86
    r1new_a += einsum("i,ia->a", x19, t1.aa) * -1
    r2new_bab += einsum("i,ijab->baj", x19, t2.abab)
    del x19
    x174 = np.zeros((nocc[0], nvir[0], nvir[1]), dtype=np.float64)
    x174 += einsum("abi,ijac->jcb", r2.aba, x16)
    x175 = np.zeros((nocc[0], nvir[0], nvir[1]), dtype=np.float64)
    x175 += einsum("iab->iab", x174) * -1
    del x174
    x20 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x20 += einsum("a,ibja->ijb", r1.b, v.aabb.ovov)
    r1new_b += einsum("ija,ijab->b", x20, t2.abab) * -1
    del x20
    x21 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x21 += einsum("abi->iab", r2.bbb)
    x21 += einsum("a,ib->iab", r1.b, t1.bb) * -1
    x181 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x181 += einsum("iab,jbka->jki", x21, v.bbbb.ovov)
    x182 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x182 += einsum("ijk->jik", x181)
    del x181
    x187 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x187 += einsum("iab,cbda->icd", x21, v.bbbb.vvvv)
    x198 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x198 += einsum("iab->iba", x187) * -1
    del x187
    x22 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x22 += einsum("iabc->ibac", v.bbbb.ovvv)
    x22 += einsum("iabc->ibca", v.bbbb.ovvv) * -1
    x116 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x116 += einsum("ia,jbac->jibc", t1.bb, x22) * -1
    x125 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x125 += einsum("ia,ibac->bc", t1.bb, x22)
    x127 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x127 += einsum("ab->ab", x125) * -1
    x184 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x184 += einsum("ab->ab", x125) * -1
    del x125
    x156 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x156 += einsum("a,ibac->ibc", r1.b, x22)
    x157 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x157 += einsum("iab->iab", x156) * -1
    r1new_b += einsum("iab,icba->c", x21, x22) * -1
    x23 = np.zeros((nocc[0], nvir[0], nvir[1]), dtype=np.float64)
    x23 += einsum("abi->iab", r2.aba)
    x23 += einsum("a,ib->iba", r1.b, t1.aa)
    x30 = np.zeros((nocc[1]), dtype=np.float64)
    x30 += einsum("iab,iajb->j", x23, v.aabb.ovov)
    x31 = np.zeros((nocc[1]), dtype=np.float64)
    x31 += einsum("i->i", x30)
    del x30
    x160 = np.zeros((nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x160 += einsum("iab,icjb->jac", x23, v.aabb.ovov)
    x162 = np.zeros((nocc[0], nocc[0], nocc[1]), dtype=np.float64)
    x162 += einsum("iab,jakb->jik", x23, v.aabb.ovov)
    x163 = np.zeros((nocc[0], nocc[0], nvir[1]), dtype=np.float64)
    x163 += einsum("iab,jacb->jic", x23, v.aabb.ovvv)
    x164 = np.zeros((nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    x164 += einsum("iab,jbca->ijc", x23, v.bbaa.ovvv)
    r1new_b += einsum("iab,iacb->c", x23, v.aabb.ovvv)
    r2new_aba = np.zeros((nvir[0], nvir[1], nocc[0]), dtype=np.float64)
    r2new_aba += einsum("iab,cadb->cdi", x23, v.aabb.vvvv) * -1
    del x23
    x24 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x24 += einsum("a,iajb->jib", r1.b, v.bbbb.ovov)
    x25 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x25 += einsum("ija->ija", x24) * -1
    x25 += einsum("ija->jia", x24)
    del x24
    r1new_b += einsum("ija,jiab->b", x25, t2.bbbb) * -1
    del x25
    x26 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x26 += einsum("abi->iab", r2.bbb)
    x26 += einsum("abi->iba", r2.bbb) * -1
    r1new_b += einsum("ia,iba->b", x14, x26) * -1
    del x26
    x27 = np.zeros((nocc[1]), dtype=np.float64)
    x27 += einsum("a,ia->i", r1.b, f.bb.ov)
    x31 += einsum("i->i", x27)
    del x27
    x28 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x28 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x28 += einsum("iajb->jiba", v.bbbb.ovov)
    x29 = np.zeros((nocc[1]), dtype=np.float64)
    x29 += einsum("iab,ijba->j", x21, x28)
    del x21
    x31 += einsum("i->i", x29) * -1
    del x29
    x188 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x188 += einsum("i,ijab->jab", x31, t2.bbbb)
    x198 += einsum("iab->iba", x188)
    del x188
    r1new_b += einsum("i,ia->a", x31, t1.bb) * -1
    r2new_aba += einsum("i,jiab->abj", x31, t2.abab)
    del x31
    x52 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x52 += einsum("abi,ijac->jbc", r2.bab, x28)
    x53 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x53 += einsum("iab->iab", x52) * -1
    del x52
    x32 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x32 += einsum("a,bica->ibc", r1.a, v.aaaa.vovv)
    x104 += einsum("iab->iab", x32) * -1
    del x32
    x33 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x33 += einsum("ab,ib->ia", f.aa.vv, t1.aa)
    x104 += einsum("a,ib->iba", r1.a, x33) * -1
    x165 += einsum("ia->ia", x33)
    del x33
    x34 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x34 += einsum("abi,cbda->idc", r2.aaa, v.aaaa.vvvv)
    x104 += einsum("iab->iab", x34) * -1
    del x34
    x35 = np.zeros((nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x35 += einsum("a,bcda->bdc", r1.a, v.aaaa.vvvv)
    x36 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x36 += einsum("ia,bca->icb", t1.aa, x35)
    del x35
    x104 += einsum("iab->iab", x36)
    del x36
    x37 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x37 += einsum("a,ibca->icb", r1.a, v.bbaa.ovvv)
    x38 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x38 += einsum("iab,jicb->jca", x37, t2.abab)
    x104 += einsum("iab->iab", x38) * -1
    del x38
    x105 += einsum("iab->iab", x37)
    del x37
    x39 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x39 += einsum("abi,jcia->jbc", r2.bab, v.aabb.ovov)
    x42 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x42 += einsum("iab->iab", x39)
    x107 += einsum("iab->iab", x39)
    del x39
    x40 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x40 += einsum("a,ib->iab", r1.a, t1.aa)
    x40 += einsum("abi->iab", r2.aaa) * -1
    x40 += einsum("abi->iba", r2.aaa)
    x41 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x41 += einsum("iab,ijca->jcb", x40, x7)
    x42 += einsum("iab->iba", x41) * -1
    x107 += einsum("iab->iba", x41) * -1
    del x41
    r2new_bab += einsum("iab,ijbc->caj", x107, t2.abab) * -1
    del x107
    x51 = np.zeros((nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x51 += einsum("iab,iajc->jbc", x40, v.aabb.ovov)
    del x40
    x53 += einsum("iab->iab", x51)
    x54 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x54 += einsum("iab,jicb->jca", x53, t2.abab)
    del x53
    x104 += einsum("iab->iba", x54) * -1
    del x54
    x105 += einsum("iab->iab", x51) * -1
    del x51
    x43 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x43 += einsum("ijab->jiab", t2.aaaa)
    x43 += einsum("ijab->jiba", t2.aaaa) * -1
    x44 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x44 += einsum("iab,ijbc->jac", x42, x43)
    del x42
    x104 += einsum("iab->iab", x44) * -1
    del x44
    x165 += einsum("ia,ijab->jb", x9, x43) * -1
    x45 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x45 += einsum("ia,jakb->ikjb", t1.aa, v.aaaa.ovov)
    x46 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x46 += einsum("ijka->ijka", x45) * -1
    x46 += einsum("ijka->ikja", x45)
    del x45
    x46 += einsum("ijka->jika", v.aaaa.ooov)
    x46 += einsum("ijka->jkia", v.aaaa.ooov) * -1
    x47 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x47 += einsum("ia,jikb->jkab", t1.aa, x46)
    x49 += einsum("ijab->ijab", x47) * -1
    x159 += einsum("ijab->jiab", x47) * -1
    del x47
    x94 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x94 += einsum("ijab,kija->kb", t2.aaaa, x46)
    x103 += einsum("ia->ia", x94) * -1
    del x94
    x165 += einsum("ijab,kjia->kb", t2.aaaa, x46) * -1
    del x46
    x49 += einsum("iabj->jiba", v.aaaa.ovvo)
    x49 += einsum("ijab->jiab", v.aaaa.oovv) * -1
    x50 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x50 += einsum("iab,jica->jbc", x10, x49)
    del x49
    x104 += einsum("iab->iab", x50)
    del x50
    x56 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x56 += einsum("ia,jb->ijab", t1.aa, t1.aa)
    x56 += einsum("ijab->jiab", t2.aaaa) * -1
    x56 += einsum("ijab->jiba", t2.aaaa)
    x57 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x57 += einsum("iab,ijcb->jca", x55, x56) * -1
    del x56
    del x55
    x104 += einsum("iab->iab", x57)
    del x57
    x58 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x58 += einsum("ia,jbca->ijcb", t1.aa, v.bbaa.ovvv)
    x62 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x62 += einsum("ijab->ijab", x58)
    del x58
    x59 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x59 += einsum("ia,jakb->ijkb", t1.aa, v.aabb.ovov)
    x60 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x60 += einsum("ijka->jika", x59)
    del x59
    x60 += einsum("ijka->ijka", v.aabb.ooov)
    x61 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x61 += einsum("ia,ijkb->jkab", t1.aa, x60)
    x62 += einsum("ijab->ijab", x61) * -1
    del x61
    x96 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x96 += einsum("ijab,ikjb->ka", t2.abab, x60)
    x103 += einsum("ia->ia", x96)
    x165 += einsum("ia->ia", x96) * -1
    del x96
    x161 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x161 += einsum("ia,jkib->jkab", t1.bb, x60) * -1
    del x60
    x62 += einsum("iabj->jiba", v.bbaa.ovvo)
    x63 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x63 += einsum("abi,jica->jbc", r2.bab, x62)
    x104 += einsum("iab->iab", x63)
    del x63
    x64 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x64 += einsum("a,ijka->ikj", r1.a, v.aaaa.ooov)
    x67 += einsum("ijk->ijk", x64)
    del x64
    x65 = np.zeros((nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x65 += einsum("abi,jbka->ikj", r2.aaa, v.aaaa.ovov)
    x67 += einsum("ijk->jki", x65)
    del x65
    x68 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x68 += einsum("ijab->jiba", t2.aaaa)
    x68 += einsum("ia,jb->ijab", t1.aa, t1.aa)
    x69 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x69 += einsum("ijk,jiab->kab", x67, x68)
    del x67
    x104 += einsum("iab->iba", x69) * -1
    del x69
    x72 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x72 += einsum("ijab,ijac->bc", x68, x7)
    del x7
    x76 += einsum("ab->ab", x72) * -1
    x120 += einsum("ab->ab", x72) * -1
    del x72
    x80 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x80 += einsum("ijab,ikba->kj", x16, x68)
    del x16
    x84 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x84 += einsum("ij->ji", x80) * -1
    del x80
    x95 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x95 += einsum("iabc,ijcb->ja", x2, x68)
    x103 += einsum("ia->ia", x95) * -1
    del x95
    x165 += einsum("iabc,ijbc->ja", x2, x68) * -1
    del x2
    del x68
    x70 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x70 += einsum("ia,ib->ab", f.aa.ov, t1.aa)
    x76 += einsum("ab->ba", x70)
    x120 += einsum("ab->ba", x70)
    del x70
    x71 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x71 += einsum("ia,iabc->bc", t1.bb, v.bbaa.ovvv)
    x76 += einsum("ab->ab", x71) * -1
    x120 += einsum("ab->ab", x71) * -1
    del x71
    x74 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x74 += einsum("ijab->ijab", t2.abab)
    x74 += einsum("ia,jb->ijab", t1.aa, t1.bb)
    x75 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x75 += einsum("iajb,ijcb->ca", v.aabb.ovov, x74)
    x76 += einsum("ab->ab", x75)
    x77 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x77 += einsum("ab,ibc->iac", x76, x10)
    del x10
    del x76
    x104 += einsum("iab->iba", x77) * -1
    del x77
    x120 += einsum("ab->ab", x75)
    del x75
    x83 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x83 += einsum("iajb,kjab->ki", v.aabb.ovov, x74)
    x84 += einsum("ij->ji", x83)
    del x83
    x100 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x100 += einsum("iabc,jica->jb", v.bbaa.ovvv, x74)
    x103 += einsum("ia->ia", x100) * -1
    x165 += einsum("ia->ia", x100)
    del x100
    x126 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x126 += einsum("iajb,ijac->cb", v.aabb.ovov, x74)
    x127 += einsum("ab->ab", x126)
    x184 += einsum("ab->ab", x126)
    del x126
    x134 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x134 += einsum("iajb,ikab->kj", v.aabb.ovov, x74)
    x135 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x135 += einsum("ij->ji", x134)
    del x134
    x145 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x145 += einsum("iabc,ijac->jb", v.aabb.ovvv, x74)
    x149 += einsum("ia->ia", x145)
    x197 += einsum("ia->ia", x145) * -1
    del x145
    x78 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x78 += einsum("ia,ja->ij", f.aa.ov, t1.aa)
    x84 += einsum("ij->ij", x78)
    del x78
    x79 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x79 += einsum("ia,jkia->jk", t1.bb, v.aabb.ooov)
    x84 += einsum("ij->ij", x79)
    del x79
    x81 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x81 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x81 += einsum("ijka->kija", v.aaaa.ooov)
    x82 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x82 += einsum("ia,jika->jk", t1.aa, x81)
    del x81
    x84 += einsum("ij->ij", x82) * -1
    del x82
    x84 += einsum("ij->ij", f.aa.oo)
    x85 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x85 += einsum("ij,abi->jab", x84, r2.aaa)
    x104 += einsum("iab->iab", x85)
    del x85
    x102 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x102 += einsum("ia,ij->ja", t1.aa, x84)
    x103 += einsum("ia->ia", x102)
    x165 += einsum("ia->ia", x102) * -1
    del x102
    r2new_aba += einsum("ij,abi->abj", x84, r2.aba)
    del x84
    x88 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x88 += einsum("iabj->ijba", v.aaaa.ovvo)
    x88 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x89 = np.zeros((nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x89 += einsum("a,ijba->ijb", r1.a, x88)
    x90 += einsum("ija->ija", x89)
    del x89
    x91 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x91 += einsum("ia,ijb->jba", t1.aa, x90)
    del x90
    x104 += einsum("iab->iba", x91) * -1
    del x91
    x101 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x101 += einsum("ia,ijba->jb", t1.aa, x88)
    del x88
    x103 += einsum("ia->ia", x101) * -1
    x165 += einsum("ia->ia", x101)
    del x101
    x93 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x93 += einsum("ia,iabj->jb", t1.bb, v.bbaa.ovvo)
    x103 += einsum("ia->ia", x93) * -1
    x165 += einsum("ia->ia", x93)
    del x93
    x97 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x97 += einsum("ijab->jiab", t2.aaaa) * -1
    x97 += einsum("ijab->jiba", t2.aaaa)
    x98 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x98 += einsum("ia,ijab->jb", x9, x97)
    del x9
    del x97
    x103 += einsum("ia->ia", x98) * -1
    del x98
    x104 += einsum("a,ib->iab", r1.a, x103) * -1
    del x103
    r2new_aaa = np.zeros((nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    r2new_aaa += einsum("iab->abi", x104)
    r2new_aaa += einsum("iab->bai", x104) * -1
    del x104
    x106 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x106 += einsum("ijab->jiab", t2.bbbb) * -1
    x106 += einsum("ijab->jiba", t2.bbbb)
    x196 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x196 += einsum("ia,ijab->jb", x14, x106)
    x197 += einsum("ia->ia", x196) * -1
    del x196
    r2new_bab += einsum("iab,ijbc->caj", x105, x106) * -1
    del x105
    x108 = np.zeros((nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x108 += einsum("abi->iab", r2.aaa) * -1
    x108 += einsum("abi->iba", r2.aaa)
    x109 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x109 += einsum("ia,jbca->jibc", t1.bb, v.aabb.ovvv)
    x113 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x113 += einsum("ijab->ijab", x109)
    del x109
    x110 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x110 += einsum("ia,jbka->jikb", t1.bb, v.aabb.ovov)
    x111 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x111 += einsum("ijka->ikja", x110)
    del x110
    x111 += einsum("iajk->ijka", v.aabb.ovoo)
    x112 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x112 += einsum("ia,jikb->jkba", t1.bb, x111)
    x113 += einsum("ijab->ijab", x112) * -1
    del x112
    x118 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x118 += einsum("ia,ijkb->jkab", t1.aa, x111) * -1
    x142 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x142 += einsum("ijab,ijka->kb", t2.abab, x111)
    del x111
    x149 += einsum("ia->ia", x142) * -1
    x197 += einsum("ia->ia", x142)
    del x142
    x113 += einsum("iabj->ijab", v.aabb.ovvo)
    x179 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x179 += einsum("abi,ijac->jcb", r2.aba, x113)
    x198 += einsum("iab->iba", x179)
    del x179
    r2new_bab += einsum("iab,ijbc->caj", x108, x113) * -1
    del x113
    del x108
    x114 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x114 += einsum("ia,jbka->ijkb", t1.bb, v.bbbb.ovov)
    x115 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x115 += einsum("ijka->ijka", x114)
    x115 += einsum("ijka->ikja", x114) * -1
    x140 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x140 += einsum("ijka->ijka", x114) * -1
    x140 += einsum("ijka->ikja", x114)
    del x114
    x115 += einsum("ijka->jika", v.bbbb.ooov) * -1
    x115 += einsum("ijka->jkia", v.bbbb.ooov)
    x116 += einsum("ia,jkib->kjab", t1.bb, x115) * -1
    del x115
    x116 += einsum("iabj->ijba", v.bbbb.ovvo)
    x116 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    r2new_bab += einsum("abi,ijca->cbj", r2.bab, x116) * -1
    del x116
    x117 += einsum("a,iabc->ibc", r1.a, v.aabb.ovvv) * -1
    r2new_bab += einsum("iab,ijcb->acj", x117, t2.abab) * -1
    del x117
    x118 += einsum("ijab->ijab", v.bbaa.oovv)
    x118 += einsum("ia,jabc->jibc", t1.bb, v.bbaa.ovvv)
    r2new_bab += einsum("abi,ijcb->acj", r2.bab, x118)
    del x118
    x119 += einsum("a,iajk->ijk", r1.a, v.aabb.ovoo)
    r2new_bab += einsum("ijk,ijab->bak", x119, x74) * -1
    del x119
    x120 += einsum("ab->ab", f.aa.vv) * -1
    r2new_bab += einsum("ab,cbi->cai", x120, r2.bab)
    r2new_aba += einsum("ab,bci->aci", x120, r2.aba)
    del x120
    x121 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x121 += einsum("ia,ib->ab", f.bb.ov, t1.bb)
    x127 += einsum("ab->ba", x121)
    x184 += einsum("ab->ba", x121)
    del x121
    x122 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x122 += einsum("ia,iabc->bc", t1.aa, v.aabb.ovvv)
    x127 += einsum("ab->ab", x122) * -1
    x184 += einsum("ab->ab", x122) * -1
    del x122
    x123 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x123 += einsum("ijab->jiba", t2.bbbb)
    x123 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    x124 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x124 += einsum("ijab,ijca->bc", x123, x28)
    x127 += einsum("ab->ab", x124) * -1
    x184 += einsum("ab->ab", x124) * -1
    del x124
    x127 += einsum("ab->ab", f.bb.vv) * -1
    r2new_bab += einsum("ab,bci->aci", x127, r2.bab)
    r2new_aba += einsum("ab,cbi->cai", x127, r2.aba)
    del x127
    x128 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x128 += einsum("ia,ja->ij", f.bb.ov, t1.bb)
    x135 += einsum("ij->ij", x128)
    del x128
    x129 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x129 += einsum("ia,iajk->jk", t1.aa, v.aabb.ovoo)
    x135 += einsum("ij->ij", x129)
    del x129
    x130 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x130 += einsum("ijab->jiba", t2.bbbb)
    x130 += einsum("ia,jb->ijba", t1.bb, t1.bb) * -1
    x131 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x131 += einsum("ijab,ikba->jk", x130, x28)
    del x28
    x135 += einsum("ij->ji", x131) * -1
    del x131
    x195 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x195 += einsum("ijab,icab->jc", x130, x22)
    del x22
    x197 += einsum("ia->ia", x195) * -1
    del x195
    x132 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x132 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x132 += einsum("ijka->kija", v.bbbb.ooov)
    x133 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x133 += einsum("ia,jika->jk", t1.bb, x132)
    del x132
    x135 += einsum("ij->ij", x133) * -1
    del x133
    x135 += einsum("ij->ij", f.bb.oo)
    x148 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x148 += einsum("ia,ij->ja", t1.bb, x135)
    x149 += einsum("ia->ia", x148) * -1
    x197 += einsum("ia->ia", x148)
    del x148
    x186 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x186 += einsum("ij,abi->jab", x135, r2.bbb)
    x198 += einsum("iab->iab", x186)
    del x186
    r2new_bab += einsum("ij,abi->abj", x135, r2.bab)
    del x135
    x136 += einsum("a,iabj->ijb", r1.a, v.aabb.ovvo)
    r2new_bab += einsum("ia,ijb->baj", t1.aa, x136)
    del x136
    x137 += einsum("a,ijba->ijb", r1.a, v.bbaa.oovv)
    r2new_bab += einsum("ia,ijb->abj", t1.bb, x137)
    del x137
    x138 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x138 += einsum("ab,ib->ia", f.bb.vv, t1.bb)
    x149 += einsum("ia->ia", x138)
    x198 += einsum("a,ib->iba", r1.b, x138) * -1
    del x138
    x139 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x139 += einsum("ia,iabj->jb", t1.aa, v.aabb.ovvo)
    x149 += einsum("ia->ia", x139)
    x197 += einsum("ia->ia", x139) * -1
    del x139
    x140 += einsum("ijka->jika", v.bbbb.ooov)
    x140 += einsum("ijka->jkia", v.bbbb.ooov) * -1
    x149 += einsum("ijab,kjia->kb", t2.bbbb, x140) * -1
    x170 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x170 += einsum("ia,jikb->jkba", t1.bb, x140)
    x172 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x172 += einsum("ijab->ijba", x170) * -1
    del x170
    x194 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x194 += einsum("ijab,kija->kb", t2.bbbb, x140)
    del x140
    x197 += einsum("ia->ia", x194) * -1
    del x194
    x141 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x141 += einsum("iabc->ibac", v.bbbb.ovvv) * -1
    x141 += einsum("iabc->ibca", v.bbbb.ovvv)
    x149 += einsum("ijab,icab->jc", x130, x141) * -1
    del x130
    x171 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x171 += einsum("ia,jbca->jibc", t1.bb, x141)
    x172 += einsum("ijab->jiab", x171) * -1
    del x171
    x189 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x189 += einsum("abi,jcba->jic", r2.bbb, x141)
    del x141
    x191 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x191 += einsum("ija->ija", x189) * -1
    del x189
    x143 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x143 += einsum("ijab->jiab", t2.bbbb)
    x143 += einsum("ijab->jiba", t2.bbbb) * -1
    x149 += einsum("ia,ijab->jb", x14, x143) * -1
    del x14
    del x143
    x146 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x146 += einsum("iabj->ijba", v.bbbb.ovvo)
    x146 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x147 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x147 += einsum("ia,ijba->jb", t1.bb, x146)
    x149 += einsum("ia->ia", x147)
    x197 += einsum("ia->ia", x147) * -1
    del x147
    x198 += einsum("a,ib->iab", r1.b, x197) * -1
    del x197
    x190 = np.zeros((nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x190 += einsum("a,ijba->ijb", r1.b, x146)
    del x146
    x191 += einsum("ija->ija", x190)
    del x190
    x192 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x192 += einsum("ia,ijb->jba", t1.bb, x191)
    del x191
    x198 += einsum("iab->iba", x192) * -1
    del x192
    x149 += einsum("ai->ia", f.bb.vo)
    r2new_bab += einsum("a,ib->bai", r1.a, x149) * -1
    del x149
    x150 = np.zeros((nocc[0], nvir[0], nvir[1]), dtype=np.float64)
    x150 += einsum("a,ibca->ibc", r1.b, v.aabb.ovvv)
    x153 += einsum("iab->iab", x150)
    x167 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x167 += einsum("iab,ijac->jcb", x150, t2.abab)
    del x150
    x198 += einsum("iab->iab", x167) * -1
    del x167
    x151 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x151 += einsum("a,ib->iab", r1.b, t1.bb)
    x151 += einsum("abi->iab", r2.bbb) * -1
    x151 += einsum("abi->iba", r2.bbb)
    x152 = np.zeros((nocc[0], nvir[0], nvir[1]), dtype=np.float64)
    x152 += einsum("iab,jcia->jcb", x151, v.aabb.ovov)
    x153 += einsum("iab->iab", x152) * -1
    r2new_aba += einsum("iab,ijac->cbj", x153, x43)
    del x153
    del x43
    x175 += einsum("iab->iab", x152)
    del x152
    x176 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x176 += einsum("iab,ijac->jbc", x175, t2.abab)
    del x175
    x198 += einsum("iab->iab", x176) * -1
    del x176
    x155 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x155 += einsum("iab,ijca->jbc", x151, x12)
    del x12
    del x151
    x157 += einsum("iab->iab", x155) * -1
    x168 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x168 += einsum("iab->iab", x155) * -1
    del x155
    x154 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x154 += einsum("abi,iajc->jbc", r2.aba, v.aabb.ovov)
    x157 += einsum("iab->iab", x154)
    r2new_aba += einsum("iab,jicb->caj", x157, t2.abab) * -1
    del x157
    x168 += einsum("iab->iab", x154)
    del x154
    x169 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x169 += einsum("iab,ijcb->jca", x168, x106)
    del x168
    del x106
    x198 += einsum("iab->iba", x169) * -1
    del x169
    x158 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x158 += einsum("abi->iab", r2.bbb) * -1
    x158 += einsum("abi->iba", r2.bbb)
    x185 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x185 += einsum("ab,icb->ica", x184, x158)
    del x184
    x198 += einsum("iab->iab", x185) * -1
    del x185
    x193 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x193 += einsum("ab,icb->ica", f.bb.vv, x158)
    x198 += einsum("iab->iba", x193) * -1
    del x193
    r2new_aba += einsum("iab,jicb->caj", x158, x62) * -1
    del x62
    x159 += einsum("iabj->ijba", v.aaaa.ovvo)
    x159 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    r2new_aba += einsum("abi,ijca->cbj", r2.aba, x159) * -1
    del x159
    x160 += einsum("a,iabc->ibc", r1.b, v.bbaa.ovvv) * -1
    r2new_aba += einsum("iab,jibc->acj", x160, t2.abab) * -1
    del x160
    x161 += einsum("ijab->ijab", v.aabb.oovv)
    x161 += einsum("ia,jabc->jibc", t1.aa, v.aabb.ovvv)
    r2new_aba += einsum("abi,ijcb->acj", r2.aba, x161)
    del x161
    x162 += einsum("a,ijka->ijk", r1.b, v.aabb.ooov)
    r2new_aba += einsum("ijk,ikab->abj", x162, x74) * -1
    del x162
    del x74
    x163 += einsum("a,ijba->ijb", r1.b, v.aabb.oovv)
    r2new_aba += einsum("ia,ijb->abj", t1.aa, x163)
    del x163
    x164 += einsum("a,iabj->jib", r1.b, v.bbaa.ovvo)
    r2new_aba += einsum("ia,jib->baj", t1.bb, x164)
    del x164
    x165 += einsum("ai->ia", f.aa.vo)
    r2new_aba += einsum("a,ib->bai", r1.b, x165) * -1
    del x165
    x166 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x166 += einsum("a,bica->ibc", r1.b, v.bbbb.vovv)
    x198 += einsum("iab->iab", x166) * -1
    del x166
    x172 += einsum("iabj->jiba", v.bbbb.ovvo)
    x172 += einsum("ijab->jiab", v.bbbb.oovv) * -1
    x173 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x173 += einsum("iab,jicb->jac", x158, x172)
    del x172
    del x158
    x198 += einsum("iab->iab", x173)
    del x173
    x177 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x177 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    x177 += einsum("ijab->jiab", t2.bbbb) * -1
    x177 += einsum("ijab->jiba", t2.bbbb)
    x178 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x178 += einsum("iab,ijcb->jca", x156, x177) * -1
    del x177
    del x156
    x198 += einsum("iab->iab", x178)
    del x178
    x180 = np.zeros((nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x180 += einsum("a,ijka->ikj", r1.b, v.bbbb.ooov)
    x182 += einsum("ijk->ijk", x180)
    del x180
    x183 = np.zeros((nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x183 += einsum("ijk,jiab->kab", x182, x123)
    del x123
    del x182
    x198 += einsum("iab->iba", x183) * -1
    del x183
    r2new_bbb = np.zeros((nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    r2new_bbb += einsum("iab->abi", x198)
    r2new_bbb += einsum("iab->bai", x198) * -1
    del x198
    r1new_a += einsum("a,ba->b", r1.a, f.aa.vv)
    r1new_b += einsum("a,ba->b", r1.b, f.bb.vv)
    r2new_aaa -= einsum("a,bi->bai", r1.a, f.aa.vo)
    r2new_aaa += einsum("a,bi->abi", r1.a, f.aa.vo)
    r2new_bab -= einsum("a,baci->cbi", r1.a, v.aabb.vvvo)
    r2new_aba -= einsum("a,bica->bci", r1.b, v.aabb.vovv)
    r2new_bbb -= einsum("a,bi->bai", r1.b, f.bb.vo)
    r2new_bbb += einsum("a,bi->abi", r1.b, f.bb.vo)

    r1new = SimpleNamespace(a=r1new_a, b=r1new_b)
    r2new = SimpleNamespace(aaa=r2new_aaa, aba=r2new_aba, bab=r2new_bab, bbb=r2new_bbb)

    r2new.aaa *= -1
    r2new.aba *= -1
    r2new.bab *= -1
    r2new.bbb *= -1

    return r1new, r2new

def hbar_ip(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    delta_oo = np.eye(nocc)
    delta_vv = np.eye(nvir)

    x0 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x0 += einsum("ia,jkia->jk", t1.bb, v.aabb.ooov)
    x56 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x56 += einsum("ij->ij", x0)
    x110 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x110 += einsum("ij->ij", x0)
    x193 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x193 += einsum("ij->ij", x0)
    h11_aa = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    h11_aa -= einsum("ij->ji", x0)
    del x0
    x1 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x1 += einsum("ijab,kajb->ik", t2.abab, v.aabb.ovov)
    x56 += einsum("ij->ji", x1)
    x110 += einsum("ij->ji", x1)
    x195 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x195 += einsum("ij->ij", x1)
    h11_aa += einsum("ij->ij", x1) * -1
    del x1
    x2 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x2 += einsum("iajb->jiab", v.aaaa.ovov)
    x2 += einsum("iajb->jiba", v.aaaa.ovov) * -1
    x47 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x47 += einsum("ijab,ijac->bc", t2.aaaa, x2)
    x50 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x50 += einsum("ab->ab", x47) * -1
    x198 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x198 += einsum("ab->ab", x47) * -1
    del x47
    x52 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x52 += einsum("ijab,ikab->jk", t2.aaaa, x2)
    x56 += einsum("ij->ji", x52) * -1
    x110 += einsum("ij->ji", x52) * -1
    del x52
    x109 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x109 += einsum("ijab,ijca->bc", t2.aaaa, x2) * -1
    h11_aa += einsum("ijab,ikba->jk", t2.aaaa, x2) * -1
    x3 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x3 += einsum("ijka->ikja", v.aaaa.ooov)
    x3 -= einsum("ijka->kija", v.aaaa.ooov)
    h11_aa -= einsum("ia,jika->kj", t1.aa, x3)
    del x3
    x4 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x4 += einsum("ia,jbia->jb", t1.bb, v.aabb.ovov)
    x7 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x7 += einsum("ia->ia", x4)
    x20 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x20 += einsum("ia->ia", x4)
    x27 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x27 += einsum("ia->ia", x4)
    x54 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x54 += einsum("ia->ia", x4)
    del x4
    x5 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x5 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x5 += einsum("iajb->jiba", v.aaaa.ovov)
    x6 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x6 += einsum("ia,ijba->jb", t1.aa, x5)
    x7 += einsum("ia->ia", x6) * -1
    x54 += einsum("ia->ia", x6) * -1
    del x6
    x55 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x55 += einsum("ia,ja->ij", t1.aa, x54)
    x56 += einsum("ij->ji", x55)
    x195 += einsum("ij->ij", x55)
    del x55
    x63 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x63 += einsum("ia,jkab->jkib", x54, t2.aaaa)
    del x54
    x68 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x68 += einsum("ijka->jika", x63) * -1
    del x63
    x129 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x129 += einsum("ijab,ikca->kjcb", t2.abab, x5) * -1
    x194 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x194 += einsum("ijab,ikba->jk", t2.aaaa, x5)
    x195 += einsum("ij->ij", x194) * -1
    del x194
    x196 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x196 += einsum("ij,kl->lijk", delta_oo.aa, x195) * -1
    x196 += einsum("ij,kl->likj", delta_oo.aa, x195)
    x196 += einsum("ij,kl->jlik", delta_oo.aa, x195)
    x196 += einsum("ij,kl->jlki", delta_oo.aa, x195) * -1
    del x195
    x7 += einsum("ia->ia", f.aa.ov)
    x8 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x8 += einsum("ia,ja->ij", t1.aa, x7)
    x110 += einsum("ij->ji", x8)
    h11_aa += einsum("ij->ij", x8) * -1
    del x8
    x197 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x197 += einsum("ia,ib->ab", t1.aa, x7)
    del x7
    x198 += einsum("ab->ab", x197)
    del x197
    x9 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x9 += einsum("ijab,iakb->jk", t2.abab, v.aabb.ovov)
    x139 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x139 += einsum("ij->ji", x9)
    x164 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x164 += einsum("ij->ji", x9)
    x234 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x234 += einsum("ij->ij", x9)
    h11_bb = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    h11_bb += einsum("ij->ij", x9) * -1
    del x9
    x10 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x10 += einsum("ia,iajk->jk", t1.aa, v.aabb.ovoo)
    x139 += einsum("ij->ij", x10)
    x164 += einsum("ij->ij", x10)
    x232 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x232 += einsum("ij->ij", x10)
    h11_bb -= einsum("ij->ji", x10)
    del x10
    x11 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x11 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x11 += einsum("iajb->jiba", v.bbbb.ovov)
    x14 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x14 += einsum("ia,ijba->jb", t1.bb, x11)
    x15 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x15 += einsum("ia->ia", x14) * -1
    x162 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x162 += einsum("ia->ia", x14) * -1
    del x14
    x108 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x108 += einsum("ijab,jkcb->ikac", t2.abab, x11) * -1
    x136 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x136 += einsum("ijab,ikba->jk", t2.bbbb, x11)
    x139 += einsum("ij->ji", x136) * -1
    x164 += einsum("ij->ji", x136) * -1
    del x136
    x216 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x216 += einsum("ijab,ijbc->ac", t2.bbbb, x11)
    x219 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x219 += einsum("ab->ab", x216) * -1
    del x216
    h11_bb += einsum("ijab,ikab->jk", t2.bbbb, x11) * -1
    x12 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x12 += einsum("ijka->ikja", v.bbbb.ooov)
    x12 -= einsum("ijka->kija", v.bbbb.ooov)
    h11_bb -= einsum("ia,jika->kj", t1.bb, x12)
    h21_abab = np.zeros((nocc[0], nocc[1], nvir[0], nocc[1]), dtype=np.float64)
    h21_abab -= einsum("ijab,jklb->ilak", t2.abab, x12)
    del x12
    x13 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x13 += einsum("ia,iajb->jb", t1.aa, v.aabb.ovov)
    x15 += einsum("ia->ia", x13)
    x25 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x25 += einsum("ia->ia", x13)
    x29 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x29 += einsum("ia->ia", x13)
    x162 += einsum("ia->ia", x13)
    del x13
    x163 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x163 += einsum("ia,ja->ij", t1.bb, x162)
    x164 += einsum("ij->ji", x163)
    x234 += einsum("ij->ij", x163)
    del x163
    x171 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x171 += einsum("ia,jkab->jkib", x162, t2.bbbb)
    del x162
    x176 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x176 += einsum("ijka->jika", x171) * -1
    del x171
    x15 += einsum("ia->ia", f.bb.ov)
    x16 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x16 += einsum("ia,ja->ij", t1.bb, x15)
    x139 += einsum("ij->ji", x16)
    h11_bb += einsum("ij->ij", x16) * -1
    del x16
    x218 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x218 += einsum("ia,ib->ab", t1.bb, x15)
    del x15
    x219 += einsum("ab->ab", x218)
    del x218
    x17 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x17 += einsum("ia,jakb->ikjb", t1.aa, v.aaaa.ovov)
    x21 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x21 += einsum("ijka->ijka", x17)
    x65 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x65 += einsum("ia,jkla->jilk", t1.aa, x17)
    x66 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x66 += einsum("ijkl->ijkl", x65)
    x196 += einsum("ijkl->klji", x65)
    x196 += einsum("ijkl->lkji", x65) * -1
    del x65
    x200 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x200 -= einsum("ijka->ikja", x17)
    x200 += einsum("ijka->ijka", x17)
    x205 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x205 += einsum("ijka->ikja", x17)
    x205 -= einsum("ijka->ijka", x17)
    del x17
    x18 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x18 -= einsum("iajb->jiab", v.aaaa.ovov)
    x18 += einsum("iajb->jiba", v.aaaa.ovov)
    x19 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x19 += einsum("ia,ijba->jb", t1.aa, x18)
    x20 -= einsum("ia->ia", x19)
    x21 += einsum("ij,ka->jika", delta_oo.aa, x20)
    del x20
    h12_aaaa = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    h12_aaaa -= einsum("ijka->ikja", x21)
    h12_aaaa += einsum("ijka->ijka", x21)
    del x21
    x27 -= einsum("ia->ia", x19)
    del x19
    x114 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x114 += einsum("ijab,ikca->kjcb", t2.abab, x18)
    x116 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x116 -= einsum("ijab->ijab", x114)
    x177 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x177 -= einsum("ijab->ijab", x114)
    x248 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x248 -= einsum("ijab->ijab", x114)
    del x114
    x22 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x22 += einsum("ia,jakb->ijkb", t1.aa, v.aabb.ovov)
    x220 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x220 += einsum("ijka->jika", x22)
    h12_abab = np.zeros((nocc[0], nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    h12_abab += einsum("ijka->ikja", x22)
    del x22
    x23 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x23 -= einsum("iajb->jiab", v.bbbb.ovov)
    x23 += einsum("iajb->jiba", v.bbbb.ovov)
    x24 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x24 += einsum("ia,ijba->jb", t1.bb, x23)
    x25 -= einsum("ia->ia", x24)
    x29 -= einsum("ia->ia", x24)
    del x24
    x30 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x30 += einsum("ij,ka->jika", delta_oo.bb, x29)
    del x29
    x70 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x70 += einsum("ijab,jkcb->ikac", t2.abab, x23)
    x71 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x71 -= einsum("ijab->ijab", x70)
    x97 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x97 -= einsum("ijab->ijab", x70)
    x242 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x242 -= einsum("ijab->ijab", x70)
    del x70
    x25 += einsum("ia->ia", f.bb.ov)
    h12_abab -= einsum("ij,ka->jkia", delta_oo.aa, x25)
    h21_abab += einsum("ia,jkba->jkbi", x25, t2.abab)
    del x25
    x26 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x26 += einsum("ia,jbka->jikb", t1.bb, v.aabb.ovov)
    x103 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x103 += einsum("ijka->ikja", x26)
    x224 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x224 += einsum("ijka->ikja", x26)
    h12_baba = np.zeros((nocc[1], nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    h12_baba += einsum("ijka->jika", x26)
    del x26
    x27 += einsum("ia->ia", f.aa.ov)
    h12_baba -= einsum("ij,ka->jkia", delta_oo.bb, x27)
    h21_baba = np.zeros((nocc[1], nocc[0], nvir[1], nocc[0]), dtype=np.float64)
    h21_baba += einsum("ia,jkab->kjbi", x27, t2.abab)
    del x27
    x28 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x28 += einsum("ia,jbka->ijkb", t1.bb, v.bbbb.ovov)
    x30 += einsum("ijka->ijka", x28)
    h12_bbbb = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    h12_bbbb -= einsum("ijka->ikja", x30)
    h12_bbbb += einsum("ijka->ijka", x30)
    del x30
    x173 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x173 += einsum("ia,jkla->jilk", t1.bb, x28)
    x174 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x174 += einsum("ijkl->ijkl", x173)
    x235 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x235 += einsum("ijkl->klji", x173)
    x235 += einsum("ijkl->lkji", x173) * -1
    del x173
    x211 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x211 -= einsum("ijka->ikja", x28)
    x211 += einsum("ijka->ijka", x28)
    del x28
    x31 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x31 += einsum("ijab,ikjb->ka", t2.abab, v.aabb.ooov)
    x58 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x58 += einsum("ia->ia", x31)
    x111 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x111 += einsum("ia->ia", x31) * -1
    del x31
    x32 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x32 += einsum("ijab,jbca->ic", t2.abab, v.bbaa.ovvv)
    x58 += einsum("ia->ia", x32) * -1
    x111 += einsum("ia->ia", x32)
    del x32
    x33 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x33 += einsum("iabc->ibac", v.aaaa.ovvv)
    x33 += einsum("iabc->ibca", v.aaaa.ovvv) * -1
    x34 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x34 += einsum("ijab,icab->jc", t2.aaaa, x33)
    x58 += einsum("ia->ia", x34) * -1
    del x34
    x111 += einsum("ijab,icba->jc", t2.aaaa, x33) * -1
    del x33
    x35 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x35 += einsum("ijka->ikja", v.aaaa.ooov)
    x35 += einsum("ijka->kija", v.aaaa.ooov) * -1
    x36 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x36 += einsum("ijab,jikb->ka", t2.aaaa, x35)
    x58 += einsum("ia->ia", x36) * -1
    del x36
    x53 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x53 += einsum("ia,ijka->jk", t1.aa, x35)
    del x35
    x56 += einsum("ij->ij", x53) * -1
    x57 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x57 += einsum("ia,ij->ja", t1.aa, x56)
    del x56
    x58 += einsum("ia->ia", x57)
    del x57
    x110 += einsum("ij->ij", x53) * -1
    x193 += einsum("ij->ij", x53) * -1
    del x53
    x196 += einsum("ij,kl->kijl", delta_oo.aa, x193) * -1
    x196 += einsum("ij,kl->kilj", delta_oo.aa, x193)
    x196 += einsum("ij,kl->jkil", delta_oo.aa, x193)
    x196 += einsum("ij,kl->jkli", delta_oo.aa, x193) * -1
    del x193
    x37 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x37 += einsum("ijab,kcjb->ikac", t2.abab, v.aabb.ovov)
    x40 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x40 += einsum("ijab->ijab", x37)
    x61 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x61 += einsum("ijab->ijab", x37)
    x107 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x107 += einsum("ijab->jiab", x37)
    x189 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x189 += einsum("ijab->ijab", x37)
    x223 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x223 += einsum("ijab->jiab", x37)
    del x37
    x38 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x38 += einsum("ijab->jiab", t2.aaaa)
    x38 += einsum("ijab->jiba", t2.aaaa) * -1
    x39 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x39 += einsum("ijab,ikca->kjcb", x38, x5)
    del x5
    x40 += einsum("ijab->jiba", x39)
    x41 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x41 += einsum("ia,jiba->jb", t1.aa, x40)
    del x40
    x58 += einsum("ia->ia", x41) * -1
    del x41
    x61 += einsum("ijab->jiba", x39)
    del x39
    x107 += einsum("ijab,ikac->jkcb", x2, x38)
    del x2
    del x38
    x42 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x42 += einsum("ijab->jiab", t2.aaaa) * -1
    x42 += einsum("ijab->jiba", t2.aaaa)
    x43 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x43 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x42)
    x44 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x44 += einsum("ia,jiba->jb", t1.bb, x43) * -1
    x58 += einsum("ia->ia", x44) * -1
    del x44
    x108 += einsum("ijab->ijab", x43) * -1
    del x43
    x111 += einsum("ia,ijba->jb", f.aa.ov, x42) * -1
    del x42
    x45 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x45 += einsum("ia,iabc->bc", t1.bb, v.bbaa.ovvv)
    x50 += einsum("ab->ab", x45) * -1
    x109 += einsum("ab->ab", x45)
    x198 += einsum("ab->ab", x45) * -1
    del x45
    x46 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x46 += einsum("ijab,icjb->ac", t2.abab, v.aabb.ovov)
    x50 += einsum("ab->ab", x46)
    x109 += einsum("ab->ab", x46) * -1
    x198 += einsum("ab->ab", x46)
    del x46
    x48 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x48 += einsum("iabc->ibac", v.aaaa.ovvv) * -1
    x48 += einsum("iabc->ibca", v.aaaa.ovvv)
    x49 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x49 += einsum("ia,ibca->bc", t1.aa, x48)
    x50 += einsum("ab->ab", x49) * -1
    x51 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x51 += einsum("ia,ba->ib", t1.aa, x50)
    del x50
    x58 += einsum("ia->ia", x51)
    del x51
    h21_aaaa = np.zeros((nocc[0], nocc[0], nvir[0], nocc[0]), dtype=np.float64)
    h21_aaaa += einsum("ij,ka->kiaj", delta_oo.aa, x58)
    h21_aaaa += einsum("ij,ka->jkai", delta_oo.aa, x58) * -1
    del x58
    x198 += einsum("ab->ab", x49) * -1
    del x49
    x109 += einsum("ia,ibac->bc", t1.aa, x48) * -1
    del x48
    x59 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x59 += einsum("ijab,kacb->ijkc", t2.aaaa, v.aaaa.ovvv)
    x68 += einsum("ijka->ijka", x59)
    del x59
    x60 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x60 += einsum("ia,jbca->ijcb", t1.aa, v.aaaa.ovvv)
    x61 += einsum("ijab->ijab", x60)
    del x60
    x62 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x62 += einsum("ia,jkba->ijkb", t1.aa, x61)
    del x61
    x68 += einsum("ijka->ijka", x62)
    del x62
    x64 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x64 += einsum("ijab,kalb->ijkl", t2.aaaa, v.aaaa.ovov)
    x66 += einsum("ijkl->jilk", x64)
    x67 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x67 += einsum("ia,jkil->jkla", t1.aa, x66)
    del x66
    x68 += einsum("ijka->jika", x67) * -1
    del x67
    h21_aaaa += einsum("ijka->ijak", x68) * -1
    h21_aaaa += einsum("ijka->jiak", x68)
    del x68
    h22_aaaaaa = np.zeros((nocc[0], nocc[0], nvir[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    h22_aaaaaa += einsum("ab,ijkl->jiblka", delta_vv.aa, x64)
    h22_aaaaaa += einsum("ab,ijkl->jibkla", delta_vv.aa, x64) * -1
    del x64
    x69 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x69 += einsum("ia,jiba->jb", f.bb.ov, t2.abab)
    x77 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x77 += einsum("ia->ia", x69)
    x111 += einsum("ia->ia", x69)
    del x69
    x71 += einsum("iabj->jiba", v.bbaa.ovvo)
    x72 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x72 += einsum("ia,jiba->jb", t1.bb, x71)
    del x71
    x77 += einsum("ia->ia", x72)
    del x72
    x73 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x73 -= einsum("ijab->jiab", t2.aaaa)
    x73 += einsum("ijab->jiba", t2.aaaa)
    x74 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x74 += einsum("ia,ijba->jb", f.aa.ov, x73)
    x77 -= einsum("ia->ia", x74)
    del x74
    x96 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x96 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x73)
    x97 -= einsum("ijab->ijab", x96)
    x242 -= einsum("ijab->ijab", x96)
    del x96
    h22_aaabab = np.zeros((nocc[0], nocc[0], nvir[0], nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    h22_aaabab += einsum("ij,klab->kialjb", delta_oo.aa, x242)
    h22_aaabab -= einsum("ij,klab->jkalib", delta_oo.aa, x242)
    h22_ababbb = np.zeros((nocc[0], nocc[1], nvir[0], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    h22_ababbb += einsum("ij,klab->kjalib", delta_oo.bb, x242)
    h22_ababbb -= einsum("ij,klab->kjailb", delta_oo.bb, x242)
    del x242
    h21_abab -= einsum("iajk,ilba->lkbj", v.aabb.ovoo, x73)
    del x73
    x75 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x75 += einsum("iabj->ijba", v.aaaa.ovvo)
    x75 -= einsum("ijab->ijab", v.aaaa.oovv)
    x76 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x76 += einsum("ia,ijba->jb", t1.aa, x75)
    x77 += einsum("ia->ia", x76)
    del x76
    h21_aaaa -= einsum("ij,ka->kiaj", delta_oo.aa, x77)
    h21_aaaa += einsum("ij,ka->jkai", delta_oo.aa, x77)
    del x77
    x82 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x82 += einsum("ia,jkba->ijkb", t1.aa, x75)
    del x75
    x86 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x86 -= einsum("ijka->ijka", x82)
    del x82
    x78 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x78 += einsum("ijab,kljb->ikla", t2.abab, v.aabb.ooov)
    x86 += einsum("ijka->ijka", x78)
    del x78
    x79 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x79 -= einsum("ijka->ikja", v.aaaa.ooov)
    x79 += einsum("ijka->kija", v.aaaa.ooov)
    h21_baba -= einsum("ijab,kila->jlbk", t2.abab, x79)
    x80 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x80 += einsum("ijab->jiab", t2.aaaa)
    x80 -= einsum("ijab->jiba", t2.aaaa)
    x81 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x81 += einsum("ijka,jlab->iklb", x79, x80)
    del x79
    x86 += einsum("ijka->kija", x81)
    del x81
    x188 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x188 += einsum("ijab,ikbc->jkac", x18, x80)
    del x18
    x189 += einsum("ijab->jiba", x188)
    del x188
    h22_aaaaaa -= einsum("ij,klab->kiajlb", delta_oo.aa, x189)
    h22_aaaaaa += einsum("ij,klab->kialjb", delta_oo.aa, x189)
    h22_aaaaaa += einsum("ij,klab->jkailb", delta_oo.aa, x189)
    h22_aaaaaa -= einsum("ij,klab->jkalib", delta_oo.aa, x189)
    del x189
    x83 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x83 += einsum("ia,jkla->ijlk", t1.aa, v.aaaa.ooov)
    x84 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x84 += einsum("ijkl->ikjl", x83)
    x84 -= einsum("ijkl->ijkl", x83)
    x85 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x85 += einsum("ia,jikl->jkla", t1.aa, x84)
    del x84
    x86 -= einsum("ijka->ijka", x85)
    del x85
    h21_aaaa += einsum("ijka->ikaj", x86)
    h21_aaaa -= einsum("ijka->kiaj", x86)
    del x86
    x192 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x192 += einsum("ijkl->jikl", x83)
    del x83
    x87 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x87 += einsum("ia,jkil->jkla", t1.aa, v.aaaa.oooo)
    x89 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x89 += einsum("ijka->ijka", x87)
    del x87
    x88 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x88 += einsum("ia,jkab->ikjb", f.aa.ov, t2.aaaa)
    x89 += einsum("ijka->ijka", x88)
    del x88
    x89 -= einsum("ijak->ijka", v.aaaa.oovo)
    h21_aaaa += einsum("ijka->jkai", x89)
    h21_aaaa -= einsum("ijka->kjai", x89)
    del x89
    x90 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x90 += einsum("ab,ib->ia", f.aa.vv, t1.aa)
    x94 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x94 += einsum("ia->ia", x90)
    x95 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x95 -= einsum("ia->ia", x90)
    del x90
    x91 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x91 += einsum("ia,ja->ij", f.aa.ov, t1.aa)
    x92 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x92 += einsum("ij->ij", x91)
    x191 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x191 += einsum("ij->ij", x91)
    del x91
    x92 += einsum("ij->ij", f.aa.oo)
    x93 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x93 += einsum("ia,ij->ja", t1.aa, x92)
    del x92
    x94 -= einsum("ia->ia", x93)
    x95 += einsum("ia->ia", x93)
    del x93
    x94 += einsum("ai->ia", f.aa.vo)
    h21_aaaa -= einsum("ij,ka->kjai", delta_oo.aa, x94)
    del x94
    x95 -= einsum("ai->ia", f.aa.vo)
    h21_aaaa -= einsum("ij,ka->jkai", delta_oo.aa, x95)
    del x95
    x97 += einsum("iabj->jiba", v.bbaa.ovvo)
    h21_abab += einsum("ia,jkba->jibk", t1.bb, x97)
    del x97
    x98 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x98 += einsum("ia,jabc->ijbc", t1.bb, v.bbaa.ovvv)
    x100 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x100 += einsum("ijab->jiab", x98)
    x225 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x225 -= einsum("ijab->jiab", x98)
    del x98
    x99 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x99 += einsum("ijab,ickb->jkac", t2.abab, v.aabb.ovov)
    x100 -= einsum("ijab->jiab", x99)
    x225 += einsum("ijab->jiab", x99)
    del x99
    x100 += einsum("ijab->ijab", v.bbaa.oovv)
    h21_abab += einsum("ia,jkba->ikbj", t1.aa, x100)
    del x100
    x101 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x101 += einsum("ia,jkla->jkil", t1.bb, v.aabb.ooov)
    x105 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x105 += einsum("ijkl->ijlk", x101)
    x209 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x209 += einsum("ijkl->ijlk", x101) * -1
    del x101
    x102 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x102 += einsum("ijab,kalb->ikjl", t2.abab, v.aabb.ovov)
    x105 += einsum("ijkl->jilk", x102)
    x209 += einsum("ijkl->jilk", x102) * -1
    del x102
    x103 += einsum("iajk->ijka", v.aabb.ovoo)
    x104 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x104 += einsum("ia,jkla->ijkl", t1.aa, x103)
    del x103
    x105 += einsum("ijkl->jikl", x104)
    x209 += einsum("ijkl->jikl", x104) * -1
    del x104
    x105 += einsum("ijkl->ijkl", v.aabb.oooo)
    h21_abab += einsum("ia,ijkl->jlak", t1.aa, x105) * -1
    h21_baba += einsum("ia,jkil->lkaj", t1.bb, x105) * -1
    del x105
    x106 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x106 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x106 += einsum("ijka->kija", v.aaaa.ooov)
    x111 += einsum("ijab,jikb->ka", t2.aaaa, x106) * -1
    del x106
    x107 += einsum("iabj->ijba", v.aaaa.ovvo)
    x107 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x111 += einsum("ia,ijba->jb", t1.aa, x107)
    del x107
    x108 += einsum("iabj->jiba", v.bbaa.ovvo)
    x111 += einsum("ia,jiba->jb", t1.bb, x108)
    del x108
    x109 += einsum("ab->ab", f.aa.vv)
    x111 += einsum("ia,ba->ib", t1.aa, x109)
    del x109
    x110 += einsum("ij->ij", f.aa.oo)
    x111 += einsum("ia,ij->ja", t1.aa, x110) * -1
    x209 += einsum("ij,kl->klji", delta_oo.bb, x110)
    del x110
    x111 += einsum("ai->ia", f.aa.vo)
    h21_abab += einsum("ij,ka->kjai", delta_oo.bb, x111) * -1
    del x111
    x112 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x112 -= einsum("ijab->jiab", t2.bbbb)
    x112 += einsum("ijab->jiba", t2.bbbb)
    x115 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x115 += einsum("iajb,jkcb->ikac", v.aabb.ovov, x112)
    x116 -= einsum("ijab->ijab", x115)
    x248 -= einsum("ijab->ijab", x115)
    del x115
    h22_babaaa = np.zeros((nocc[1], nocc[0], nvir[1], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    h22_babaaa += einsum("ij,klab->libkja", delta_oo.aa, x248)
    h22_babaaa -= einsum("ij,klab->libjka", delta_oo.aa, x248)
    h22_bbbaba = np.zeros((nocc[1], nocc[1], nvir[1], nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    h22_bbbaba += einsum("ij,klab->ljbkia", delta_oo.bb, x248)
    h22_bbbaba -= einsum("ij,klab->ilbkja", delta_oo.bb, x248)
    del x248
    x179 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x179 += einsum("ia,ijba->jb", f.bb.ov, x112)
    x181 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x181 -= einsum("ia->ia", x179)
    del x179
    h21_baba -= einsum("ijka,klba->ljbi", v.aabb.ooov, x112)
    x113 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x113 += einsum("ia,jbca->jibc", t1.bb, v.aabb.ovvv)
    x116 += einsum("ijab->ijab", x113)
    x251 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x251 += einsum("ijab->ijab", x113)
    x254 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x254 -= einsum("ijab->ijab", x113)
    del x113
    x116 += einsum("iabj->ijab", v.aabb.ovvo)
    h21_baba += einsum("ia,jkab->kibj", t1.aa, x116)
    del x116
    x117 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x117 += einsum("ijab,kajc->ikbc", t2.abab, v.aabb.ovov)
    x118 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x118 -= einsum("ijab->jiab", x117)
    x221 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x221 += einsum("ijab->jiab", x117)
    del x117
    x118 += einsum("ijab->ijab", v.aabb.oovv)
    h21_baba += einsum("ia,jkba->ikbj", t1.bb, x118)
    del x118
    x119 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x119 += einsum("ia,ijab->jb", f.aa.ov, t2.abab)
    x140 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x140 += einsum("ia->ia", x119)
    x181 += einsum("ia->ia", x119)
    del x119
    x120 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x120 += einsum("ijab,iajk->kb", t2.abab, v.aabb.ovoo)
    x140 += einsum("ia->ia", x120) * -1
    x166 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x166 += einsum("ia->ia", x120)
    del x120
    x121 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x121 += einsum("ijab,iacb->jc", t2.abab, v.aabb.ovvv)
    x140 += einsum("ia->ia", x121)
    x166 += einsum("ia->ia", x121) * -1
    del x121
    x122 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x122 += einsum("iabc->ibac", v.bbbb.ovvv)
    x122 += einsum("iabc->ibca", v.bbbb.ovvv) * -1
    x134 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x134 += einsum("ia,ibca->bc", t1.bb, x122)
    x135 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x135 += einsum("ab->ab", x134) * -1
    x160 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x160 += einsum("ab->ab", x134) * -1
    del x134
    x140 += einsum("ijab,icba->jc", t2.bbbb, x122) * -1
    del x122
    x123 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x123 += einsum("ijka->ikja", v.bbbb.ooov)
    x123 += einsum("ijka->kija", v.bbbb.ooov) * -1
    x140 += einsum("ijab,jika->kb", t2.bbbb, x123) * -1
    x155 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x155 += einsum("ijab,ijka->kb", t2.bbbb, x123)
    del x123
    x166 += einsum("ia->ia", x155) * -1
    del x155
    x124 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x124 += einsum("ijab,iakc->jkbc", t2.abab, v.aabb.ovov)
    x126 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x126 += einsum("ijab->jiab", x124)
    x157 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x157 += einsum("ijab->ijab", x124)
    x169 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x169 += einsum("ijab->ijab", x124)
    x215 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x215 += einsum("ijab->jiab", x124)
    x229 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x229 += einsum("ijab->ijab", x124)
    del x124
    x125 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x125 += einsum("ijab->jiab", t2.bbbb)
    x125 += einsum("ijab->jiba", t2.bbbb) * -1
    x126 += einsum("ijab,ikbc->jkca", x11, x125)
    del x11
    x126 += einsum("iabj->ijba", v.bbbb.ovvo)
    x126 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x140 += einsum("ia,ijba->jb", t1.bb, x126)
    del x126
    x127 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x127 += einsum("ijab->jiab", t2.bbbb) * -1
    x127 += einsum("ijab->jiba", t2.bbbb)
    x128 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x128 += einsum("iajb,jkcb->ikac", v.aabb.ovov, x127)
    x129 += einsum("ijab->ijab", x128) * -1
    x159 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x159 += einsum("ia,ijab->jb", t1.aa, x128) * -1
    del x128
    x166 += einsum("ia->ia", x159) * -1
    del x159
    x140 += einsum("ia,ijba->jb", f.bb.ov, x127) * -1
    del x127
    x129 += einsum("iabj->ijab", v.aabb.ovvo)
    x140 += einsum("ia,ijab->jb", t1.aa, x129)
    del x129
    x130 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x130 += einsum("ia,iabc->bc", t1.aa, v.aabb.ovvv)
    x135 += einsum("ab->ab", x130)
    x160 += einsum("ab->ab", x130)
    x219 += einsum("ab->ab", x130) * -1
    del x130
    x131 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x131 += einsum("ijab,iajc->bc", t2.abab, v.aabb.ovov)
    x135 += einsum("ab->ab", x131) * -1
    x160 += einsum("ab->ab", x131) * -1
    x219 += einsum("ab->ab", x131)
    del x131
    x132 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x132 += einsum("iajb->jiab", v.bbbb.ovov)
    x132 += einsum("iajb->jiba", v.bbbb.ovov) * -1
    x133 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x133 += einsum("ijab,ijbc->ac", t2.bbbb, x132)
    x135 += einsum("ab->ab", x133) * -1
    x160 += einsum("ab->ab", x133) * -1
    del x133
    x161 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x161 += einsum("ia,ba->ib", t1.bb, x160)
    del x160
    x166 += einsum("ia->ia", x161) * -1
    del x161
    x156 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x156 += einsum("ijab,ikac->jkbc", x125, x132)
    del x125
    x157 += einsum("ijab->ijab", x156)
    x158 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x158 += einsum("ia,jiba->jb", t1.bb, x157)
    del x157
    x166 += einsum("ia->ia", x158) * -1
    del x158
    x169 += einsum("ijab->ijab", x156)
    del x156
    x233 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x233 += einsum("ijab,ikab->jk", t2.bbbb, x132)
    del x132
    x234 += einsum("ij->ij", x233) * -1
    del x233
    x235 += einsum("ij,kl->lijk", delta_oo.bb, x234) * -1
    x235 += einsum("ij,kl->likj", delta_oo.bb, x234)
    x235 += einsum("ij,kl->jlik", delta_oo.bb, x234)
    x235 += einsum("ij,kl->jlki", delta_oo.bb, x234) * -1
    del x234
    x135 += einsum("ab->ab", f.bb.vv)
    x140 += einsum("ia,ba->ib", t1.bb, x135)
    del x135
    x137 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x137 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x137 += einsum("ijka->kija", v.bbbb.ooov)
    x138 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x138 += einsum("ia,jika->jk", t1.bb, x137)
    del x137
    x139 += einsum("ij->ij", x138) * -1
    x164 += einsum("ij->ij", x138) * -1
    x165 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x165 += einsum("ia,ij->ja", t1.bb, x164)
    del x164
    x166 += einsum("ia->ia", x165)
    del x165
    x232 += einsum("ij->ij", x138) * -1
    del x138
    x235 += einsum("ij,kl->kijl", delta_oo.bb, x232) * -1
    x235 += einsum("ij,kl->kilj", delta_oo.bb, x232)
    x235 += einsum("ij,kl->jkil", delta_oo.bb, x232)
    x235 += einsum("ij,kl->jkli", delta_oo.bb, x232) * -1
    del x232
    x139 += einsum("ij->ij", f.bb.oo)
    x140 += einsum("ia,ij->ja", t1.bb, x139) * -1
    x209 += einsum("ij,kl->jikl", delta_oo.aa, x139)
    del x139
    x140 += einsum("ai->ia", f.bb.vo)
    h21_baba += einsum("ij,ka->kjai", delta_oo.aa, x140) * -1
    del x140
    x141 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x141 += einsum("ia,jkil->jkla", t1.bb, v.bbbb.oooo)
    x143 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x143 += einsum("ijka->ijka", x141)
    del x141
    x142 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x142 += einsum("ia,jkba->ijkb", f.bb.ov, t2.bbbb)
    x143 += einsum("ijka->ijka", x142)
    del x142
    x143 -= einsum("ijak->ijka", v.bbbb.oovo)
    h21_bbbb = np.zeros((nocc[1], nocc[1], nvir[1], nocc[1]), dtype=np.float64)
    h21_bbbb += einsum("ijka->jkai", x143)
    h21_bbbb -= einsum("ijka->kjai", x143)
    del x143
    x144 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x144 += einsum("ijab,iakl->jklb", t2.abab, v.aabb.ovoo)
    x152 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x152 += einsum("ijka->ijka", x144)
    del x144
    x145 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x145 -= einsum("ijka->ikja", v.bbbb.ooov)
    x145 += einsum("ijka->kija", v.bbbb.ooov)
    x146 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x146 += einsum("ijab,kilb->jkla", x112, x145)
    del x112
    del x145
    x152 += einsum("ijka->ijka", x146)
    del x146
    x147 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x147 += einsum("iabj->ijba", v.bbbb.ovvo)
    x147 -= einsum("ijab->ijab", v.bbbb.oovv)
    x148 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x148 += einsum("ia,jkba->ijkb", t1.bb, x147)
    x152 -= einsum("ijka->ijka", x148)
    del x148
    x180 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x180 += einsum("ia,ijba->jb", t1.bb, x147)
    del x147
    x181 += einsum("ia->ia", x180)
    del x180
    x149 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x149 += einsum("ia,jkla->ijlk", t1.bb, v.bbbb.ooov)
    x150 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x150 += einsum("ijkl->ikjl", x149)
    x150 -= einsum("ijkl->ijkl", x149)
    x151 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x151 += einsum("ia,jikl->jkla", t1.bb, x150)
    del x150
    x152 -= einsum("ijka->ijka", x151)
    del x151
    h21_bbbb += einsum("ijka->ikaj", x152)
    h21_bbbb -= einsum("ijka->kiaj", x152)
    del x152
    x231 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x231 += einsum("ijkl->jikl", x149)
    del x149
    x153 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x153 += einsum("iabc->ibac", v.bbbb.ovvv) * -1
    x153 += einsum("iabc->ibca", v.bbbb.ovvv)
    x154 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x154 += einsum("ijab,icba->jc", t2.bbbb, x153)
    x166 += einsum("ia->ia", x154) * -1
    del x154
    h21_bbbb += einsum("ij,ka->kiaj", delta_oo.bb, x166)
    h21_bbbb += einsum("ij,ka->jkai", delta_oo.bb, x166) * -1
    del x166
    x217 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x217 += einsum("ia,ibca->bc", t1.bb, x153)
    del x153
    x219 += einsum("ab->ab", x217) * -1
    del x217
    x167 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x167 += einsum("ijab,kbca->jikc", t2.bbbb, v.bbbb.ovvv)
    x176 += einsum("ijka->ijka", x167)
    del x167
    x168 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x168 += einsum("ia,jbca->ijcb", t1.bb, v.bbbb.ovvv)
    x169 += einsum("ijab->ijab", x168)
    del x168
    x170 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x170 += einsum("ia,jkba->ijkb", t1.bb, x169)
    del x169
    x176 += einsum("ijka->ijka", x170)
    del x170
    x172 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x172 += einsum("ijab,kbla->ijlk", t2.bbbb, v.bbbb.ovov)
    x174 += einsum("ijkl->jilk", x172)
    x175 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x175 += einsum("ia,jkil->jkla", t1.bb, x174)
    del x174
    x176 += einsum("ijka->jika", x175) * -1
    del x175
    h21_bbbb += einsum("ijka->ijak", x176) * -1
    h21_bbbb += einsum("ijka->jiak", x176)
    del x176
    h22_bbbbbb = np.zeros((nocc[1], nocc[1], nvir[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    h22_bbbbbb += einsum("ab,ijkl->jiblka", delta_vv.bb, x172)
    h22_bbbbbb += einsum("ab,ijkl->jibkla", delta_vv.bb, x172) * -1
    del x172
    x177 += einsum("iabj->ijab", v.aabb.ovvo)
    x178 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x178 += einsum("ia,ijab->jb", t1.aa, x177)
    del x177
    x181 += einsum("ia->ia", x178)
    del x178
    h21_bbbb -= einsum("ij,ka->kiaj", delta_oo.bb, x181)
    h21_bbbb += einsum("ij,ka->jkai", delta_oo.bb, x181)
    del x181
    x182 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x182 += einsum("ab,ib->ia", f.bb.vv, t1.bb)
    x186 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x186 -= einsum("ia->ia", x182)
    x187 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x187 += einsum("ia->ia", x182)
    del x182
    x183 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x183 += einsum("ia,ja->ij", f.bb.ov, t1.bb)
    x184 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x184 += einsum("ij->ij", x183)
    x230 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x230 += einsum("ij->ij", x183)
    del x183
    x184 += einsum("ij->ij", f.bb.oo)
    x185 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x185 += einsum("ia,ij->ja", t1.bb, x184)
    del x184
    x186 += einsum("ia->ia", x185)
    x187 -= einsum("ia->ia", x185)
    del x185
    x186 -= einsum("ai->ia", f.bb.vo)
    h21_bbbb -= einsum("ij,ka->jkai", delta_oo.bb, x186)
    del x186
    x187 += einsum("ai->ia", f.bb.vo)
    h21_bbbb -= einsum("ij,ka->kjai", delta_oo.bb, x187)
    del x187
    x190 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x190 += einsum("ijab,kclb->ijklac", t2.aaaa, v.aaaa.ovov)
    h22_aaaaaa -= einsum("ijklab->ijaklb", x190)
    h22_aaaaaa += einsum("ijklab->ijalkb", x190)
    h22_aaaaaa += einsum("ijklab->jiaklb", x190)
    h22_aaaaaa -= einsum("ijklab->jialkb", x190)
    del x190
    x191 += einsum("ij->ij", f.aa.oo)
    x192 += einsum("ij,kl->jikl", delta_oo.aa, x191)
    del x191
    x196 += einsum("ijkl->ikjl", x192)
    x196 += einsum("ijkl->kijl", x192) * -1
    x196 += einsum("ijkl->iklj", x192) * -1
    x196 += einsum("ijkl->kilj", x192)
    del x192
    x196 += einsum("ijkl->kijl", v.aaaa.oooo)
    x196 += einsum("ijkl->kilj", v.aaaa.oooo) * -1
    h22_aaaaaa += einsum("ab,ijkl->lkbjia", delta_vv.aa, x196) * -1
    del x196
    x198 += einsum("ab->ab", f.aa.vv) * -1
    h22_abaaba = np.zeros((nocc[0], nocc[1], nvir[0], nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    h22_abaaba += einsum("ij,kl,ab->jlaikb", delta_oo.aa, delta_oo.bb, x198) * -1
    x199 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x199 -= einsum("ij,kl->jkli", delta_oo.aa, delta_oo.aa)
    x199 += einsum("ij,kl->jlik", delta_oo.aa, delta_oo.aa)
    h22_aaaaaa += einsum("ab,ijkl->lkajib", x198, x199) * -1
    del x198
    del x199
    x200 += einsum("ijka->jkia", v.aaaa.ooov)
    x200 -= einsum("ijka->jika", v.aaaa.ooov)
    x201 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x201 += einsum("ia,jkib->jkab", t1.aa, x200)
    del x200
    x204 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x204 -= einsum("ijab->jiab", x201)
    x223 -= einsum("ijab->jiab", x201)
    del x201
    x202 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x202 -= einsum("iabc->ibac", v.aaaa.ovvv)
    x202 += einsum("iabc->ibca", v.aaaa.ovvv)
    x203 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x203 += einsum("ia,jbca->ijbc", t1.aa, x202)
    x204 -= einsum("ijab->jiab", x203)
    x223 -= einsum("ijab->jiab", x203)
    del x203
    x207 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x207 += einsum("ia,jbac->ijbc", t1.aa, x202)
    del x202
    x208 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x208 -= einsum("ijab->jiab", x207)
    del x207
    x204 += einsum("iabj->ijba", v.aaaa.ovvo)
    x204 -= einsum("ijab->ijab", v.aaaa.oovv)
    h22_aaaaaa += einsum("ij,klab->jlaikb", delta_oo.aa, x204)
    h22_aaaaaa -= einsum("ij,klab->ljaikb", delta_oo.aa, x204)
    del x204
    x205 -= einsum("ijka->jkia", v.aaaa.ooov)
    x205 += einsum("ijka->jika", v.aaaa.ooov)
    x206 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x206 += einsum("ia,jkib->jkab", t1.aa, x205)
    del x205
    x208 -= einsum("ijab->jiab", x206)
    del x206
    x208 += einsum("ijab->ijab", v.aaaa.oovv)
    x208 -= einsum("iabj->ijba", v.aaaa.ovvo)
    h22_aaaaaa -= einsum("ij,klab->ljakib", delta_oo.aa, x208)
    h22_aaaaaa += einsum("ij,klab->jlakib", delta_oo.aa, x208)
    del x208
    x209 += einsum("ijkl->ijkl", v.aabb.oooo) * -1
    h22_babbab = np.zeros((nocc[1], nocc[0], nvir[1], nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    h22_babbab += einsum("ab,ijkl->ljbkia", delta_vv.bb, x209) * -1
    h22_abaaba += einsum("ab,ijkl->jlbika", delta_vv.aa, x209) * -1
    del x209
    x210 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x210 += einsum("ijab->jiab", t2.bbbb)
    x210 -= einsum("ijab->jiba", t2.bbbb)
    x215 += einsum("ijab,ikca->kjbc", x210, x23)
    del x23
    x211 += einsum("ijka->jkia", v.bbbb.ooov)
    x211 -= einsum("ijka->jika", v.bbbb.ooov)
    x212 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x212 += einsum("ia,jkib->jkba", t1.bb, x211)
    x215 -= einsum("ijab->jiba", x212)
    x237 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x237 -= einsum("ijab->jiba", x212)
    del x212
    x238 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x238 += einsum("ia,jikb->jkba", t1.bb, x211)
    del x211
    x241 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x241 -= einsum("ijab->jiba", x238)
    del x238
    x213 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x213 -= einsum("iabc->ibac", v.bbbb.ovvv)
    x213 += einsum("iabc->ibca", v.bbbb.ovvv)
    x214 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x214 += einsum("ia,jbca->jibc", t1.bb, x213)
    del x213
    x215 -= einsum("ijab->ijab", x214)
    x237 -= einsum("ijab->ijab", x214)
    del x214
    x215 += einsum("iabj->ijba", v.bbbb.ovvo)
    x215 -= einsum("ijab->ijab", v.bbbb.oovv)
    h22_babbab += einsum("ij,klab->ljakib", delta_oo.aa, x215)
    del x215
    x219 += einsum("ab->ab", f.bb.vv) * -1
    h22_babbab += einsum("ij,kl,ab->ljakib", delta_oo.aa, delta_oo.bb, x219) * -1
    x220 += einsum("ijka->ijka", v.aabb.ooov)
    x221 += einsum("ia,jkib->jkab", t1.bb, x220)
    x245 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x245 += einsum("ia,ijkb->jkab", t1.aa, x220)
    del x220
    x246 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x246 += einsum("ijab->ijab", x245)
    x247 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x247 -= einsum("ijab->ijab", x245)
    del x245
    x221 -= einsum("ijab->ijab", v.aabb.oovv)
    x221 -= einsum("ia,jabc->jibc", t1.aa, v.aabb.ovvv)
    h22_babbab += einsum("ij,klab->jlaikb", delta_oo.bb, x221)
    del x221
    x222 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x222 += einsum("iajb->jiab", v.aaaa.ovov)
    x222 -= einsum("iajb->jiba", v.aaaa.ovov)
    x223 += einsum("ijab,ikac->jkcb", x222, x80)
    del x80
    del x222
    x223 += einsum("iabj->ijba", v.aaaa.ovvo)
    x223 -= einsum("ijab->ijab", v.aaaa.oovv)
    h22_abaaba += einsum("ij,klab->ljakib", delta_oo.bb, x223)
    del x223
    x224 += einsum("iajk->ijka", v.aabb.ovoo)
    x225 += einsum("ia,ijkb->jkab", t1.aa, x224)
    x250 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x250 += einsum("ia,jikb->jkba", t1.bb, x224)
    del x224
    x251 -= einsum("ijab->ijab", x250)
    x254 += einsum("ijab->ijab", x250)
    del x250
    x225 -= einsum("ijab->ijab", v.bbaa.oovv)
    h22_abaaba += einsum("ij,klab->jlaikb", delta_oo.aa, x225)
    del x225
    x226 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x226 += einsum("ijab,kalc->jilkbc", t2.bbbb, v.bbbb.ovov)
    h22_bbbbbb -= einsum("ijklab->ijaklb", x226)
    h22_bbbbbb += einsum("ijklab->ijalkb", x226)
    h22_bbbbbb += einsum("ijklab->jiaklb", x226)
    h22_bbbbbb -= einsum("ijklab->jialkb", x226)
    del x226
    x227 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x227 += einsum("iajb->jiab", v.bbbb.ovov)
    x227 -= einsum("iajb->jiba", v.bbbb.ovov)
    x228 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x228 += einsum("ijab,ikac->jkbc", x210, x227)
    del x210
    del x227
    x229 += einsum("ijab->ijab", x228)
    del x228
    h22_bbbbbb -= einsum("ij,klab->kiajlb", delta_oo.bb, x229)
    h22_bbbbbb += einsum("ij,klab->kialjb", delta_oo.bb, x229)
    h22_bbbbbb += einsum("ij,klab->jkailb", delta_oo.bb, x229)
    h22_bbbbbb -= einsum("ij,klab->jkalib", delta_oo.bb, x229)
    del x229
    x230 += einsum("ij->ij", f.bb.oo)
    x231 += einsum("ij,kl->jikl", delta_oo.bb, x230)
    del x230
    x235 += einsum("ijkl->ikjl", x231)
    x235 += einsum("ijkl->kijl", x231) * -1
    x235 += einsum("ijkl->iklj", x231) * -1
    x235 += einsum("ijkl->kilj", x231)
    del x231
    x235 += einsum("ijkl->kijl", v.bbbb.oooo)
    x235 += einsum("ijkl->kilj", v.bbbb.oooo) * -1
    h22_bbbbbb += einsum("ab,ijkl->lkbjia", delta_vv.bb, x235) * -1
    del x235
    x236 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x236 += einsum("ij,kl->jkli", delta_oo.bb, delta_oo.bb)
    x236 -= einsum("ij,kl->jlik", delta_oo.bb, delta_oo.bb)
    h22_bbbbbb += einsum("ab,ijkl->lkajib", x219, x236)
    del x219
    del x236
    x237 += einsum("iabj->ijba", v.bbbb.ovvo)
    x237 -= einsum("ijab->ijab", v.bbbb.oovv)
    h22_bbbbbb += einsum("ij,klab->jlaikb", delta_oo.bb, x237)
    h22_bbbbbb -= einsum("ij,klab->ljaikb", delta_oo.bb, x237)
    del x237
    x239 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x239 += einsum("iabc->ibac", v.bbbb.ovvv)
    x239 -= einsum("iabc->ibca", v.bbbb.ovvv)
    x240 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x240 += einsum("ia,jbca->jibc", t1.bb, x239)
    del x239
    x241 -= einsum("ijab->ijab", x240)
    del x240
    x241 += einsum("ijab->ijab", v.bbbb.oovv)
    x241 -= einsum("iabj->ijba", v.bbbb.ovvo)
    h22_bbbbbb -= einsum("ij,klab->ljakib", delta_oo.bb, x241)
    h22_bbbbbb += einsum("ij,klab->jlakib", delta_oo.bb, x241)
    del x241
    x243 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x243 += einsum("ijab,kblc->ijklac", t2.aaaa, v.aabb.ovov)
    h22_aaabab -= einsum("ijklab->ijalkb", x243)
    h22_aaabab += einsum("ijklab->jialkb", x243)
    del x243
    x244 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x244 += einsum("ia,jbca->ijcb", t1.aa, v.bbaa.ovvv)
    x246 -= einsum("ijab->ijab", x244)
    x247 += einsum("ijab->ijab", x244)
    del x244
    x246 -= einsum("iabj->jiba", v.bbaa.ovvo)
    h22_aaabab += einsum("ij,klab->jkalib", delta_oo.aa, x246)
    del x246
    x247 += einsum("iabj->jiba", v.bbaa.ovvo)
    h22_aaabab += einsum("ij,klab->kjalib", delta_oo.aa, x247)
    h22_ababbb -= einsum("ij,klab->kjailb", delta_oo.bb, x247)
    h22_ababbb += einsum("ij,klab->kjalib", delta_oo.bb, x247)
    del x247
    x249 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x249 += einsum("ijab,kalc->ilkjcb", t2.abab, v.aaaa.ovov)
    h22_babaaa += einsum("ijklab->libkja", x249)
    h22_babaaa -= einsum("ijklab->libjka", x249)
    del x249
    x251 += einsum("iabj->ijab", v.aabb.ovvo)
    h22_babaaa += einsum("ij,klab->ljbkia", delta_oo.aa, x251)
    h22_babaaa -= einsum("ij,klab->ljbika", delta_oo.aa, x251)
    h22_bbbaba += einsum("ij,klab->ljbkia", delta_oo.bb, x251)
    del x251
    x252 = np.zeros((nocc[0], nocc[1], nocc[1], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x252 += einsum("ijab,kclb->ijklac", t2.abab, v.bbbb.ovov)
    h22_ababbb += einsum("ijklab->ijalkb", x252)
    h22_ababbb -= einsum("ijklab->ijaklb", x252)
    del x252
    x253 = np.zeros((nocc[0], nocc[1], nocc[1], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x253 += einsum("ijab,kcla->kjilcb", t2.bbbb, v.aabb.ovov)
    h22_bbbaba -= einsum("ijklab->jkbila", x253)
    h22_bbbaba += einsum("ijklab->kjbila", x253)
    del x253
    x254 -= einsum("iabj->ijab", v.aabb.ovvo)
    h22_bbbaba += einsum("ij,klab->jlbkia", delta_oo.bb, x254)
    del x254
    h11_aa -= einsum("ij->ji", f.aa.oo)
    h11_bb -= einsum("ij->ji", f.bb.oo)
    h12_aaaa += einsum("ijka->jkia", v.aaaa.ooov)
    h12_aaaa -= einsum("ijka->jika", v.aaaa.ooov)
    h12_aaaa -= einsum("ij,ka->jkia", delta_oo.aa, f.aa.ov)
    h12_aaaa += einsum("ij,ka->jika", delta_oo.aa, f.aa.ov)
    h12_abab += einsum("ijka->jkia", v.aabb.ooov)
    h12_baba += einsum("iajk->kija", v.aabb.ovoo)
    h12_bbbb += einsum("ijka->jkia", v.bbbb.ooov)
    h12_bbbb -= einsum("ijka->jika", v.bbbb.ooov)
    h12_bbbb -= einsum("ij,ka->jkia", delta_oo.bb, f.bb.ov)
    h12_bbbb += einsum("ij,ka->jika", delta_oo.bb, f.bb.ov)
    h21_abab += einsum("ijak->kjai", v.bbaa.oovo)
    h21_abab -= einsum("ijab,iklb->kjal", t2.abab, v.aabb.ooov)
    h21_abab += einsum("ijab,kbca->ijck", t2.abab, v.bbaa.ovvv)
    h21_baba += einsum("ijab,kacb->jick", t2.abab, v.aabb.ovvv)
    h21_baba += einsum("ijak->kjai", v.aabb.oovo)
    h21_baba -= einsum("ijab,kajl->libk", t2.abab, v.aabb.ovoo)
    h22_babbab -= einsum("ijab,kalc->jiblkc", t2.abab, v.aabb.ovov)
    h22_abaaba -= einsum("ijab,kclb->ijaklc", t2.abab, v.aabb.ovov)

    return {"h11": h11, "h12": h12, "h21": h21, "h22": h22}

def hbar_ea(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    delta_oo = np.eye(nocc)
    delta_vv = np.eye(nvir)

    x0 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x0 += einsum("ia,iabc->bc", t1.bb, v.bbaa.ovvv)
    x60 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x60 += einsum("ab->ab", x0) * -1
    x183 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x183 += einsum("ab->ab", x0)
    x191 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x191 += einsum("ab->ab", x0) * -1
    h11_aa = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    h11_aa += einsum("ab->ab", x0)
    del x0
    x1 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x1 += einsum("ijab,icjb->ac", t2.abab, v.aabb.ovov)
    x60 += einsum("ab->ab", x1)
    x183 += einsum("ab->ab", x1) * -1
    x191 += einsum("ab->ab", x1)
    h11_aa += einsum("ab->ab", x1) * -1
    del x1
    x2 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x2 += einsum("iajb->jiba", v.aaaa.ovov)
    x2 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x3 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x3 += einsum("ijab,ijcb->ac", t2.aaaa, x2)
    x183 += einsum("ab->ab", x3) * -1
    h11_aa += einsum("ab->ab", x3) * -1
    del x3
    x6 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x6 += einsum("ia,ijba->jb", t1.aa, x2)
    x7 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x7 += einsum("ia->ia", x6) * -1
    x43 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x43 += einsum("ia->ia", x6) * -1
    del x6
    x63 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x63 += einsum("ijab,ikba->jk", t2.aaaa, x2)
    x64 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x64 += einsum("ij->ij", x63) * -1
    x184 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x184 += einsum("ij->ji", x63) * -1
    del x63
    x166 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x166 += einsum("ijab,ikca->kjcb", t2.abab, x2) * -1
    x4 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x4 -= einsum("iabc->ibac", v.aaaa.ovvv)
    x4 += einsum("iabc->ibca", v.aaaa.ovvv)
    h11_aa -= einsum("ia,ibac->bc", t1.aa, x4)
    del x4
    x5 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x5 += einsum("ia,jbia->jb", t1.bb, v.aabb.ovov)
    x7 += einsum("ia->ia", x5)
    x21 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x21 += einsum("ia->ia", x5)
    x30 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x30 += einsum("ia->ia", x5)
    x43 += einsum("ia->ia", x5)
    del x5
    x44 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x44 += einsum("ia,ijbc->jbca", x43, t2.aaaa)
    del x43
    x45 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x45 += einsum("iabc->ibac", x44) * -1
    del x44
    x7 += einsum("ia->ia", f.aa.ov)
    x8 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x8 += einsum("ia,ib->ab", t1.aa, x7)
    x191 += einsum("ab->ab", x8)
    h11_aa += einsum("ab->ab", x8) * -1
    del x8
    x88 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x88 += einsum("ia,ja->ij", t1.aa, x7)
    del x7
    x89 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x89 += einsum("ij->ji", x88)
    x184 += einsum("ij->ji", x88)
    del x88
    x9 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x9 += einsum("ijab,iajc->bc", t2.abab, v.aabb.ovov)
    x109 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x109 += einsum("ab->ab", x9) * -1
    x167 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x167 += einsum("ab->ab", x9) * -1
    x206 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x206 += einsum("ab->ab", x9)
    h11_bb = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    h11_bb += einsum("ab->ab", x9) * -1
    del x9
    x10 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x10 += einsum("ia,iabc->bc", t1.aa, v.aabb.ovvv)
    x109 += einsum("ab->ab", x10)
    x167 += einsum("ab->ab", x10)
    x206 += einsum("ab->ab", x10) * -1
    h11_bb += einsum("ab->ab", x10)
    del x10
    x11 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x11 += einsum("iajb->jiba", v.bbbb.ovov)
    x11 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x12 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x12 += einsum("ijab,ijcb->ac", t2.bbbb, x11)
    x109 += einsum("ab->ab", x12) * -1
    x167 += einsum("ab->ab", x12) * -1
    h11_bb += einsum("ab->ab", x12) * -1
    del x12
    x15 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x15 += einsum("ia,ijba->jb", t1.bb, x11)
    x16 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x16 += einsum("ia->ia", x15) * -1
    x137 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x137 += einsum("ia->ia", x15) * -1
    del x15
    x112 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x112 += einsum("ijab,ikba->jk", t2.bbbb, x11)
    x113 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x113 += einsum("ij->ij", x112) * -1
    x168 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x168 += einsum("ij->ji", x112) * -1
    del x112
    x182 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x182 += einsum("ijab,jkcb->ikac", t2.abab, x11) * -1
    x204 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x204 += einsum("ijab,ijbc->ac", t2.bbbb, x11)
    del x11
    x206 += einsum("ab->ab", x204) * -1
    del x204
    x13 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x13 += einsum("iabc->ibac", v.bbbb.ovvv)
    x13 -= einsum("iabc->ibca", v.bbbb.ovvv)
    h11_bb -= einsum("ia,ibca->bc", t1.bb, x13)
    h21_abab = np.zeros((nvir[0], nvir[1], nocc[0], nvir[1]), dtype=np.float64)
    h21_abab -= einsum("ijab,jcbd->acid", t2.abab, x13)
    del x13
    x14 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x14 += einsum("ia,iajb->jb", t1.aa, v.aabb.ovov)
    x16 += einsum("ia->ia", x14)
    x26 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x26 += einsum("ia->ia", x14)
    x28 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x28 += einsum("ia->ia", x14)
    x137 += einsum("ia->ia", x14)
    del x14
    x138 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x138 += einsum("ia,ijbc->jbca", x137, t2.bbbb)
    del x137
    x139 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x139 += einsum("iabc->ibac", x138) * -1
    del x138
    x16 += einsum("ia->ia", f.bb.ov)
    x17 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x17 += einsum("ia,ib->ab", t1.bb, x16)
    x206 += einsum("ab->ab", x17)
    h11_bb += einsum("ab->ab", x17) * -1
    del x17
    x149 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x149 += einsum("ia,ja->ij", t1.bb, x16)
    del x16
    x150 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x150 += einsum("ij->ji", x149)
    x168 += einsum("ij->ji", x149)
    del x149
    x18 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x18 += einsum("ia,jbic->jabc", t1.aa, v.aaaa.ovov)
    x22 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x22 += einsum("iabc->iabc", x18)
    x197 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x197 += einsum("ia,ibcd->badc", t1.aa, x18)
    del x18
    x198 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x198 += einsum("abcd->badc", x197)
    del x197
    x19 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x19 += einsum("iajb->jiba", v.aaaa.ovov)
    x19 -= einsum("iajb->jiab", v.aaaa.ovov)
    x20 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x20 += einsum("ia,ijba->jb", t1.aa, x19)
    x21 -= einsum("ia->ia", x20)
    x22 += einsum("ab,ic->ibac", delta_vv.aa, x21)
    del x21
    x30 -= einsum("ia->ia", x20)
    del x20
    x232 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x232 += einsum("ijab,ikca->kjcb", t2.abab, x19)
    del x19
    x234 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x234 -= einsum("ijab->ijab", x232)
    del x232
    x22 -= einsum("iabc->ibac", v.aaaa.ovvv)
    h12_aaaa = np.zeros((nvir[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    h12_aaaa += einsum("iabc->abci", x22)
    h12_aaaa -= einsum("iabc->acbi", x22)
    del x22
    x23 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x23 += einsum("ia,jbic->jabc", t1.bb, v.bbbb.ovov)
    x27 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x27 += einsum("iabc->iabc", x23)
    x223 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x223 += einsum("ia,ibcd->badc", t1.bb, x23)
    del x23
    x224 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x224 += einsum("abcd->badc", x223)
    del x223
    x24 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x24 += einsum("iajb->jiba", v.bbbb.ovov)
    x24 -= einsum("iajb->jiab", v.bbbb.ovov)
    x25 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x25 += einsum("ia,ijba->jb", t1.bb, x24)
    x26 -= einsum("ia->ia", x25)
    x27 += einsum("ab,ic->ibac", delta_vv.bb, x26)
    del x26
    x28 -= einsum("ia->ia", x25)
    del x25
    x229 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x229 += einsum("ijab,jkcb->ikac", t2.abab, x24)
    del x24
    x230 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x230 -= einsum("ijab->ijab", x229)
    del x229
    x27 -= einsum("iabc->ibac", v.bbbb.ovvv)
    h12_bbbb = np.zeros((nvir[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    h12_bbbb += einsum("iabc->abci", x27)
    h12_bbbb -= einsum("iabc->acbi", x27)
    del x27
    x28 += einsum("ia->ia", f.bb.ov)
    h12_abab = np.zeros((nvir[0], nvir[1], nvir[0], nocc[1]), dtype=np.float64)
    h12_abab -= einsum("ab,ic->bcai", delta_vv.aa, x28)
    h21_abab += einsum("ia,jibc->bcja", x28, t2.abab)
    del x28
    x29 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x29 += einsum("ia,jbic->jbac", t1.bb, v.aabb.ovov)
    x211 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x211 += einsum("iabc->iabc", x29) * -1
    h12_baba = np.zeros((nvir[1], nvir[0], nvir[1], nocc[0]), dtype=np.float64)
    h12_baba += einsum("iabc->baci", x29)
    del x29
    x30 += einsum("ia->ia", f.aa.ov)
    h12_baba -= einsum("ab,ic->bcai", delta_vv.bb, x30)
    h21_baba = np.zeros((nvir[1], nvir[0], nocc[1], nvir[0]), dtype=np.float64)
    h21_baba += einsum("ia,ijbc->cbja", x30, t2.abab)
    del x30
    x31 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x31 += einsum("ijab,jkic->kbac", t2.aaaa, v.aaaa.ooov)
    x45 += einsum("iabc->iabc", x31)
    del x31
    x32 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x32 += einsum("ijab,icjd->abcd", t2.aaaa, v.aaaa.ovov)
    x33 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x33 += einsum("ia,bcad->icbd", t1.aa, x32)
    x45 += einsum("iabc->iabc", x33) * -1
    del x33
    h22_aaaaaa = np.zeros((nvir[0], nvir[0], nocc[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    h22_aaaaaa += einsum("ij,abcd->abicdj", delta_oo.aa, x32)
    h22_aaaaaa += einsum("ij,abcd->abidcj", delta_oo.aa, x32) * -1
    del x32
    x34 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x34 += einsum("ijab,kcjb->ikac", t2.abab, v.aabb.ovov)
    x41 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x41 += einsum("ijab->ijab", x34)
    x52 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x52 += einsum("ijab->ijab", x34)
    x181 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x181 += einsum("ijab->jiab", x34)
    x192 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x192 += einsum("ijab->ijab", x34) * -1
    x195 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x195 += einsum("ijab->ijab", x34)
    x196 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x196 += einsum("ijab->jiab", x34)
    x214 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x214 += einsum("ijab->jiab", x34) * -1
    del x34
    x35 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x35 += einsum("ijab->jiba", t2.aaaa)
    x35 += einsum("ijab->jiab", t2.aaaa) * -1
    x83 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x83 += einsum("ia,ijba->jb", f.aa.ov, x35)
    x91 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x91 += einsum("ia->ia", x83) * -1
    x185 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x185 += einsum("ia->ia", x83) * -1
    del x83
    x182 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x35) * -1
    x187 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x187 += einsum("ijab,ikbc->jkac", x2, x35)
    del x2
    x192 += einsum("ijab->jiba", x187)
    x214 += einsum("ijab->ijba", x187)
    del x187
    x36 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x36 += einsum("iajb->jiba", v.aaaa.ovov) * -1
    x36 += einsum("iajb->jiab", v.aaaa.ovov)
    x37 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x37 += einsum("ijab,ikca->jkbc", x35, x36)
    del x35
    x41 += einsum("ijab->ijab", x37)
    x52 += einsum("ijab->ijab", x37)
    x53 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x53 += einsum("ia,jiba->jb", t1.aa, x52)
    del x52
    x66 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x66 += einsum("ia->ia", x53) * -1
    del x53
    x181 += einsum("ijab->jiab", x37)
    x195 += einsum("ijab->ijab", x37)
    x196 += einsum("ijab->jiab", x37)
    del x37
    x57 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x57 += einsum("ijab,ijcb->ac", t2.aaaa, x36)
    del x36
    x60 += einsum("ab->ab", x57) * -1
    x191 += einsum("ab->ab", x57) * -1
    del x57
    x38 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x38 += einsum("ia,jakb->ikjb", t1.aa, v.aaaa.ovov)
    x39 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x39 += einsum("ijka->ijka", x38)
    x188 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x188 += einsum("ijka->ijka", x38) * -1
    x188 += einsum("ijka->ikja", x38)
    x193 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x193 += einsum("ijka->ijka", x38)
    x193 += einsum("ijka->ikja", x38) * -1
    del x38
    x39 += einsum("ijka->jika", v.aaaa.ooov) * -1
    x40 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x40 += einsum("ia,jkib->jkab", t1.aa, x39)
    del x39
    x41 += einsum("ijab->ijab", x40) * -1
    del x40
    x42 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x42 += einsum("ia,jibc->jabc", t1.aa, x41)
    del x41
    x45 += einsum("iabc->iabc", x42)
    del x42
    h21_aaaa = np.zeros((nvir[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    h21_aaaa += einsum("iabc->baic", x45)
    h21_aaaa += einsum("iabc->abic", x45) * -1
    del x45
    x46 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x46 += einsum("ijab,ikjb->ka", t2.abab, v.aabb.ooov)
    x66 += einsum("ia->ia", x46)
    x185 += einsum("ia->ia", x46) * -1
    del x46
    x47 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x47 += einsum("ijab,jbca->ic", t2.abab, v.bbaa.ovvv)
    x66 += einsum("ia->ia", x47) * -1
    x185 += einsum("ia->ia", x47)
    del x47
    x48 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x48 += einsum("iabc->ibac", v.aaaa.ovvv) * -1
    x48 += einsum("iabc->ibca", v.aaaa.ovvv)
    x49 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x49 += einsum("ijab,icba->jc", t2.aaaa, x48)
    x66 += einsum("ia->ia", x49) * -1
    del x49
    x183 += einsum("ia,ibac->bc", t1.aa, x48) * -1
    x190 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x190 += einsum("ia,jbac->ijbc", t1.aa, x48)
    del x48
    x192 += einsum("ijab->ijab", x190) * -1
    x214 += einsum("ijab->jiab", x190) * -1
    del x190
    x50 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x50 += einsum("ijka->ikja", v.aaaa.ooov)
    x50 += einsum("ijka->kija", v.aaaa.ooov) * -1
    x51 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x51 += einsum("ijab,ijka->kb", t2.aaaa, x50)
    x66 += einsum("ia->ia", x51) * -1
    del x51
    x87 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x87 += einsum("ia,ijka->jk", t1.aa, x50)
    del x50
    x89 += einsum("ij->ij", x87) * -1
    x184 += einsum("ij->ij", x87) * -1
    del x87
    x54 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x54 += einsum("ijab->jiba", t2.aaaa) * -1
    x54 += einsum("ijab->jiab", t2.aaaa)
    x55 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x55 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x54)
    del x54
    x56 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x56 += einsum("ia,jiba->jb", t1.bb, x55) * -1
    del x55
    x66 += einsum("ia->ia", x56)
    del x56
    x58 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x58 += einsum("iabc->ibac", v.aaaa.ovvv)
    x58 += einsum("iabc->ibca", v.aaaa.ovvv) * -1
    x59 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x59 += einsum("ia,ibac->bc", t1.aa, x58)
    x60 += einsum("ab->ab", x59) * -1
    x61 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x61 += einsum("ia,ba->ib", t1.aa, x60)
    del x60
    x66 += einsum("ia->ia", x61)
    del x61
    x191 += einsum("ab->ab", x59) * -1
    del x59
    x185 += einsum("ijab,icba->jc", t2.aaaa, x58) * -1
    x194 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x194 += einsum("ia,jbac->ijbc", t1.aa, x58)
    del x58
    x195 += einsum("ijab->ijab", x194) * -1
    x196 += einsum("ijab->jiab", x194) * -1
    del x194
    x62 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x62 += einsum("ijab,kajb->ik", t2.abab, v.aabb.ovov)
    x64 += einsum("ij->ij", x62)
    x65 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x65 += einsum("ia,ji->ja", t1.aa, x64)
    del x64
    x66 += einsum("ia->ia", x65)
    del x65
    h21_aaaa += einsum("ab,ic->cbia", delta_vv.aa, x66)
    h21_aaaa += einsum("ab,ic->acib", delta_vv.aa, x66) * -1
    del x66
    x184 += einsum("ij->ji", x62)
    del x62
    x67 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x67 += einsum("ia,bcda->ibdc", t1.aa, v.aaaa.vvvv)
    x75 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x75 -= einsum("iabc->iabc", x67)
    del x67
    x68 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x68 += einsum("ijab,jbcd->iacd", t2.abab, v.bbaa.ovvv)
    x75 += einsum("iabc->iabc", x68)
    del x68
    x69 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x69 += einsum("ijab->jiba", t2.aaaa)
    x69 -= einsum("ijab->jiab", t2.aaaa)
    x228 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x228 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x69)
    x230 -= einsum("ijab->ijab", x228)
    del x228
    x70 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x70 += einsum("iabc->ibac", v.aaaa.ovvv)
    x70 -= einsum("iabc->ibca", v.aaaa.ovvv)
    x71 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x71 += einsum("ijab,icad->jbcd", x69, x70)
    del x69
    x75 += einsum("iabc->iabc", x71)
    del x71
    x72 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x72 += einsum("ia,jbac->ijbc", t1.aa, x70)
    x73 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x73 -= einsum("ijab->ijab", x72)
    del x72
    h21_baba -= einsum("ijab,icad->bcjd", t2.abab, x70)
    del x70
    x73 += einsum("iabj->jiba", v.aaaa.ovvo)
    x73 -= einsum("ijab->jiab", v.aaaa.oovv)
    x74 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x74 += einsum("ia,jibc->jabc", t1.aa, x73)
    del x73
    x75 += einsum("iabc->iabc", x74)
    del x74
    x75 += einsum("aibc->iabc", v.aaaa.vovv)
    h21_aaaa += einsum("iabc->baic", x75)
    h21_aaaa -= einsum("iabc->abic", x75)
    del x75
    x76 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x76 += einsum("ia,jibc->jabc", f.aa.ov, t2.aaaa)
    h21_aaaa -= einsum("iabc->cbia", x76)
    h21_aaaa += einsum("iabc->bcia", x76)
    del x76
    x77 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x77 -= einsum("iajb->jiba", v.bbbb.ovov)
    x77 += einsum("iajb->jiab", v.bbbb.ovov)
    x78 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x78 += einsum("ijab,jkcb->ikac", t2.abab, x77)
    del x77
    x79 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x79 -= einsum("ia,jiba->jb", t1.bb, x78)
    h21_aaaa += einsum("ab,ic->cbia", delta_vv.aa, x79)
    h21_aaaa -= einsum("ab,ic->acib", delta_vv.aa, x79)
    del x79
    x176 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x176 -= einsum("ijab->ijab", x78)
    del x78
    x80 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x80 += einsum("ab,ib->ia", f.aa.vv, t1.aa)
    x91 += einsum("ia->ia", x80)
    del x80
    x81 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x81 += einsum("ia,jiba->jb", f.bb.ov, t2.abab)
    x91 += einsum("ia->ia", x81)
    x185 += einsum("ia->ia", x81)
    del x81
    x82 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x82 += einsum("ia,iabj->jb", t1.bb, v.bbaa.ovvo)
    x91 += einsum("ia->ia", x82)
    del x82
    x84 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x84 += einsum("iabj->ijba", v.aaaa.ovvo)
    x84 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x85 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x85 += einsum("ia,ijba->jb", t1.aa, x84)
    del x84
    x91 += einsum("ia->ia", x85)
    del x85
    x86 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x86 += einsum("ia,jkia->jk", t1.bb, v.aabb.ooov)
    x89 += einsum("ij->ij", x86)
    x184 += einsum("ij->ij", x86)
    del x86
    x89 += einsum("ij->ij", f.aa.oo)
    x90 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x90 += einsum("ia,ij->ja", t1.aa, x89)
    del x89
    x91 += einsum("ia->ia", x90) * -1
    del x90
    x91 += einsum("ai->ia", f.aa.vo)
    h21_aaaa += einsum("ab,ic->cbia", delta_vv.aa, x91) * -1
    h21_aaaa += einsum("ab,ic->bcia", delta_vv.aa, x91)
    del x91
    x92 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x92 += einsum("ijab,iajk->kb", t2.abab, v.aabb.ovoo)
    x115 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x115 += einsum("ia->ia", x92)
    x169 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x169 += einsum("ia->ia", x92) * -1
    del x92
    x93 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x93 += einsum("ijab,iacb->jc", t2.abab, v.aabb.ovvv)
    x115 += einsum("ia->ia", x93) * -1
    x169 += einsum("ia->ia", x93)
    del x93
    x94 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x94 += einsum("iabc->ibac", v.bbbb.ovvv) * -1
    x94 += einsum("iabc->ibca", v.bbbb.ovvv)
    x95 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x95 += einsum("ijab,icba->jc", t2.bbbb, x94)
    x115 += einsum("ia->ia", x95) * -1
    del x95
    x169 += einsum("ijab,icab->jc", t2.bbbb, x94) * -1
    x218 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x218 += einsum("ia,jbac->ijbc", t1.bb, x94)
    x219 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x219 += einsum("ijab->ijab", x218) * -1
    del x218
    x220 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x220 += einsum("ia,jbca->ijbc", t1.bb, x94) * -1
    del x94
    x96 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x96 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x96 += einsum("ijka->kija", v.bbbb.ooov)
    x97 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x97 += einsum("ijab,jika->kb", t2.bbbb, x96)
    del x96
    x115 += einsum("ia->ia", x97) * -1
    del x97
    x98 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x98 += einsum("ijab,iakc->jkbc", t2.abab, v.aabb.ovov)
    x102 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x102 += einsum("ijab->ijab", x98)
    x135 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x135 += einsum("ijab->ijab", x98)
    x165 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x165 += einsum("ijab->jiab", x98)
    x207 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x207 += einsum("ijab->jiab", x98) * -1
    x219 += einsum("ijab->ijab", x98) * -1
    x220 += einsum("ijab->ijab", x98)
    x222 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x222 += einsum("ijab->jiab", x98)
    del x98
    x99 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x99 += einsum("ijab->jiba", t2.bbbb)
    x99 += einsum("ijab->jiab", t2.bbbb) * -1
    x143 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x143 += einsum("ia,ijba->jb", f.bb.ov, x99)
    x152 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x152 += einsum("ia->ia", x143) * -1
    x169 += einsum("ia->ia", x143) * -1
    del x143
    x166 += einsum("iajb,jkcb->ikac", v.aabb.ovov, x99) * -1
    x100 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x100 += einsum("iajb->jiba", v.bbbb.ovov) * -1
    x100 += einsum("iajb->jiab", v.bbbb.ovov)
    x101 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x101 += einsum("ijab,ikbc->kjca", x100, x99)
    x102 += einsum("ijab->ijab", x101)
    x103 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x103 += einsum("ia,jiba->jb", t1.bb, x102)
    del x102
    x115 += einsum("ia->ia", x103) * -1
    del x103
    x135 += einsum("ijab->ijab", x101)
    x165 += einsum("ijab->jiab", x101)
    x220 += einsum("ijab->ijab", x101)
    x222 += einsum("ijab->jiab", x101)
    del x101
    x201 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x201 += einsum("ijab,ikac->kjcb", x100, x99)
    del x99
    del x100
    x207 += einsum("ijab->jiab", x201)
    x219 += einsum("ijab->ijab", x201)
    del x201
    x104 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x104 += einsum("ijab->jiba", t2.bbbb) * -1
    x104 += einsum("ijab->jiab", t2.bbbb)
    x105 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x105 += einsum("iajb,jkcb->ikac", v.aabb.ovov, x104)
    del x104
    x106 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x106 += einsum("ia,ijab->jb", t1.aa, x105) * -1
    del x105
    x115 += einsum("ia->ia", x106)
    del x106
    x107 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x107 += einsum("iabc->ibac", v.bbbb.ovvv)
    x107 += einsum("iabc->ibca", v.bbbb.ovvv) * -1
    x108 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x108 += einsum("ia,ibca->bc", t1.bb, x107)
    x109 += einsum("ab->ab", x108) * -1
    x110 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x110 += einsum("ia,ba->ib", t1.bb, x109)
    del x109
    x115 += einsum("ia->ia", x110) * -1
    del x110
    x167 += einsum("ab->ab", x108) * -1
    del x108
    x205 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x205 += einsum("ia,ibac->bc", t1.bb, x107)
    x206 += einsum("ab->ab", x205) * -1
    del x205
    x207 += einsum("ia,jbca->jibc", t1.bb, x107) * -1
    x222 += einsum("ia,jbac->jibc", t1.bb, x107) * -1
    del x107
    x111 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x111 += einsum("ijab,iakb->jk", t2.abab, v.aabb.ovov)
    x113 += einsum("ij->ij", x111)
    x114 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x114 += einsum("ia,ji->ja", t1.bb, x113)
    del x113
    x115 += einsum("ia->ia", x114)
    del x114
    h21_bbbb = np.zeros((nvir[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    h21_bbbb += einsum("ab,ic->cbia", delta_vv.bb, x115)
    h21_bbbb += einsum("ab,ic->acib", delta_vv.bb, x115) * -1
    del x115
    x168 += einsum("ij->ji", x111)
    del x111
    x116 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x116 += einsum("ia,bcda->ibdc", t1.bb, v.bbbb.vvvv)
    x124 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x124 -= einsum("iabc->iabc", x116)
    del x116
    x117 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x117 += einsum("ijab,iacd->jbcd", t2.abab, v.aabb.ovvv)
    x124 += einsum("iabc->iabc", x117)
    del x117
    x118 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x118 += einsum("ijab->jiba", t2.bbbb)
    x118 -= einsum("ijab->jiab", t2.bbbb)
    x233 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x233 += einsum("iajb,jkcb->ikac", v.aabb.ovov, x118)
    x234 -= einsum("ijab->ijab", x233)
    del x233
    x119 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x119 -= einsum("iabc->ibac", v.bbbb.ovvv)
    x119 += einsum("iabc->ibca", v.bbbb.ovvv)
    x120 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x120 += einsum("ijab,icda->jbcd", x118, x119)
    del x118
    x124 += einsum("iabc->iabc", x120)
    del x120
    x121 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x121 += einsum("ia,jbca->ijbc", t1.bb, x119)
    del x119
    x122 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x122 -= einsum("ijab->ijab", x121)
    del x121
    x122 += einsum("iabj->jiba", v.bbbb.ovvo)
    x122 -= einsum("ijab->jiab", v.bbbb.oovv)
    x123 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x123 += einsum("ia,jibc->jabc", t1.bb, x122)
    del x122
    x124 += einsum("iabc->iabc", x123)
    del x123
    x124 += einsum("aibc->iabc", v.bbbb.vovv)
    h21_bbbb += einsum("iabc->baic", x124)
    h21_bbbb -= einsum("iabc->abic", x124)
    del x124
    x125 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x125 -= einsum("iajb->jiba", v.aaaa.ovov)
    x125 += einsum("iajb->jiab", v.aaaa.ovov)
    x126 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x126 += einsum("ijab,ikca->kjcb", t2.abab, x125)
    del x125
    x127 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x127 -= einsum("ia,ijab->jb", t1.aa, x126)
    h21_bbbb += einsum("ab,ic->cbia", delta_vv.bb, x127)
    h21_bbbb -= einsum("ab,ic->acib", delta_vv.bb, x127)
    del x127
    x159 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x159 -= einsum("ijab->ijab", x126)
    del x126
    x128 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x128 += einsum("ia,jibc->jabc", f.bb.ov, t2.bbbb)
    h21_bbbb -= einsum("iabc->cbia", x128)
    h21_bbbb += einsum("iabc->bcia", x128)
    del x128
    x129 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x129 += einsum("ijab,jkic->kbac", t2.bbbb, v.bbbb.ooov)
    x139 += einsum("iabc->iabc", x129)
    del x129
    x130 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x130 += einsum("ijab,icjd->abcd", t2.bbbb, v.bbbb.ovov)
    x131 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x131 += einsum("ia,bcad->icbd", t1.bb, x130)
    x139 += einsum("iabc->iabc", x131) * -1
    del x131
    h22_bbbbbb = np.zeros((nvir[1], nvir[1], nocc[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    h22_bbbbbb += einsum("ij,abcd->abicdj", delta_oo.bb, x130)
    h22_bbbbbb += einsum("ij,abcd->abidcj", delta_oo.bb, x130) * -1
    del x130
    x132 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x132 += einsum("ia,jakb->ikjb", t1.bb, v.bbbb.ovov)
    x133 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x133 += einsum("ijka->ijka", x132)
    x202 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x202 += einsum("ijka->ijka", x132)
    x202 += einsum("ijka->ikja", x132) * -1
    x221 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x221 += einsum("ijka->ijka", x132) * -1
    x221 += einsum("ijka->ikja", x132)
    del x132
    x133 += einsum("ijka->jika", v.bbbb.ooov) * -1
    x134 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x134 += einsum("ia,jkib->jkab", t1.bb, x133)
    del x133
    x135 += einsum("ijab->ijab", x134) * -1
    del x134
    x136 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x136 += einsum("ia,jibc->jabc", t1.bb, x135)
    del x135
    x139 += einsum("iabc->iabc", x136)
    del x136
    h21_bbbb += einsum("iabc->baic", x139)
    h21_bbbb += einsum("iabc->abic", x139) * -1
    del x139
    x140 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x140 += einsum("ab,ib->ia", f.bb.vv, t1.bb)
    x152 += einsum("ia->ia", x140)
    del x140
    x141 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x141 += einsum("ia,ijab->jb", f.aa.ov, t2.abab)
    x152 += einsum("ia->ia", x141)
    x169 += einsum("ia->ia", x141)
    del x141
    x142 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x142 += einsum("ia,iabj->jb", t1.aa, v.aabb.ovvo)
    x152 += einsum("ia->ia", x142)
    del x142
    x144 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x144 += einsum("iabj->ijba", v.bbbb.ovvo)
    x144 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x145 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x145 += einsum("ia,ijba->jb", t1.bb, x144)
    del x144
    x152 += einsum("ia->ia", x145)
    del x145
    x146 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x146 += einsum("ia,iajk->jk", t1.aa, v.aabb.ovoo)
    x150 += einsum("ij->ij", x146)
    x168 += einsum("ij->ij", x146)
    del x146
    x147 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x147 += einsum("ijka->ikja", v.bbbb.ooov)
    x147 += einsum("ijka->kija", v.bbbb.ooov) * -1
    x148 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x148 += einsum("ia,ijka->jk", t1.bb, x147)
    x150 += einsum("ij->ij", x148) * -1
    x168 += einsum("ij->ij", x148) * -1
    del x148
    x169 += einsum("ijab,jika->kb", t2.bbbb, x147) * -1
    del x147
    x150 += einsum("ij->ij", f.bb.oo)
    x151 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x151 += einsum("ia,ij->ja", t1.bb, x150)
    del x150
    x152 += einsum("ia->ia", x151) * -1
    del x151
    x152 += einsum("ai->ia", f.bb.vo)
    h21_bbbb += einsum("ab,ic->bcia", delta_vv.bb, x152)
    h21_bbbb += einsum("ab,ic->cbia", delta_vv.bb, x152) * -1
    del x152
    x153 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x153 -= einsum("ijab->jiba", t2.bbbb)
    x153 += einsum("ijab->jiab", t2.bbbb)
    x155 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x155 += einsum("iajb,jkcb->ikac", v.aabb.ovov, x153)
    x159 -= einsum("ijab->ijab", x155)
    del x155
    h21_baba -= einsum("iabc,ijda->dbjc", v.bbaa.ovvv, x153)
    del x153
    x154 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x154 += einsum("ia,jbca->jibc", t1.bb, v.aabb.ovvv)
    x159 -= einsum("ijab->ijab", x154)
    x234 += einsum("ijab->ijab", x154)
    del x154
    x156 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x156 += einsum("ia,jbka->jikb", t1.bb, v.aabb.ovov)
    x157 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x157 += einsum("ijka->ikja", x156)
    x208 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x208 += einsum("ijka->ikja", x156)
    del x156
    x157 += einsum("iajk->ijka", v.aabb.ovoo)
    x158 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x158 += einsum("ia,jikb->jkba", t1.bb, x157)
    del x157
    x159 += einsum("ijab->ijab", x158)
    x234 -= einsum("ijab->ijab", x158)
    del x158
    x159 -= einsum("iabj->ijab", v.aabb.ovvo)
    h21_baba -= einsum("ia,ijbc->cajb", t1.aa, x159)
    h22_babaaa = np.zeros((nvir[1], nvir[0], nocc[1], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    h22_babaaa -= einsum("ab,ijcd->dbjcai", delta_vv.aa, x159)
    del x159
    x160 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x160 += einsum("ijab,icjd->acbd", t2.abab, v.aabb.ovov)
    x161 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x161 += einsum("abcd->abcd", x160)
    x213 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x213 += einsum("abcd->abcd", x160)
    del x160
    x161 += einsum("abcd->abcd", v.aabb.vvvv)
    h21_baba += einsum("ia,bcda->dbic", t1.bb, x161) * -1
    h21_abab += einsum("ia,bacd->bcid", t1.aa, x161) * -1
    del x161
    x162 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x162 += einsum("ia,jabc->ijbc", t1.bb, v.bbaa.ovvv)
    x164 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x164 += einsum("ijab->jiab", x162)
    x209 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x209 += einsum("ijab->jiab", x162)
    del x162
    x163 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x163 += einsum("ijab,ickb->jkac", t2.abab, v.aabb.ovov)
    x164 -= einsum("ijab->jiab", x163)
    x209 += einsum("ijab->jiab", x163) * -1
    del x163
    x164 += einsum("ijab->ijab", v.bbaa.oovv)
    h21_baba += einsum("ia,ijbc->abjc", t1.bb, x164)
    del x164
    x165 += einsum("iabj->ijba", v.bbbb.ovvo)
    x165 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x169 += einsum("ia,ijba->jb", t1.bb, x165)
    del x165
    x166 += einsum("iabj->ijab", v.aabb.ovvo)
    x169 += einsum("ia,ijab->jb", t1.aa, x166)
    del x166
    x167 += einsum("ab->ab", f.bb.vv)
    x169 += einsum("ia,ba->ib", t1.bb, x167)
    del x167
    x168 += einsum("ij->ij", f.bb.oo)
    x169 += einsum("ia,ij->ja", t1.bb, x168) * -1
    x207 += einsum("ab,ij->ijba", delta_vv.bb, x168)
    x219 += einsum("ab,ij->jiba", delta_vv.bb, x168)
    del x168
    x169 += einsum("ai->ia", f.bb.vo)
    h21_baba += einsum("ab,ic->cbia", delta_vv.aa, x169) * -1
    del x169
    x170 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x170 -= einsum("ijab->jiba", t2.aaaa)
    x170 += einsum("ijab->jiab", t2.aaaa)
    x172 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x172 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x170)
    x176 -= einsum("ijab->ijab", x172)
    del x172
    h21_abab -= einsum("iabc,ijda->dbjc", v.aabb.ovvv, x170)
    del x170
    x171 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x171 += einsum("ia,jbca->ijcb", t1.aa, v.bbaa.ovvv)
    x176 -= einsum("ijab->ijab", x171)
    x230 += einsum("ijab->ijab", x171)
    del x171
    x173 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x173 += einsum("ia,jakb->ijkb", t1.aa, v.aabb.ovov)
    x174 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x174 += einsum("ijka->jika", x173)
    x215 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x215 += einsum("ijka->jika", x173)
    del x173
    x174 += einsum("ijka->ijka", v.aabb.ooov)
    x175 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x175 += einsum("ia,ijkb->jkab", t1.aa, x174)
    del x174
    x176 += einsum("ijab->ijab", x175)
    x230 -= einsum("ijab->ijab", x175)
    del x175
    x176 -= einsum("iabj->jiba", v.bbaa.ovvo)
    h21_abab -= einsum("ia,jibc->bajc", t1.bb, x176)
    h22_ababbb = np.zeros((nvir[0], nvir[1], nocc[0], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    h22_ababbb -= einsum("ab,ijcd->cbidaj", delta_vv.bb, x176)
    del x176
    x177 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x177 += einsum("ia,jabc->ijbc", t1.aa, v.aabb.ovvv)
    x179 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x179 += einsum("ijab->jiab", x177)
    x216 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x216 += einsum("ijab->jiab", x177)
    del x177
    x178 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x178 += einsum("ijab,kajc->ikbc", t2.abab, v.aabb.ovov)
    x179 -= einsum("ijab->jiab", x178)
    x216 += einsum("ijab->jiab", x178) * -1
    del x178
    x179 += einsum("ijab->ijab", v.aabb.oovv)
    h21_abab += einsum("ia,ijbc->abjc", t1.aa, x179)
    del x179
    x180 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x180 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x180 += einsum("ijka->kija", v.aaaa.ooov)
    x185 += einsum("ijab,ijka->kb", t2.aaaa, x180) * -1
    del x180
    x181 += einsum("iabj->ijba", v.aaaa.ovvo)
    x181 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x185 += einsum("ia,ijba->jb", t1.aa, x181)
    del x181
    x182 += einsum("iabj->jiba", v.bbaa.ovvo)
    x185 += einsum("ia,jiba->jb", t1.bb, x182)
    del x182
    x183 += einsum("ab->ab", f.aa.vv)
    x185 += einsum("ia,ba->ib", t1.aa, x183)
    del x183
    x184 += einsum("ij->ij", f.aa.oo)
    x185 += einsum("ia,ij->ja", t1.aa, x184) * -1
    x192 += einsum("ab,ij->jiba", delta_vv.aa, x184)
    x214 += einsum("ab,ij->ijba", delta_vv.aa, x184)
    del x184
    x185 += einsum("ai->ia", f.aa.vo)
    h21_abab += einsum("ab,ic->cbia", delta_vv.bb, x185) * -1
    del x185
    x186 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x186 += einsum("ijab,kcjd->ikabcd", t2.aaaa, v.aaaa.ovov)
    h22_aaaaaa += einsum("ijabcd->baicdj", x186)
    h22_aaaaaa -= einsum("ijabcd->baidcj", x186)
    h22_aaaaaa -= einsum("ijabcd->abicdj", x186)
    h22_aaaaaa += einsum("ijabcd->abidcj", x186)
    del x186
    x188 += einsum("ijka->jika", v.aaaa.ooov)
    x188 += einsum("ijka->jkia", v.aaaa.ooov) * -1
    x189 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x189 += einsum("ia,jkib->jkab", t1.aa, x188)
    x192 += einsum("ijab->ijab", x189) * -1
    x214 += einsum("ijab->jiab", x189) * -1
    del x189
    x196 += einsum("ia,jikb->kjab", t1.aa, x188) * -1
    del x188
    x191 += einsum("ab->ab", f.aa.vv) * -1
    x192 += einsum("ij,ab->jiab", delta_oo.aa, x191)
    x195 += einsum("ij,ab->jiab", delta_oo.aa, x191) * -1
    x196 += einsum("ij,ab->jiab", delta_oo.aa, x191) * -1
    x209 += einsum("ij,ab->jiab", delta_oo.bb, x191)
    x214 += einsum("ij,ab->jiab", delta_oo.aa, x191)
    del x191
    x192 += einsum("ijab->jiab", v.aaaa.oovv)
    x192 += einsum("iabj->jiba", v.aaaa.ovvo) * -1
    h22_aaaaaa += einsum("ab,ijcd->cbiadj", delta_vv.aa, x192)
    h22_aaaaaa += einsum("ab,ijcd->cbidaj", delta_vv.aa, x192) * -1
    del x192
    x193 += einsum("ijka->jika", v.aaaa.ooov) * -1
    x193 += einsum("ijka->jkia", v.aaaa.ooov)
    x195 += einsum("ia,jkib->jkab", t1.aa, x193) * -1
    del x193
    x195 += einsum("iabj->jiba", v.aaaa.ovvo)
    x195 += einsum("ijab->jiab", v.aaaa.oovv) * -1
    h22_aaaaaa += einsum("ab,ijcd->bcidaj", delta_vv.aa, x195) * -1
    del x195
    x196 += einsum("iabj->ijba", v.aaaa.ovvo)
    x196 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    h22_aaaaaa += einsum("ab,ijcd->bcjadi", delta_vv.aa, x196)
    del x196
    x198 += einsum("abcd->cadb", v.aaaa.vvvv)
    x200 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x200 += einsum("abcd->abdc", x198)
    x200 += einsum("abcd->abcd", x198) * -1
    del x198
    x199 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x199 += einsum("ia,ibcd->acbd", t1.aa, v.aaaa.ovvv)
    x200 += einsum("abcd->bacd", x199) * -1
    x200 += einsum("abcd->badc", x199)
    x200 += einsum("abcd->abcd", x199)
    x200 += einsum("abcd->abdc", x199) * -1
    del x199
    h22_aaaaaa += einsum("ij,abcd->bajdci", delta_oo.aa, x200) * -1
    del x200
    x202 += einsum("ijka->jika", v.bbbb.ooov) * -1
    x202 += einsum("ijka->jkia", v.bbbb.ooov)
    x203 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x203 += einsum("ia,jikb->jkba", t1.bb, x202)
    x207 += einsum("ijab->jiba", x203) * -1
    x219 += einsum("ijab->ijba", x203) * -1
    del x203
    x220 += einsum("ia,jkib->jkab", t1.bb, x202) * -1
    del x202
    x206 += einsum("ab->ab", f.bb.vv) * -1
    x207 += einsum("ij,ab->jiab", delta_oo.bb, x206)
    x216 += einsum("ij,ab->jiab", delta_oo.aa, x206)
    x219 += einsum("ij,ab->jiab", delta_oo.bb, x206)
    x220 += einsum("ij,ab->jiab", delta_oo.bb, x206) * -1
    x222 += einsum("ij,ab->jiab", delta_oo.bb, x206) * -1
    del x206
    x207 += einsum("ijab->ijab", v.bbbb.oovv)
    x207 += einsum("iabj->ijba", v.bbbb.ovvo) * -1
    h22_babbab = np.zeros((nvir[1], nvir[0], nocc[1], nvir[1], nvir[0], nocc[1]), dtype=np.float64)
    h22_babbab += einsum("ab,ijcd->cbjdai", delta_vv.aa, x207) * -1
    del x207
    x208 += einsum("iajk->ijka", v.aabb.ovoo)
    x209 += einsum("ia,ijkb->jkab", t1.aa, x208) * -1
    del x208
    x209 += einsum("ijab->ijab", v.bbaa.oovv)
    h22_babbab += einsum("ab,ijcd->bcjadi", delta_vv.bb, x209) * -1
    del x209
    x210 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x210 += einsum("ia,ibcd->cdab", t1.bb, v.bbaa.ovvv)
    x213 += einsum("abcd->abcd", x210) * -1
    del x210
    x211 += einsum("iabc->iabc", v.aabb.ovvv)
    x212 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x212 += einsum("ia,ibcd->bacd", t1.aa, x211)
    del x211
    x213 += einsum("abcd->bacd", x212) * -1
    del x212
    x213 += einsum("abcd->abcd", v.aabb.vvvv)
    h22_babbab += einsum("ij,abcd->cajdbi", delta_oo.bb, x213)
    h22_abaaba = np.zeros((nvir[0], nvir[1], nocc[0], nvir[0], nvir[1], nocc[0]), dtype=np.float64)
    h22_abaaba += einsum("ij,abcd->acjbdi", delta_oo.aa, x213)
    del x213
    x214 += einsum("ijab->ijab", v.aaaa.oovv)
    x214 += einsum("iabj->ijba", v.aaaa.ovvo) * -1
    h22_abaaba += einsum("ab,ijcd->cbjdai", delta_vv.bb, x214) * -1
    del x214
    x215 += einsum("ijka->ijka", v.aabb.ooov)
    x216 += einsum("ia,jkib->jkab", t1.bb, x215) * -1
    del x215
    x216 += einsum("ijab->ijab", v.aabb.oovv)
    h22_abaaba += einsum("ab,ijcd->bcjadi", delta_vv.aa, x216) * -1
    del x216
    x217 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x217 += einsum("ijab,kcjd->ikabcd", t2.bbbb, v.bbbb.ovov)
    h22_bbbbbb += einsum("ijabcd->baicdj", x217)
    h22_bbbbbb -= einsum("ijabcd->baidcj", x217)
    h22_bbbbbb -= einsum("ijabcd->abicdj", x217)
    h22_bbbbbb += einsum("ijabcd->abidcj", x217)
    del x217
    x219 += einsum("ijab->jiab", v.bbbb.oovv)
    x219 += einsum("iabj->jiba", v.bbbb.ovvo) * -1
    h22_bbbbbb += einsum("ab,ijcd->cbiadj", delta_vv.bb, x219)
    h22_bbbbbb += einsum("ab,ijcd->cbidaj", delta_vv.bb, x219) * -1
    del x219
    x220 += einsum("iabj->jiba", v.bbbb.ovvo)
    x220 += einsum("ijab->jiab", v.bbbb.oovv) * -1
    h22_bbbbbb += einsum("ab,ijcd->bcidaj", delta_vv.bb, x220) * -1
    del x220
    x221 += einsum("ijka->jika", v.bbbb.ooov)
    x221 += einsum("ijka->jkia", v.bbbb.ooov) * -1
    x222 += einsum("ia,jikb->kjab", t1.bb, x221) * -1
    del x221
    x222 += einsum("iabj->ijba", v.bbbb.ovvo)
    x222 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    h22_bbbbbb += einsum("ab,ijcd->bcjadi", delta_vv.bb, x222)
    del x222
    x224 += einsum("abcd->cadb", v.bbbb.vvvv)
    x226 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x226 += einsum("abcd->abdc", x224) * -1
    x226 += einsum("abcd->abcd", x224)
    del x224
    x225 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x225 += einsum("ia,ibcd->acbd", t1.bb, v.bbbb.ovvv)
    x226 += einsum("abcd->bacd", x225)
    x226 += einsum("abcd->badc", x225) * -1
    x226 += einsum("abcd->abcd", x225) * -1
    x226 += einsum("abcd->abdc", x225)
    del x225
    h22_bbbbbb += einsum("ij,abcd->bajcdi", delta_oo.bb, x226) * -1
    del x226
    x227 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x227 += einsum("ijab,jckd->ikabcd", t2.aaaa, v.aabb.ovov)
    h22_aaabab = np.zeros((nvir[0], nvir[0], nocc[0], nvir[1], nvir[0], nocc[1]), dtype=np.float64)
    h22_aaabab += einsum("ijabcd->baidcj", x227)
    h22_aaabab -= einsum("ijabcd->abidcj", x227)
    del x227
    x230 += einsum("iabj->jiba", v.bbaa.ovvo)
    h22_aaabab += einsum("ab,ijcd->cbidaj", delta_vv.aa, x230)
    h22_aaabab -= einsum("ab,ijcd->bcidaj", delta_vv.aa, x230)
    h22_ababbb -= einsum("ab,ijcd->cbiadj", delta_vv.bb, x230)
    del x230
    x231 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x231 += einsum("ijab,kcid->kjacdb", t2.abab, v.aaaa.ovov)
    h22_babaaa -= einsum("ijabcd->dajbci", x231)
    h22_babaaa += einsum("ijabcd->dajcbi", x231)
    del x231
    x234 += einsum("iabj->ijab", v.aabb.ovvo)
    h22_babaaa -= einsum("ab,ijcd->dbjaci", delta_vv.aa, x234)
    h22_bbbaba = np.zeros((nvir[1], nvir[1], nocc[1], nvir[0], nvir[1], nocc[0]), dtype=np.float64)
    h22_bbbaba += einsum("ab,ijcd->dbjcai", delta_vv.bb, x234)
    h22_bbbaba -= einsum("ab,ijcd->bdjcai", delta_vv.bb, x234)
    del x234
    x235 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x235 += einsum("ijab,kcjd->ikabcd", t2.abab, v.bbbb.ovov)
    h22_ababbb -= einsum("ijabcd->abicdj", x235)
    h22_ababbb += einsum("ijabcd->abidcj", x235)
    del x235
    x236 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x236 += einsum("ijab,kcjd->kicabd", t2.bbbb, v.aabb.ovov)
    h22_bbbaba += einsum("ijabcd->cbjadi", x236)
    h22_bbbaba -= einsum("ijabcd->bcjadi", x236)
    del x236
    h11_aa += einsum("ab->ab", f.aa.vv)
    h11_bb += einsum("ab->ab", f.bb.vv)
    h12_aaaa += einsum("ab,ic->baci", delta_vv.aa, f.aa.ov)
    h12_aaaa -= einsum("ab,ic->bcai", delta_vv.aa, f.aa.ov)
    h12_bbbb += einsum("ab,ic->baci", delta_vv.bb, f.bb.ov)
    h12_bbbb -= einsum("ab,ic->bcai", delta_vv.bb, f.bb.ov)
    h12_abab -= einsum("iabc->baci", v.bbaa.ovvv)
    h12_abab += einsum("ia,ibjc->acbj", t1.aa, v.aabb.ovov)
    h12_baba -= einsum("iabc->baci", v.aabb.ovvv)
    h21_baba -= einsum("abci->caib", v.aabb.vvvo)
    h21_baba += einsum("ijab,icdb->dajc", t2.abab, v.aabb.ovvv)
    h21_baba += einsum("ijab,icjk->bakc", t2.abab, v.aabb.ovoo) * -1
    h21_abab += einsum("ijab,jcda->dbic", t2.abab, v.bbaa.ovvv)
    h21_abab += einsum("ijab,ikjc->abkc", t2.abab, v.aabb.ooov) * -1
    h21_abab -= einsum("aibc->abic", v.aabb.vovv)
    h22_babbab -= einsum("ijab,ickd->bajdck", t2.abab, v.aabb.ovov)
    h22_abaaba -= einsum("ijab,kcjd->abicdk", t2.abab, v.aabb.ovov)

    return {"h11": h11, "h12": h12, "h21": h21, "h22": h22}

def make_ee_mom_kets(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    ketee1_oo_aaaa = np.zeros((nocc[0], nvir[0], nocc[0], nocc[0]), dtype=np.float64)
    ketee1_oo_aaaa += einsum("ij,ka->jaki", delta_oo.aa, t1.aa) * -0.5
    ketee1_oo_bbbb = np.zeros((nocc[1], nvir[1], nocc[1], nocc[1]), dtype=np.float64)
    ketee1_oo_bbbb += einsum("ij,ka->jaki", delta_oo.bb, t1.bb) * -0.5
    ketee1_ov_aaaa = np.zeros((nocc[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    ketee1_ov_aaaa += einsum("ia,jb->iajb", t1.aa, t1.aa) * -0.5
    ketee1_ov_aaaa += einsum("ijab->jaib", t2.aaaa) * -0.5
    ketee1_ov_aaaa += einsum("ijab->jbia", t2.aaaa) * 0.5
    ketee1_ov_bbbb = np.zeros((nocc[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    ketee1_ov_bbbb += einsum("ia,jb->iajb", t1.bb, t1.bb) * -0.5
    ketee1_ov_bbbb += einsum("ijab->jaib", t2.bbbb) * -0.5
    ketee1_ov_bbbb += einsum("ijab->jbia", t2.bbbb) * 0.5
    ketee1_ov_bbaa = np.zeros((nocc[1], nvir[1], nocc[0], nvir[0]), dtype=np.float64)
    ketee1_ov_bbaa += einsum("ijab->jbia", t2.abab) * 0.5
    ketee1_ov_bbaa += einsum("ia,jb->jbia", t1.aa, t1.bb) * -0.5
    ketee1_ov_aabb = np.zeros((nocc[0], nvir[0], nocc[1], nvir[1]), dtype=np.float64)
    ketee1_ov_aabb += einsum("ijab->iajb", t2.abab) * 0.5
    ketee1_ov_aabb += einsum("ia,jb->iajb", t1.aa, t1.bb) * -0.5
    ketee1_vo_aaaa = np.zeros((nocc[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    ketee1_vo_aaaa += einsum("ab,ij->jbai", delta_vv.aa, delta_oo.aa) * 0.5
    ketee1_vo_bbbb = np.zeros((nocc[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    ketee1_vo_bbbb += einsum("ab,ij->jbai", delta_vv.bb, delta_oo.bb) * 0.5
    ketee1_vv_aaaa = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    ketee1_vv_aaaa += einsum("ab,ic->ibac", delta_vv.aa, t1.aa) * 0.5
    ketee1_vv_bbbb = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    ketee1_vv_bbbb += einsum("ab,ic->ibac", delta_vv.bb, t1.bb) * 0.5
    ketee2_oo_aaaaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nocc[0], nocc[0]), dtype=np.float64)
    ketee2_oo_aaaaaa += einsum("ij,klab->jlabki", delta_oo.aa, t2.aaaa) * -0.5
    ketee2_oo_aaaaaa += einsum("ij,klab->jlbaki", delta_oo.aa, t2.aaaa) * 0.5
    ketee2_oo_aaaaaa += einsum("ij,klab->ljabki", delta_oo.aa, t2.aaaa) * 0.5
    ketee2_oo_aaaaaa += einsum("ij,klab->ljbaki", delta_oo.aa, t2.aaaa) * -0.5
    ketee2_oo_babaaa = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nocc[0], nocc[0]), dtype=np.float64)
    ketee2_oo_babaaa += einsum("ij,klab->ljbaki", delta_oo.aa, t2.abab) * -0.5
    ketee2_oo_ababbb = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nocc[1], nocc[1]), dtype=np.float64)
    ketee2_oo_ababbb += einsum("ij,klab->kjabli", delta_oo.bb, t2.abab) * -0.5
    ketee2_oo_bbbbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nocc[1], nocc[1]), dtype=np.float64)
    ketee2_oo_bbbbbb += einsum("ij,klab->jlabki", delta_oo.bb, t2.bbbb) * -0.5
    ketee2_oo_bbbbbb += einsum("ij,klab->jlbaki", delta_oo.bb, t2.bbbb) * 0.5
    ketee2_oo_bbbbbb += einsum("ij,klab->ljabki", delta_oo.bb, t2.bbbb) * 0.5
    ketee2_oo_bbbbbb += einsum("ij,klab->ljbaki", delta_oo.bb, t2.bbbb) * -0.5
    ketee2_oo_ababaa = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nocc[0], nocc[0]), dtype=np.float64)
    ketee2_oo_ababaa += einsum("ij,klab->jlabki", delta_oo.aa, t2.abab) * -0.5
    ketee2_oo_bababb = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nocc[1], nocc[1]), dtype=np.float64)
    ketee2_oo_bababb += einsum("ij,klab->jkbali", delta_oo.bb, t2.abab) * -0.5
    ketee2_ov_aaaaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    ketee2_ov_aaaaaa += einsum("ia,jkbc->ikbcja", t1.aa, t2.aaaa) * -0.5
    ketee2_ov_aaaaaa += einsum("ia,jkbc->ikcbja", t1.aa, t2.aaaa) * 0.5
    ketee2_ov_aaaaaa += einsum("ia,jkbc->kibcja", t1.aa, t2.aaaa) * 0.5
    ketee2_ov_aaaaaa += einsum("ia,jkbc->kicbja", t1.aa, t2.aaaa) * -0.5
    ketee2_ov_aaaaaa += einsum("ia,jkbc->kjabic", t1.aa, t2.aaaa) * -0.5
    ketee2_ov_aaaaaa += einsum("ia,jkbc->kjacib", t1.aa, t2.aaaa) * 0.5
    ketee2_ov_aaaaaa += einsum("ia,jkbc->kjbaic", t1.aa, t2.aaaa) * 0.5
    ketee2_ov_aaaaaa += einsum("ia,jkbc->kjcaib", t1.aa, t2.aaaa) * -0.5
    ketee2_ov_bbbbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    ketee2_ov_bbbbbb += einsum("ia,jkbc->ikbcja", t1.bb, t2.bbbb) * -0.5
    ketee2_ov_bbbbbb += einsum("ia,jkbc->ikcbja", t1.bb, t2.bbbb) * 0.5
    ketee2_ov_bbbbbb += einsum("ia,jkbc->kibcja", t1.bb, t2.bbbb) * 0.5
    ketee2_ov_bbbbbb += einsum("ia,jkbc->kicbja", t1.bb, t2.bbbb) * -0.5
    ketee2_ov_bbbbbb += einsum("ia,jkbc->kjabic", t1.bb, t2.bbbb) * -0.5
    ketee2_ov_bbbbbb += einsum("ia,jkbc->kjacib", t1.bb, t2.bbbb) * 0.5
    ketee2_ov_bbbbbb += einsum("ia,jkbc->kjbaic", t1.bb, t2.bbbb) * 0.5
    ketee2_ov_bbbbbb += einsum("ia,jkbc->kjcaib", t1.bb, t2.bbbb) * -0.5
    ketee2_ov_ababaa = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nocc[0], nvir[0]), dtype=np.float64)
    ketee2_ov_ababaa += einsum("ia,jkbc->ikbcja", t1.aa, t2.abab) * -0.5
    ketee2_ov_ababaa += einsum("ia,jkbc->jkacib", t1.aa, t2.abab) * -0.5
    ketee2_ov_bababb = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nocc[1], nvir[1]), dtype=np.float64)
    ketee2_ov_bababb += einsum("ia,jkbc->ijcbka", t1.bb, t2.abab) * -0.5
    ketee2_ov_bababb += einsum("ia,jkbc->kjabic", t1.bb, t2.abab) * -0.5
    ketee2_ov_babaaa = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    ketee2_ov_babaaa += einsum("ia,jkbc->kicbja", t1.aa, t2.abab) * -0.5
    ketee2_ov_babaaa += einsum("ia,jkbc->kjcaib", t1.aa, t2.abab) * -0.5
    ketee2_ov_ababbb = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    ketee2_ov_ababbb += einsum("ia,jkbc->jibcka", t1.bb, t2.abab) * -0.5
    ketee2_ov_ababbb += einsum("ia,jkbc->jkbaic", t1.bb, t2.abab) * -0.5
    ketee2_vv_aaaaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    ketee2_vv_aaaaaa += einsum("ab,ijcd->jibcad", delta_vv.aa, t2.aaaa) * 0.5
    ketee2_vv_aaaaaa += einsum("ab,ijcd->jibdac", delta_vv.aa, t2.aaaa) * -0.5
    ketee2_vv_aaaaaa += einsum("ab,ijcd->jicbad", delta_vv.aa, t2.aaaa) * -0.5
    ketee2_vv_aaaaaa += einsum("ab,ijcd->jidbac", delta_vv.aa, t2.aaaa) * 0.5
    ketee2_vv_babaaa = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    ketee2_vv_babaaa += einsum("ab,ijcd->jidbac", delta_vv.aa, t2.abab) * 0.5
    ketee2_vv_ababbb = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    ketee2_vv_ababbb += einsum("ab,ijcd->ijcbad", delta_vv.bb, t2.abab) * 0.5
    ketee2_vv_bbbbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    ketee2_vv_bbbbbb += einsum("ab,ijcd->jibcad", delta_vv.bb, t2.bbbb) * 0.5
    ketee2_vv_bbbbbb += einsum("ab,ijcd->jibdac", delta_vv.bb, t2.bbbb) * -0.5
    ketee2_vv_bbbbbb += einsum("ab,ijcd->jicbad", delta_vv.bb, t2.bbbb) * -0.5
    ketee2_vv_bbbbbb += einsum("ab,ijcd->jidbac", delta_vv.bb, t2.bbbb) * 0.5
    ketee2_vv_ababaa = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nvir[0], nvir[0]), dtype=np.float64)
    ketee2_vv_ababaa += einsum("ab,ijcd->ijbdac", delta_vv.aa, t2.abab) * 0.5
    ketee2_vv_bababb = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    ketee2_vv_bababb += einsum("ab,ijcd->jibcad", delta_vv.bb, t2.abab) * 0.5

    ketee1_oo_abab = np.zeros((nocc[0], nvir[1], nocc[0], nocc[1]), dtype=np.float64)
    ketee1_oo_baba = np.zeros((nocc[1], nvir[0], nocc[1], nocc[0]), dtype=np.float64)
    ketee1_ov_abab = np.zeros((nocc[0], nvir[1], nocc[0], nvir[1]), dtype=np.float64)
    ketee1_ov_baba = np.zeros((nocc[1], nvir[0], nocc[1], nvir[0]), dtype=np.float64)
    ketee1_vo_abab = np.zeros((nocc[0], nvir[1], nvir[0], nocc[1]), dtype=np.float64)
    ketee1_vo_baba = np.zeros((nocc[1], nvir[0], nvir[1], nocc[0]), dtype=np.float64)
    ketee1_vv_abab = np.zeros((nocc[0], nvir[1], nvir[0], nvir[1]), dtype=np.float64)
    ketee1_vv_baba = np.zeros((nocc[1], nvir[0], nvir[1], nvir[0]), dtype=np.float64)
    ketee2_oo_bbbbaa = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nocc[0], nocc[0]), dtype=np.float64)
    ketee2_oo_aaaabb = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nocc[1], nocc[1]), dtype=np.float64)
    ketee2_ov_bbbbaa = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nocc[0], nvir[0]), dtype=np.float64)
    ketee2_ov_aaaabb = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nocc[1], nvir[1]), dtype=np.float64)
    ketee2_vo_aaaaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    ketee2_vo_ababaa = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nvir[0], nocc[0]), dtype=np.float64)
    ketee2_vo_babaaa = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nvir[0], nocc[0]), dtype=np.float64)
    ketee2_vo_bbbbaa = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nvir[0], nocc[0]), dtype=np.float64)
    ketee2_vo_aaaabb = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nvir[1], nocc[1]), dtype=np.float64)
    ketee2_vo_ababbb = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    ketee2_vo_bababb = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0], nvir[1], nocc[1]), dtype=np.float64)
    ketee2_vo_bbbbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nvir[1], nocc[1]), dtype=np.float64)
    ketee2_vv_bbbbaa = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1], nvir[0], nvir[0]), dtype=np.float64)
    ketee2_vv_aaaabb = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)

    ketee1_aaaa = np.concatenate([np.concatenate([ketee1_oo_aaaa, ketee1_ov_aaaa], axis=-1), np.concatenate([ketee1_vo_aaaa, ketee1_vv_aaaa], axis=-1)], axis=-2)
    ketee1_abab = np.concatenate([np.concatenate([ketee1_oo_abab, ketee1_ov_abab], axis=-1), np.concatenate([ketee1_vo_abab, ketee1_vv_abab], axis=-1)], axis=-2)
    ketee1_baba = np.concatenate([np.concatenate([ketee1_oo_baba, ketee1_ov_baba], axis=-1), np.concatenate([ketee1_vo_baba, ketee1_vv_baba], axis=-1)], axis=-2)
    ketee1_bbbb = np.concatenate([np.concatenate([ketee1_oo_bbbb, ketee1_ov_bbbb], axis=-1), np.concatenate([ketee1_vo_bbbb, ketee1_vv_bbbb], axis=-1)], axis=-2)
    ketee2_aaaaaa = np.concatenate([np.concatenate([ketee2_oo_aaaaaa, ketee2_ov_aaaaaa], axis=-1), np.concatenate([ketee2_vo_aaaaaa, ketee2_vv_aaaaaa], axis=-1)], axis=-2)
    ketee2_ababaa = np.concatenate([np.concatenate([ketee2_oo_ababaa, ketee2_ov_ababaa], axis=-1), np.concatenate([ketee2_vo_ababaa, ketee2_vv_ababaa], axis=-1)], axis=-2)
    ketee2_babaaa = np.concatenate([np.concatenate([ketee2_oo_babaaa, ketee2_ov_babaaa], axis=-1), np.concatenate([ketee2_vo_babaaa, ketee2_vv_babaaa], axis=-1)], axis=-2)
    ketee2_bbbbaa = np.concatenate([np.concatenate([ketee2_oo_bbbbaa, ketee2_ov_bbbbaa], axis=-1), np.concatenate([ketee2_vo_bbbbaa, ketee2_vv_bbbbaa], axis=-1)], axis=-2)
    ketee2_aaaabb = np.concatenate([np.concatenate([ketee2_oo_aaaabb, ketee2_ov_aaaabb], axis=-1), np.concatenate([ketee2_vo_aaaabb, ketee2_vv_aaaabb], axis=-1)], axis=-2)
    ketee2_ababbb = np.concatenate([np.concatenate([ketee2_oo_ababbb, ketee2_ov_ababbb], axis=-1), np.concatenate([ketee2_vo_ababbb, ketee2_vv_ababbb], axis=-1)], axis=-2)
    ketee2_bababb = np.concatenate([np.concatenate([ketee2_oo_bababb, ketee2_ov_bababb], axis=-1), np.concatenate([ketee2_vo_bababb, ketee2_vv_bababb], axis=-1)], axis=-2)
    ketee2_bbbbbb = np.concatenate([np.concatenate([ketee2_oo_bbbbbb, ketee2_ov_bbbbbb], axis=-1), np.concatenate([ketee2_vo_bbbbbb, ketee2_vv_bbbbbb], axis=-1)], axis=-2)

    ketee1 = SimpleNamespace(aaaa=ketee1_aaaa, abab=ketee1_abab, baba=ketee1_baba, bbbb=ketee1_bbbb)
    ketee2 = SimpleNamespace(aaaaaa=ketee2_aaaaaa, ababaa=ketee2_ababaa, babaaa=ketee2_babaaa, bbbbaa=ketee2_bbbbaa, aaaabb=ketee2_aaaabb, ababbb=ketee2_ababbb, bababb=ketee2_bababb, bbbbbb=ketee2_bbbbbb)

    return ketee1, ketee2

def make_ee_mom_bras(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    x0 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x0 += einsum("ia,abjk->kjib", t1.aa, l2.aaaa)
    x20 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x20 += einsum("ijka->ikja", x0) * -1
    x20 += einsum("ijka->jkia", x0)
    x21 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x21 += einsum("ijka->ijka", x0)
    x21 += einsum("ijka->jika", x0) * -1
    braee1_oo_aaaa = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    braee1_oo_aaaa += einsum("ijka->kija", x0) * 0.5
    braee1_oo_aaaa += einsum("ijka->kjia", x0) * -0.5
    del x0
    x1 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x1 += einsum("ia,abjk->kjib", t1.bb, l2.bbbb)
    x24 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x24 += einsum("ijka->ikja", x1)
    x24 += einsum("ijka->jkia", x1) * -1
    x25 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x25 += einsum("ijka->ijka", x1)
    x25 += einsum("ijka->jika", x1) * -1
    braee1_oo_bbbb = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    braee1_oo_bbbb += einsum("ijka->kija", x1) * 0.5
    braee1_oo_bbbb += einsum("ijka->kjia", x1) * -0.5
    del x1
    x2 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x2 += einsum("ia,abjk->jikb", t1.aa, l2.abab)
    x22 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x22 += einsum("ijka->ijka", x2) * -1
    braee1_oo_aabb = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    braee1_oo_aabb += einsum("ijka->jika", x2) * -0.5
    del x2
    x3 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x3 += einsum("ia,bajk->jkib", t1.bb, l2.abab)
    x23 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x23 += einsum("ijka->ijka", x3) * -1
    braee1_oo_bbaa = np.zeros((nocc[1], nocc[1], nocc[0], nvir[0]), dtype=np.float64)
    braee1_oo_bbaa += einsum("ijka->kjia", x3) * -0.5
    del x3
    x4 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x4 += einsum("ia,jb->ijab", t1.aa, t1.aa)
    x4 += einsum("ijab->jiab", t2.aaaa) * -1
    x4 += einsum("ijab->jiba", t2.aaaa)
    braee1_ov_aabb = np.zeros((nocc[0], nvir[0], nocc[1], nvir[1]), dtype=np.float64)
    braee1_ov_aabb += einsum("abij,ikca->kcjb", l2.abab, x4) * -0.5
    x5 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x5 += einsum("abij->jiab", l2.aaaa)
    x5 += einsum("abij->jiba", l2.aaaa) * -1
    braee1_ov_aaaa = np.zeros((nocc[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    braee1_ov_aaaa += einsum("ijab,ikbc->jakc", x4, x5) * 0.5
    del x4
    del x5
    x6 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x6 += einsum("ijab->jiab", t2.aaaa)
    x6 += einsum("ijab->jiba", t2.aaaa) * -1
    x7 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x7 += einsum("abij,ijac->bc", l2.aaaa, x6) * -1
    x8 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x8 += einsum("abij,ikab->jk", l2.aaaa, x6) * -1
    del x6
    x7 += einsum("ab->ba", delta_vv.aa) * -1
    x7 += einsum("ai,ib->ab", l1.aa, t1.aa)
    x7 += einsum("abij,ijcb->ac", l2.abab, t2.abab)
    braee1_ov_aaaa += einsum("ij,ab->jbia", delta_oo.aa, x7) * -0.5
    del x7
    x8 += einsum("ai,ja->ij", l1.aa, t1.aa)
    x8 += einsum("abij,kjab->ik", l2.abab, t2.abab)
    braee1_ov_aaaa += einsum("ab,ij->jbia", delta_vv.aa, x8) * -0.5
    del x8
    x9 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x9 += einsum("ia,jb->ijab", t1.bb, t1.bb)
    x9 += einsum("ijab->jiab", t2.bbbb) * -1
    x9 += einsum("ijab->jiba", t2.bbbb)
    braee1_ov_bbaa = np.zeros((nocc[1], nvir[1], nocc[0], nvir[0]), dtype=np.float64)
    braee1_ov_bbaa += einsum("abij,jkcb->kcia", l2.abab, x9) * -0.5
    x10 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x10 += einsum("abij->jiab", l2.bbbb)
    x10 += einsum("abij->jiba", l2.bbbb) * -1
    braee1_ov_bbbb = np.zeros((nocc[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    braee1_ov_bbbb += einsum("ijab,ikca->kcjb", x10, x9) * 0.5
    del x9
    del x10
    x11 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x11 += einsum("ijab->jiab", t2.bbbb) * -1
    x11 += einsum("ijab->jiba", t2.bbbb)
    x12 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x12 += einsum("abij,ijca->bc", l2.bbbb, x11) * -1
    x13 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x13 += einsum("abij,ikba->jk", l2.bbbb, x11) * -1
    del x11
    x12 += einsum("ab->ba", delta_vv.bb) * -1
    x12 += einsum("ai,ib->ab", l1.bb, t1.bb)
    x12 += einsum("abij,ijac->bc", l2.abab, t2.abab)
    braee1_ov_bbbb += einsum("ij,ab->jbia", delta_oo.bb, x12) * -0.5
    del x12
    x13 += einsum("ai,ja->ij", l1.bb, t1.bb)
    x13 += einsum("abij,ikab->jk", l2.abab, t2.abab)
    braee1_ov_bbbb += einsum("ab,ij->jbia", delta_vv.bb, x13) * -0.5
    del x13
    x14 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x14 += einsum("abij->jiab", l2.aaaa) * -1
    x14 += einsum("abij->jiba", l2.aaaa)
    braee1_ov_bbaa += einsum("ijab,ikca->jbkc", t2.abab, x14) * -0.5
    del x14
    x15 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x15 += einsum("abij->jiab", l2.bbbb) * -1
    x15 += einsum("abij->jiba", l2.bbbb)
    braee1_ov_aabb += einsum("ijab,jkcb->iakc", t2.abab, x15) * -0.5
    del x15
    x16 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x16 += einsum("ia,bcji->jbca", t1.aa, l2.aaaa)
    braee1_vv_aaaa = np.zeros((nvir[0], nvir[0], nocc[0], nvir[0]), dtype=np.float64)
    braee1_vv_aaaa += einsum("iabc->acib", x16) * -0.5
    braee1_vv_aaaa += einsum("iabc->bcia", x16) * 0.5
    braee2_ov_aaaaaa = np.zeros((nocc[0], nvir[0], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    braee2_ov_aaaaaa += einsum("ij,kabc->icjkab", delta_oo.aa, x16) * 0.5
    braee2_ov_aaaaaa += einsum("ij,kabc->icjkba", delta_oo.aa, x16) * -0.5
    braee2_ov_aaaaaa += einsum("ij,kabc->ickjab", delta_oo.aa, x16) * -0.5
    braee2_ov_aaaaaa += einsum("ij,kabc->ickjba", delta_oo.aa, x16) * 0.5
    del x16
    x17 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x17 += einsum("ia,bcji->jbca", t1.bb, l2.bbbb)
    braee1_vv_bbbb = np.zeros((nvir[1], nvir[1], nocc[1], nvir[1]), dtype=np.float64)
    braee1_vv_bbbb += einsum("iabc->acib", x17) * -0.5
    braee1_vv_bbbb += einsum("iabc->bcia", x17) * 0.5
    braee2_ov_bbbbbb = np.zeros((nocc[1], nvir[1], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_ov_bbbbbb += einsum("ij,kabc->icjkab", delta_oo.bb, x17) * 0.5
    braee2_ov_bbbbbb += einsum("ij,kabc->icjkba", delta_oo.bb, x17) * -0.5
    braee2_ov_bbbbbb += einsum("ij,kabc->ickjab", delta_oo.bb, x17) * -0.5
    braee2_ov_bbbbbb += einsum("ij,kabc->ickjba", delta_oo.bb, x17) * 0.5
    del x17
    x18 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x18 += einsum("ia,bcij->jbac", t1.aa, l2.abab)
    braee1_vv_aabb = np.zeros((nvir[0], nvir[0], nocc[1], nvir[1]), dtype=np.float64)
    braee1_vv_aabb += einsum("iabc->abic", x18) * 0.5
    braee2_ov_aababa = np.zeros((nocc[0], nvir[0], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_ov_aababa += einsum("ij,kabc->ibkjca", delta_oo.aa, x18) * -0.5
    braee2_ov_aaabab = np.zeros((nocc[0], nvir[0], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_ov_aaabab += einsum("ij,kabc->ibjkac", delta_oo.aa, x18) * -0.5
    del x18
    x19 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x19 += einsum("ia,bcji->jbca", t1.bb, l2.abab)
    braee1_vv_bbaa = np.zeros((nvir[1], nvir[1], nocc[0], nvir[0]), dtype=np.float64)
    braee1_vv_bbaa += einsum("iabc->bcia", x19) * 0.5
    braee2_ov_bbbaba = np.zeros((nocc[1], nvir[1], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_ov_bbbaba += einsum("ij,kabc->icjkba", delta_oo.bb, x19) * -0.5
    braee2_ov_bbabab = np.zeros((nocc[1], nvir[1], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_ov_bbabab += einsum("ij,kabc->ickjab", delta_oo.bb, x19) * -0.5
    del x19
    x20 += einsum("ij,ak->jika", delta_oo.aa, l1.aa) * -1
    x20 += einsum("ij,ak->kjia", delta_oo.aa, l1.aa)
    braee2_ov_aaaaaa += einsum("ab,ijkc->jbikac", delta_vv.aa, x20) * -0.5
    del x20
    x21 += einsum("ij,ak->jkia", delta_oo.aa, l1.aa)
    x21 += einsum("ij,ak->kjia", delta_oo.aa, l1.aa) * -1
    braee2_ov_aaaaaa += einsum("ab,ijkc->kbijca", delta_vv.aa, x21) * -0.5
    del x21
    x22 += einsum("ij,ak->jika", delta_oo.aa, l1.bb)
    braee2_ov_aababa += einsum("ab,ijkc->jbkica", delta_vv.aa, x22) * 0.5
    braee2_ov_aaabab += einsum("ab,ijkc->jbikac", delta_vv.aa, x22) * 0.5
    del x22
    x23 += einsum("ij,ak->kjia", delta_oo.bb, l1.aa)
    braee2_ov_bbbaba += einsum("ab,ijkc->kbjiac", delta_vv.bb, x23) * 0.5
    braee2_ov_bbabab += einsum("ab,ijkc->kbijca", delta_vv.bb, x23) * 0.5
    del x23
    x24 += einsum("ij,ak->jika", delta_oo.bb, l1.bb)
    x24 += einsum("ij,ak->kjia", delta_oo.bb, l1.bb) * -1
    braee2_ov_bbbbbb += einsum("ab,ijkc->jbkiac", delta_vv.bb, x24) * -0.5
    del x24
    x25 += einsum("ij,ak->jkia", delta_oo.bb, l1.bb)
    x25 += einsum("ij,ak->kjia", delta_oo.bb, l1.bb) * -1
    braee2_ov_bbbbbb += einsum("ab,ijkc->kbijca", delta_vv.bb, x25) * -0.5
    del x25
    braee1_oo_aaaa += einsum("ij,ak->jika", delta_oo.aa, l1.aa) * 0.5
    braee1_oo_aaaa += einsum("ij,ak->jkia", delta_oo.aa, l1.aa) * -0.5
    braee1_oo_bbbb += einsum("ij,ak->jika", delta_oo.bb, l1.bb) * 0.5
    braee1_oo_bbbb += einsum("ij,ak->jkia", delta_oo.bb, l1.bb) * -0.5
    braee1_oo_aabb += einsum("ij,ak->jika", delta_oo.aa, l1.bb) * 0.5
    braee1_oo_bbaa += einsum("ij,ak->jika", delta_oo.bb, l1.aa) * 0.5
    braee1_ov_aaaa += einsum("abij,kjcb->kcia", l2.abab, t2.abab) * 0.5
    braee1_ov_aaaa += einsum("ai,jb->jbia", l1.aa, t1.aa) * 0.5
    braee1_ov_bbbb += einsum("abij,ikac->kcjb", l2.abab, t2.abab) * 0.5
    braee1_ov_bbbb += einsum("ai,jb->jbia", l1.bb, t1.bb) * 0.5
    braee1_ov_bbaa += einsum("ai,jb->jbia", l1.aa, t1.bb) * 0.5
    braee1_ov_aabb += einsum("ai,jb->jbia", l1.bb, t1.aa) * 0.5
    braee1_vo_aaaa = np.zeros((nvir[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    braee1_vo_aaaa += einsum("abij->ajib", l2.aaaa) * -0.5
    braee1_vo_aaaa += einsum("abij->bjia", l2.aaaa) * 0.5
    braee1_vo_bbbb = np.zeros((nvir[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    braee1_vo_bbbb += einsum("abij->ajib", l2.bbbb) * -0.5
    braee1_vo_bbbb += einsum("abij->bjia", l2.bbbb) * 0.5
    braee1_vo_bbaa = np.zeros((nvir[1], nocc[1], nocc[0], nvir[0]), dtype=np.float64)
    braee1_vo_bbaa += einsum("abij->bjia", l2.abab) * 0.5
    braee1_vo_aabb = np.zeros((nvir[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    braee1_vo_aabb += einsum("abij->aijb", l2.abab) * 0.5
    braee1_vv_aaaa += einsum("ab,ci->cbia", delta_vv.aa, l1.aa) * 0.5
    braee1_vv_bbbb += einsum("ab,ci->cbia", delta_vv.bb, l1.bb) * 0.5
    braee2_oo_aaaaaa = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    braee2_oo_aaaaaa += einsum("ij,abkl->jilkab", delta_oo.aa, l2.aaaa) * -0.5
    braee2_oo_aaaaaa += einsum("ij,abkl->jilkba", delta_oo.aa, l2.aaaa) * 0.5
    braee2_oo_aaaaaa += einsum("ij,abkl->jlikab", delta_oo.aa, l2.aaaa) * 0.5
    braee2_oo_aaaaaa += einsum("ij,abkl->jlikba", delta_oo.aa, l2.aaaa) * -0.5
    braee2_oo_aaaaaa += einsum("ij,abkl->jlkiab", delta_oo.aa, l2.aaaa) * -0.5
    braee2_oo_aaaaaa += einsum("ij,abkl->jlkiba", delta_oo.aa, l2.aaaa) * 0.5
    braee2_oo_bbbbbb = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_oo_bbbbbb += einsum("ij,abkl->jilkab", delta_oo.bb, l2.bbbb) * -0.5
    braee2_oo_bbbbbb += einsum("ij,abkl->jilkba", delta_oo.bb, l2.bbbb) * 0.5
    braee2_oo_bbbbbb += einsum("ij,abkl->jlikab", delta_oo.bb, l2.bbbb) * 0.5
    braee2_oo_bbbbbb += einsum("ij,abkl->jlikba", delta_oo.bb, l2.bbbb) * -0.5
    braee2_oo_bbbbbb += einsum("ij,abkl->jlkiab", delta_oo.bb, l2.bbbb) * -0.5
    braee2_oo_bbbbbb += einsum("ij,abkl->jlkiba", delta_oo.bb, l2.bbbb) * 0.5
    braee2_oo_aababa = np.zeros((nocc[0], nocc[0], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_oo_aababa += einsum("ij,abkl->jilkba", delta_oo.aa, l2.abab) * 0.5
    braee2_oo_aababa += einsum("ij,abkl->jkliba", delta_oo.aa, l2.abab) * -0.5
    braee2_oo_bbabab = np.zeros((nocc[1], nocc[1], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_oo_bbabab += einsum("ij,abkl->jiklab", delta_oo.bb, l2.abab) * 0.5
    braee2_oo_bbabab += einsum("ij,abkl->jlkiab", delta_oo.bb, l2.abab) * -0.5
    braee2_oo_aaabab = np.zeros((nocc[0], nocc[0], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_oo_aaabab += einsum("ij,abkl->jiklab", delta_oo.aa, l2.abab) * 0.5
    braee2_oo_aaabab += einsum("ij,abkl->jkilab", delta_oo.aa, l2.abab) * -0.5
    braee2_oo_aabbbb = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_oo_aabbbb += einsum("ij,abkl->jilkab", delta_oo.aa, l2.bbbb) * -0.5
    braee2_oo_aabbbb += einsum("ij,abkl->jilkba", delta_oo.aa, l2.bbbb) * 0.5
    braee2_oo_bbaaaa = np.zeros((nocc[1], nocc[1], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    braee2_oo_bbaaaa += einsum("ij,abkl->jilkab", delta_oo.bb, l2.aaaa) * -0.5
    braee2_oo_bbaaaa += einsum("ij,abkl->jilkba", delta_oo.bb, l2.aaaa) * 0.5
    braee2_oo_bbbaba = np.zeros((nocc[1], nocc[1], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_oo_bbbaba += einsum("ij,abkl->jilkba", delta_oo.bb, l2.abab) * 0.5
    braee2_oo_bbbaba += einsum("ij,abkl->jlikba", delta_oo.bb, l2.abab) * -0.5
    braee2_ov_aaaaaa += einsum("ia,bcjk->iakjbc", t1.aa, l2.aaaa) * -0.5
    braee2_ov_aaaaaa += einsum("ia,bcjk->iakjcb", t1.aa, l2.aaaa) * 0.5
    braee2_ov_aababa += einsum("ia,bcjk->iakjcb", t1.aa, l2.abab) * 0.5
    braee2_ov_aaabab += einsum("ia,bcjk->iajkbc", t1.aa, l2.abab) * 0.5
    braee2_ov_aabbbb = np.zeros((nocc[0], nvir[0], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_ov_aabbbb += einsum("ia,bcjk->iakjbc", t1.aa, l2.bbbb) * -0.5
    braee2_ov_aabbbb += einsum("ia,bcjk->iakjcb", t1.aa, l2.bbbb) * 0.5
    braee2_ov_bbaaaa = np.zeros((nocc[1], nvir[1], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    braee2_ov_bbaaaa += einsum("ia,bcjk->iakjbc", t1.bb, l2.aaaa) * -0.5
    braee2_ov_bbaaaa += einsum("ia,bcjk->iakjcb", t1.bb, l2.aaaa) * 0.5
    braee2_ov_bbbaba += einsum("ia,bcjk->iakjcb", t1.bb, l2.abab) * 0.5
    braee2_ov_bbabab += einsum("ia,bcjk->iajkbc", t1.bb, l2.abab) * 0.5
    braee2_ov_bbbbbb += einsum("ia,bcjk->iakjbc", t1.bb, l2.bbbb) * -0.5
    braee2_ov_bbbbbb += einsum("ia,bcjk->iakjcb", t1.bb, l2.bbbb) * 0.5
    braee2_vv_aaaaaa = np.zeros((nvir[0], nvir[0], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    braee2_vv_aaaaaa += einsum("ab,cdij->cbjiad", delta_vv.aa, l2.aaaa) * -0.5
    braee2_vv_aaaaaa += einsum("ab,cdij->dbjiac", delta_vv.aa, l2.aaaa) * 0.5
    braee2_vv_aaaaaa += einsum("ab,cdij->cbjida", delta_vv.aa, l2.aaaa) * 0.5
    braee2_vv_aaaaaa += einsum("ab,cdij->dbjica", delta_vv.aa, l2.aaaa) * -0.5
    braee2_vv_bbbbbb = np.zeros((nvir[1], nvir[1], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_vv_bbbbbb += einsum("ab,cdij->cbjiad", delta_vv.bb, l2.bbbb) * -0.5
    braee2_vv_bbbbbb += einsum("ab,cdij->dbjiac", delta_vv.bb, l2.bbbb) * 0.5
    braee2_vv_bbbbbb += einsum("ab,cdij->cbjida", delta_vv.bb, l2.bbbb) * 0.5
    braee2_vv_bbbbbb += einsum("ab,cdij->dbjica", delta_vv.bb, l2.bbbb) * -0.5
    braee2_vv_aababa = np.zeros((nvir[0], nvir[0], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_vv_aababa += einsum("ab,cdij->cbjida", delta_vv.aa, l2.abab) * 0.5
    braee2_vv_bbabab = np.zeros((nvir[1], nvir[1], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_vv_bbabab += einsum("ab,cdij->dbijca", delta_vv.bb, l2.abab) * 0.5
    braee2_vv_aaabab = np.zeros((nvir[0], nvir[0], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_vv_aaabab += einsum("ab,cdij->cbijad", delta_vv.aa, l2.abab) * 0.5
    braee2_vv_bbbaba = np.zeros((nvir[1], nvir[1], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_vv_bbbaba += einsum("ab,cdij->dbjiac", delta_vv.bb, l2.abab) * 0.5

    braee1_oo_abab = np.zeros((nocc[0], nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    braee1_oo_baba = np.zeros((nocc[1], nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    braee1_ov_abab = np.zeros((nocc[0], nvir[1], nocc[0], nvir[1]), dtype=np.float64)
    braee1_ov_baba = np.zeros((nocc[1], nvir[0], nocc[1], nvir[0]), dtype=np.float64)
    braee1_vo_abab = np.zeros((nvir[0], nocc[1], nocc[0], nvir[1]), dtype=np.float64)
    braee1_vo_baba = np.zeros((nvir[1], nocc[0], nocc[1], nvir[0]), dtype=np.float64)
    braee1_vv_abab = np.zeros((nvir[0], nvir[1], nocc[0], nvir[1]), dtype=np.float64)
    braee1_vv_baba = np.zeros((nvir[1], nvir[0], nocc[1], nvir[0]), dtype=np.float64)
    braee2_vo_aaaaaa = np.zeros((nvir[0], nocc[0], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    braee2_vo_aaabab = np.zeros((nvir[0], nocc[0], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_vo_aababa = np.zeros((nvir[0], nocc[0], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_vo_aabbbb = np.zeros((nvir[0], nocc[0], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_vo_bbaaaa = np.zeros((nvir[1], nocc[1], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    braee2_vo_bbabab = np.zeros((nvir[1], nocc[1], nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    braee2_vo_bbbaba = np.zeros((nvir[1], nocc[1], nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    braee2_vo_bbbbbb = np.zeros((nvir[1], nocc[1], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_vv_aabbbb = np.zeros((nvir[0], nvir[0], nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    braee2_vv_bbaaaa = np.zeros((nvir[1], nvir[1], nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)

    braee1_aaaa = np.concatenate([np.concatenate([braee1_oo_aaaa, braee1_ov_aaaa], axis=1), np.concatenate([braee1_vo_aaaa, braee1_vv_aaaa], axis=1)], axis=0)
    braee1_abab = np.concatenate([np.concatenate([braee1_oo_abab, braee1_ov_abab], axis=1), np.concatenate([braee1_vo_abab, braee1_vv_abab], axis=1)], axis=0)
    braee1_baba = np.concatenate([np.concatenate([braee1_oo_baba, braee1_ov_baba], axis=1), np.concatenate([braee1_vo_baba, braee1_vv_baba], axis=1)], axis=0)
    braee1_bbbb = np.concatenate([np.concatenate([braee1_oo_bbbb, braee1_ov_bbbb], axis=1), np.concatenate([braee1_vo_bbbb, braee1_vv_bbbb], axis=1)], axis=0)
    braee2_aaaaaa = np.concatenate([np.concatenate([braee2_oo_aaaaaa, braee2_ov_aaaaaa], axis=1), np.concatenate([braee2_vo_aaaaaa, braee2_vv_aaaaaa], axis=1)], axis=0)
    braee2_aaabab = np.concatenate([np.concatenate([braee2_oo_aaabab, braee2_ov_aaabab], axis=1), np.concatenate([braee2_vo_aaabab, braee2_vv_aaabab], axis=1)], axis=0)
    braee2_aababa = np.concatenate([np.concatenate([braee2_oo_aababa, braee2_ov_aababa], axis=1), np.concatenate([braee2_vo_aababa, braee2_vv_aababa], axis=1)], axis=0)
    braee2_aabbbb = np.concatenate([np.concatenate([braee2_oo_aabbbb, braee2_ov_aabbbb], axis=1), np.concatenate([braee2_vo_aabbbb, braee2_vv_aabbbb], axis=1)], axis=0)
    braee2_bbaaaa = np.concatenate([np.concatenate([braee2_oo_bbaaaa, braee2_ov_bbaaaa], axis=1), np.concatenate([braee2_vo_bbaaaa, braee2_vv_bbaaaa], axis=1)], axis=0)
    braee2_bbabab = np.concatenate([np.concatenate([braee2_oo_bbabab, braee2_ov_bbabab], axis=1), np.concatenate([braee2_vo_bbabab, braee2_vv_bbabab], axis=1)], axis=0)
    braee2_bbbaba = np.concatenate([np.concatenate([braee2_oo_bbbaba, braee2_ov_bbbaba], axis=1), np.concatenate([braee2_vo_bbbaba, braee2_vv_bbbaba], axis=1)], axis=0)
    braee2_bbbbbb = np.concatenate([np.concatenate([braee2_oo_bbbbbb, braee2_ov_bbbbbb], axis=1), np.concatenate([braee2_vo_bbbbbb, braee2_vv_bbbbbb], axis=1)], axis=0)

    braee1 = SimpleNamespace(aaaa=braee1_aaaa, abab=braee1_abab, baba=braee1_baba, bbbb=braee1_bbbb)
    braee2 = SimpleNamespace(aaaaaa=braee2_aaaaaa, aaabab=braee2_aaabab, aababa=braee2_aababa, aabbbb=braee2_aabbbb, bbaaaa=braee2_bbaaaa, bbabab=braee2_bbabab, bbbaba=braee2_bbbaba, bbbbbb=braee2_bbbbbb)

    return braee1, braee2

def hbar_diag_ee(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, **kwargs):
    delta_oo = SimpleNamespace()
    delta_oo.aa = np.eye(nocc[0])
    delta_oo.bb = np.eye(nocc[1])
    delta_vv = SimpleNamespace()
    delta_vv.aa = np.eye(nvir[0])
    delta_vv.bb = np.eye(nvir[1])

    ree1_aaaa = np.zeros((nocc[0],  nvir[0]), dtype=np.float64)
    ree1_aaaa += einsum("ab,ijcd,idkc->ja", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree1_aaaa += einsum("ab,ijcd,ickd->ja", delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree1_aaaa += einsum("ab,ic,jd,jckd->ia", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree1_aaaa += einsum("ab,ic,jd,jdkc->ia", delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree1_aaaa += einsum("ab,ijcd,ickd->ja", delta_vv.aa, t2.baba, v.bbaa.ovov) * -1
    ree1_aaaa -= einsum("ab,ic,jd,jdkc->ia", delta_vv.aa, t1.aa, t1.bb, v.bbaa.ovov)
    ree1_aaaa += einsum("ij,klab,lckb->ia", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree1_aaaa += einsum("ij,klab,kclb->ia", delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree1_aaaa += einsum("ij,ka,lb,lckb->ia", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree1_aaaa += einsum("ij,ka,lb,kclb->ia", delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree1_aaaa += einsum("ia,ibjk->ka", t1.aa, v.aaaa.ovoo)
    ree1_aaaa -= einsum("ia,ijkb->ja", t1.aa, v.aaaa.ooov)
    ree1_aaaa -= einsum("ij,ka,kb->ib", delta_oo.aa, f.aa.ov, t1.aa)
    ree1_aaaa += einsum("ia,bajc->ib", t1.aa, v.aaaa.vvov)
    ree1_aaaa -= einsum("ia,bcja->ib", t1.aa, v.aaaa.vvov)
    ree1_aaaa -= einsum("ab,ic,jc->ja", delta_vv.aa, f.aa.ov, t1.aa)
    ree1_aaaa += einsum("ijab,ickb->ja", t2.aaaa, v.aaaa.ovov)
    ree1_aaaa += einsum("ijab,iakc->jb", t2.aaaa, v.aaaa.ovov)
    ree1_aaaa -= einsum("ijab,ibkc->ja", t2.aaaa, v.aaaa.ovov)
    ree1_aaaa -= einsum("ijab,icka->jb", t2.aaaa, v.aaaa.ovov)
    ree1_aaaa += einsum("ab,ic,ijkc->ja", delta_vv.aa, t1.aa, v.aaaa.ooov)
    ree1_aaaa += einsum("ij,ka,bcka->ib", delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree1_aaaa += einsum("ia,jb,jcka->ib", t1.aa, t1.aa, v.aaaa.ovov)
    ree1_aaaa -= einsum("ab,ic,icjk->ka", delta_vv.aa, t1.aa, v.aaaa.ovoo)
    ree1_aaaa -= einsum("ij,ka,bakc->ib", delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree1_aaaa -= einsum("ia,jb,jakc->ib", t1.aa, t1.aa, v.aaaa.ovov)
    ree1_aaaa += einsum("ijab,iakc->jb", t2.baba, v.bbaa.ovov)
    ree1_aaaa += einsum("ij,ka,bcka->ib", delta_oo.aa, t1.bb, v.aabb.vvov)
    ree1_aaaa -= einsum("ab,ic,icjk->ka", delta_vv.aa, t1.bb, v.bbaa.ovoo)
    ree1_aaaa -= einsum("abij->ja", v.aaaa.vvoo)
    ree1_aaaa += einsum("ij,ab->ia", delta_oo.aa, f.aa.vv)
    ree1_aaaa -= einsum("ab,ij->ja", delta_vv.aa, f.aa.oo)
    ree1_aaaa += einsum("aijb->ia", v.aaaa.voov)
    ree1_aaaa += einsum("ij,klab,kclb->ia", delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree1_aaaa -= einsum("ij,ka,lb,lcka->ib", delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree1_bbbb = np.zeros((nocc[1],  nvir[1]), dtype=np.float64)
    ree1_bbbb += einsum("ia,ibjk->ka", t1.bb, v.bbbb.ovoo)
    ree1_bbbb -= einsum("ia,ijkb->ja", t1.bb, v.bbbb.ooov)
    ree1_bbbb -= einsum("ij,ka,kb->ib", delta_oo.bb, f.bb.ov, t1.bb)
    ree1_bbbb += einsum("ij,klab,kclb->ia", delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree1_bbbb -= einsum("ij,ka,lb,lcka->ib", delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree1_bbbb += einsum("ia,bajc->ib", t1.bb, v.bbbb.vvov)
    ree1_bbbb -= einsum("ia,bcja->ib", t1.bb, v.bbbb.vvov)
    ree1_bbbb -= einsum("ab,ic,jc->ja", delta_vv.bb, f.bb.ov, t1.bb)
    ree1_bbbb += einsum("ij,klab,lckb->ia", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree1_bbbb += einsum("ij,klab,kclb->ia", delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree1_bbbb += einsum("ij,ka,lb,lckb->ia", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree1_bbbb += einsum("ij,ka,lb,kclb->ia", delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree1_bbbb -= einsum("abij->ja", v.bbbb.vvoo)
    ree1_bbbb += einsum("ij,ab->ia", delta_oo.bb, f.bb.vv)
    ree1_bbbb -= einsum("ab,ij->ja", delta_vv.bb, f.bb.oo)
    ree1_bbbb += einsum("aijb->ia", v.bbbb.voov)
    ree1_bbbb += einsum("ijab,ickb->ja", t2.bbbb, v.bbbb.ovov)
    ree1_bbbb += einsum("ijab,iakc->jb", t2.bbbb, v.bbbb.ovov)
    ree1_bbbb -= einsum("ijab,ibkc->ja", t2.bbbb, v.bbbb.ovov)
    ree1_bbbb -= einsum("ijab,icka->jb", t2.bbbb, v.bbbb.ovov)
    ree1_bbbb += einsum("ab,ic,ijkc->ja", delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree1_bbbb += einsum("ij,ka,bcka->ib", delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree1_bbbb += einsum("ia,jb,jcka->ib", t1.bb, t1.bb, v.bbbb.ovov)
    ree1_bbbb -= einsum("ab,ic,icjk->ka", delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree1_bbbb -= einsum("ij,ka,bakc->ib", delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree1_bbbb -= einsum("ia,jb,jakc->ib", t1.bb, t1.bb, v.bbbb.ovov)
    ree1_bbbb += einsum("ab,ijcd,ickd->ja", delta_vv.bb, t2.abab, v.aabb.ovov) * -1
    ree1_bbbb -= einsum("ab,ic,jd,ickd->ja", delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree1_bbbb += einsum("ab,ijcd,idkc->ja", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree1_bbbb += einsum("ab,ijcd,ickd->ja", delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree1_bbbb += einsum("ab,ic,jd,jckd->ia", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree1_bbbb += einsum("ab,ic,jd,jdkc->ia", delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree1_bbbb += einsum("ijab,iakc->jb", t2.abab, v.aabb.ovov)
    ree1_bbbb += einsum("ij,ka,bcka->ib", delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree1_bbbb -= einsum("ab,ic,icjk->ka", delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree1_baba = np.zeros((nocc[1],  nvir[0]), dtype=np.float64)
    ree1_baba += einsum("ab,ijcd,idkc->ja", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree1_baba += einsum("ab,ijcd,ickd->ja", delta_vv.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree1_baba += einsum("ab,ic,jd,jckd->ia", delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree1_baba += einsum("ab,ic,jd,jdkc->ia", delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree1_baba += einsum("ijab,ickb->ja", t2.abab, v.aabb.ovov)
    ree1_baba += einsum("ia,jb,ickb->ja", t1.aa, t1.bb, v.aabb.ovov)
    ree1_baba += einsum("ab,ic,ijkc->ja", delta_vv.aa, t1.bb, v.bbbb.ooov)
    ree1_baba += einsum("ij,ka,bcka->ib", delta_oo.bb, t1.bb, v.aabb.vvov)
    ree1_baba -= einsum("ab,ic,icjk->ka", delta_vv.aa, t1.bb, v.bbbb.ovoo)
    ree1_baba += einsum("ab,ijcd,ickd->ja", delta_vv.aa, t2.abab, v.aabb.ovov) * -1
    ree1_baba -= einsum("ab,ic,jd,ickd->ja", delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree1_baba -= einsum("abij->ja", v.aabb.vvoo)
    ree1_baba += einsum("ij,ab->ia", delta_oo.bb, f.aa.vv)
    ree1_baba -= einsum("ab,ij->ja", delta_vv.aa, f.bb.oo)
    ree1_baba += einsum("ia,ibjk->ka", t1.aa, v.aabb.ovoo)
    ree1_baba -= einsum("ij,ka,kb->ib", delta_oo.bb, f.aa.ov, t1.aa)
    ree1_baba += einsum("ij,ka,bcka->ib", delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree1_baba -= einsum("ab,ic,icjk->ka", delta_vv.aa, t1.aa, v.aabb.ovoo)
    ree1_baba -= einsum("ij,ka,bakc->ib", delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree1_baba -= einsum("ia,bcja->ib", t1.bb, v.aabb.vvov)
    ree1_baba -= einsum("ab,ic,jc->ja", delta_vv.aa, f.bb.ov, t1.bb)
    ree1_baba += einsum("ij,klab,lckb->ia", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree1_baba += einsum("ij,klab,kclb->ia", delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree1_baba += einsum("ij,ka,lb,lckb->ia", delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree1_baba += einsum("ij,ka,lb,kclb->ia", delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree1_baba += einsum("ij,klab,kclb->ia", delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree1_baba -= einsum("ij,ka,lb,kclb->ia", delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree1_abab = np.zeros((nocc[0],  nvir[1]), dtype=np.float64)
    ree1_abab += einsum("ij,klab,lckb->ia", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree1_abab += einsum("ij,klab,kclb->ia", delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree1_abab += einsum("ij,ka,lb,lckb->ia", delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree1_abab += einsum("ij,ka,lb,kclb->ia", delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree1_abab += einsum("ijab,ickb->ja", t2.baba, v.bbaa.ovov)
    ree1_abab += einsum("ia,jb,jcka->ib", t1.aa, t1.bb, v.bbaa.ovov)
    ree1_abab += einsum("ab,ijcd,idkc->ja", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree1_abab += einsum("ab,ijcd,ickd->ja", delta_vv.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree1_abab += einsum("ab,ic,jd,jckd->ia", delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree1_abab += einsum("ab,ic,jd,jdkc->ia", delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree1_abab += einsum("ab,ijcd,ickd->ja", delta_vv.bb, t2.baba, v.bbaa.ovov) * -1
    ree1_abab -= einsum("ab,ic,jd,jdkc->ia", delta_vv.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree1_abab -= einsum("abij->ja", v.bbaa.vvoo)
    ree1_abab += einsum("ij,ab->ia", delta_oo.aa, f.bb.vv)
    ree1_abab -= einsum("ab,ij->ja", delta_vv.bb, f.aa.oo)
    ree1_abab += einsum("ij,klab,kclb->ia", delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    ree1_abab -= einsum("ij,ka,lb,kclb->ia", delta_oo.aa, t1.bb, t1.aa, v.bbaa.ovov)
    ree1_abab += einsum("ij,ka,bcka->ib", delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree1_abab -= einsum("ab,ic,icjk->ka", delta_vv.bb, t1.bb, v.bbaa.ovoo)
    ree1_abab -= einsum("ij,ka,bakc->ib", delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree1_abab -= einsum("ia,bcja->ib", t1.aa, v.bbaa.vvov)
    ree1_abab -= einsum("ab,ic,jc->ja", delta_vv.bb, f.aa.ov, t1.aa)
    ree1_abab += einsum("ab,ic,ijkc->ja", delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree1_abab += einsum("ij,ka,bcka->ib", delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree1_abab -= einsum("ab,ic,icjk->ka", delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree1_abab += einsum("ia,ibjk->ka", t1.bb, v.bbaa.ovoo)
    ree1_abab -= einsum("ij,ka,kb->ib", delta_oo.aa, f.bb.ov, t1.bb)

    ree2_aaaaaaaa = np.zeros((nocc[0],  nocc[0],  nvir[0],  nvir[0]), dtype=np.float64)
    ree2_aaaaaaaa += einsum("ij,kl,mnab,ncmd->jlba", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,kl,mnab,mcnd->ljba", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,kl,mnab,mcnd->jlba", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ij,kl,mnab,ncmd->ljba", delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ij,kl,ma,nb,ncmd->jlba", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,kl,ma,nb,mcnd->ljba", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,kl,ma,nb,mcnd->jlba", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ij,kl,ma,nb,ncmd->ljba", delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ijef,kfle->ijda", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ijef,kelf->ijda", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ijef,kelf->ijda", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ijef,kfle->ijda", delta_vv.aa, delta_vv.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.aa, delta_vv.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ijcd,kcle->ijda", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ijcd,keld->ijca", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ijcd,kelc->ijda", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ijcd,kdle->ijca", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ijcd,kdle->ijbc", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ijcd,kelc->ijbd", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ijcd,keld->ijbc", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ijcd,kcle->ijbd", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,kelc->ijda", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,kdle->ijca", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,kcle->ijda", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,keld->ijca", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,keld->ijbc", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,kcle->ijbd", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,kdle->ijbc", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ijcd,kelc->ijbd", delta_vv.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ie,jkle->ikda", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,cd,ie,jekl->lida", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldec->kjea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldec->jkea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,cd,ie,jekl->ilda", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,cd,ie,jkle->kida", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldec->jkea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldec->kjea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa += einsum("ab,ij,kc,dcle->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,dcle->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,dcle->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,dcle->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,cd,ie,jekl->ilda", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,cd,ie,jkle->kida", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldec->jkea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldec->kjea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,cd,ie,jkle->ikda", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,cd,ie,jekl->lida", delta_vv.aa, delta_vv.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldec->kjea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldec->jkea", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,dcle->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,dcle->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,dcle->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,dcle->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->jlba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->jlab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->ljba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->ljab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->jlba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->jlab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->ljba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ij,klab,mckd->ljab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->jlba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->jlab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->ljba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->ljab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->jlba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->jlab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->ljba", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ij,klab,mckd->ljab", delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ldkm->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ij,kl,ma,bcmd->jlba", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ij,kl,ma,bcmd->jlab", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ij,kl,ma,bcmd->ljba", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ij,kl,ma,bcmd->ljab", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->mjca", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ldkm->jmbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ij,kl,ma,bcmd->ljba", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ij,kl,ma,bcmd->ljab", delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,md->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,md->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,md->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,md->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,md->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,md->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ijkl->ljda", delta_vv.aa, delta_vv.aa, v.aaaa.oooo)
    ree2_aaaaaaaa += einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa += einsum("ab,ij,kcdl->ljda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa += einsum("ab,ij,kcdl->jlda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa += einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa += einsum("ab,cd,ijkl->jlda", delta_vv.aa, delta_vv.aa, v.aaaa.oooo)
    ree2_aaaaaaaa += einsum("ab,ij,kcdl->jlda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa += einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa += einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa += einsum("ab,ij,kcdl->ljda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa += einsum("ab,ij,ckld->jkbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa += einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa += einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa += einsum("ab,ij,ckld->kjbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa += einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa += einsum("ab,ij,ckld->kjbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa += einsum("ab,ij,ckld->jkbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa += einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa += einsum("ij,kl,abcd->jlca", delta_oo.aa, delta_oo.aa, v.aaaa.vvvv)
    ree2_aaaaaaaa += einsum("ij,kl,abcd->ljca", delta_oo.aa, delta_oo.aa, v.aaaa.vvvv)
    ree2_aaaaaaaa -= einsum("ab,cd,ijkl->jlda", delta_vv.aa, delta_vv.aa, v.aaaa.oooo)
    ree2_aaaaaaaa -= einsum("ab,ij,kcdl->jlda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa -= einsum("ab,ij,kcdl->ljda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa -= einsum("ab,cd,ijkl->ljda", delta_vv.aa, delta_vv.aa, v.aaaa.oooo)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa -= einsum("ab,ij,kcdl->ljda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa -= einsum("ab,ij,kcdl->jlda", delta_vv.aa, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.aa, v.aaaa.oovv)
    ree2_aaaaaaaa -= einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa -= einsum("ab,ij,ckld->kjbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa -= einsum("ab,ij,ckld->jkbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa -= einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa -= einsum("ab,ij,ckld->jkbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa -= einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa -= einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.aa, v.aaaa.vvoo)
    ree2_aaaaaaaa -= einsum("ab,ij,ckld->kjbc", delta_vv.aa, delta_oo.aa, v.aaaa.voov)
    ree2_aaaaaaaa -= einsum("ij,kl,abcd->jlca", delta_oo.aa, delta_oo.aa, v.aaaa.vvvv)
    ree2_aaaaaaaa -= einsum("ij,kl,abcd->ljca", delta_oo.aa, delta_oo.aa, v.aaaa.vvvv)
    ree2_aaaaaaaa += einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa += einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa += einsum("ab,ij,kl,cd->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa += einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa += einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa += einsum("ab,ij,kl,cd->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa += einsum("ab,ij,kl,cd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa += einsum("ab,ij,kl,cd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,cd->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.aa.oo)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,cd->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,cd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,cd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mekd->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,klcd,mcke->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->ljda", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->ljca", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekd->jlbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mcke->jlbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa += einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaaaaaaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaaaaaaa -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa = np.zeros((nocc[1],  nocc[0],  nvir[0],  nvir[0]), dtype=np.float64)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kc,delc->ikda", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,cd,ie,jekl->lida", delta_vv.aa, delta_vv.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa += einsum("ab,ij,kc,dcle->ikda", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,ij,kc,dcle->ikbd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,ij,kc,delc->ikbd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,cd,ie,jekl->lida", delta_vv.aa, delta_vv.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa -= einsum("ab,ij,kc,dcle->ikda", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,delc->ikda", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,delc->ikbd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,dcle->ikbd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,le->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,le->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,klcd,kemd->lica", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kemd->libc", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kemd->lica", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kemd->libc", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,kc,ld,kemd->lica", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa -= einsum("ab,ij,kc,ld,kemd->lica", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa -= einsum("ab,ij,kc,ld,kemd->libc", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kcme->ilda", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kcme->ilda", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kcme->ilbd", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,klme->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,demc->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,klme->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,demc->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,demc->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_baaabaaa += einsum("ij,kl,mnab,ncmd->kiba", delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ij,kl,mnab,mcnd->kiba", delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ij,kl,ma,nb,ncmd->kiba", delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ij,kl,ma,nb,mcnd->kiba", delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,nemd->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,nemd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,nemd->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mncd,nemd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,nemd->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,nemd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,nemd->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,kl,mc,nd,nemd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baaabaaa += einsum("ab,ij,cdkl->lica", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_baaabaaa += einsum("ab,ij,cdkl->ilca", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_baaabaaa += einsum("ab,cd,ijkl->ljda", delta_vv.aa, delta_vv.aa, v.aabb.oooo)
    ree2_baaabaaa += einsum("ab,ij,ckld->ikca", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_baaabaaa += einsum("ab,ij,ckld->ikbc", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_baaabaaa += einsum("ab,ij,cdkl->libc", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_baaabaaa += einsum("ab,ij,cdkl->ilbc", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_baaabaaa += einsum("ij,kl,abcd->kica", delta_oo.aa, delta_oo.bb, v.aaaa.vvvv)
    ree2_baaabaaa -= einsum("ab,cd,ijkl->ljda", delta_vv.aa, delta_vv.aa, v.aabb.oooo)
    ree2_baaabaaa -= einsum("ab,ij,ckld->ikca", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_baaabaaa -= einsum("ab,ij,cdkl->lica", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_baaabaaa -= einsum("ab,ij,cdkl->ilca", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_baaabaaa -= einsum("ab,ij,cdkl->libc", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_baaabaaa -= einsum("ab,ij,cdkl->ilbc", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_baaabaaa -= einsum("ab,ij,ckld->ikbc", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_baaabaaa -= einsum("ij,kl,abcd->kica", delta_oo.aa, delta_oo.bb, v.aaaa.vvvv)
    ree2_baaabaaa += einsum("ab,cd,ij,kl->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.oo)
    ree2_baaabaaa += einsum("ab,cd,ij,kl->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.oo)
    ree2_baaabaaa += einsum("ab,ij,kl,cd->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_baaabaaa += einsum("ab,ij,kl,cd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_baaabaaa -= einsum("ab,ij,kl,cd->kica", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_baaabaaa -= einsum("ab,cd,ij,kl->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.oo)
    ree2_baaabaaa -= einsum("ab,cd,ij,kl->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.oo)
    ree2_baaabaaa -= einsum("ab,ij,kl,cd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_baaabaaa += einsum("ab,ij,klcd,kemc->ilda", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kdme->ilca", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kcme->ilda", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kemd->ilca", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kdme->ilbc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,klcd,kemc->ilbd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kcme->ilda", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kemd->ilca", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kemc->ilda", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kdme->ilca", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kdme->ilbc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kemc->ilbd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kemd->ilbc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,klcd,kcme->ilbd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,dcme->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,ij,kc,ld,kdme->ilca", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,klme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,demc->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,dcme->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,ij,kc,ld,kdme->ilbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,klme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,demc->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,dcme->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,ld,kdme->ilca", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,dcme->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,ld,kdme->ilbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,demc->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ij,klab,kcmd->ilba", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ij,klab,kcmd->ilab", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ij,klab,kcmd->ilba", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa -= einsum("ij,klab,kcmd->ilab", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baaabaaa += einsum("ab,ij,kc,klmd->ilca", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baaabaaa += einsum("ab,ij,kc,kdlm->mica", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa += einsum("ab,ij,kc,kdlm->imca", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baaabaaa += einsum("ab,ij,kc,kdlm->mibc", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa += einsum("ab,ij,kc,kdlm->imbc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baaabaaa += einsum("ab,ij,kc,klmd->ilbc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baaabaaa += einsum("ij,kl,ma,bcmd->kiba", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ij,kl,ma,bcmd->kiab", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,kdlm->mica", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa -= einsum("ab,ij,kc,kdlm->imca", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baaabaaa -= einsum("ab,ij,kc,klmd->ilca", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baaabaaa -= einsum("ab,ij,kc,klmd->ilbc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baaabaaa -= einsum("ab,ij,kc,kdlm->mibc", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baaabaaa -= einsum("ab,ij,kc,kdlm->imbc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baaabaaa -= einsum("ij,kl,ma,bcmd->kiba", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa -= einsum("ij,kl,ma,bcmd->kiab", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,md->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_baaabaaa += einsum("ab,ij,kl,mc,md->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,md->kida", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_baaabaaa -= einsum("ab,ij,kl,mc,md->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_baaabaaa += einsum("ab,ijcd,keld->jica", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ijcd,keld->jibc", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa -= einsum("ab,ijcd,keld->jica", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa -= einsum("ab,ijcd,keld->jibc", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,ij,kc,delc->kida", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_baaabaaa += einsum("ab,cd,ie,jkle->ikda", delta_vv.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    ree2_baaabaaa += einsum("ab,ij,kc,delc->kibd", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_baaabaaa -= einsum("ab,cd,ie,jkle->ikda", delta_vv.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    ree2_baaabaaa -= einsum("ab,ij,kc,delc->kida", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_baaabaaa -= einsum("ab,ij,kc,delc->kibd", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_baaabaaa += einsum("ab,cd,ij,ke,le->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_baaabaaa -= einsum("ab,cd,ij,ke,le->lida", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_baaabaaa += einsum("ab,cd,ijef,kelf->jida", delta_vv.aa, delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ijef,kelf->jida", delta_vv.aa, delta_vv.aa, t2.abab, v.aabb.ovov) * -1
    ree2_baaabaaa += einsum("ab,cd,ie,jf,kelf->jida", delta_vv.aa, delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baaabaaa += einsum("ab,cd,ie,jf,kelf->jida", delta_vv.aa, delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_abaaabaa = np.zeros((nocc[0],  nocc[1],  nvir[0],  nvir[0]), dtype=np.float64)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kc,delc->kida", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,cd,ie,jekl->ilda", delta_vv.aa, delta_vv.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa += einsum("ab,ij,kc,dcle->kida", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,ij,kc,dcle->kibd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,ij,kc,delc->kibd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,cd,ie,jekl->ilda", delta_vv.aa, delta_vv.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa -= einsum("ab,ij,kc,dcle->kida", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,delc->kida", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,delc->kibd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,dcle->kibd", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,le->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,le->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,klcd,kemd->ilca", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kemd->ilca", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kemd->ilbc", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa -= einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa -= einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kcme->lida", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kcme->libd", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kcme->lida", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kcme->libd", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,klme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,demc->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,klme->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,demc->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abaaabaa += einsum("ij,kl,mnab,ncmd->ikba", delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ij,kl,mnab,mcnd->ikba", delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ij,kl,ma,nb,ncmd->ikba", delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ij,kl,ma,nb,mcnd->ikba", delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,nemd->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,nemd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,nemd->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mncd,nemd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,nemd->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,nemd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,nemd->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,kl,mc,nd,nemd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abaaabaa += einsum("ab,ij,cdkl->ilca", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_abaaabaa += einsum("ab,ij,cdkl->lica", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_abaaabaa += einsum("ab,cd,ijkl->jlda", delta_vv.aa, delta_vv.aa, v.aabb.oooo)
    ree2_abaaabaa += einsum("ab,ij,ckld->kica", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_abaaabaa += einsum("ab,ij,ckld->kibc", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_abaaabaa += einsum("ab,ij,cdkl->ilbc", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_abaaabaa += einsum("ab,ij,cdkl->libc", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_abaaabaa += einsum("ij,kl,abcd->ikca", delta_oo.aa, delta_oo.bb, v.aaaa.vvvv)
    ree2_abaaabaa -= einsum("ab,cd,ijkl->jlda", delta_vv.aa, delta_vv.aa, v.aabb.oooo)
    ree2_abaaabaa -= einsum("ab,ij,ckld->kica", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_abaaabaa -= einsum("ab,ij,cdkl->ilca", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_abaaabaa -= einsum("ab,ij,cdkl->lica", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_abaaabaa -= einsum("ab,ij,cdkl->ilbc", delta_vv.aa, delta_oo.aa, v.aabb.vvoo)
    ree2_abaaabaa -= einsum("ab,ij,cdkl->libc", delta_vv.aa, delta_oo.bb, v.aaaa.vvoo)
    ree2_abaaabaa -= einsum("ab,ij,ckld->kibc", delta_vv.aa, delta_oo.bb, v.aaaa.voov)
    ree2_abaaabaa -= einsum("ij,kl,abcd->ikca", delta_oo.aa, delta_oo.bb, v.aaaa.vvvv)
    ree2_abaaabaa += einsum("ab,cd,ij,kl->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.oo)
    ree2_abaaabaa += einsum("ab,cd,ij,kl->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.oo)
    ree2_abaaabaa += einsum("ab,ij,kl,cd->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_abaaabaa += einsum("ab,ij,kl,cd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_abaaabaa -= einsum("ab,ij,kl,cd->ikca", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_abaaabaa -= einsum("ab,cd,ij,kl->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.oo)
    ree2_abaaabaa -= einsum("ab,cd,ij,kl->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.aa.oo)
    ree2_abaaabaa -= einsum("ab,ij,kl,cd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_abaaabaa += einsum("ab,ij,klcd,kemc->lida", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kdme->lica", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kcme->lida", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kemd->lica", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kemd->libc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kcme->libd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kdme->libc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,klcd,kemc->libd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kcme->lida", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kemd->lica", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kemc->lida", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kdme->lica", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kdme->libc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kemc->libd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kemd->libc", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,klcd,kcme->libd", delta_vv.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,dcme->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,ij,kc,ld,kdme->lica", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,klme->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,demc->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,ij,kc,ld,kemd->lica", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,dcme->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,ij,kc,ld,kdme->libc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,klme->lida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,demc->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,ld,kemd->lica", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,dcme->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,ld,kdme->lica", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,dcme->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,ld,kdme->libc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,ld,kemd->libc", delta_vv.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ij,klab,kcmd->liba", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ij,klab,kcmd->liab", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ij,klab,kcmd->liba", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa -= einsum("ij,klab,kcmd->liab", delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abaaabaa += einsum("ab,ij,kc,klmd->lica", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abaaabaa += einsum("ab,ij,kc,kdlm->imca", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa += einsum("ab,ij,kc,kdlm->mica", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abaaabaa += einsum("ab,ij,kc,kdlm->imbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa += einsum("ab,ij,kc,kdlm->mibc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abaaabaa += einsum("ab,ij,kc,klmd->libc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abaaabaa += einsum("ij,kl,ma,bcmd->ikba", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ij,kl,ma,bcmd->ikab", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,kdlm->imca", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa -= einsum("ab,ij,kc,kdlm->mica", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abaaabaa -= einsum("ab,ij,kc,klmd->lica", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abaaabaa -= einsum("ab,ij,kc,klmd->libc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abaaabaa -= einsum("ab,ij,kc,kdlm->imbc", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abaaabaa -= einsum("ab,ij,kc,kdlm->mibc", delta_vv.aa, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abaaabaa -= einsum("ij,kl,ma,bcmd->ikba", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa -= einsum("ij,kl,ma,bcmd->ikab", delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,md->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abaaabaa += einsum("ab,ij,kl,mc,md->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,md->ikda", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abaaabaa -= einsum("ab,ij,kl,mc,md->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_abaaabaa += einsum("ab,ijcd,keld->ijca", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ijcd,keld->ijbc", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa -= einsum("ab,ijcd,keld->ijca", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa -= einsum("ab,ijcd,keld->ijbc", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,ij,kc,delc->ikda", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_abaaabaa += einsum("ab,cd,ie,jkle->kida", delta_vv.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    ree2_abaaabaa += einsum("ab,ij,kc,delc->ikbd", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_abaaabaa -= einsum("ab,cd,ie,jkle->kida", delta_vv.aa, delta_vv.aa, t1.bb, v.aabb.ooov)
    ree2_abaaabaa -= einsum("ab,ij,kc,delc->ikda", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_abaaabaa -= einsum("ab,ij,kc,delc->ikbd", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_abaaabaa += einsum("ab,cd,ij,ke,le->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_abaaabaa -= einsum("ab,cd,ij,ke,le->ilda", delta_vv.aa, delta_vv.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_abaaabaa += einsum("ab,cd,ijef,kelf->ijda", delta_vv.aa, delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ijef,kelf->ijda", delta_vv.aa, delta_vv.aa, t2.abab, v.aabb.ovov) * -1
    ree2_abaaabaa += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.aa, delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abaaabaa += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.aa, delta_vv.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_bbaabbaa = np.zeros((nocc[1],  nocc[1],  nvir[0],  nvir[0]), dtype=np.float64)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_bbaabbaa += einsum("ij,kl,mnab,ncmd->jlba", delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ij,kl,mnab,mcnd->ljba", delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ij,kl,mnab,mcnd->jlba", delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ij,kl,mnab,ncmd->ljba", delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ij,kl,ma,nb,ncmd->jlba", delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ij,kl,ma,nb,mcnd->ljba", delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ij,kl,ma,nb,mcnd->jlba", delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ij,kl,ma,nb,ncmd->ljba", delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ijef,kfle->ijda", delta_vv.aa, delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ijef,kelf->ijda", delta_vv.aa, delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ijef,kelf->ijda", delta_vv.aa, delta_vv.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ijef,kfle->ijda", delta_vv.aa, delta_vv.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.aa, delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.aa, delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.aa, delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.aa, delta_vv.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ijkl->ljda", delta_vv.aa, delta_vv.aa, v.bbbb.oooo)
    ree2_bbaabbaa += einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa += einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa += einsum("ab,cd,ijkl->jlda", delta_vv.aa, delta_vv.aa, v.bbbb.oooo)
    ree2_bbaabbaa += einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa += einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa += einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa += einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa += einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa += einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa += einsum("ij,kl,abcd->jlca", delta_oo.bb, delta_oo.bb, v.aaaa.vvvv)
    ree2_bbaabbaa += einsum("ij,kl,abcd->ljca", delta_oo.bb, delta_oo.bb, v.aaaa.vvvv)
    ree2_bbaabbaa -= einsum("ab,cd,ijkl->jlda", delta_vv.aa, delta_vv.aa, v.bbbb.oooo)
    ree2_bbaabbaa -= einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa -= einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa -= einsum("ab,cd,ijkl->ljda", delta_vv.aa, delta_vv.aa, v.bbbb.oooo)
    ree2_bbaabbaa -= einsum("ab,ij,klcd->jlca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa -= einsum("ab,ij,klcd->ljca", delta_vv.aa, delta_oo.bb, v.bbaa.oovv)
    ree2_bbaabbaa -= einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa -= einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa -= einsum("ab,ij,cdkl->ljbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa -= einsum("ab,ij,cdkl->jlbc", delta_vv.aa, delta_oo.bb, v.aabb.vvoo)
    ree2_bbaabbaa -= einsum("ij,kl,abcd->jlca", delta_oo.bb, delta_oo.bb, v.aaaa.vvvv)
    ree2_bbaabbaa -= einsum("ij,kl,abcd->ljca", delta_oo.bb, delta_oo.bb, v.aaaa.vvvv)
    ree2_bbaabbaa += einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa += einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa += einsum("ab,ij,kl,cd->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa += einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa += einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa += einsum("ab,ij,kl,cd->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa += einsum("ab,ij,kl,cd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa += einsum("ab,ij,kl,cd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa -= einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa -= einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa -= einsum("ab,ij,kl,cd->jlca", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa -= einsum("ab,cd,ij,kl->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa -= einsum("ab,cd,ij,kl->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.oo)
    ree2_bbaabbaa -= einsum("ab,ij,kl,cd->ljca", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa -= einsum("ab,ij,kl,cd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa -= einsum("ab,ij,kl,cd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa += einsum("ij,kl,ma,bcmd->jlba", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ij,kl,ma,bcmd->jlab", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ij,kl,ma,bcmd->ljba", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ij,kl,ma,bcmd->ljab", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbaabbaa -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ij,kl,ma,bcmd->ljba", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa -= einsum("ij,kl,ma,bcmd->ljab", delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,md->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,md->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa += einsum("ab,ij,kl,mc,md->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,md->ljda", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,md->jlda", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa -= einsum("ab,ij,kl,mc,md->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbaabbaa += einsum("ab,cd,ie,jkle->ikda", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa += einsum("ab,cd,ie,jekl->lida", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa += einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa += einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa += einsum("ab,cd,ie,jekl->ilda", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa += einsum("ab,cd,ie,jkle->kida", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa += einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa += einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa += einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,cd,ie,jekl->ilda", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa -= einsum("ab,cd,ie,jkle->kida", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa -= einsum("ab,cd,ie,jkle->ikda", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ooov)
    ree2_bbaabbaa -= einsum("ab,cd,ie,jekl->lida", delta_vv.aa, delta_vv.aa, t1.bb, v.bbbb.ovoo)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lcde->jkda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa -= einsum("ab,ij,kc,lcde->kjda", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbaabbaa -= einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,delc->kjbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa -= einsum("ab,ij,kc,delc->jkbd", delta_vv.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbaabbaa += einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbaabbaa -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.aa, delta_vv.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_aaabaaab = np.zeros((nocc[0],  nocc[0],  nvir[0],  nvir[1]), dtype=np.float64)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kc,lmkd->jmcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab += einsum("ab,ij,kc,ldkm->mjcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab += einsum("ab,ij,kc,ldkm->jmcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab += einsum("ab,ij,kc,lmkd->mjcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab += einsum("ij,kl,ma,bcmd->ljab", delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ldkm->jmcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab -= einsum("ab,ij,kc,lmkd->mjcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab -= einsum("ab,ij,kc,lmkd->jmcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ldkm->mjcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,md->ljdb", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,md->jldb", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,melf->kjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,melf->kjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lf,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,ijcd,kelc->ijdb", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ijcd,kdle->ijcb", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ijcd,kcle->ijdb", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ijcd,keld->ijcb", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ie,jekl->ilbd", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab += einsum("ab,cd,ie,jkle->kibd", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab += einsum("ab,ij,kc,lcde->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aaabaaab += einsum("ab,ij,kc,lcde->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aaabaaab += einsum("ab,ij,kc,ldec->jkeb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab += einsum("ab,ij,kc,lcde->kjdb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab += einsum("ab,ij,kc,lcde->jkdb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab += einsum("ab,ij,kc,ldec->kjeb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab -= einsum("ab,cd,ie,jkle->ikbd", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab -= einsum("ab,cd,ie,jekl->libd", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab -= einsum("ab,ij,kc,lcde->jkbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aaabaaab -= einsum("ab,ij,kc,lcde->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aaabaaab -= einsum("ab,ij,kc,lcde->jkdb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab -= einsum("ab,ij,kc,ldec->kjeb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab -= einsum("ab,ij,kc,ldec->jkeb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab -= einsum("ab,ij,kc,lcde->kjdb", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,le->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,le->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,le->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,le->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aaabaaab += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kc,ld,mcle->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ld,mcle->kjbd", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mekc->jldb", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mekc->ljdb", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mekc->ljdb", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mekc->jldb", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,nemc->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,nemc->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ijef,kelf->ijbd", delta_vv.aa, delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ijef,kfle->ijbd", delta_vv.aa, delta_vv.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ie,jf,kelf->ijbd", delta_vv.aa, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ie,jf,kfle->ijbd", delta_vv.aa, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,nemd->jlcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,nemd->ljcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,nemd->jlcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,mend->ljcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,mend->jlcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,nemd->ljcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aaabaaab += einsum("ab,cd,ijkl->jlbd", delta_vv.aa, delta_vv.bb, v.aaaa.oooo)
    ree2_aaabaaab += einsum("ab,ij,klcd->ljbc", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aaabaaab += einsum("ab,ij,klcd->jlbc", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aaabaaab += einsum("ab,ij,kcdl->jldb", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaabaaab += einsum("ab,ij,klcd->ljcb", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aaabaaab += einsum("ab,ij,klcd->jlcb", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aaabaaab += einsum("ab,ij,kcdl->ljdb", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaabaaab += einsum("ij,kl,abcd->jlac", delta_oo.aa, delta_oo.aa, v.aabb.vvvv)
    ree2_aaabaaab -= einsum("ab,cd,ijkl->ljbd", delta_vv.aa, delta_vv.bb, v.aaaa.oooo)
    ree2_aaabaaab -= einsum("ab,ij,klcd->jlbc", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aaabaaab -= einsum("ab,ij,klcd->ljbc", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aaabaaab -= einsum("ab,ij,klcd->jlcb", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aaabaaab -= einsum("ab,ij,kcdl->ljdb", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaabaaab -= einsum("ab,ij,kcdl->jldb", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aaabaaab -= einsum("ab,ij,klcd->ljcb", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aaabaaab -= einsum("ij,kl,abcd->ljac", delta_oo.aa, delta_oo.aa, v.aabb.vvvv)
    ree2_aaabaaab += einsum("ab,cd,ij,kl->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aaabaaab += einsum("ab,cd,ij,kl->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aaabaaab += einsum("ab,ij,kl,cd->jlbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aaabaaab += einsum("ab,ij,kl,cd->jlcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaabaaab -= einsum("ab,cd,ij,kl->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aaabaaab -= einsum("ab,cd,ij,kl->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aaabaaab -= einsum("ab,ij,kl,cd->ljbc", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aaabaaab -= einsum("ab,ij,kl,cd->ljcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aaabaaab += einsum("ab,ij,klcd,mekc->jldb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mdke->jlcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mcke->ljdb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mekd->ljcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mcke->jldb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mekd->jlcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mekc->ljdb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,klcd,mdke->ljcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mcke->jldb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mekd->jlcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mekc->ljdb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mdke->ljcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mekc->jldb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mdke->jlcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mcke->ljdb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,klcd,mekd->ljcb", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lekm->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab += einsum("ab,cd,ij,ke,lekm->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaabaaab += einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,dcme->ljdb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaabaaab += einsum("ab,ij,kc,ld,mekd->ljcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kc,ld,mekd->jlcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kc,ld,mdke->ljcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,lekm->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,lekm->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aaabaaab -= einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,dcme->jldb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ld,mekd->jlcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ld,mdke->ljcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab -= einsum("ab,ij,kc,ld,mekd->ljcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,mend->ljcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,nd,mend->jlcb", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aaabaaab += einsum("ij,klab,mckd->ljba", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ij,klab,mckd->jlba", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ij,klab,mckd->jlba", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab -= einsum("ij,klab,mckd->ljba", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aaabaaab += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab += einsum("ij,kl,ma,bcmd->ljba", delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaabaaab -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aaabaaab -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aaabaaab += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aaabaaab -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aaabaaab += einsum("ij,kl,mnab,mcnd->jlab", delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aaabaaab += einsum("ij,kl,mnab,mcnd->ljab", delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aaabaaab += einsum("ij,kl,ma,nb,mcnd->jlab", delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aaabaaab += einsum("ij,kl,ma,nb,mcnd->ljab", delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_baabbaab = np.zeros((nocc[1],  nocc[0],  nvir[0],  nvir[1]), dtype=np.float64)
    ree2_baabbaab += einsum("ab,cd,ij,klef,kfme->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baabbaab += einsum("ab,cd,ij,klef,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baabbaab += einsum("ab,cd,ij,ke,lf,kfme->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baabbaab += einsum("ab,cd,ij,ke,lf,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baabbaab += einsum("ab,cd,ij,klef,kfme->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,cd,ij,klef,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_baabbaab += einsum("ab,cd,ij,ke,lf,kfme->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,cd,ij,ke,lf,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_baabbaab += einsum("ab,cd,ij,klef,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_baabbaab -= einsum("ab,cd,ij,ke,lf,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baabbaab += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_baabbaab += einsum("ab,cd,ijkl->ljbd", delta_vv.aa, delta_vv.bb, v.aabb.oooo)
    ree2_baabbaab += einsum("ab,ij,ckld->kibc", delta_vv.aa, delta_oo.aa, v.bbbb.voov)
    ree2_baabbaab += einsum("ab,ij,ckld->ikcb", delta_vv.bb, delta_oo.bb, v.aaaa.voov)
    ree2_baabbaab += einsum("ij,kl,abcd->kiac", delta_oo.aa, delta_oo.bb, v.aabb.vvvv)
    ree2_baabbaab -= einsum("ab,ij,cdkl->libc", delta_vv.aa, delta_oo.aa, v.bbbb.vvoo)
    ree2_baabbaab -= einsum("ab,ij,cdkl->ilbc", delta_vv.aa, delta_oo.bb, v.bbaa.vvoo)
    ree2_baabbaab -= einsum("ab,ij,cdkl->licb", delta_vv.bb, delta_oo.aa, v.aabb.vvoo)
    ree2_baabbaab -= einsum("ab,ij,cdkl->ilcb", delta_vv.bb, delta_oo.bb, v.aaaa.vvoo)
    ree2_baabbaab += einsum("ab,ij,kl,cd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_baabbaab += einsum("ab,ij,kl,cd->kicb", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_baabbaab -= einsum("ab,cd,ij,kl->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_baabbaab -= einsum("ab,cd,ij,kl->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_baabbaab += einsum("ab,cd,ij,klef,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_baabbaab -= einsum("ab,cd,ij,ke,lf,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_baabbaab -= einsum("ab,ijcd,keld->jicb", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,cd,ie,jkle->ikbd", delta_vv.aa, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_baabbaab += einsum("ab,ij,kc,dcle->kibd", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_baabbaab -= einsum("ab,ij,kc,delc->kibd", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_baabbaab -= einsum("ab,ij,kc,delc->kidb", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_baabbaab -= einsum("ab,cd,ij,ke,le->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_baabbaab += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_baabbaab -= einsum("ab,ij,kl,mc,nd,nemc->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_baabbaab -= einsum("ab,ijcd,kcle->jibd", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,cd,ie,jekl->libd", delta_vv.aa, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_baabbaab += einsum("ab,ij,kc,dcle->ikdb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baabbaab -= einsum("ab,ij,kc,delc->ikbd", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_baabbaab -= einsum("ab,ij,kc,delc->ikdb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baabbaab -= einsum("ab,cd,ij,ke,le->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_baabbaab += einsum("ab,ij,klcd,kcme->libd", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,ij,klcd,kcme->ildb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baabbaab += einsum("ab,ij,klcd,kemd->ilcb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baabbaab -= einsum("ab,ij,klcd,kemc->ildb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baabbaab -= einsum("ab,ij,klcd,kdme->ilcb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baabbaab += einsum("ab,cd,ij,ke,klme->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baabbaab += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_baabbaab += einsum("ab,ij,kl,mc,demc->kidb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baabbaab += einsum("ab,ij,kc,ld,kemd->ilcb", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baabbaab -= einsum("ab,cd,ij,ke,kelm->mibd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baabbaab -= einsum("ab,cd,ij,ke,kelm->imbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baabbaab -= einsum("ab,ij,kl,mc,dcme->kidb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_baabbaab -= einsum("ab,ij,kc,ld,kdme->ilcb", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baabbaab += einsum("ab,ij,klcd,kcme->libd", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,ij,klcd,kemd->libc", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,ij,klcd,kcme->ildb", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baabbaab -= einsum("ab,ij,klcd,kemc->libd", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_baabbaab -= einsum("ab,ij,klcd,kdme->libc", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,cd,ij,ke,klme->libd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_baabbaab += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_baabbaab += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,ij,kl,mc,demc->kidb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_baabbaab -= einsum("ab,cd,ij,ke,kelm->mibd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_baabbaab -= einsum("ab,cd,ij,ke,kelm->imbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_baabbaab -= einsum("ab,ij,kl,mc,dcme->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_baabbaab -= einsum("ab,ij,kc,ld,kdme->libc", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_baabbaab -= einsum("ij,klab,kcmd->ilba", delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_baabbaab += einsum("ab,ij,kc,kdlm->mibc", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_baabbaab += einsum("ab,ij,kc,kdlm->imbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_baabbaab -= einsum("ab,ij,kc,klmd->libc", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_baabbaab -= einsum("ij,kl,ma,bcmd->kiba", delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_baabbaab -= einsum("ab,ij,kl,mc,md->kibd", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_baabbaab += einsum("ab,ij,kl,mncd,mend->kicb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_baabbaab -= einsum("ab,ij,kl,mc,nd,mend->kicb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,ij,klcd,kemd->licb", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,ij,kc,ld,kemd->licb", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,ij,kl,mncd,nemd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_baabbaab += einsum("ab,ij,kl,mc,nd,nemd->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_baabbaab += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_baabbaab += einsum("ij,kl,mnab,mcnd->kiab", delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_baabbaab += einsum("ij,kl,ma,nb,mcnd->kiab", delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,cd,ijef,kelf->jibd", delta_vv.aa, delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,cd,ie,jf,kelf->jibd", delta_vv.aa, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,ij,kl,mncd,nemd->kicb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_baabbaab += einsum("ab,ij,kl,mncd,mend->kicb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_baabbaab += einsum("ab,ij,kl,mc,nd,nemd->kicb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_baabbaab += einsum("ab,ij,kl,mc,nd,mend->kicb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_baabbaab -= einsum("ij,klab,kcmd->liab", delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_baabbaab += einsum("ab,ij,kc,kdlm->micb", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_baabbaab += einsum("ab,ij,kc,kdlm->imcb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_baabbaab -= einsum("ab,ij,kc,klmd->ilcb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_baabbaab -= einsum("ij,kl,ma,bcmd->kiab", delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_baabbaab -= einsum("ab,ij,kl,mc,md->kidb", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abababab = np.zeros((nocc[0],  nocc[1],  nvir[0],  nvir[1]), dtype=np.float64)
    ree2_abababab += einsum("ab,cd,ij,klef,kfme->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abababab += einsum("ab,cd,ij,klef,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abababab += einsum("ab,cd,ij,ke,lf,kfme->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abababab += einsum("ab,cd,ij,ke,lf,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abababab += einsum("ab,cd,ij,klef,kfme->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,cd,ij,klef,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abababab += einsum("ab,cd,ij,ke,lf,kfme->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,cd,ij,ke,lf,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abababab += einsum("ab,cd,ij,klef,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_abababab -= einsum("ab,cd,ij,ke,lf,kemf->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abababab += einsum("ab,ij,klcd,kemd->libc", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abababab += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abababab += einsum("ab,cd,ijkl->jlbd", delta_vv.aa, delta_vv.bb, v.aabb.oooo)
    ree2_abababab += einsum("ab,ij,ckld->ikbc", delta_vv.aa, delta_oo.aa, v.bbbb.voov)
    ree2_abababab += einsum("ab,ij,ckld->kicb", delta_vv.bb, delta_oo.bb, v.aaaa.voov)
    ree2_abababab += einsum("ij,kl,abcd->ikac", delta_oo.aa, delta_oo.bb, v.aabb.vvvv)
    ree2_abababab -= einsum("ab,ij,cdkl->ilbc", delta_vv.aa, delta_oo.aa, v.bbbb.vvoo)
    ree2_abababab -= einsum("ab,ij,cdkl->libc", delta_vv.aa, delta_oo.bb, v.bbaa.vvoo)
    ree2_abababab -= einsum("ab,ij,cdkl->ilcb", delta_vv.bb, delta_oo.aa, v.aabb.vvoo)
    ree2_abababab -= einsum("ab,ij,cdkl->licb", delta_vv.bb, delta_oo.bb, v.aaaa.vvoo)
    ree2_abababab += einsum("ab,ij,kl,cd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_abababab += einsum("ab,ij,kl,cd->ikcb", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_abababab -= einsum("ab,cd,ij,kl->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_abababab -= einsum("ab,cd,ij,kl->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_abababab += einsum("ab,cd,ij,klef,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abababab -= einsum("ab,cd,ij,ke,lf,kemf->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abababab -= einsum("ab,ijcd,keld->ijcb", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abababab += einsum("ab,cd,ie,jkle->kibd", delta_vv.aa, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_abababab += einsum("ab,ij,kc,dcle->ikbd", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abababab -= einsum("ab,ij,kc,delc->ikbd", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abababab -= einsum("ab,ij,kc,delc->ikdb", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_abababab -= einsum("ab,cd,ij,ke,le->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_abababab += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abababab -= einsum("ab,ij,kl,mc,nd,nemc->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_abababab -= einsum("ab,ijcd,kcle->ijbd", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_abababab += einsum("ab,cd,ie,jekl->ilbd", delta_vv.aa, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_abababab += einsum("ab,ij,kc,dcle->kidb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abababab -= einsum("ab,ij,kc,delc->kibd", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abababab -= einsum("ab,ij,kc,delc->kidb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abababab -= einsum("ab,cd,ij,ke,le->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abababab += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abababab += einsum("ab,ij,klcd,kcme->lidb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abababab += einsum("ab,ij,klcd,kemd->licb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abababab -= einsum("ab,ij,klcd,kemc->lidb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abababab -= einsum("ab,ij,klcd,kdme->licb", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abababab += einsum("ab,cd,ij,ke,klme->libd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abababab += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abababab += einsum("ab,ij,kl,mc,demc->ikdb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abababab += einsum("ab,ij,kc,ld,kemd->licb", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abababab -= einsum("ab,cd,ij,ke,kelm->imbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abababab -= einsum("ab,cd,ij,ke,kelm->mibd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abababab -= einsum("ab,ij,kl,mc,dcme->ikdb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abababab -= einsum("ab,ij,kc,ld,kdme->licb", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abababab += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,ij,klcd,kcme->lidb", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abababab -= einsum("ab,ij,klcd,kemc->ilbd", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abababab -= einsum("ab,ij,klcd,kdme->ilbc", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,cd,ij,ke,klme->ilbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abababab += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abababab += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,ij,kl,mc,demc->ikdb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abababab -= einsum("ab,cd,ij,ke,kelm->imbd", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abababab -= einsum("ab,cd,ij,ke,kelm->mibd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abababab -= einsum("ab,ij,kl,mc,dcme->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abababab -= einsum("ab,ij,kc,ld,kdme->ilbc", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abababab -= einsum("ij,klab,kcmd->liba", delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abababab += einsum("ab,ij,kc,kdlm->imbc", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abababab += einsum("ab,ij,kc,kdlm->mibc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abababab -= einsum("ab,ij,kc,klmd->ilbc", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abababab -= einsum("ij,kl,ma,bcmd->ikba", delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abababab -= einsum("ab,ij,kl,mc,md->ikbd", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_abababab += einsum("ab,ij,kl,mncd,mend->ikcb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_abababab -= einsum("ab,ij,kl,mc,nd,mend->ikcb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abababab += einsum("ab,ij,klcd,kemd->ilcb", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abababab += einsum("ab,ij,kc,ld,kemd->ilcb", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abababab += einsum("ab,ij,kl,mncd,nemd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abababab += einsum("ab,ij,kl,mc,nd,nemd->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abababab += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abababab += einsum("ij,kl,mnab,mcnd->ikab", delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_abababab += einsum("ij,kl,ma,nb,mcnd->ikab", delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abababab += einsum("ab,cd,ijef,kelf->ijbd", delta_vv.aa, delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abababab += einsum("ab,cd,ie,jf,kelf->ijbd", delta_vv.aa, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abababab += einsum("ab,ij,kl,mncd,nemd->ikcb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abababab += einsum("ab,ij,kl,mncd,mend->ikcb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abababab += einsum("ab,ij,kl,mc,nd,nemd->ikcb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abababab += einsum("ab,ij,kl,mc,nd,mend->ikcb", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abababab -= einsum("ij,klab,kcmd->ilab", delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abababab += einsum("ab,ij,kc,kdlm->imcb", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abababab += einsum("ab,ij,kc,kdlm->micb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abababab -= einsum("ab,ij,kc,klmd->licb", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abababab -= einsum("ij,kl,ma,bcmd->ikab", delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abababab -= einsum("ab,ij,kl,mc,md->ikdb", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbabbbab = np.zeros((nocc[1],  nocc[1],  nvir[0],  nvir[1]), dtype=np.float64)
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mekf->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mekf->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ij,klab,mckd->ljab", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ij,klab,mckd->jlab", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ij,klab,mckd->jlab", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ij,klab,mckd->ljab", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kc,lmkd->jmcb", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab += einsum("ab,ij,kc,lmkd->mjcb", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab += einsum("ij,kl,ma,bcmd->ljab", delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbabbbab -= einsum("ab,ij,kc,lmkd->mjcb", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab -= einsum("ab,ij,kc,lmkd->jmcb", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,md->ljdb", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,md->jldb", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_bbabbbab += einsum("ij,kl,mnab,mcnd->jlab", delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbabbbab += einsum("ij,kl,mnab,mcnd->ljab", delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbabbbab += einsum("ij,kl,ma,nb,ncmd->jlba", delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbabbbab += einsum("ij,kl,ma,nb,ncmd->ljba", delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,nemd->jlcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,nemd->ljcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,nemd->jlcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,mend->ljcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,mend->jlcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,nemd->ljcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,klef,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lf,mfke->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,dcme->ljdb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,dcme->jldb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbabbbab += einsum("ab,cd,ijef,kelf->ijbd", delta_vv.aa, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ijef,kfle->ijbd", delta_vv.aa, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,cd,ie,jf,kelf->ijbd", delta_vv.aa, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ie,jf,kfle->ijbd", delta_vv.aa, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mcke->ljbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mekd->ljbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mcke->jlbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mekd->jlbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mcke->jlbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mekd->jlbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mcke->ljbd", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mekd->ljbc", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lekm->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,lekm->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbabbbab += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbabbbab += einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,lmke->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,lekm->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,lekm->jmbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,lmke->mjbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mdke->jlcb", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,klcd,mdke->ljcb", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mdke->ljcb", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ab,ij,klcd,mdke->jlcb", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,ij,kc,ld,mdke->ljcb", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ld,mdke->ljcb", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbabbbab += einsum("ab,cd,ijkl->jlbd", delta_vv.aa, delta_vv.bb, v.bbbb.oooo)
    ree2_bbabbbab += einsum("ab,ij,kcdl->jlbd", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbabbbab += einsum("ab,ij,klcd->ljbc", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbabbbab += einsum("ab,ij,klcd->jlbc", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbabbbab += einsum("ab,ij,kcdl->ljbd", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbabbbab += einsum("ab,ij,klcd->ljcb", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbabbbab += einsum("ab,ij,klcd->jlcb", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbabbbab += einsum("ij,kl,abcd->jlac", delta_oo.bb, delta_oo.bb, v.aabb.vvvv)
    ree2_bbabbbab -= einsum("ab,cd,ijkl->ljbd", delta_vv.aa, delta_vv.bb, v.bbbb.oooo)
    ree2_bbabbbab -= einsum("ab,ij,klcd->jlbc", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbabbbab -= einsum("ab,ij,kcdl->ljbd", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbabbbab -= einsum("ab,ij,kcdl->jlbd", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbabbbab -= einsum("ab,ij,klcd->ljbc", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbabbbab -= einsum("ab,ij,klcd->jlcb", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbabbbab -= einsum("ab,ij,klcd->ljcb", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbabbbab -= einsum("ij,kl,abcd->ljac", delta_oo.bb, delta_oo.bb, v.aabb.vvvv)
    ree2_bbabbbab += einsum("ab,cd,ij,kl->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbabbbab += einsum("ab,cd,ij,kl->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbabbbab += einsum("ab,ij,kl,cd->jlbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbabbbab += einsum("ab,ij,kl,cd->jlcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbabbbab -= einsum("ab,cd,ij,kl->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbabbbab -= einsum("ab,cd,ij,kl->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbabbbab -= einsum("ab,ij,kl,cd->ljbc", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbabbbab -= einsum("ab,ij,kl,cd->ljcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbabbbab += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab += einsum("ab,ij,kc,ldkm->mjbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab += einsum("ab,ij,kc,ldkm->jmbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab += einsum("ij,kl,ma,bcmd->ljba", delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ldkm->jmbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab -= einsum("ab,ij,kc,ldkm->mjbc", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbabbbab -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbabbbab += einsum("ab,ijcd,kelc->ijbd", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,ijcd,kdle->ijbc", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ijcd,kcle->ijbd", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab -= einsum("ab,ijcd,keld->ijbc", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbabbbab += einsum("ab,cd,ie,jekl->ilbd", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab += einsum("ab,cd,ie,jkle->kibd", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab += einsum("ab,ij,kc,ldec->jkbe", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab += einsum("ab,ij,kc,lcde->kjbd", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab += einsum("ab,ij,kc,lcde->jkbd", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab += einsum("ab,ij,kc,ldec->kjbe", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab += einsum("ab,ij,kc,lcde->kjdb", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbabbbab += einsum("ab,ij,kc,lcde->jkdb", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbabbbab -= einsum("ab,cd,ie,jkle->ikbd", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbabbbab -= einsum("ab,cd,ie,jekl->libd", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbabbbab -= einsum("ab,ij,kc,lcde->jkbd", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab -= einsum("ab,ij,kc,ldec->kjbe", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab -= einsum("ab,ij,kc,ldec->jkbe", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab -= einsum("ab,ij,kc,lcde->kjbd", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbabbbab -= einsum("ab,ij,kc,lcde->jkdb", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbabbbab -= einsum("ab,ij,kc,lcde->kjdb", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,le->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbabbbab += einsum("ab,cd,ij,ke,le->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,le->jlbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbabbbab -= einsum("ab,cd,ij,ke,le->ljbd", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,nemc->ljdb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbabbbab += einsum("ab,ij,kl,mc,nd,nemc->jldb", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aabaaaba = np.zeros((nocc[0],  nocc[0],  nvir[1],  nvir[0]), dtype=np.float64)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,nemd->jlcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,nemd->ljcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,nemd->jlcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,mend->ljcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,mend->jlcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,nemd->ljcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba += einsum("ab,ij,kc,ldkm->mjbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba += einsum("ab,ij,kc,ldkm->jmbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba += einsum("ij,kl,ma,bcmd->ljba", delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ldkm->jmbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ldkm->mjbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,melf->kjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,melf->kjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lf,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,ijcd,kelc->ijbd", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ijcd,kdle->ijbc", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ijcd,kcle->ijbd", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ijcd,keld->ijbc", delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ie,jekl->ildb", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba += einsum("ab,cd,ie,jkle->kidb", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba += einsum("ab,ij,kc,lcde->kjdb", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabaaaba += einsum("ab,ij,kc,lcde->jkdb", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabaaaba += einsum("ab,ij,kc,ldec->jkbe", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba += einsum("ab,ij,kc,lcde->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba += einsum("ab,ij,kc,lcde->jkbd", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba += einsum("ab,ij,kc,ldec->kjbe", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba -= einsum("ab,cd,ie,jkle->ikdb", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba -= einsum("ab,cd,ie,jekl->lidb", delta_vv.aa, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba -= einsum("ab,ij,kc,lcde->jkdb", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabaaaba -= einsum("ab,ij,kc,lcde->kjdb", delta_vv.aa, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabaaaba -= einsum("ab,ij,kc,lcde->jkbd", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba -= einsum("ab,ij,kc,ldec->kjbe", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba -= einsum("ab,ij,kc,ldec->jkbe", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba -= einsum("ab,ij,kc,lcde->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovvv)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,le->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,le->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,le->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,le->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabaaaba += einsum("ab,ij,klcd,mdke->jlcb", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mdke->ljcb", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mdke->ljcb", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mdke->jlcb", delta_vv.aa, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kc,ld,mcle->kjdb", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ld,mcle->kjdb", delta_vv.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.aa, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,dcme->ljdb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,dcme->jldb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,nemc->ljdb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,nemc->jldb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ijef,kelf->ijdb", delta_vv.aa, delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ijef,kfle->ijdb", delta_vv.aa, delta_vv.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ie,jf,kelf->ijdb", delta_vv.aa, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ie,jf,kfle->ijdb", delta_vv.aa, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabaaaba += einsum("ab,cd,ijkl->jldb", delta_vv.aa, delta_vv.bb, v.aaaa.oooo)
    ree2_aabaaaba += einsum("ab,ij,klcd->ljcb", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aabaaaba += einsum("ab,ij,klcd->jlcb", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aabaaaba += einsum("ab,ij,kcdl->jlbd", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aabaaaba += einsum("ab,ij,klcd->ljbc", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aabaaaba += einsum("ab,ij,klcd->jlbc", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aabaaaba += einsum("ab,ij,kcdl->ljbd", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aabaaaba += einsum("ij,kl,abcd->jlca", delta_oo.aa, delta_oo.aa, v.aabb.vvvv)
    ree2_aabaaaba -= einsum("ab,cd,ijkl->ljdb", delta_vv.aa, delta_vv.bb, v.aaaa.oooo)
    ree2_aabaaaba -= einsum("ab,ij,klcd->jlcb", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aabaaaba -= einsum("ab,ij,klcd->ljcb", delta_vv.aa, delta_oo.aa, v.aabb.oovv)
    ree2_aabaaaba -= einsum("ab,ij,klcd->jlbc", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aabaaaba -= einsum("ab,ij,kcdl->ljbd", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aabaaaba -= einsum("ab,ij,kcdl->jlbd", delta_vv.bb, delta_oo.aa, v.aaaa.ovvo)
    ree2_aabaaaba -= einsum("ab,ij,klcd->ljbc", delta_vv.bb, delta_oo.aa, v.aaaa.oovv)
    ree2_aabaaaba -= einsum("ij,kl,abcd->ljca", delta_oo.aa, delta_oo.aa, v.aabb.vvvv)
    ree2_aabaaaba += einsum("ab,cd,ij,kl->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabaaaba += einsum("ab,cd,ij,kl->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabaaaba += einsum("ab,ij,kl,cd->jlcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabaaaba += einsum("ab,ij,kl,cd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aabaaaba -= einsum("ab,cd,ij,kl->jldb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabaaaba -= einsum("ab,cd,ij,kl->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabaaaba -= einsum("ab,ij,kl,cd->ljcb", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabaaaba -= einsum("ab,ij,kl,cd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.aa.vv)
    ree2_aabaaaba += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mcke->ljbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mekd->ljbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mcke->jlbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mekd->jlbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mcke->jlbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mekd->jlbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mcke->ljbd", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,klcd,mekd->ljbc", delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lekm->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba += einsum("ab,cd,ij,ke,lekm->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aabaaaba += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aabaaaba += einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,lekm->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,lekm->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabaaaba -= einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.aa, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.aaaa.vvov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba -= einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aabaaaba += einsum("ij,klab,mckd->ljab", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ij,klab,mckd->jlab", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ij,klab,mckd->jlab", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba -= einsum("ij,klab,mckd->ljab", delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabaaaba += einsum("ab,ij,kc,lmkd->jmcb", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba += einsum("ab,ij,kc,lmkd->mjcb", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba += einsum("ij,kl,ma,bcmd->ljab", delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aabaaaba -= einsum("ab,ij,kc,lmkd->mjcb", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba -= einsum("ab,ij,kc,lmkd->jmcb", delta_vv.aa, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabaaaba -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.aa, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_aabaaaba += einsum("ab,ij,kl,mc,md->ljdb", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabaaaba -= einsum("ab,ij,kl,mc,md->jldb", delta_vv.aa, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabaaaba += einsum("ij,kl,mnab,mcnd->jlba", delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_aabaaaba += einsum("ij,kl,mnab,mcnd->ljba", delta_oo.aa, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_aabaaaba += einsum("ij,kl,ma,nb,mcnd->jlba", delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabaaaba += einsum("ij,kl,ma,nb,mcnd->ljba", delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_babababa = np.zeros((nocc[1],  nocc[0],  nvir[1],  nvir[0]), dtype=np.float64)
    ree2_babababa += einsum("ab,cd,ij,klef,kfme->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babababa += einsum("ab,cd,ij,klef,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_babababa += einsum("ab,cd,ij,ke,lf,kfme->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_babababa += einsum("ab,cd,ij,ke,lf,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_babababa += einsum("ab,cd,ij,klef,kfme->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,cd,ij,klef,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babababa += einsum("ab,cd,ij,ke,lf,kfme->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,cd,ij,ke,lf,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babababa += einsum("ab,cd,ij,klef,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_babababa -= einsum("ab,cd,ij,ke,lf,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babababa += einsum("ab,ij,klcd,kemd->ilcb", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babababa += einsum("ab,ij,kc,ld,kemd->ilcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_babababa += einsum("ab,cd,ijkl->ljdb", delta_vv.aa, delta_vv.bb, v.aabb.oooo)
    ree2_babababa += einsum("ab,ij,ckld->kicb", delta_vv.aa, delta_oo.aa, v.bbbb.voov)
    ree2_babababa += einsum("ab,ij,ckld->ikbc", delta_vv.bb, delta_oo.bb, v.aaaa.voov)
    ree2_babababa += einsum("ij,kl,abcd->kica", delta_oo.aa, delta_oo.bb, v.aabb.vvvv)
    ree2_babababa -= einsum("ab,ij,cdkl->licb", delta_vv.aa, delta_oo.aa, v.bbbb.vvoo)
    ree2_babababa -= einsum("ab,ij,cdkl->ilcb", delta_vv.aa, delta_oo.bb, v.bbaa.vvoo)
    ree2_babababa -= einsum("ab,ij,cdkl->libc", delta_vv.bb, delta_oo.aa, v.aabb.vvoo)
    ree2_babababa -= einsum("ab,ij,cdkl->ilbc", delta_vv.bb, delta_oo.bb, v.aaaa.vvoo)
    ree2_babababa += einsum("ab,ij,kl,cd->kicb", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_babababa += einsum("ab,ij,kl,cd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_babababa -= einsum("ab,cd,ij,kl->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_babababa -= einsum("ab,cd,ij,kl->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_babababa += einsum("ab,cd,ij,klef,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_babababa -= einsum("ab,cd,ij,ke,lf,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_babababa -= einsum("ab,ijcd,keld->jibc", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_babababa += einsum("ab,cd,ie,jkle->ikdb", delta_vv.aa, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_babababa += einsum("ab,ij,kc,dcle->kidb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babababa -= einsum("ab,ij,kc,delc->kidb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babababa -= einsum("ab,ij,kc,delc->kibd", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_babababa -= einsum("ab,cd,ij,ke,le->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_babababa += einsum("ab,ij,kl,mncd,mend->kicb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_babababa -= einsum("ab,ij,kl,mc,nd,nemc->kidb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_babababa -= einsum("ab,ijcd,kcle->jidb", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_babababa += einsum("ab,cd,ie,jekl->lidb", delta_vv.aa, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_babababa += einsum("ab,ij,kc,dcle->ikbd", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_babababa -= einsum("ab,ij,kc,delc->ikdb", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babababa -= einsum("ab,ij,kc,delc->ikbd", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_babababa -= einsum("ab,cd,ij,ke,le->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_babababa += einsum("ab,ij,klcd,kcme->lidb", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babababa += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babababa += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babababa -= einsum("ab,ij,klcd,kemc->ilbd", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babababa -= einsum("ab,ij,klcd,kdme->ilbc", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babababa += einsum("ab,cd,ij,ke,klme->ildb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_babababa += einsum("ab,ij,kl,mc,demc->kidb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babababa += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_babababa += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_babababa -= einsum("ab,cd,ij,ke,kelm->midb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_babababa -= einsum("ab,cd,ij,ke,kelm->imdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_babababa -= einsum("ab,ij,kl,mc,dcme->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_babababa -= einsum("ab,ij,kc,ld,kdme->ilbc", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_babababa += einsum("ab,ij,klcd,kcme->lidb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,ij,klcd,kemd->licb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babababa -= einsum("ab,ij,klcd,kemc->lidb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babababa -= einsum("ab,ij,klcd,kdme->licb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,cd,ij,ke,klme->lidb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babababa += einsum("ab,ij,kl,mc,demc->kidb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babababa += einsum("ab,ij,kc,ld,kemd->licb", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_babababa -= einsum("ab,cd,ij,ke,kelm->midb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babababa -= einsum("ab,cd,ij,ke,kelm->imdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babababa -= einsum("ab,ij,kl,mc,dcme->kidb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babababa -= einsum("ab,ij,kc,ld,kdme->licb", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babababa -= einsum("ij,klab,kcmd->ilab", delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babababa += einsum("ab,ij,kc,kdlm->micb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babababa += einsum("ab,ij,kc,kdlm->imcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babababa -= einsum("ab,ij,kc,klmd->licb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babababa -= einsum("ij,kl,ma,bcmd->kiab", delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_babababa -= einsum("ab,ij,kl,mc,md->kidb", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_babababa += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_babababa -= einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babababa += einsum("ab,ij,klcd,kemd->libc", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babababa += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babababa += einsum("ab,ij,kl,mncd,nemd->kicb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,ij,kl,mncd,mend->kicb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babababa += einsum("ab,ij,kl,mc,nd,nemd->kicb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babababa += einsum("ab,ij,kl,mc,nd,mend->kicb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babababa += einsum("ij,kl,mnab,mcnd->kiba", delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_babababa += einsum("ij,kl,ma,nb,mcnd->kiba", delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babababa += einsum("ab,cd,ijef,kelf->jidb", delta_vv.aa, delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_babababa += einsum("ab,cd,ie,jf,kelf->jidb", delta_vv.aa, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babababa += einsum("ab,ij,kl,mncd,nemd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babababa += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_babababa += einsum("ab,ij,kl,mc,nd,nemd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_babababa += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_babababa -= einsum("ij,klab,kcmd->liba", delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babababa += einsum("ab,ij,kc,kdlm->mibc", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_babababa += einsum("ab,ij,kc,kdlm->imbc", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_babababa -= einsum("ab,ij,kc,klmd->ilbc", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_babababa -= einsum("ij,kl,ma,bcmd->kiba", delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babababa -= einsum("ab,ij,kl,mc,md->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abbaabba = np.zeros((nocc[0],  nocc[1],  nvir[1],  nvir[0]), dtype=np.float64)
    ree2_abbaabba += einsum("ab,cd,ij,klef,kfme->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbaabba += einsum("ab,cd,ij,klef,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abbaabba += einsum("ab,cd,ij,ke,lf,kfme->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abbaabba += einsum("ab,cd,ij,ke,lf,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abbaabba += einsum("ab,cd,ij,klef,kfme->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,cd,ij,klef,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbaabba += einsum("ab,cd,ij,ke,lf,kfme->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,cd,ij,ke,lf,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbaabba += einsum("ab,cd,ij,klef,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_abbaabba -= einsum("ab,cd,ij,ke,lf,kemf->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,ij,klcd,kemd->licb", delta_vv.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbaabba += einsum("ab,ij,kc,ld,kemd->licb", delta_vv.aa, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abbaabba += einsum("ab,cd,ijkl->jldb", delta_vv.aa, delta_vv.bb, v.aabb.oooo)
    ree2_abbaabba += einsum("ab,ij,ckld->ikcb", delta_vv.aa, delta_oo.aa, v.bbbb.voov)
    ree2_abbaabba += einsum("ab,ij,ckld->kibc", delta_vv.bb, delta_oo.bb, v.aaaa.voov)
    ree2_abbaabba += einsum("ij,kl,abcd->ikca", delta_oo.aa, delta_oo.bb, v.aabb.vvvv)
    ree2_abbaabba -= einsum("ab,ij,cdkl->ilcb", delta_vv.aa, delta_oo.aa, v.bbbb.vvoo)
    ree2_abbaabba -= einsum("ab,ij,cdkl->licb", delta_vv.aa, delta_oo.bb, v.bbaa.vvoo)
    ree2_abbaabba -= einsum("ab,ij,cdkl->ilbc", delta_vv.bb, delta_oo.aa, v.aabb.vvoo)
    ree2_abbaabba -= einsum("ab,ij,cdkl->libc", delta_vv.bb, delta_oo.bb, v.aaaa.vvoo)
    ree2_abbaabba += einsum("ab,ij,kl,cd->ikcb", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_abbaabba += einsum("ab,ij,kl,cd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.vv)
    ree2_abbaabba -= einsum("ab,cd,ij,kl->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_abbaabba -= einsum("ab,cd,ij,kl->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_abbaabba += einsum("ab,cd,ij,klef,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abbaabba -= einsum("ab,cd,ij,ke,lf,kemf->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abbaabba -= einsum("ab,ijcd,keld->ijbc", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,cd,ie,jkle->kidb", delta_vv.aa, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_abbaabba += einsum("ab,ij,kc,dcle->ikdb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbaabba -= einsum("ab,ij,kc,delc->ikdb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbaabba -= einsum("ab,ij,kc,delc->ikbd", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.vvov)
    ree2_abbaabba -= einsum("ab,cd,ij,ke,le->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_abbaabba += einsum("ab,ij,kl,mncd,mend->ikcb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abbaabba -= einsum("ab,ij,kl,mc,nd,nemc->ikdb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_abbaabba -= einsum("ab,ijcd,kcle->ijdb", delta_vv.aa, t2.abab, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,cd,ie,jekl->ildb", delta_vv.aa, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_abbaabba += einsum("ab,ij,kc,dcle->kibd", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abbaabba -= einsum("ab,ij,kc,delc->kidb", delta_vv.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbaabba -= einsum("ab,ij,kc,delc->kibd", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abbaabba -= einsum("ab,cd,ij,ke,le->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abbaabba += einsum("ab,ij,klcd,kcme->ildb", delta_vv.aa, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,ij,klcd,kcme->libd", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbaabba += einsum("ab,ij,klcd,kemd->libc", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbaabba -= einsum("ab,ij,klcd,kemc->libd", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbaabba -= einsum("ab,ij,klcd,kdme->libc", delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbaabba += einsum("ab,cd,ij,ke,klme->lidb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abbaabba += einsum("ab,ij,kl,mc,demc->ikdb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbaabba += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abbaabba += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abbaabba -= einsum("ab,cd,ij,ke,kelm->imdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abbaabba -= einsum("ab,cd,ij,ke,kelm->midb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abbaabba -= einsum("ab,ij,kl,mc,dcme->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_abbaabba -= einsum("ab,ij,kc,ld,kdme->libc", delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abbaabba += einsum("ab,ij,klcd,kcme->ildb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,ij,klcd,kemd->ilcb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,ij,klcd,kcme->libd", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbaabba -= einsum("ab,ij,klcd,kemc->ildb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbaabba -= einsum("ab,ij,klcd,kdme->ilcb", delta_vv.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,cd,ij,ke,klme->ildb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbaabba += einsum("ab,ij,kl,mc,demc->ikdb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbaabba += einsum("ab,ij,kc,ld,kemd->ilcb", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abbaabba -= einsum("ab,cd,ij,ke,kelm->imdb", delta_vv.aa, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbaabba -= einsum("ab,cd,ij,ke,kelm->midb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbaabba -= einsum("ab,ij,kl,mc,dcme->ikdb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbaabba -= einsum("ab,ij,kc,ld,kdme->ilcb", delta_vv.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbaabba -= einsum("ij,klab,kcmd->liab", delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbaabba += einsum("ab,ij,kc,kdlm->imcb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbaabba += einsum("ab,ij,kc,kdlm->micb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbaabba -= einsum("ab,ij,kc,klmd->ilcb", delta_vv.aa, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbaabba -= einsum("ij,kl,ma,bcmd->ikab", delta_oo.aa, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_abbaabba -= einsum("ab,ij,kl,mc,md->ikdb", delta_vv.aa, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_abbaabba += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_abbaabba -= einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,ij,kl,mncd,nemd->ikcb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,ij,kl,mncd,mend->ikcb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbaabba += einsum("ab,ij,kl,mc,nd,nemd->ikcb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbaabba += einsum("ab,ij,kl,mc,nd,mend->ikcb", delta_vv.aa, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbaabba += einsum("ij,kl,mnab,mcnd->ikba", delta_oo.aa, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_abbaabba += einsum("ij,kl,ma,nb,mcnd->ikba", delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,cd,ijef,kelf->ijdb", delta_vv.aa, delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,cd,ie,jf,kelf->ijdb", delta_vv.aa, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,ij,kl,mncd,nemd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbaabba += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abbaabba += einsum("ab,ij,kl,mc,nd,nemd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abbaabba += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abbaabba -= einsum("ij,klab,kcmd->ilba", delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbaabba += einsum("ab,ij,kc,kdlm->imbc", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abbaabba += einsum("ab,ij,kc,kdlm->mibc", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abbaabba -= einsum("ab,ij,kc,klmd->libc", delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abbaabba -= einsum("ij,kl,ma,bcmd->ikba", delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbaabba -= einsum("ab,ij,kl,mc,md->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbbabbba = np.zeros((nocc[1],  nocc[1],  nvir[1],  nvir[0]), dtype=np.float64)
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mekf->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mekf->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,nemd->jlcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,nemd->ljcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,nemd->jlcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,mend->ljcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,mend->jlcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,nemd->ljcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ij,klab,mckd->ljba", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ij,klab,mckd->jlba", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ij,klab,mckd->jlba", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ij,klab,mckd->ljba", delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba += einsum("ij,kl,ma,bcmd->ljba", delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbabbba -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_bbbabbba += einsum("ij,kl,mnab,mcnd->jlba", delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbbabbba += einsum("ij,kl,mnab,mcnd->ljba", delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbbabbba += einsum("ij,kl,ma,nb,ncmd->jlab", delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbbabbba += einsum("ij,kl,ma,nb,ncmd->ljab", delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->ljcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->jlcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,mend->ljcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,mend->jlcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,klef,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lf,mfke->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,klcd,mekc->jldb", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mekc->ljdb", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mekc->ljdb", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mekc->jldb", delta_vv.aa, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.aaaa.vvov)
    ree2_bbbabbba += einsum("ab,cd,ijef,kelf->ijdb", delta_vv.aa, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ijef,kfle->ijdb", delta_vv.aa, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,cd,ie,jf,kelf->ijdb", delta_vv.aa, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ie,jf,kfle->ijdb", delta_vv.aa, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mekc->jldb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mdke->jlcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mcke->ljdb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mekd->ljcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mcke->jldb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mekd->jlcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mekc->ljdb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,klcd,mdke->ljcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mcke->jldb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mekd->jlcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mekc->ljdb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mdke->ljcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mekc->jldb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mdke->jlcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mcke->ljdb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,klcd,mekd->ljcb", delta_vv.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lekm->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,lekm->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,demc->jldb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbabbba += einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,dcme->ljdb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbabbba += einsum("ab,ij,kc,ld,mekd->ljcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kc,ld,mekd->jlcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kc,ld,mdke->ljcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,lmke->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,lekm->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,lekm->jmdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,lmke->mjdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,dcme->jldb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ld,mekd->jlcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,demc->ljdb", delta_vv.aa, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ld,mdke->ljcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ld,mdke->jlcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ld,mekd->ljcb", delta_vv.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbbabbba += einsum("ab,cd,ijkl->jldb", delta_vv.aa, delta_vv.bb, v.bbbb.oooo)
    ree2_bbbabbba += einsum("ab,ij,kcdl->jldb", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbabbba += einsum("ab,ij,klcd->ljcb", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbabbba += einsum("ab,ij,klcd->jlcb", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbabbba += einsum("ab,ij,kcdl->ljdb", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbabbba += einsum("ab,ij,klcd->ljbc", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbbabbba += einsum("ab,ij,klcd->jlbc", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbbabbba += einsum("ij,kl,abcd->jlca", delta_oo.bb, delta_oo.bb, v.aabb.vvvv)
    ree2_bbbabbba -= einsum("ab,cd,ijkl->ljdb", delta_vv.aa, delta_vv.bb, v.bbbb.oooo)
    ree2_bbbabbba -= einsum("ab,ij,klcd->jlcb", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbabbba -= einsum("ab,ij,kcdl->ljdb", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbabbba -= einsum("ab,ij,kcdl->jldb", delta_vv.aa, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbabbba -= einsum("ab,ij,klcd->ljcb", delta_vv.aa, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbabbba -= einsum("ab,ij,klcd->jlbc", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbbabbba -= einsum("ab,ij,klcd->ljbc", delta_vv.bb, delta_oo.bb, v.bbaa.oovv)
    ree2_bbbabbba -= einsum("ij,kl,abcd->ljca", delta_oo.bb, delta_oo.bb, v.aabb.vvvv)
    ree2_bbbabbba += einsum("ab,cd,ij,kl->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbabbba += einsum("ab,cd,ij,kl->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbabbba += einsum("ab,ij,kl,cd->jlcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbabbba += einsum("ab,ij,kl,cd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbbabbba -= einsum("ab,cd,ij,kl->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbabbba -= einsum("ab,cd,ij,kl->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbabbba -= einsum("ab,ij,kl,cd->ljcb", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbabbba -= einsum("ab,ij,kl,cd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.aa.vv)
    ree2_bbbabbba += einsum("ab,ij,kc,lmkd->jmcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba += einsum("ab,ij,kc,ldkm->mjcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba += einsum("ab,ij,kc,ldkm->jmcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba += einsum("ab,ij,kc,lmkd->mjcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba += einsum("ij,kl,ma,bcmd->ljab", delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ldkm->jmcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba -= einsum("ab,ij,kc,lmkd->mjcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba -= einsum("ab,ij,kc,lmkd->jmcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba -= einsum("ab,ij,kc,ldkm->mjcb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.bb, delta_oo.bb, t1.bb, v.aabb.vvov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,md->ljdb", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbabbba -= einsum("ab,ij,kl,mc,md->jldb", delta_vv.aa, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbabbba += einsum("ab,ijcd,kelc->ijdb", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,ijcd,kdle->ijcb", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ijcd,kcle->ijdb", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba -= einsum("ab,ijcd,keld->ijcb", delta_vv.aa, t2.bbbb, v.bbbb.ovov)
    ree2_bbbabbba += einsum("ab,cd,ie,jekl->ildb", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba += einsum("ab,cd,ie,jkle->kidb", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba += einsum("ab,ij,kc,ldec->jkeb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba += einsum("ab,ij,kc,lcde->kjdb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba += einsum("ab,ij,kc,lcde->jkdb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba += einsum("ab,ij,kc,ldec->kjeb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba += einsum("ab,ij,kc,lcde->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbbabbba += einsum("ab,ij,kc,lcde->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbbabbba -= einsum("ab,cd,ie,jkle->ikdb", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbabbba -= einsum("ab,cd,ie,jekl->lidb", delta_vv.aa, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbabbba -= einsum("ab,ij,kc,lcde->jkdb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba -= einsum("ab,ij,kc,ldec->kjeb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba -= einsum("ab,ij,kc,ldec->jkeb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba -= einsum("ab,ij,kc,lcde->kjdb", delta_vv.aa, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbabbba -= einsum("ab,ij,kc,lcde->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbbabbba -= einsum("ab,ij,kc,lcde->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovvv)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,le->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbabbba += einsum("ab,cd,ij,ke,le->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,le->jldb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbabbba -= einsum("ab,cd,ij,ke,le->ljdb", delta_vv.aa, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.abab, v.aabb.ovov) * -1
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,nemc->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov)
    ree2_bbbabbba += einsum("ab,ij,kl,mc,nd,nemc->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aabbaabb = np.zeros((nocc[0],  nocc[0],  nvir[1],  nvir[1]), dtype=np.float64)
    ree2_aabbaabb += einsum("ab,cd,ijef,kfle->ijda", delta_vv.bb, delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ijef,kelf->ijda", delta_vv.bb, delta_vv.bb, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ijef,kelf->ijda", delta_vv.bb, delta_vv.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ijef,kfle->ijda", delta_vv.bb, delta_vv.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.bb, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.bb, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.bb, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.bb, delta_vv.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ie,jkle->ikda", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb += einsum("ab,cd,ie,jekl->lida", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb += einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb += einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb += einsum("ab,cd,ie,jekl->ilda", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb += einsum("ab,cd,ie,jkle->kida", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb += einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb += einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,cd,ie,jekl->ilda", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb -= einsum("ab,cd,ie,jkle->kida", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb -= einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb -= einsum("ab,cd,ie,jkle->ikda", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ooov)
    ree2_aabbaabb -= einsum("ab,cd,ie,jekl->lida", delta_vv.bb, delta_vv.bb, t1.aa, v.aaaa.ovoo)
    ree2_aabbaabb -= einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb -= einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovvv)
    ree2_aabbaabb -= einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.aa, t1.aa, v.bbaa.vvov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.ov, t1.aa)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, t2.baba, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kl,mc,nd,nemc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ijkl->ljda", delta_vv.bb, delta_vv.bb, v.aaaa.oooo)
    ree2_aabbaabb += einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb += einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb += einsum("ab,cd,ijkl->jlda", delta_vv.bb, delta_vv.bb, v.aaaa.oooo)
    ree2_aabbaabb += einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb += einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb += einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb += einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb += einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb += einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb += einsum("ij,kl,abcd->jlca", delta_oo.aa, delta_oo.aa, v.bbbb.vvvv)
    ree2_aabbaabb += einsum("ij,kl,abcd->ljca", delta_oo.aa, delta_oo.aa, v.bbbb.vvvv)
    ree2_aabbaabb -= einsum("ab,cd,ijkl->jlda", delta_vv.bb, delta_vv.bb, v.aaaa.oooo)
    ree2_aabbaabb -= einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb -= einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb -= einsum("ab,cd,ijkl->ljda", delta_vv.bb, delta_vv.bb, v.aaaa.oooo)
    ree2_aabbaabb -= einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb -= einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.aa, v.aabb.oovv)
    ree2_aabbaabb -= einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb -= einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb -= einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb -= einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.aa, v.bbaa.vvoo)
    ree2_aabbaabb -= einsum("ij,kl,abcd->jlca", delta_oo.aa, delta_oo.aa, v.bbbb.vvvv)
    ree2_aabbaabb -= einsum("ij,kl,abcd->ljca", delta_oo.aa, delta_oo.aa, v.bbbb.vvvv)
    ree2_aabbaabb += einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb += einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb += einsum("ab,ij,kl,cd->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb += einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb += einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb += einsum("ab,ij,kl,cd->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb += einsum("ab,ij,kl,cd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb += einsum("ab,ij,kl,cd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb -= einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb -= einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb -= einsum("ab,ij,kl,cd->jlca", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb -= einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb -= einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.aa.oo)
    ree2_aabbaabb -= einsum("ab,ij,kl,cd->ljca", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb -= einsum("ab,ij,kl,cd->ljbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb -= einsum("ab,ij,kl,cd->jlbc", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.vv)
    ree2_aabbaabb += einsum("ij,kl,mnab,ncmd->jlba", delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ij,kl,mnab,mcnd->ljba", delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ij,kl,mnab,mcnd->jlba", delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ij,kl,mnab,ncmd->ljba", delta_oo.aa, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ij,kl,ma,nb,ncmd->jlba", delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ij,kl,ma,nb,mcnd->ljba", delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_aabbaabb += einsum("ij,kl,ma,nb,mcnd->jlba", delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ij,kl,ma,nb,ncmd->ljba", delta_oo.aa, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ij,kl,ma,bcmd->jlba", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ij,kl,ma,bcmd->jlab", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ij,kl,ma,bcmd->ljba", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ij,kl,ma,bcmd->ljab", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ij,kl,ma,bcmd->ljba", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ij,kl,ma,bcmd->ljab", delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,md->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,md->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,md->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,md->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,md->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,md->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.aabb.ooov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb -= einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.bb, delta_oo.aa, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,melf->kjda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.aaaa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.aa, t2.baba, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mcle->kjda", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mcle->kjda", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mcle->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mcle->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mcle->kjda", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mcle->kjda", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mcle->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.aa, v.aabb.ovov)
    ree2_aabbaabb -= einsum("ab,ij,kc,ld,mcle->kjbd", delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babbbabb = np.zeros((nocc[1],  nocc[0],  nvir[1],  nvir[1]), dtype=np.float64)
    ree2_babbbabb += einsum("ab,ij,klcd,kemd->ilca", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kemd->ilca", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kemd->ilbc", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_babbbabb -= einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_babbbabb -= einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,cd,ijef,kelf->jida", delta_vv.bb, delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,cd,ijef,kelf->jida", delta_vv.bb, delta_vv.bb, t2.abab, v.aabb.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ie,jf,kelf->jida", delta_vv.bb, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,cd,ie,jf,kelf->jida", delta_vv.bb, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mncd,nemd->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mncd,nemd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mncd,nemd->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mncd,nemd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,mend->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemd->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemd->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,mend->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kc,delc->kida", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,cd,ie,jkle->ikda", delta_vv.bb, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_babbbabb += einsum("ab,ij,kc,dcle->kida", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,ij,kc,dcle->kibd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,ij,kc,delc->kibd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,cd,ie,jkle->ikda", delta_vv.bb, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_babbbabb -= einsum("ab,ij,kc,dcle->kida", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,delc->kida", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,delc->kibd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,dcle->kibd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,le->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,le->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_babbbabb += einsum("ab,ij,klcd,kemc->lida", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kdme->lica", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kcme->lida", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kemd->lica", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kemd->libc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kcme->libd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kdme->libc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kemc->libd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kcme->lida", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kemd->lica", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kemc->lida", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kdme->lica", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kdme->libc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kemc->libd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kemd->libc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kcme->libd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babbbabb += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babbbabb += einsum("ab,ij,kl,mc,dcme->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,ij,kc,ld,kdme->lica", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,klme->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,demc->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,ij,kc,ld,kemd->lica", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,dcme->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,ij,kc,ld,kdme->libc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,klme->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,demc->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,ld,kemd->lica", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,dcme->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,ld,kdme->lica", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,dcme->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,ld,kdme->libc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,demc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,ld,kemd->libc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_babbbabb += einsum("ab,ijcd,kcle->jida", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,ijcd,kcle->jibd", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_babbbabb -= einsum("ab,ijcd,kcle->jida", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_babbbabb -= einsum("ab,ijcd,kcle->jibd", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,ij,kc,delc->ikda", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babbbabb += einsum("ab,cd,ie,jekl->lida", delta_vv.bb, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_babbbabb += einsum("ab,ij,kc,delc->ikbd", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babbbabb -= einsum("ab,cd,ie,jekl->lida", delta_vv.bb, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_babbbabb -= einsum("ab,ij,kc,delc->ikda", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,delc->ikbd", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,le->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,le->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mncd,mend->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemc->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemc->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,kl,mc,nd,nemc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,cdkl->lica", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_babbbabb += einsum("ab,ij,cdkl->ilca", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_babbbabb += einsum("ab,cd,ijkl->ljda", delta_vv.bb, delta_vv.bb, v.aabb.oooo)
    ree2_babbbabb += einsum("ab,ij,ckld->kica", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_babbbabb += einsum("ab,ij,ckld->kibc", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_babbbabb += einsum("ab,ij,cdkl->libc", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_babbbabb += einsum("ab,ij,cdkl->ilbc", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_babbbabb += einsum("ij,kl,abcd->kica", delta_oo.aa, delta_oo.bb, v.bbbb.vvvv)
    ree2_babbbabb -= einsum("ab,cd,ijkl->ljda", delta_vv.bb, delta_vv.bb, v.aabb.oooo)
    ree2_babbbabb -= einsum("ab,ij,ckld->kica", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_babbbabb -= einsum("ab,ij,cdkl->lica", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_babbbabb -= einsum("ab,ij,cdkl->ilca", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_babbbabb -= einsum("ab,ij,cdkl->libc", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_babbbabb -= einsum("ab,ij,cdkl->ilbc", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_babbbabb -= einsum("ab,ij,ckld->kibc", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_babbbabb -= einsum("ij,kl,abcd->kica", delta_oo.aa, delta_oo.bb, v.bbbb.vvvv)
    ree2_babbbabb += einsum("ab,cd,ij,kl->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_babbbabb += einsum("ab,cd,ij,kl->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_babbbabb += einsum("ab,ij,kl,cd->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_babbbabb += einsum("ab,ij,kl,cd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_babbbabb -= einsum("ab,ij,kl,cd->kica", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_babbbabb -= einsum("ab,cd,ij,kl->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_babbbabb -= einsum("ab,cd,ij,kl->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_babbbabb -= einsum("ab,ij,kl,cd->kibc", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_babbbabb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_babbbabb += einsum("ij,klab,kcmd->liba", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ij,klab,kcmd->liab", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ij,klab,kcmd->liba", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb -= einsum("ij,klab,kcmd->liab", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ab,ij,kc,klmd->lica", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babbbabb += einsum("ab,ij,kc,kdlm->mica", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babbbabb += einsum("ab,ij,kc,kdlm->imca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babbbabb += einsum("ab,ij,kc,kdlm->mibc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babbbabb += einsum("ab,ij,kc,kdlm->imbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babbbabb += einsum("ab,ij,kc,klmd->libc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babbbabb += einsum("ij,kl,ma,bcmd->kiba", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ij,kl,ma,bcmd->kiab", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ab,ij,kc,kdlm->mica", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babbbabb -= einsum("ab,ij,kc,kdlm->imca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babbbabb -= einsum("ab,ij,kc,klmd->lica", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babbbabb -= einsum("ab,ij,kc,klmd->libc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_babbbabb -= einsum("ab,ij,kc,kdlm->mibc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_babbbabb -= einsum("ab,ij,kc,kdlm->imbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_babbbabb -= einsum("ij,kl,ma,bcmd->kiba", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb -= einsum("ij,kl,ma,bcmd->kiab", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,md->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_babbbabb += einsum("ab,ij,kl,mc,md->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,md->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,md->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_babbbabb += einsum("ij,kl,mnab,ncmd->kiba", delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ij,kl,mnab,mcnd->kiba", delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ij,kl,ma,nb,ncmd->kiba", delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_babbbabb += einsum("ij,kl,ma,nb,mcnd->kiba", delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_babbbabb += einsum("ab,ij,klcd,kcme->lida", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,ij,klcd,kcme->libd", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kcme->lida", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babbbabb -= einsum("ab,ij,klcd,kcme->libd", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_babbbabb += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_babbbabb += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_babbbabb += einsum("ab,cd,ij,ke,klme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,demc->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babbbabb += einsum("ab,ij,kl,mc,demc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,klme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,demc->kida", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_babbbabb -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_babbbabb -= einsum("ab,ij,kl,mc,demc->kibd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb = np.zeros((nocc[0],  nocc[1],  nvir[1],  nvir[1]), dtype=np.float64)
    ree2_abbbabbb += einsum("ab,ij,klcd,kemd->lica", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kemd->libc", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kemd->lica", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kemd->libc", delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,ij,kc,ld,kemd->lica", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,ij,kc,ld,kemd->libc", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abbbabbb -= einsum("ab,ij,kc,ld,kemd->lica", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abbbabbb -= einsum("ab,ij,kc,ld,kemd->libc", delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,cd,ijef,kelf->ijda", delta_vv.bb, delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ijef,kelf->ijda", delta_vv.bb, delta_vv.bb, t2.abab, v.aabb.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.bb, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.bb, delta_vv.bb, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,nemd->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,nemd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,nemd->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,nemd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,mend->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemd->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemd->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,mend->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kc,delc->ikda", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,cd,ie,jkle->kida", delta_vv.bb, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_abbbabbb += einsum("ab,ij,kc,dcle->ikda", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,ij,kc,dcle->ikbd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,ij,kc,delc->ikbd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,cd,ie,jkle->kida", delta_vv.bb, delta_vv.bb, t1.bb, v.aabb.ooov)
    ree2_abbbabbb -= einsum("ab,ij,kc,dcle->ikda", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,delc->ikda", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,delc->ikbd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,dcle->ikbd", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,le->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,le->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.ov, t1.bb)
    ree2_abbbabbb += einsum("ab,ij,klcd,kemc->ilda", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kdme->ilca", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kcme->ilda", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kemd->ilca", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kemd->ilbc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kdme->ilbc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kemc->ilbd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kcme->ilda", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kemd->ilca", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kemc->ilda", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kdme->ilca", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kdme->ilbc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kemc->ilbd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kemd->ilbc", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kcme->ilbd", delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,dcme->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,ij,kc,ld,kdme->ilca", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,klme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,demc->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,dcme->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,ij,kc,ld,kdme->ilbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,klme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,demc->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,ld,kemd->ilca", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,dcme->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,ld,kdme->ilca", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,dcme->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,ld,kdme->ilbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,ld,kemd->ilbc", delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,ijcd,kcle->ijda", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,ijcd,kcle->ijbd", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abbbabbb -= einsum("ab,ijcd,kcle->ijda", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abbbabbb -= einsum("ab,ijcd,kcle->ijbd", delta_vv.bb, t2.abab, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kc,delc->kida", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb += einsum("ab,cd,ie,jekl->ilda", delta_vv.bb, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_abbbabbb += einsum("ab,ij,kc,delc->kibd", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb -= einsum("ab,cd,ie,jekl->ilda", delta_vv.bb, delta_vv.bb, t1.aa, v.aabb.ovoo)
    ree2_abbbabbb -= einsum("ab,ij,kc,delc->kida", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,delc->kibd", delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,le->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,le->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.ov, t1.aa)
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mncd,mend->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemc->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemc->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,kl,mc,nd,nemc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kfme->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,cdkl->ilca", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_abbbabbb += einsum("ab,ij,cdkl->lica", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_abbbabbb += einsum("ab,cd,ijkl->jlda", delta_vv.bb, delta_vv.bb, v.aabb.oooo)
    ree2_abbbabbb += einsum("ab,ij,ckld->ikca", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_abbbabbb += einsum("ab,ij,ckld->ikbc", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_abbbabbb += einsum("ab,ij,cdkl->ilbc", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_abbbabbb += einsum("ab,ij,cdkl->libc", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_abbbabbb += einsum("ij,kl,abcd->ikca", delta_oo.aa, delta_oo.bb, v.bbbb.vvvv)
    ree2_abbbabbb -= einsum("ab,cd,ijkl->jlda", delta_vv.bb, delta_vv.bb, v.aabb.oooo)
    ree2_abbbabbb -= einsum("ab,ij,ckld->ikca", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_abbbabbb -= einsum("ab,ij,cdkl->ilca", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_abbbabbb -= einsum("ab,ij,cdkl->lica", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_abbbabbb -= einsum("ab,ij,cdkl->ilbc", delta_vv.bb, delta_oo.aa, v.bbbb.vvoo)
    ree2_abbbabbb -= einsum("ab,ij,cdkl->libc", delta_vv.bb, delta_oo.bb, v.bbaa.vvoo)
    ree2_abbbabbb -= einsum("ab,ij,ckld->ikbc", delta_vv.bb, delta_oo.aa, v.bbbb.voov)
    ree2_abbbabbb -= einsum("ij,kl,abcd->ikca", delta_oo.aa, delta_oo.bb, v.bbbb.vvvv)
    ree2_abbbabbb += einsum("ab,cd,ij,kl->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_abbbabbb += einsum("ab,cd,ij,kl->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_abbbabbb += einsum("ab,ij,kl,cd->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_abbbabbb += einsum("ab,ij,kl,cd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_abbbabbb -= einsum("ab,ij,kl,cd->ikca", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_abbbabbb -= einsum("ab,cd,ij,kl->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, f.bb.oo)
    ree2_abbbabbb -= einsum("ab,cd,ij,kl->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.aa.oo)
    ree2_abbbabbb -= einsum("ab,ij,kl,cd->ikbc", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.vv)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->ilda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, t1.bb, v.aabb.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,klef,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.aaaa, v.aaaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kfme->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abbbabbb += einsum("ab,cd,ij,ke,lf,kemf->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.aa, v.aaaa.ovov) * -1
    ree2_abbbabbb += einsum("ij,klab,kcmd->ilba", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ij,klab,kcmd->ilab", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ij,klab,kcmd->ilba", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb -= einsum("ij,klab,kcmd->ilab", delta_oo.aa, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ab,ij,kc,klmd->ilca", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbbabbb += einsum("ab,ij,kc,kdlm->imca", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbbabbb += einsum("ab,ij,kc,kdlm->mica", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbbabbb += einsum("ab,ij,kc,kdlm->imbc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbbabbb += einsum("ab,ij,kc,kdlm->mibc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbbabbb += einsum("ab,ij,kc,klmd->ilbc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbbabbb += einsum("ij,kl,ma,bcmd->ikba", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ij,kl,ma,bcmd->ikab", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ab,ij,kc,kdlm->imca", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbbabbb -= einsum("ab,ij,kc,kdlm->mica", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbbabbb -= einsum("ab,ij,kc,klmd->ilca", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbbabbb -= einsum("ab,ij,kc,klmd->ilbc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ooov)
    ree2_abbbabbb -= einsum("ab,ij,kc,kdlm->imbc", delta_vv.bb, delta_oo.aa, t1.bb, v.bbbb.ovoo)
    ree2_abbbabbb -= einsum("ab,ij,kc,kdlm->mibc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbaa.ovoo)
    ree2_abbbabbb -= einsum("ij,kl,ma,bcmd->ikba", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb -= einsum("ij,kl,ma,bcmd->ikab", delta_oo.aa, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,md->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,md->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,md->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,md->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_abbbabbb += einsum("ij,kl,mnab,ncmd->ikba", delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ij,kl,mnab,mcnd->ikba", delta_oo.aa, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ij,kl,ma,nb,ncmd->ikba", delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_abbbabbb += einsum("ij,kl,ma,nb,mcnd->ikba", delta_oo.aa, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_abbbabbb += einsum("ab,ij,klcd,kcme->ilda", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,ij,klcd,kcme->ilbd", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kcme->ilda", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbbabbb -= einsum("ab,ij,klcd,kcme->ilbd", delta_vv.bb, delta_oo.aa, t2.abab, v.aabb.ovov)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abbbabbb += einsum("ab,cd,ij,ke,klme->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,demc->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb += einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,klme->lida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ooov)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,demc->ikda", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,kelm->imda", delta_vv.bb, delta_vv.bb, delta_oo.aa, t1.aa, v.aabb.ovoo)
    ree2_abbbabbb -= einsum("ab,cd,ij,ke,kelm->mida", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.aaaa.ovoo)
    ree2_abbbabbb -= einsum("ab,ij,kl,mc,demc->ikbd", delta_vv.bb, delta_oo.aa, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb = np.zeros((nocc[1],  nocc[1],  nvir[1],  nvir[1]), dtype=np.float64)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.baba, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.aa, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ijcd,kcle->ijda", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ijcd,keld->ijca", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ijcd,kelc->ijda", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ijcd,kdle->ijca", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ijcd,kdle->ijbc", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ijcd,kelc->ijbd", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ijcd,keld->ijbc", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ijcd,kcle->ijbd", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,kelc->ijda", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,kdle->ijca", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,kcle->ijda", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,keld->ijca", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,keld->ijbc", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,kcle->ijbd", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,kdle->ijbc", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ijcd,kelc->ijbd", delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ie,jkle->ikda", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,cd,ie,jekl->lida", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldec->kjea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldec->jkea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,cd,ie,jekl->ilda", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,cd,ie,jkle->kida", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldec->jkea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldec->kjea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb += einsum("ab,ij,kc,dcle->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,dcle->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,dcle->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,dcle->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,cd,ie,jekl->ilda", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,cd,ie,jkle->kida", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldec->jkea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldec->kjea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,cd,ie,jkle->ikda", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,cd,ie,jekl->lida", delta_vv.bb, delta_vv.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lcde->jkda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldec->kjea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldec->jkea", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lcde->kjda", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovvv)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,dcle->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,dcle->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,dcle->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,delc->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,delc->jkbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,dcle->kjbd", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,le->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,le->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,nemd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mncd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,nemd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,nd,mend->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ij,kl,mnab,ncmd->jlba", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,kl,mnab,mcnd->ljba", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,kl,mnab,mcnd->jlba", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ij,kl,mnab,ncmd->ljba", delta_oo.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ij,kl,ma,nb,ncmd->jlba", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,kl,ma,nb,mcnd->ljba", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,kl,ma,nb,mcnd->jlba", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ij,kl,ma,nb,ncmd->ljba", delta_oo.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mekf->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ijkl->ljda", delta_vv.bb, delta_vv.bb, v.bbbb.oooo)
    ree2_bbbbbbbb += einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb += einsum("ab,ij,kcdl->ljda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb += einsum("ab,ij,kcdl->jlda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb += einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb += einsum("ab,cd,ijkl->jlda", delta_vv.bb, delta_vv.bb, v.bbbb.oooo)
    ree2_bbbbbbbb += einsum("ab,ij,kcdl->jlda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb += einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb += einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb += einsum("ab,ij,kcdl->ljda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb += einsum("ab,ij,ckld->jkbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb += einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb += einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb += einsum("ab,ij,ckld->kjbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb += einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb += einsum("ab,ij,ckld->kjbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb += einsum("ab,ij,ckld->jkbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb += einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb += einsum("ij,kl,abcd->jlca", delta_oo.bb, delta_oo.bb, v.bbbb.vvvv)
    ree2_bbbbbbbb += einsum("ij,kl,abcd->ljca", delta_oo.bb, delta_oo.bb, v.bbbb.vvvv)
    ree2_bbbbbbbb -= einsum("ab,cd,ijkl->jlda", delta_vv.bb, delta_vv.bb, v.bbbb.oooo)
    ree2_bbbbbbbb -= einsum("ab,ij,kcdl->jlda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb -= einsum("ab,ij,kcdl->ljda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb -= einsum("ab,cd,ijkl->ljda", delta_vv.bb, delta_vv.bb, v.bbbb.oooo)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd->jlca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb -= einsum("ab,ij,kcdl->ljda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb -= einsum("ab,ij,kcdl->jlda", delta_vv.bb, delta_oo.bb, v.bbbb.ovvo)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd->ljca", delta_vv.bb, delta_oo.bb, v.bbbb.oovv)
    ree2_bbbbbbbb -= einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb -= einsum("ab,ij,ckld->kjbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb -= einsum("ab,ij,ckld->jkbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb -= einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb -= einsum("ab,ij,ckld->jkbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb -= einsum("ab,ij,cdkl->ljbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb -= einsum("ab,ij,cdkl->jlbc", delta_vv.bb, delta_oo.bb, v.bbbb.vvoo)
    ree2_bbbbbbbb -= einsum("ab,ij,ckld->kjbc", delta_vv.bb, delta_oo.bb, v.bbbb.voov)
    ree2_bbbbbbbb -= einsum("ij,kl,abcd->jlca", delta_oo.bb, delta_oo.bb, v.bbbb.vvvv)
    ree2_bbbbbbbb -= einsum("ij,kl,abcd->ljca", delta_oo.bb, delta_oo.bb, v.bbbb.vvvv)
    ree2_bbbbbbbb += einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb += einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb += einsum("ab,ij,kl,cd->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb += einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb += einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb += einsum("ab,ij,kl,cd->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb += einsum("ab,ij,kl,cd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb += einsum("ab,ij,kl,cd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,cd->jlca", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,kl->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,kl->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, f.bb.oo)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,cd->ljca", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,cd->ljbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,cd->jlbc", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.vv)
    ree2_bbbbbbbb += einsum("ab,cd,ijef,kfle->ijda", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ijef,kelf->ijda", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ijef,kelf->ijda", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ijef,kfle->ijda", delta_vv.bb, delta_vv.bb, t2.bbbb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ie,jf,kelf->ijda", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ie,jf,kfle->ijda", delta_vv.bb, delta_vv.bb, t1.bb, t1.bb, v.bbbb.ovov) * -1
    ree2_bbbbbbbb += einsum("ij,klab,mckd->jlba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,klab,mckd->jlab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,klab,mckd->ljba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,klab,mckd->ljab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,klab,mckd->jlba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,klab,mckd->jlab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,klab,mckd->ljba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ij,klab,mckd->ljab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->jlba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->jlab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->ljba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->ljab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->jlba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->jlab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->ljba", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ij,klab,mckd->ljab", delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ldkm->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ij,kl,ma,bcmd->jlba", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ij,kl,ma,bcmd->jlab", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ij,kl,ma,bcmd->ljba", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ij,kl,ma,bcmd->ljab", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->jmca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->mjca", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ldkm->jmbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,lmkd->mjbc", delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ij,kl,ma,bcmd->jlba", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ij,kl,ma,bcmd->jlab", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ij,kl,ma,bcmd->ljba", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ij,kl,ma,bcmd->ljab", delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,md->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,md->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,md->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,md->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,md->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,md->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,md->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,md->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, f.bb.ov, t1.bb)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekd->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mcke->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->jlca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->ljda", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->ljca", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekd->jlbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mcke->jlbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mdke->ljbc", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.bbbb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,dcme->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lekm->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lekm->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ovoo)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.bb, v.bbbb.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,dcme->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->jlca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->ljca", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,dcme->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,dcme->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.bb, v.bbbb.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mekd->jlbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,kc,ld,mdke->ljbc", delta_vv.bb, delta_oo.bb, t1.bb, t1.bb, v.bbbb.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,klef,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->jlda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lf,mfke->ljda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, t1.bb, v.bbaa.ovov) * -1
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlda", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->jlbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb -= einsum("ab,ij,klcd,mekc->ljbd", delta_vv.bb, delta_oo.bb, t2.abab, v.bbaa.ovov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb += einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb += einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->jlda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->jmda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb -= einsum("ab,cd,ij,ke,lmke->mjda", delta_vv.bb, delta_vv.bb, delta_oo.bb, t1.aa, v.bbaa.ooov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->ljda", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->ljbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)
    ree2_bbbbbbbb -= einsum("ab,ij,kl,mc,demc->jlbd", delta_vv.bb, delta_oo.bb, delta_oo.bb, t1.aa, v.bbaa.vvov)

    ree1 = SimpleNamespace(aa=ree1_aaaa, ab=ree1_abab, ba=ree1_baba, bb=ree1_bbbb)
    ree2 = SimpleNamespace(aaaa=ree2_aaaaaaaa, aaab=ree2_aaabaaab, aaba=ree2_aabaaaba, aabb=ree2_aabbaabb, abaa=ree2_abaaabaa, abab=ree2_abababab, abba=ree2_abbaabba, abbb=ree2_abbbabbb, baaa=ree2_baaabaaa, baab=ree2_baabbaab, baba=ree2_babababa, babb=ree2_babbbabb, bbaa=ree2_bbaabbaa, bbab=ree2_bbabbbab, bbba=ree2_bbbabbba, bbbb=ree2_bbbbbbbb)

    return ree1, ree2

def hbar_matvec_ee(f=None, v=None, nocc=None, nvir=None, t1=None, t2=None, l1=None, l2=None, r1=None, r2=None, **kwargs):
    x0 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x0 += einsum("ijab->ijab", r2.aaaa)
    x0 += einsum("ijab->jiab", r2.aaaa) * -1
    x153 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x153 += einsum("ij,ikab->jkab", f.aa.oo, x0) * 0.5
    x164 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x164 += einsum("ijab->ijab", x153) * -1
    del x153
    x1 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x1 += einsum("iabc->ibac", v.aaaa.ovvv)
    x1 += einsum("iabc->ibca", v.aaaa.ovvv) * -1
    x146 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x146 += einsum("ijab,kcab->ijkc", r2.aaaa, x1)
    x147 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x147 += einsum("ijka->ijka", x146) * -1
    del x146
    x156 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x156 += einsum("ijab,icab->jc", t2.aaaa, x1)
    x163 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x163 += einsum("ia->ia", x156) * -1
    del x156
    x366 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x366 += einsum("ijab,icba->jc", t2.aaaa, x1)
    x373 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x373 += einsum("ia->ia", x366) * -1
    del x366
    ree1new_aa = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    ree1new_aa += einsum("ijab,icab->jc", x0, x1) * 0.5
    del x1
    x2 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x2 += einsum("ijka->ikja", v.aaaa.ooov)
    x2 += einsum("ijka->kija", v.aaaa.ooov) * -1
    x36 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x36 += einsum("ia,ijka->jk", r1.aa, x2) * -2
    x45 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x45 += einsum("ia,ijka->jk", t1.aa, x2)
    x47 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x47 += einsum("ij->ij", x45) * -1
    x124 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x124 += einsum("ij->ij", x45) * -1
    del x45
    x136 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x136 += einsum("ijab,ijkc->kabc", r2.aaaa, x2)
    x137 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x137 += einsum("iabc->iabc", x136) * -1
    del x136
    x157 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x157 += einsum("ijab,ijka->kb", t2.aaaa, x2)
    x163 += einsum("ia->ia", x157) * -1
    del x157
    x305 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x305 += einsum("ijab,ikla->kljb", t2.abab, x2)
    x314 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x314 += einsum("ijka->ijka", x305) * -1
    del x305
    x361 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x361 += einsum("ia,ijka->jk", r1.aa, x2)
    x364 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x364 += einsum("ij->ij", x361) * -1
    del x361
    x3 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x3 += einsum("ijab->ijab", r2.aaaa)
    x3 += einsum("ijab->ijba", r2.aaaa) * -1
    x139 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x139 += einsum("ab,ijcb->ijac", f.aa.vv, x3) * 0.5
    x164 += einsum("ijab->ijab", x139) * -1
    del x139
    ree1new_aa += einsum("ijka,ijab->kb", x2, x3) * 0.5
    del x2
    x4 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x4 += einsum("ijab->ijab", r2.abab)
    x4 += einsum("ijab->jiba", r2.baba)
    x8 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x8 += einsum("iajb,kjcb->ikac", v.aabb.ovov, x4)
    x9 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x9 += einsum("ijab->jiba", x8)
    del x8
    x27 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x27 += einsum("iajb,ijcb->ca", v.aabb.ovov, x4) * 0.5
    x29 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x29 += einsum("iajb,kjab->ik", v.aabb.ovov, x4)
    x36 += einsum("ij->ij", x29)
    x132 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x132 += einsum("ij->ji", x29)
    del x29
    x54 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x54 += einsum("iajb,ikac->jkbc", v.aabb.ovov, x4)
    x55 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x55 += einsum("ijab->jiba", x54)
    del x54
    x69 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x69 += einsum("iajb,ijac->cb", v.aabb.ovov, x4) * 0.5
    x73 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x73 += einsum("iajb,ikab->jk", v.aabb.ovov, x4)
    x80 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x80 += einsum("ij->ij", x73)
    x469 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x469 += einsum("ij->ji", x73)
    del x73
    x115 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x115 += einsum("ijka,lkba->ijlb", v.aabb.ooov, x4)
    x118 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x118 += einsum("ijka->ikja", x115)
    del x115
    x121 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x121 += einsum("iabc,jida->jbcd", v.bbaa.ovvv, x4)
    x122 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x122 += einsum("iabc->icab", x121)
    del x121
    x128 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x128 += einsum("iajb,ijcb->ac", v.aabb.ovov, x4)
    x129 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x129 += einsum("ab->ba", x128)
    x334 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x334 += einsum("ab->ba", x128)
    del x128
    x248 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x248 += einsum("abcd,ijbd->ijac", v.aabb.vvvv, x4) * 0.5
    ree2new_abab = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    ree2new_abab += einsum("ijab->ijab", x248)
    ree2new_baba = np.zeros((nocc[1], nocc[0], nvir[1], nvir[0]), dtype=np.float64)
    ree2new_baba += einsum("ijab->jiba", x248)
    del x248
    x252 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x252 += einsum("iajb,klab->ikjl", v.aabb.ovov, x4)
    x253 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x253 += einsum("ijab,ikjl->klab", t2.abab, x252) * 0.5
    del x252
    ree2new_abab += einsum("ijab->ijab", x253)
    ree2new_baba += einsum("ijab->jiba", x253)
    del x253
    x256 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x256 += einsum("iabc,jkac->jikb", v.aabb.ovvv, x4) * 0.5
    x278 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x278 += einsum("ijka->jika", x256)
    del x256
    x257 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x257 += einsum("iajk,ljab->likb", v.aabb.ovoo, x4) * 0.5
    x278 += einsum("ijka->jika", x257) * -1
    del x257
    x263 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x263 += einsum("iajb,klab->ikjl", v.aabb.ovov, x4) * 0.5
    x270 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x270 += einsum("ijkl->jikl", x263)
    del x263
    x276 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x276 += einsum("iajb,kjac->ikbc", v.aabb.ovov, x4)
    x277 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x277 += einsum("ia,jkab->kjib", t1.bb, x276) * 0.5
    del x276
    x278 += einsum("ijka->jika", x277) * -1
    del x277
    x285 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x285 += einsum("iajb,ikcb->jkac", v.aabb.ovov, x4)
    x286 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x286 += einsum("ia,jkab->ijkb", t1.aa, x285) * -1
    x385 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x385 += einsum("ia,jkab->ijkb", t1.aa, x285) * -0.5
    del x285
    x286 += einsum("iabc,jkca->jikb", v.bbaa.ovvv, x4)
    x286 += einsum("ijka,ilba->jklb", v.aabb.ooov, x4) * -1
    x291 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x291 += einsum("iabc,ijdc->jdab", v.aabb.ovvv, x4)
    x295 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x295 += einsum("iabc->iabc", x291) * -1
    del x291
    x292 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x292 += einsum("iajk,ijbc->kbac", v.aabb.ovoo, x4)
    x295 += einsum("iabc->iabc", x292)
    del x292
    x293 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x293 += einsum("iajb,ijcd->acbd", v.aabb.ovov, x4)
    x294 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x294 += einsum("ia,bcad->icbd", t1.bb, x293)
    del x293
    x295 += einsum("iabc->iabc", x294)
    del x294
    x299 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x299 += einsum("iabc,jicd->jbad", v.bbaa.ovvv, x4)
    x301 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x301 += einsum("iabc->iacb", x299) * -1
    del x299
    x300 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x300 += einsum("ijka,ikbc->jbac", v.aabb.ooov, x4)
    x301 += einsum("iabc->iacb", x300)
    del x300
    x329 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x329 += einsum("iajb,ijac->bc", v.aabb.ovov, x4)
    x331 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x331 += einsum("ab->ba", x329)
    x467 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x467 += einsum("ab->ba", x329)
    del x329
    x353 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x353 += einsum("iajb,ikab->jk", v.aabb.ovov, x4) * 0.5
    x357 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x357 += einsum("ij->ij", x353)
    del x353
    x360 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x360 += einsum("iajb,kjab->ik", v.aabb.ovov, x4) * 0.5
    x364 += einsum("ij->ij", x360)
    del x360
    x385 += einsum("iabc,jkca->jikb", v.bbaa.ovvv, x4) * 0.5
    x385 += einsum("ijka,ilba->jklb", v.aabb.ooov, x4) * -0.5
    x456 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x456 += einsum("iajk,ilab->ljkb", v.aabb.ovoo, x4)
    x459 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x459 += einsum("ijka->jika", x456)
    del x456
    x462 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x462 += einsum("iabc,ijad->jdbc", v.aabb.ovvv, x4)
    x463 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x463 += einsum("iabc->iabc", x462)
    del x462
    ree1new_aa += einsum("iabc,jica->jb", v.bbaa.ovvv, x4) * 0.5
    ree1new_aa += einsum("ijka,ikba->jb", v.aabb.ooov, x4) * -0.5
    ree1new_aa += einsum("ia,jiba->jb", f.bb.ov, x4) * 0.5
    ree1new_bb = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    ree1new_bb += einsum("iabc,ijac->jb", v.aabb.ovvv, x4) * 0.5
    ree1new_bb += einsum("iajk,ijab->kb", v.aabb.ovoo, x4) * -0.5
    ree1new_bb += einsum("ia,ijab->jb", f.aa.ov, x4) * 0.5
    x5 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x5 += einsum("ijab->ijab", r2.aaaa) * -1
    x5 += einsum("ijab->ijba", r2.aaaa)
    x5 += einsum("ijab->jiab", r2.aaaa)
    x5 += einsum("ijab->jiba", r2.aaaa) * -1
    x12 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x12 += einsum("iajb,kica->kjcb", v.aabb.ovov, x5)
    x13 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x13 += einsum("ijab->ijab", x12) * -1
    del x12
    x297 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x297 += einsum("iabc,jida->jdbc", v.aabb.ovvv, x5)
    x301 += einsum("iabc->iabc", x297) * -1
    del x297
    x6 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x6 += einsum("iajb->jiab", v.aaaa.ovov)
    x6 += einsum("iajb->jiba", v.aaaa.ovov) * -1
    x7 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x7 += einsum("ijab,jkac->ikbc", x5, x6)
    x9 += einsum("ijab->ijab", x7) * -1
    del x7
    x116 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x116 += einsum("ia,jkba->ijkb", t1.aa, x9)
    x118 += einsum("ijka->kjia", x116)
    del x116
    ree1new_aa += einsum("ia,jiba->jb", t1.aa, x9) * 0.5
    del x9
    x36 += einsum("ijab,ikba->kj", x0, x6)
    x44 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x44 += einsum("ijab,ikab->jk", t2.aaaa, x6)
    x47 += einsum("ij->ji", x44) * -1
    x124 += einsum("ij->ji", x44) * -1
    del x44
    x56 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x56 += einsum("ijab,ikca->kjcb", x4, x6)
    x59 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x59 += einsum("ijab->ijab", x56)
    del x56
    x359 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x359 += einsum("ijab,ikba->jk", x0, x6) * 0.5
    x364 += einsum("ij->ji", x359)
    del x359
    x10 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x10 += einsum("iajb->jiab", v.bbbb.ovov)
    x10 += einsum("iajb->jiba", v.bbbb.ovov) * -1
    x11 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x11 += einsum("ijab,kica->kjcb", x10, x4)
    x13 += einsum("ijab->ijab", x11) * -1
    del x11
    x286 += einsum("ia,jkba->jkib", t1.bb, x13)
    x385 += einsum("ia,jkba->jkib", t1.bb, x13) * 0.5
    ree1new_aa += einsum("ia,jiba->jb", t1.bb, x13) * 0.5
    del x13
    x75 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x75 += einsum("ia,ijab->jb", t1.bb, x10)
    x76 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x76 += einsum("ia->ia", x75) * -1
    del x75
    x78 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x78 += einsum("ia,ijab->jb", r1.bb, x10)
    x79 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x79 += einsum("ia->ia", x78) * -1
    del x78
    x90 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x90 += einsum("ijab,ikab->kj", t2.bbbb, x10)
    x93 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x93 += einsum("ij->ij", x90) * -1
    x465 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x465 += einsum("ij->ij", x90) * -1
    x495 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x495 += einsum("ij->ji", x90) * -1
    del x90
    x103 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x103 += einsum("ijab,jkbc->ikac", t2.abab, x10)
    x104 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x104 += einsum("ijab->ijab", x103) * -1
    x282 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x282 += einsum("ijab->ijab", x103) * -1
    del x103
    x451 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x451 += einsum("ijab,ijcb->ca", t2.bbbb, x10)
    x453 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x453 += einsum("ab->ba", x451) * -1
    x493 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x493 += einsum("ab->ba", x451) * -1
    del x451
    x14 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x14 += einsum("ijab,kcjb->ikac", t2.abab, v.aabb.ovov)
    x18 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x18 += einsum("ijab->jiab", x14)
    x99 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x99 += einsum("ijab->ijab", x14)
    x172 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x172 += einsum("ijab->ijab", x14)
    x192 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x192 += einsum("ijab->ijab", x14)
    x237 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x237 += einsum("ijab->jiab", x14)
    del x14
    x15 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x15 -= einsum("ijab->jiab", t2.aaaa)
    x15 += einsum("ijab->jiba", t2.aaaa)
    x19 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x19 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x15)
    x22 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x22 -= einsum("ijab->ijab", x19)
    del x19
    x216 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x216 += einsum("ia,ijba->jb", f.aa.ov, x15)
    x223 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x223 -= einsum("ia->ia", x216)
    del x216
    x16 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x16 -= einsum("iajb->jiab", v.aaaa.ovov)
    x16 += einsum("iajb->jiba", v.aaaa.ovov)
    x17 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x17 += einsum("ijab,ikcb->jkac", x15, x16)
    del x15
    x18 += einsum("ijab->jiab", x17)
    del x17
    x64 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x64 += einsum("ijab,ikca->kjcb", t2.abab, x16)
    x66 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x66 -= einsum("ijab->ijab", x64)
    del x64
    x174 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x174 += einsum("ia,ijba->jb", t1.aa, x16)
    x175 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x175 -= einsum("ia->ia", x174)
    x220 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x220 -= einsum("ia->ia", x174)
    del x174
    x194 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x194 += einsum("ia,ijba->jb", r1.aa, x16)
    del x16
    x195 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x195 -= einsum("ia->ia", x194)
    del x194
    x18 += einsum("iabj->ijba", v.aaaa.ovvo)
    x18 -= einsum("ijab->ijab", v.aaaa.oovv)
    x214 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x214 += einsum("ia,ijba->jb", t1.aa, x18)
    x223 += einsum("ia->ia", x214)
    del x214
    ree1new_aa += einsum("ia,ijba->jb", r1.aa, x18)
    del x18
    x20 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x20 += einsum("iajb->jiab", v.bbbb.ovov)
    x20 -= einsum("iajb->jiba", v.bbbb.ovov)
    x21 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x21 += einsum("ijab,jkbc->ikac", t2.abab, x20)
    x22 -= einsum("ijab->ijab", x21)
    del x21
    x392 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x392 += einsum("ia,ijab->jb", t1.bb, x20)
    x393 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x393 -= einsum("ia->ia", x392)
    x437 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x437 -= einsum("ia->ia", x392)
    del x392
    x412 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x412 += einsum("ia,ijab->jb", r1.bb, x20)
    x413 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x413 -= einsum("ia->ia", x412)
    del x412
    x22 += einsum("iabj->jiba", v.bbaa.ovvo)
    x215 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x215 += einsum("ia,jiba->jb", t1.bb, x22)
    x223 += einsum("ia->ia", x215)
    del x215
    ree1new_aa += einsum("ia,jiba->jb", r1.bb, x22)
    del x22
    x23 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x23 += einsum("ijab->ijab", r2.aaaa)
    x23 += einsum("ijab->ijba", r2.aaaa) * -1
    x23 += einsum("ijab->jiab", r2.aaaa) * -1
    x23 += einsum("ijab->jiba", r2.aaaa)
    x286 += einsum("iajk,liba->ljkb", v.aabb.ovoo, x23)
    x385 += einsum("iajk,liba->ljkb", v.aabb.ovoo, x23) * 0.5
    ree1new_aa += einsum("ia,jiba->jb", f.aa.ov, x23) * 0.5
    x24 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x24 += einsum("ia,iabc->bc", r1.bb, v.bbaa.ovvv)
    x27 += einsum("ab->ab", x24) * -1
    x207 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x207 += einsum("ab->ab", x24)
    x334 += einsum("ab->ab", x24) * -2
    del x24
    x25 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x25 += einsum("iajb->jiab", v.aaaa.ovov) * -1
    x25 += einsum("iajb->jiba", v.aaaa.ovov)
    x27 += einsum("ijab,ijac->cb", x25, x3) * 0.5
    x31 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x31 += einsum("ia,ijba->jb", t1.aa, x25)
    x32 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x32 += einsum("ia->ia", x31) * -1
    del x31
    x34 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x34 += einsum("ia,ijba->jb", r1.aa, x25)
    x35 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x35 += einsum("ia->ia", x34) * -1
    del x34
    x39 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x39 += einsum("ijab,ijcb->ac", t2.aaaa, x25)
    x41 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x41 += einsum("ab->ab", x39) * -1
    del x39
    x109 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x109 += einsum("ijab,ijbc->ac", t2.aaaa, x25)
    x111 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x111 += einsum("ab->ab", x109) * -1
    x158 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x158 += einsum("ab->ab", x109) * -1
    del x109
    x127 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x127 += einsum("ijab,ijac->cb", x25, x3)
    x129 += einsum("ab->ab", x127)
    x130 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x130 += einsum("ab,ijbc->ijca", x129, t2.aaaa) * 0.5
    del x129
    x164 += einsum("ijab->jiba", x130)
    del x130
    x334 += einsum("ab->ab", x127)
    del x127
    x131 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x131 += einsum("ijab,ikab->jk", x0, x25)
    del x0
    x132 += einsum("ij->ij", x131)
    del x131
    x133 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x133 += einsum("ij,jkab->kiab", x132, t2.aaaa) * 0.5
    del x132
    x164 += einsum("ijab->jiba", x133)
    del x133
    x160 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x160 += einsum("ijab,ikba->jk", t2.aaaa, x25)
    x161 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x161 += einsum("ij->ij", x160) * -1
    del x160
    x231 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x231 += einsum("ijab,ikca->kjcb", t2.abab, x25)
    x234 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x234 += einsum("ijab->ijab", x231) * -1
    x261 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x261 += einsum("ijab->ijab", x231) * -1
    del x231
    x26 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x26 += einsum("iabc->ibac", v.aaaa.ovvv) * -1
    x26 += einsum("iabc->ibca", v.aaaa.ovvv)
    x27 += einsum("ia,ibca->bc", r1.aa, x26) * -1
    ree1new_aa += einsum("ia,ba->ib", t1.aa, x27) * -1
    del x27
    x40 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x40 += einsum("ia,ibac->bc", t1.aa, x26)
    x41 += einsum("ab->ab", x40) * -1
    del x40
    x110 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x110 += einsum("ia,ibca->bc", t1.aa, x26)
    x111 += einsum("ab->ab", x110) * -1
    del x110
    x120 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x120 += einsum("iabc,jibd->jdac", x26, x5)
    x122 += einsum("iabc->iabc", x120) * -1
    del x120
    x123 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x123 += einsum("ia,jbca->ijbc", t1.aa, x122) * 0.5
    del x122
    x164 += einsum("ijab->jiab", x123)
    del x123
    x290 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x290 += einsum("iabc,ijcd->jabd", x26, x4)
    x295 += einsum("iabc->iabc", x290)
    del x290
    x333 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x333 += einsum("ia,ibca->bc", r1.aa, x26) * 2
    x334 += einsum("ab->ab", x333) * -1
    del x333
    x335 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x335 += einsum("ab,ijbc->ijac", x334, t2.abab) * 0.5
    del x334
    ree2new_abab += einsum("ijab->ijab", x335) * -1
    ree2new_baba += einsum("ijab->jiba", x335) * -1
    del x335
    x339 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x339 += einsum("ijab,icad->jcdb", t2.abab, x26)
    del x26
    x343 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x343 += einsum("iabc->iabc", x339) * -1
    del x339
    x28 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x28 += einsum("ia,jkia->jk", r1.bb, v.aabb.ooov)
    x36 += einsum("ij->ij", x28) * 2
    x211 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x211 += einsum("ij->ij", x28)
    x364 += einsum("ij->ij", x28)
    del x28
    x30 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x30 += einsum("ia,jbia->jb", t1.bb, v.aabb.ovov)
    x32 += einsum("ia->ia", x30)
    x175 += einsum("ia->ia", x30)
    x220 += einsum("ia->ia", x30)
    del x30
    x221 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x221 += einsum("ia,ja->ij", t1.aa, x220)
    del x220
    x222 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x222 += einsum("ia,ji->ja", t1.aa, x221)
    del x221
    x223 -= einsum("ia->ia", x222)
    del x222
    x32 += einsum("ia->ia", f.aa.ov)
    x36 += einsum("ia,ja->ji", r1.aa, x32) * 2
    x46 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x46 += einsum("ia,ja->ij", t1.aa, x32)
    x47 += einsum("ij->ji", x46)
    x124 += einsum("ij->ji", x46)
    del x46
    x117 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x117 += einsum("ia,jkab->jkib", x32, x3)
    x118 += einsum("ijka->kija", x117) * -1
    del x117
    x258 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x258 += einsum("ia,jkab->jikb", x32, x4) * 0.5
    x278 += einsum("ijka->jika", x258)
    del x258
    x308 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x308 += einsum("ia,jkab->jikb", x32, t2.abab)
    x314 += einsum("ijka->jika", x308)
    del x308
    x362 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x362 += einsum("ia,ja->ij", r1.aa, x32)
    del x32
    x364 += einsum("ij->ji", x362)
    del x362
    x33 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x33 += einsum("ia,jbia->jb", r1.bb, v.aabb.ovov)
    x35 += einsum("ia->ia", x33)
    x36 += einsum("ia,ja->ji", t1.aa, x35) * 2
    ree1new_aa += einsum("ia,ij->ja", t1.aa, x36) * -0.5
    del x36
    x272 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x272 += einsum("ia,jkab->jikb", x35, t2.abab)
    x278 += einsum("ijka->jika", x272)
    del x272
    x363 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x363 += einsum("ia,ja->ij", t1.aa, x35)
    del x35
    x364 += einsum("ij->ji", x363)
    del x363
    x365 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x365 += einsum("ij,ikab->jkab", x364, t2.abab)
    del x364
    ree2new_abab += einsum("ijab->ijab", x365) * -1
    ree2new_baba += einsum("ijab->jiba", x365) * -1
    del x365
    x195 += einsum("ia->ia", x33)
    del x33
    x196 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x196 += einsum("ia,jkab->jkib", x195, t2.aaaa)
    x200 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x200 -= einsum("ijka->jkia", x196)
    del x196
    x203 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x203 += einsum("ia,ja->ij", t1.aa, x195)
    del x195
    x204 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x204 += einsum("ij->ij", x203)
    del x203
    x37 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x37 += einsum("ia,iabc->bc", t1.bb, v.bbaa.ovvv)
    x41 += einsum("ab->ab", x37)
    x111 += einsum("ab->ab", x37) * -1
    x218 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x218 += einsum("ab->ab", x37)
    del x37
    x38 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x38 += einsum("ijab,icjb->ac", t2.abab, v.aabb.ovov)
    x41 += einsum("ab->ab", x38) * -1
    x111 += einsum("ab->ab", x38)
    x112 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x112 += einsum("ab,ijbc->ijca", x111, x3) * 0.5
    del x3
    del x111
    x164 += einsum("ijab->ijab", x112)
    del x112
    x158 += einsum("ab->ab", x38)
    del x38
    x159 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x159 += einsum("ia,ba->ib", t1.aa, x158)
    del x158
    x163 += einsum("ia->ia", x159)
    del x159
    x41 += einsum("ab->ab", f.aa.vv)
    x288 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x288 += einsum("ab,ijbc->ijac", x41, x4) * 0.5
    ree2new_abab += einsum("ijab->ijab", x288)
    ree2new_baba += einsum("ijab->jiba", x288)
    del x288
    x371 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x371 += einsum("ia,ba->ib", t1.aa, x41)
    x373 += einsum("ia->ia", x371)
    del x371
    ree1new_aa += einsum("ia,ba->ib", r1.aa, x41)
    del x41
    x42 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x42 += einsum("ia,jkia->jk", t1.bb, v.aabb.ooov)
    x47 += einsum("ij->ij", x42)
    x124 += einsum("ij->ij", x42)
    x228 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x228 += einsum("ij->ij", x42)
    del x42
    x43 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x43 += einsum("ijab,kajb->ik", t2.abab, v.aabb.ovov)
    x47 += einsum("ij->ji", x43)
    x124 += einsum("ij->ji", x43)
    x161 += einsum("ij->ij", x43)
    del x43
    x162 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x162 += einsum("ia,ji->ja", t1.aa, x161)
    del x161
    x163 += einsum("ia->ia", x162)
    del x162
    x47 += einsum("ij->ij", f.aa.oo)
    x327 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x327 += einsum("ij,ikab->jkab", x47, x4) * 0.5
    ree2new_abab += einsum("ijab->ijab", x327) * -1
    ree2new_baba += einsum("ijab->jiba", x327) * -1
    del x327
    x372 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x372 += einsum("ia,ij->ja", t1.aa, x47)
    x373 += einsum("ia->ia", x372) * -1
    del x372
    ree1new_aa += einsum("ia,ij->ja", r1.aa, x47) * -1
    del x47
    x48 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x48 += einsum("ijab->ijab", r2.bbbb)
    x48 += einsum("ijab->jiab", r2.bbbb) * -1
    x490 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x490 += einsum("ij,ikab->jkab", f.bb.oo, x48) * 0.5
    x498 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x498 += einsum("ijab->ijab", x490) * -1
    del x490
    x49 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x49 += einsum("iabc->ibac", v.bbbb.ovvv) * -1
    x49 += einsum("iabc->ibca", v.bbbb.ovvv)
    x69 += einsum("ia,ibca->bc", r1.bb, x49) * -1
    x330 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x330 += einsum("ia,ibca->bc", r1.bb, x49) * 2
    x331 += einsum("ab->ab", x330) * -1
    del x330
    x377 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x377 += einsum("ijab,icab->jc", t2.bbbb, x49)
    x384 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x384 += einsum("ia->ia", x377) * -1
    del x377
    x452 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x452 += einsum("ia,ibca->bc", t1.bb, x49)
    x453 += einsum("ab->ab", x452) * -1
    del x452
    x483 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x483 += einsum("ijab,kcba->ijkc", r2.bbbb, x49)
    x484 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x484 += einsum("ijka->ijka", x483) * -1
    del x483
    ree1new_bb += einsum("ijab,icba->jc", x48, x49) * 0.5
    del x48
    del x49
    x50 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x50 += einsum("ijka->ikja", v.bbbb.ooov)
    x50 += einsum("ijka->kija", v.bbbb.ooov) * -1
    x80 += einsum("ia,ijka->jk", r1.bb, x50) * -2
    x91 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x91 += einsum("ia,ijka->jk", t1.bb, x50)
    x93 += einsum("ij->ij", x91) * -1
    x465 += einsum("ij->ij", x91) * -1
    del x91
    x318 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x318 += einsum("ijab,jklb->ikla", t2.abab, x50)
    x324 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x324 += einsum("ijka->ijka", x318) * -1
    del x318
    x354 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x354 += einsum("ia,ijka->jk", r1.bb, x50)
    x357 += einsum("ij->ij", x354) * -1
    del x354
    x378 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x378 += einsum("ijab,ijkb->ka", t2.bbbb, x50)
    x384 += einsum("ia->ia", x378) * -1
    del x378
    x51 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x51 += einsum("ijab->ijab", r2.bbbb) * -1
    x51 += einsum("ijab->ijba", r2.bbbb)
    ree1new_bb += einsum("ijka,ijba->kb", x50, x51) * 0.5
    del x50
    x52 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x52 += einsum("ijab->ijab", r2.bbbb) * -1
    x52 += einsum("ijab->ijba", r2.bbbb)
    x52 += einsum("ijab->jiab", r2.bbbb)
    x52 += einsum("ijab->jiba", r2.bbbb) * -1
    x53 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x53 += einsum("ijab,ikca->jkbc", x10, x52)
    x55 += einsum("ijab->jiba", x53) * -1
    del x53
    x457 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x457 += einsum("ia,jkba->ijkb", t1.bb, x55)
    x459 += einsum("ijka->kjia", x457)
    del x457
    ree1new_bb += einsum("ia,jiba->jb", t1.bb, x55) * 0.5
    del x55
    x57 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x57 += einsum("ijab->ijab", r2.bbbb)
    x57 += einsum("ijab->ijba", r2.bbbb) * -1
    x57 += einsum("ijab->jiab", r2.bbbb) * -1
    x57 += einsum("ijab->jiba", r2.bbbb)
    x58 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x58 += einsum("iajb,jkbc->ikac", v.aabb.ovov, x57)
    x59 += einsum("ijab->ijab", x58)
    del x58
    x259 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x259 += einsum("ia,jkab->ijkb", t1.aa, x59) * 0.5
    x278 += einsum("ijka->jika", x259)
    del x259
    ree1new_bb += einsum("ia,ijab->jb", t1.aa, x59) * 0.5
    del x59
    x255 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x255 += einsum("ijka,klab->ijlb", v.aabb.ooov, x57) * 0.5
    x278 += einsum("ijka->ijka", x255)
    del x255
    x289 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x289 += einsum("iabc,ijad->jbcd", v.bbaa.ovvv, x57)
    x295 += einsum("iabc->iabc", x289)
    del x289
    x296 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x296 += einsum("ia,jbac->ijbc", t1.aa, x295) * 0.5
    del x295
    ree2new_abab += einsum("ijab->ijab", x296)
    ree2new_baba += einsum("ijab->jiba", x296)
    del x296
    ree1new_bb += einsum("ia,ijab->jb", f.bb.ov, x57) * 0.5
    x60 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x60 += einsum("ijab,iakc->jkbc", t2.abab, v.aabb.ovov)
    x63 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x63 += einsum("ijab->jiab", x60)
    x240 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x240 += einsum("ijab->jiab", x60)
    x390 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x390 += einsum("ijab->ijab", x60)
    x410 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x410 += einsum("ijab->ijab", x60)
    x445 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x445 += einsum("ijab->ijab", x60)
    del x60
    x61 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x61 += einsum("ijab->jiab", t2.bbbb)
    x61 -= einsum("ijab->jiba", t2.bbbb)
    x62 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x62 += einsum("ijab,ikac->jkbc", x20, x61)
    del x20
    x63 += einsum("ijab->ijba", x62)
    x390 += einsum("ijab->jiba", x62)
    x410 += einsum("ijab->jiba", x62)
    del x62
    x65 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x65 += einsum("iajb,jkbc->ikac", v.aabb.ovov, x61)
    x66 -= einsum("ijab->ijab", x65)
    del x65
    x433 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x433 += einsum("ia,ijab->jb", f.bb.ov, x61)
    x440 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x440 -= einsum("ia->ia", x433)
    del x433
    x63 += einsum("iabj->ijba", v.bbbb.ovvo)
    x63 -= einsum("ijab->ijab", v.bbbb.oovv)
    x431 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x431 += einsum("ia,ijba->jb", t1.bb, x63)
    x440 += einsum("ia->ia", x431)
    del x431
    ree1new_bb += einsum("ia,ijba->jb", r1.bb, x63)
    del x63
    x66 += einsum("iabj->ijab", v.aabb.ovvo)
    x432 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x432 += einsum("ia,ijab->jb", t1.aa, x66)
    x440 += einsum("ia->ia", x432)
    del x432
    ree1new_bb += einsum("ia,ijab->jb", r1.aa, x66)
    del x66
    x67 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x67 += einsum("ia,iabc->bc", r1.aa, v.aabb.ovvv)
    x69 += einsum("ab->ab", x67) * -1
    x331 += einsum("ab->ab", x67) * -2
    x425 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x425 += einsum("ab->ab", x67)
    del x67
    x68 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x68 += einsum("ijab->ijab", r2.bbbb)
    x68 += einsum("ijab->ijba", r2.bbbb) * -1
    x69 += einsum("ijab,ijbc->ca", x10, x68) * 0.5
    ree1new_bb += einsum("ia,ba->ib", t1.bb, x69) * -1
    del x69
    x328 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x328 += einsum("ijab,ijbc->ac", x10, x68)
    x331 += einsum("ab->ba", x328)
    x332 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x332 += einsum("ab,ijcb->ijca", x331, t2.abab) * 0.5
    del x331
    ree2new_abab += einsum("ijab->ijab", x332) * -1
    ree2new_baba += einsum("ijab->jiba", x332) * -1
    del x332
    x467 += einsum("ab->ba", x328)
    del x328
    x468 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x468 += einsum("ab,ijbc->ijca", x467, t2.bbbb) * 0.5
    del x467
    x498 += einsum("ijab->jiba", x468)
    del x468
    x476 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x476 += einsum("ab,ijcb->ijac", f.bb.vv, x68) * 0.5
    x498 += einsum("ijab->ijab", x476) * -1
    del x476
    x70 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x70 += einsum("ia,iajk->jk", r1.aa, v.aabb.ovoo)
    x80 += einsum("ij->ij", x70) * 2
    x357 += einsum("ij->ij", x70)
    x429 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x429 += einsum("ij->ij", x70)
    del x70
    x71 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x71 += einsum("ijab->ijab", r2.bbbb) * -1
    x71 += einsum("ijab->jiab", r2.bbbb)
    x72 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x72 += einsum("ijab,kiba->jk", x10, x71)
    x80 += einsum("ij->ij", x72)
    x469 += einsum("ij->ji", x72)
    del x72
    x470 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x470 += einsum("ij,jkab->kiab", x469, t2.bbbb) * 0.5
    del x469
    x498 += einsum("ijab->jiba", x470)
    del x470
    x352 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x352 += einsum("ijab,kiba->jk", x10, x71) * 0.5
    x357 += einsum("ij->ij", x352)
    del x352
    x74 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x74 += einsum("ia,iajb->jb", t1.aa, v.aabb.ovov)
    x76 += einsum("ia->ia", x74)
    x393 += einsum("ia->ia", x74)
    x437 += einsum("ia->ia", x74)
    del x74
    x438 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x438 += einsum("ia,ja->ij", t1.bb, x437)
    del x437
    x439 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x439 += einsum("ia,ji->ja", t1.bb, x438)
    del x438
    x440 -= einsum("ia->ia", x439)
    del x439
    x76 += einsum("ia->ia", f.bb.ov)
    x80 += einsum("ia,ja->ji", r1.bb, x76) * 2
    x92 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x92 += einsum("ia,ja->ij", t1.bb, x76)
    x93 += einsum("ij->ji", x92)
    x465 += einsum("ij->ji", x92)
    del x92
    x286 += einsum("ia,jkba->jikb", x76, x4)
    x321 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x321 += einsum("ia,jkba->jkib", x76, t2.abab)
    x324 += einsum("ijka->ikja", x321)
    del x321
    x355 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x355 += einsum("ia,ja->ij", r1.bb, x76)
    x357 += einsum("ij->ji", x355)
    del x355
    x385 += einsum("ia,jkba->jikb", x76, x4) * 0.5
    x458 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x458 += einsum("ia,jkab->jkib", x76, x68)
    del x68
    del x76
    x459 += einsum("ijka->kija", x458) * -1
    del x458
    x77 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x77 += einsum("ia,iajb->jb", r1.aa, v.aabb.ovov)
    x79 += einsum("ia->ia", x77)
    x80 += einsum("ia,ja->ji", t1.bb, x79) * 2
    ree1new_bb += einsum("ia,ij->ja", t1.bb, x80) * -0.5
    del x80
    x286 += einsum("ia,jkba->jikb", x79, t2.abab) * 2
    x356 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x356 += einsum("ia,ja->ij", t1.bb, x79)
    x357 += einsum("ij->ji", x356)
    del x356
    x358 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x358 += einsum("ij,kiab->kjab", x357, t2.abab)
    del x357
    ree2new_abab += einsum("ijab->ijab", x358) * -1
    ree2new_baba += einsum("ijab->jiba", x358) * -1
    del x358
    x385 += einsum("ia,jkba->jikb", x79, t2.abab)
    del x79
    x413 += einsum("ia->ia", x77)
    del x77
    x414 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x414 += einsum("ia,jkab->jkib", x413, t2.bbbb)
    x418 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x418 -= einsum("ijka->jkia", x414)
    del x414
    x421 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x421 += einsum("ia,ja->ij", t1.bb, x413)
    del x413
    x422 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x422 += einsum("ij->ij", x421)
    del x421
    x81 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x81 += einsum("ia,iabc->bc", t1.aa, v.aabb.ovvv)
    x87 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x87 += einsum("ab->ab", x81)
    x435 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x435 += einsum("ab->ab", x81)
    x453 += einsum("ab->ab", x81) * -1
    del x81
    x82 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x82 += einsum("ijab,iajc->bc", t2.abab, v.aabb.ovov)
    x87 += einsum("ab->ab", x82) * -1
    x453 += einsum("ab->ab", x82)
    x454 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x454 += einsum("ab,ijcb->ijca", x453, x51) * 0.5
    del x51
    del x453
    x498 += einsum("ijab->ijab", x454)
    del x454
    x493 += einsum("ab->ab", x82)
    del x82
    x494 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x494 += einsum("ia,ba->ib", t1.bb, x493)
    del x493
    x497 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x497 += einsum("ia->ia", x494)
    del x494
    x83 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x83 += einsum("iajb->jiab", v.bbbb.ovov) * -1
    x83 += einsum("iajb->jiba", v.bbbb.ovov)
    x84 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x84 += einsum("ijab,ijcb->ac", t2.bbbb, x83)
    del x83
    x87 += einsum("ab->ab", x84) * -1
    del x84
    x85 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x85 += einsum("iabc->ibac", v.bbbb.ovvv)
    x85 += einsum("iabc->ibca", v.bbbb.ovvv) * -1
    x86 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x86 += einsum("ia,ibca->bc", t1.bb, x85)
    x87 += einsum("ab->ab", x86) * -1
    del x86
    x298 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x298 += einsum("ijab,jcdb->iacd", x4, x85)
    x301 += einsum("iabc->iabc", x298) * -1
    del x298
    x302 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x302 += einsum("ia,jbca->jibc", t1.bb, x301) * 0.5
    del x301
    ree2new_abab += einsum("ijab->ijab", x302)
    ree2new_baba += einsum("ijab->jiba", x302)
    del x302
    x348 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x348 += einsum("ijab,jcdb->iacd", t2.abab, x85)
    x350 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x350 += einsum("iabc->iabc", x348) * -1
    del x348
    x461 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x461 += einsum("ijab,icdb->jacd", x52, x85)
    x463 += einsum("iabc->iabc", x461) * -1
    del x461
    x464 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x464 += einsum("ia,jbca->ijbc", t1.bb, x463) * 0.5
    del x463
    x498 += einsum("ijab->jiab", x464)
    del x464
    x491 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x491 += einsum("ijab,icab->jc", t2.bbbb, x85)
    del x85
    x497 += einsum("ia->ia", x491) * -1
    del x491
    x87 += einsum("ab->ab", f.bb.vv)
    x287 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x287 += einsum("ab,ijcb->ijca", x87, x4) * 0.5
    ree2new_abab += einsum("ijab->ijab", x287)
    ree2new_baba += einsum("ijab->jiba", x287)
    del x287
    x382 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x382 += einsum("ia,ba->ib", t1.bb, x87)
    x384 += einsum("ia->ia", x382)
    del x382
    ree1new_bb += einsum("ia,ba->ib", r1.bb, x87)
    del x87
    x88 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x88 += einsum("ia,iajk->jk", t1.aa, v.aabb.ovoo)
    x93 += einsum("ij->ij", x88)
    x465 += einsum("ij->ij", x88)
    x502 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x502 += einsum("ij->ij", x88)
    del x88
    x89 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x89 += einsum("ijab,iakb->jk", t2.abab, v.aabb.ovov)
    x93 += einsum("ij->ji", x89)
    x465 += einsum("ij->ji", x89)
    x466 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x466 += einsum("ij,ikab->kjab", x465, x71) * 0.5
    del x465
    del x71
    x498 += einsum("ijab->ijab", x466) * -1
    del x466
    x495 += einsum("ij->ij", x89)
    del x89
    x496 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x496 += einsum("ia,ji->ja", t1.bb, x495)
    del x495
    x497 += einsum("ia->ia", x496)
    del x496
    x93 += einsum("ij->ij", f.bb.oo)
    x326 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x326 += einsum("ij,kiab->kjab", x93, x4) * 0.5
    ree2new_abab += einsum("ijab->ijab", x326) * -1
    ree2new_baba += einsum("ijab->jiba", x326) * -1
    del x326
    x383 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x383 += einsum("ia,ij->ja", t1.bb, x93)
    x384 += einsum("ia->ia", x383) * -1
    del x383
    ree1new_bb += einsum("ia,ij->ja", r1.bb, x93) * -1
    del x93
    x94 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x94 += einsum("ijab,cbda->ijdc", r2.aaaa, v.aaaa.vvvv)
    x164 += einsum("ijab->ijab", x94) * 0.5
    del x94
    x95 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x95 += einsum("ijab,kbla->ijlk", r2.aaaa, v.aaaa.ovov)
    x96 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x96 += einsum("ijab,klji->klba", t2.aaaa, x95)
    x164 += einsum("ijab->ijab", x96) * 0.5
    del x96
    x145 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x145 += einsum("ia,jkli->jkla", t1.aa, x95)
    del x95
    x147 += einsum("ijka->ijka", x145)
    del x145
    x148 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x148 += einsum("ia,jkib->jkab", t1.aa, x147) * 0.5
    del x147
    x164 += einsum("ijab->ijab", x148)
    del x148
    x97 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x97 += einsum("ijab->jiab", t2.aaaa)
    x97 += einsum("ijab->jiba", t2.aaaa) * -1
    x98 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x98 += einsum("ijab,ikac->jkbc", x6, x97)
    del x97
    del x6
    x99 += einsum("ijab->jiba", x98)
    del x98
    x99 += einsum("iabj->jiba", v.aaaa.ovvo)
    x99 += einsum("ijab->jiab", v.aaaa.oovv) * -1
    x100 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x100 += einsum("ijab,kjca->ikbc", x5, x99) * 0.5
    del x99
    del x5
    x164 += einsum("ijab->ijab", x100)
    del x100
    x101 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x101 += einsum("ijab->jiab", t2.aaaa) * -1
    x101 += einsum("ijab->jiba", t2.aaaa)
    x102 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x102 += einsum("iajb,ikca->kjcb", v.aabb.ovov, x101)
    x104 += einsum("ijab->ijab", x102) * -1
    x282 += einsum("ijab->ijab", x102) * -1
    del x102
    x236 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x236 += einsum("ijab,ikcb->kjca", x101, x25)
    del x25
    x237 += einsum("ijab->ijba", x236)
    del x236
    x319 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x319 += einsum("iajk,ilba->ljkb", v.aabb.ovoo, x101)
    x324 += einsum("ijka->ijka", x319) * -1
    del x319
    x347 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x347 += einsum("iabc,ijda->jdbc", v.aabb.ovvv, x101)
    x350 += einsum("iabc->iabc", x347) * -1
    del x347
    x370 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x370 += einsum("ia,ijba->jb", f.aa.ov, x101)
    del x101
    x373 += einsum("ia->ia", x370) * -1
    del x370
    x104 += einsum("iabj->jiba", v.bbaa.ovvo)
    x105 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x105 += einsum("ijab,kjcb->kica", x104, x4) * 0.5
    x164 += einsum("ijab->ijab", x105)
    del x105
    x320 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x320 += einsum("ia,jkba->jikb", t1.bb, x104)
    x324 += einsum("ijka->ikja", x320)
    del x320
    x369 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x369 += einsum("ia,jiba->jb", t1.bb, x104)
    x373 += einsum("ia->ia", x369)
    del x369
    ree2new_abab += einsum("ijab,kjbc->ikac", x104, x52) * 0.5
    ree2new_baba += einsum("ijab,jkbc->kica", x104, x52) * -0.5
    del x104
    del x52
    x106 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x106 += einsum("ijab,kalb->ijkl", t2.aaaa, v.aaaa.ovov)
    x107 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x107 += einsum("ijkl->lkji", x106)
    x150 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x150 += einsum("ia,jkil->kjla", t1.aa, x106)
    del x106
    x151 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x151 += einsum("ijka->ijka", x150) * -1
    del x150
    x107 += einsum("ijkl->kilj", v.aaaa.oooo)
    x108 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x108 += einsum("ijab,jikl->klab", r2.aaaa, x107) * 0.5
    del x107
    x164 += einsum("ijab->jiab", x108)
    del x108
    x113 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x113 += einsum("ijka->ikja", v.aaaa.ooov) * -1
    x113 += einsum("ijka->kija", v.aaaa.ooov)
    x114 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x114 += einsum("ijka,jlab->likb", x113, x23)
    x118 += einsum("ijka->jika", x114) * -1
    del x114
    x119 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x119 += einsum("ia,ijkb->jkab", t1.aa, x118) * 0.5
    del x118
    x164 += einsum("ijab->ijba", x119) * -1
    del x119
    x254 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x254 += einsum("ijka,ilab->jklb", x113, x4) * 0.5
    x278 += einsum("ijka->ijka", x254)
    del x254
    x367 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x367 += einsum("ijab,ijka->kb", t2.aaaa, x113)
    del x113
    x373 += einsum("ia->ia", x367) * -1
    del x367
    x125 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x125 += einsum("ijab->ijab", r2.aaaa) * -1
    x125 += einsum("ijab->jiab", r2.aaaa)
    x126 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x126 += einsum("ij,ikab->jkab", x124, x125) * 0.5
    del x124
    del x125
    x164 += einsum("ijab->jiab", x126) * -1
    del x126
    x134 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x134 += einsum("ijab,jcid->abdc", r2.aaaa, v.aaaa.ovov)
    x135 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x135 += einsum("ia,bcda->ibcd", t1.aa, x134)
    del x134
    x137 += einsum("iabc->iabc", x135)
    del x135
    x138 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x138 += einsum("ia,jbca->ijbc", t1.aa, x137) * 0.5
    del x137
    x164 += einsum("ijab->ijab", x138)
    del x138
    x140 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x140 += einsum("ijab,jkic->kbac", t2.aaaa, v.aaaa.ooov)
    x143 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x143 += einsum("iabc->iabc", x140)
    del x140
    x141 = np.zeros((nvir[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x141 += einsum("ijab,icjd->abcd", t2.aaaa, v.aaaa.ovov)
    x142 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x142 += einsum("ia,bcad->icbd", t1.aa, x141)
    del x141
    x143 += einsum("iabc->iabc", x142) * -1
    del x142
    x144 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x144 += einsum("ia,jbca->ijbc", r1.aa, x143)
    del x143
    x164 += einsum("ijab->ijab", x144) * -1
    del x144
    x149 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x149 += einsum("ijab,kbca->jikc", t2.aaaa, v.aaaa.ovvv)
    x151 += einsum("ijka->ijka", x149)
    del x149
    x152 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x152 += einsum("ia,jkib->jkab", r1.aa, x151)
    del x151
    x164 += einsum("ijab->ijab", x152) * -1
    del x152
    x154 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x154 += einsum("ijab,ikjb->ka", t2.abab, v.aabb.ooov)
    x163 += einsum("ia->ia", x154)
    x373 += einsum("ia->ia", x154) * -1
    del x154
    x155 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x155 += einsum("ijab,jbca->ic", t2.abab, v.bbaa.ovvv)
    x163 += einsum("ia->ia", x155) * -1
    x164 += einsum("ia,jb->ijab", r1.aa, x163) * -1
    del x163
    ree2new_aaaa = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    ree2new_aaaa += einsum("ijab->ijab", x164)
    ree2new_aaaa += einsum("ijab->ijba", x164) * -1
    ree2new_aaaa += einsum("ijab->jiab", x164) * -1
    ree2new_aaaa += einsum("ijab->jiba", x164)
    del x164
    x373 += einsum("ia->ia", x155)
    del x155
    x165 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x165 += einsum("ijab,kljb->ikla", t2.abab, v.aabb.ooov)
    x182 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x182 += einsum("ijka->jika", x165)
    del x165
    x166 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x166 -= einsum("ijka->ikja", v.aaaa.ooov)
    x166 += einsum("ijka->kija", v.aaaa.ooov)
    x167 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x167 += einsum("ijab->jiab", t2.aaaa)
    x167 -= einsum("ijab->jiba", t2.aaaa)
    x168 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x168 += einsum("ijka,jlab->iklb", x166, x167)
    del x166
    x182 += einsum("ijka->ikja", x168)
    del x168
    x169 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x169 += einsum("ia,jbca->ijcb", t1.aa, v.aaaa.ovvv)
    x172 += einsum("ijab->ijab", x169)
    del x169
    x170 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x170 += einsum("iajb->jiab", v.aaaa.ovov)
    x170 -= einsum("iajb->jiba", v.aaaa.ovov)
    x171 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x171 += einsum("ijab,ikac->jkbc", x167, x170)
    del x170
    x172 += einsum("ijab->ijab", x171)
    x192 += einsum("ijab->ijab", x171)
    del x171
    x172 += einsum("iabj->jiba", v.aaaa.ovvo)
    x172 -= einsum("ijab->jiab", v.aaaa.oovv)
    x173 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x173 += einsum("ia,jkba->ijkb", t1.aa, x172)
    del x172
    x182 -= einsum("ijka->kija", x173)
    del x173
    x175 += einsum("ia->ia", f.aa.ov)
    x176 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x176 += einsum("ia,jkab->jkib", x175, t2.aaaa)
    x182 += einsum("ijka->kjia", x176)
    del x176
    x202 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x202 += einsum("ia,ja->ij", r1.aa, x175)
    del x175
    x204 += einsum("ij->ij", x202)
    del x202
    x205 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x205 += einsum("ij,jkab->kiab", x204, t2.aaaa)
    del x204
    x224 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x224 += einsum("ijab->jiba", x205)
    del x205
    x177 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x177 += einsum("ia,jakb->ikjb", t1.aa, v.aaaa.ovov)
    x178 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x178 += einsum("ia,jkla->jilk", t1.aa, x177)
    x180 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x180 += einsum("ijkl->lkji", x178)
    del x178
    x197 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x197 -= einsum("ijka->jkia", x177)
    del x177
    x179 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x179 += einsum("ia,jkla->ijlk", t1.aa, v.aaaa.ooov)
    x180 += einsum("ijkl->jkli", x179)
    x180 -= einsum("ijkl->kjli", x179)
    del x179
    x180 += einsum("ijkl->kilj", v.aaaa.oooo)
    x181 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x181 += einsum("ia,ijkl->jkla", t1.aa, x180)
    del x180
    x182 += einsum("ijka->ikja", x181)
    del x181
    x182 -= einsum("ijak->ijka", v.aaaa.oovo)
    x183 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x183 += einsum("ia,ijkb->jkab", r1.aa, x182)
    del x182
    x224 += einsum("ijab->ijab", x183)
    del x183
    x184 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x184 += einsum("ia,bacd->icbd", t1.aa, v.aaaa.vvvv)
    x188 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x188 -= einsum("iabc->iabc", x184)
    del x184
    x185 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x185 += einsum("ijab,jbcd->iacd", t2.abab, v.bbaa.ovvv)
    x188 += einsum("iabc->iabc", x185)
    del x185
    x186 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x186 -= einsum("iabc->ibac", v.aaaa.ovvv)
    x186 += einsum("iabc->ibca", v.aaaa.ovvv)
    x187 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x187 += einsum("ijab,icad->jbcd", x167, x186)
    del x167
    x188 += einsum("iabc->iabc", x187)
    del x187
    x206 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x206 += einsum("ia,ibac->bc", r1.aa, x186)
    x207 -= einsum("ab->ab", x206)
    del x206
    x208 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x208 += einsum("ab,ijbc->ijca", x207, t2.aaaa)
    del x207
    x224 += einsum("ijab->jiab", x208)
    del x208
    x217 = np.zeros((nvir[0], nvir[0]), dtype=np.float64)
    x217 += einsum("ia,ibac->bc", t1.aa, x186)
    del x186
    x218 -= einsum("ab->ab", x217)
    del x217
    x219 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x219 += einsum("ia,ba->ib", t1.aa, x218)
    del x218
    x223 += einsum("ia->ia", x219)
    del x219
    x188 += einsum("aibc->iabc", v.aaaa.vovv)
    x189 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x189 += einsum("ia,jbca->ijbc", r1.aa, x188)
    del x188
    x224 -= einsum("ijab->ijab", x189)
    del x189
    x190 = np.zeros((nocc[0], nvir[0], nvir[0], nvir[0]), dtype=np.float64)
    x190 += einsum("iabc->ibac", v.aaaa.ovvv)
    x190 -= einsum("iabc->ibca", v.aaaa.ovvv)
    x191 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x191 += einsum("ia,jbac->ijbc", t1.aa, x190)
    del x190
    x192 -= einsum("ijab->ijab", x191)
    del x191
    x192 += einsum("iabj->jiba", v.aaaa.ovvo)
    x192 -= einsum("ijab->jiab", v.aaaa.oovv)
    x193 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x193 += einsum("ia,jkba->ijkb", r1.aa, x192)
    del x192
    x200 += einsum("ijka->ikja", x193)
    del x193
    x197 += einsum("ijka->ikja", v.aaaa.ooov)
    x198 = np.zeros((nocc[0], nocc[0], nocc[0], nocc[0]), dtype=np.float64)
    x198 += einsum("ia,jkla->ijkl", r1.aa, x197)
    del x197
    x199 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x199 += einsum("ia,jkil->jkla", t1.aa, x198)
    del x198
    x200 += einsum("ijka->ijka", x199)
    del x199
    x201 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x201 += einsum("ia,jikb->jkab", t1.aa, x200)
    del x200
    x224 -= einsum("ijab->ijab", x201)
    del x201
    x209 = np.zeros((nocc[0], nocc[0], nocc[0], nvir[0]), dtype=np.float64)
    x209 += einsum("ijka->ikja", v.aaaa.ooov)
    x209 -= einsum("ijka->kija", v.aaaa.ooov)
    x210 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x210 += einsum("ia,ijka->jk", r1.aa, x209)
    x211 -= einsum("ij->ij", x210)
    del x210
    x212 = np.zeros((nocc[0], nocc[0], nvir[0], nvir[0]), dtype=np.float64)
    x212 += einsum("ij,ikab->kjab", x211, t2.aaaa)
    del x211
    x224 -= einsum("ijab->ijba", x212)
    del x212
    x227 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x227 += einsum("ia,ijka->jk", t1.aa, x209)
    del x209
    x228 -= einsum("ij->ij", x227)
    del x227
    x213 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x213 += einsum("ia,jiba->jb", f.bb.ov, t2.abab)
    x223 += einsum("ia->ia", x213)
    x224 += einsum("ia,jb->ijab", r1.aa, x223)
    del x223
    ree2new_aaaa += einsum("ijab->ijab", x224)
    ree2new_aaaa -= einsum("ijab->ijba", x224)
    ree2new_aaaa -= einsum("ijab->jiab", x224)
    ree2new_aaaa += einsum("ijab->jiba", x224)
    del x224
    x373 += einsum("ia->ia", x213)
    del x213
    x225 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x225 += einsum("ab,ib->ia", f.aa.vv, t1.aa)
    x230 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x230 -= einsum("ia->ia", x225)
    del x225
    x226 = np.zeros((nocc[0], nocc[0]), dtype=np.float64)
    x226 += einsum("ia,ja->ij", f.aa.ov, t1.aa)
    x228 += einsum("ij->ij", x226)
    del x226
    x228 += einsum("ij->ij", f.aa.oo)
    x229 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x229 += einsum("ia,ij->ja", t1.aa, x228)
    del x228
    x230 += einsum("ia->ia", x229)
    del x229
    x230 -= einsum("ai->ia", f.aa.vo)
    ree2new_aaaa -= einsum("ia,jb->jiba", r1.aa, x230)
    ree2new_aaaa -= einsum("ia,jb->ijab", r1.aa, x230)
    ree2new_aaaa += einsum("ia,jb->ijba", r1.aa, x230)
    ree2new_aaaa += einsum("ia,jb->jiab", r1.aa, x230)
    del x230
    x232 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x232 += einsum("ijab->jiab", t2.bbbb)
    x232 += einsum("ijab->jiba", t2.bbbb) * -1
    x233 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x233 += einsum("iajb,jkbc->ikac", v.aabb.ovov, x232)
    x234 += einsum("ijab->ijab", x233) * -1
    x261 += einsum("ijab->ijab", x233) * -1
    del x233
    x239 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x239 += einsum("ijab,ikac->jkbc", x10, x232)
    del x10
    x240 += einsum("ijab->ijba", x239)
    x445 += einsum("ijab->jiba", x239)
    del x239
    x306 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x306 += einsum("ijka,klab->ijlb", v.aabb.ooov, x232)
    x314 += einsum("ijka->ijka", x306) * -1
    del x306
    x338 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x338 += einsum("iabc,ijad->jbcd", v.bbaa.ovvv, x232)
    x343 += einsum("iabc->iabc", x338) * -1
    del x338
    x381 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x381 += einsum("ia,ijab->jb", f.bb.ov, x232)
    del x232
    x384 += einsum("ia->ia", x381) * -1
    del x381
    x234 += einsum("iabj->ijab", v.aabb.ovvo)
    x235 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x235 += einsum("ijab,jkbc->ikac", x23, x234) * 0.5
    del x23
    ree2new_abab += einsum("ijab->ijab", x235)
    ree2new_baba += einsum("ijab->jiba", x235)
    del x235
    x380 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x380 += einsum("ia,ijab->jb", t1.aa, x234)
    x384 += einsum("ia->ia", x380)
    del x380
    x447 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x447 += einsum("ijab,ikac->kjcb", x234, x4) * 0.5
    del x234
    x498 += einsum("ijab->ijab", x447)
    del x447
    x237 += einsum("iabj->ijba", v.aaaa.ovvo)
    x237 += einsum("ijab->ijab", v.aaaa.oovv) * -1
    x238 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x238 += einsum("ijab,ikbc->jkac", x237, x4) * 0.5
    ree2new_abab += einsum("ijab->ijab", x238)
    ree2new_baba += einsum("ijab->jiba", x238)
    del x238
    x368 = np.zeros((nocc[0], nvir[0]), dtype=np.float64)
    x368 += einsum("ia,ijba->jb", t1.aa, x237)
    del x237
    x373 += einsum("ia->ia", x368)
    del x368
    x240 += einsum("iabj->ijba", v.bbbb.ovvo)
    x240 += einsum("ijab->ijab", v.bbbb.oovv) * -1
    x241 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x241 += einsum("ijab,kicb->kjca", x240, x4) * 0.5
    ree2new_abab += einsum("ijab->ijab", x241)
    ree2new_baba += einsum("ijab->jiba", x241)
    del x241
    x379 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x379 += einsum("ia,ijba->jb", t1.bb, x240)
    del x240
    x384 += einsum("ia->ia", x379)
    del x379
    x242 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x242 += einsum("ijab,ickb->jkac", t2.abab, v.aabb.ovov)
    x243 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x243 += einsum("ijab->jiab", x242) * -1
    x284 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x284 += einsum("ijab->jiab", x242) * -1
    del x242
    x243 += einsum("ijab->ijab", v.bbaa.oovv)
    x244 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x244 += einsum("ijab,kibc->kjac", x243, x4) * 0.5
    del x243
    ree2new_abab += einsum("ijab->ijab", x244) * -1
    ree2new_baba += einsum("ijab->jiba", x244) * -1
    del x244
    x245 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x245 += einsum("ijab,kajc->ikbc", t2.abab, v.aabb.ovov)
    x246 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x246 += einsum("ijab->jiab", x245) * -1
    x274 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x274 += einsum("ijab->jiab", x245) * -1
    del x245
    x246 += einsum("ijab->ijab", v.aabb.oovv)
    x247 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x247 += einsum("ijab,ikcb->jkca", x246, x4) * 0.5
    ree2new_abab += einsum("ijab->ijab", x247) * -1
    ree2new_baba += einsum("ijab->jiba", x247) * -1
    del x247
    x313 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x313 += einsum("ia,jkba->jkib", t1.bb, x246)
    del x246
    x314 += einsum("ijka->ijka", x313)
    del x313
    x249 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x249 += einsum("ijab,kalb->ikjl", t2.abab, v.aabb.ovov)
    x250 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x250 += einsum("ijkl->jilk", x249)
    x311 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x311 += einsum("ijkl->jilk", x249)
    del x249
    x250 += einsum("ijkl->ijkl", v.aabb.oooo)
    x251 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x251 += einsum("ijkl,ikab->jlab", x250, x4) * 0.5
    del x250
    ree2new_abab += einsum("ijab->ijab", x251)
    ree2new_baba += einsum("ijab->jiba", x251)
    del x251
    x260 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x260 += einsum("ia,jbca->jibc", t1.bb, v.aabb.ovvv)
    x261 += einsum("ijab->ijab", x260)
    del x260
    x261 += einsum("iabj->ijab", v.aabb.ovvo)
    x262 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x262 += einsum("ia,jkab->ijkb", r1.aa, x261)
    x278 += einsum("ijka->jika", x262)
    del x262
    x307 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x307 += einsum("ia,jkab->ijkb", t1.aa, x261)
    del x261
    x314 += einsum("ijka->jika", x307)
    del x307
    x264 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x264 += einsum("ia,jbka->jikb", t1.bb, v.aabb.ovov)
    x265 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x265 += einsum("ijka->ikja", x264)
    del x264
    x265 += einsum("iajk->ijka", v.aabb.ovoo)
    x266 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x266 += einsum("ia,jkla->ijkl", r1.aa, x265)
    x270 += einsum("ijkl->ijkl", x266)
    del x266
    x310 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x310 += einsum("ia,jkla->ijkl", t1.aa, x265)
    del x265
    x311 += einsum("ijkl->jikl", x310)
    del x310
    x267 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x267 += einsum("ia,jakb->ijkb", t1.aa, v.aabb.ovov)
    x268 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x268 += einsum("ijka->jika", x267)
    del x267
    x268 += einsum("ijka->ijka", v.aabb.ooov)
    x269 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x269 += einsum("ia,jkla->jkil", r1.bb, x268)
    del x268
    x270 += einsum("ijkl->jilk", x269)
    del x269
    x271 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x271 += einsum("ia,jkil->jkla", t1.bb, x270)
    del x270
    x278 += einsum("ijka->jika", x271) * -1
    del x271
    x273 = np.zeros((nocc[0], nocc[0], nvir[1], nvir[1]), dtype=np.float64)
    x273 += einsum("ia,jabc->ijbc", t1.aa, v.aabb.ovvv)
    x274 += einsum("ijab->jiab", x273)
    del x273
    x274 += einsum("ijab->ijab", v.aabb.oovv)
    x275 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x275 += einsum("ia,jkba->jkib", r1.bb, x274)
    del x274
    x278 += einsum("ijka->ijka", x275)
    del x275
    x279 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x279 += einsum("ia,ijkb->jkab", t1.aa, x278)
    del x278
    ree2new_abab += einsum("ijab->ijab", x279) * -1
    ree2new_baba += einsum("ijab->jiba", x279) * -1
    del x279
    x280 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x280 += einsum("ijka->ikja", v.bbbb.ooov) * -1
    x280 += einsum("ijka->kija", v.bbbb.ooov)
    x286 += einsum("ijka,liba->ljkb", x280, x4)
    x385 += einsum("ijka,liba->ljkb", x280, x4) * 0.5
    del x4
    x455 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x455 += einsum("ijka,jlab->likb", x280, x57)
    x459 += einsum("ijka->jika", x455) * -1
    del x455
    x460 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x460 += einsum("ia,ijkb->jkab", t1.bb, x459) * 0.5
    del x459
    x498 += einsum("ijab->ijba", x460) * -1
    del x460
    x473 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x473 += einsum("ijab,jikc->kabc", r2.bbbb, x280)
    x474 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x474 += einsum("iabc->iabc", x473) * -1
    del x473
    x492 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x492 += einsum("ijab,ijkb->ka", t2.bbbb, x280)
    del x280
    x497 += einsum("ia->ia", x492) * -1
    del x492
    x281 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x281 += einsum("ia,jbca->ijcb", t1.aa, v.bbaa.ovvv)
    x282 += einsum("ijab->ijab", x281)
    del x281
    x282 += einsum("iabj->jiba", v.bbaa.ovvo)
    x286 += einsum("ia,jkba->jkib", r1.bb, x282) * 2
    x385 += einsum("ia,jkba->jkib", r1.bb, x282)
    del x282
    x283 = np.zeros((nocc[1], nocc[1], nvir[0], nvir[0]), dtype=np.float64)
    x283 += einsum("ia,jabc->ijbc", t1.bb, v.bbaa.ovvv)
    x284 += einsum("ijab->jiab", x283)
    del x283
    x284 += einsum("ijab->ijab", v.bbaa.oovv)
    x286 += einsum("ia,jkba->ijkb", r1.aa, x284) * 2
    ree2new_abab += einsum("ia,jikb->jkba", t1.bb, x286) * -0.5
    del x286
    x322 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x322 += einsum("ia,jkba->ijkb", t1.aa, x284)
    x324 += einsum("ijka->ijka", x322)
    del x322
    x385 += einsum("ia,jkba->ijkb", r1.aa, x284)
    del x284
    ree2new_baba += einsum("ia,jikb->kjab", t1.bb, x385) * -1
    del x385
    x303 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x303 += einsum("ijab,kajl->iklb", t2.abab, v.aabb.ovoo)
    x314 += einsum("ijka->jika", x303) * -1
    del x303
    x304 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x304 += einsum("ijab,kacb->ikjc", t2.abab, v.aabb.ovvv)
    x314 += einsum("ijka->jika", x304)
    del x304
    x309 = np.zeros((nocc[0], nocc[0], nocc[1], nocc[1]), dtype=np.float64)
    x309 += einsum("ia,jkla->jkil", t1.bb, v.aabb.ooov)
    x311 += einsum("ijkl->ijlk", x309)
    del x309
    x311 += einsum("ijkl->ijkl", v.aabb.oooo)
    x312 = np.zeros((nocc[0], nocc[0], nocc[1], nvir[1]), dtype=np.float64)
    x312 += einsum("ia,jkil->jkla", t1.bb, x311)
    x314 += einsum("ijka->ijka", x312) * -1
    del x312
    x323 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x323 += einsum("ia,ijkl->jkla", t1.aa, x311)
    del x311
    x324 += einsum("ijka->ijka", x323) * -1
    del x323
    x314 += einsum("ijak->ijka", v.aabb.oovo)
    x315 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x315 += einsum("ia,ijkb->jkab", r1.aa, x314)
    del x314
    ree2new_abab += einsum("ijab->ijab", x315) * -1
    ree2new_baba += einsum("ijab->jiba", x315) * -1
    del x315
    x316 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x316 += einsum("ijab,iklb->kjla", t2.abab, v.aabb.ooov)
    x324 += einsum("ijka->ikja", x316) * -1
    del x316
    x317 = np.zeros((nocc[0], nocc[1], nocc[1], nvir[0]), dtype=np.float64)
    x317 += einsum("ijab,kbca->ijkc", t2.abab, v.bbaa.ovvv)
    x324 += einsum("ijka->ikja", x317)
    del x317
    x324 += einsum("ijak->kija", v.bbaa.oovo)
    x325 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x325 += einsum("ia,jikb->jkba", r1.bb, x324)
    del x324
    ree2new_abab += einsum("ijab->ijab", x325) * -1
    ree2new_baba += einsum("ijab->jiba", x325) * -1
    del x325
    x336 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x336 += einsum("ijab,icjk->kacb", t2.abab, v.aabb.ovoo)
    x343 += einsum("iabc->iabc", x336)
    del x336
    x337 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x337 += einsum("ijab,icdb->jacd", t2.abab, v.aabb.ovvv)
    x343 += einsum("iabc->iabc", x337) * -1
    del x337
    x340 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x340 += einsum("ijab,icjd->acbd", t2.abab, v.aabb.ovov)
    x341 = np.zeros((nvir[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x341 += einsum("abcd->abcd", x340)
    del x340
    x341 += einsum("abcd->abcd", v.aabb.vvvv)
    x342 = np.zeros((nocc[1], nvir[0], nvir[0], nvir[1]), dtype=np.float64)
    x342 += einsum("ia,bcda->ibcd", t1.bb, x341)
    x343 += einsum("iabc->iabc", x342)
    del x342
    x349 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x349 += einsum("ia,bacd->ibcd", t1.aa, x341)
    del x341
    x350 += einsum("iabc->iabc", x349)
    del x349
    x343 += einsum("abci->iabc", v.aabb.vvvo)
    x344 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x344 += einsum("ia,jbac->ijbc", r1.aa, x343)
    del x343
    ree2new_abab += einsum("ijab->ijab", x344)
    ree2new_baba += einsum("ijab->jiba", x344)
    del x344
    x345 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x345 += einsum("ijab,ikjc->kabc", t2.abab, v.aabb.ooov)
    x350 += einsum("iabc->iabc", x345)
    del x345
    x346 = np.zeros((nocc[0], nvir[0], nvir[1], nvir[1]), dtype=np.float64)
    x346 += einsum("ijab,jcda->idbc", t2.abab, v.bbaa.ovvv)
    x350 += einsum("iabc->iabc", x346) * -1
    del x346
    x350 += einsum("aibc->iabc", v.aabb.vovv)
    x351 = np.zeros((nocc[0], nocc[1], nvir[0], nvir[1]), dtype=np.float64)
    x351 += einsum("ia,jbca->jibc", r1.bb, x350)
    del x350
    ree2new_abab += einsum("ijab->ijab", x351)
    ree2new_baba += einsum("ijab->jiba", x351)
    del x351
    x373 += einsum("ai->ia", f.aa.vo)
    ree2new_abab += einsum("ia,jb->jiba", r1.bb, x373)
    ree2new_baba += einsum("ia,jb->ijab", r1.bb, x373)
    del x373
    x374 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x374 += einsum("ia,ijab->jb", f.aa.ov, t2.abab)
    x384 += einsum("ia->ia", x374)
    x440 += einsum("ia->ia", x374)
    del x374
    x375 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x375 += einsum("ijab,iajk->kb", t2.abab, v.aabb.ovoo)
    x384 += einsum("ia->ia", x375) * -1
    x497 += einsum("ia->ia", x375)
    del x375
    x376 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x376 += einsum("ijab,iacb->jc", t2.abab, v.aabb.ovvv)
    x384 += einsum("ia->ia", x376)
    x497 += einsum("ia->ia", x376) * -1
    del x376
    x498 += einsum("ia,jb->ijab", r1.bb, x497) * -1
    del x497
    x384 += einsum("ai->ia", f.bb.vo)
    ree2new_abab += einsum("ia,jb->ijab", r1.aa, x384)
    ree2new_baba += einsum("ia,jb->jiba", r1.aa, x384)
    del x384
    x386 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x386 += einsum("ijab,iakl->jklb", t2.abab, v.aabb.ovoo)
    x400 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x400 += einsum("ijka->jika", x386)
    del x386
    x387 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x387 -= einsum("ijka->ikja", v.bbbb.ooov)
    x387 += einsum("ijka->kija", v.bbbb.ooov)
    x388 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x388 += einsum("ijka,jlab->likb", x387, x61)
    del x387
    x400 += einsum("ijka->jika", x388)
    del x388
    x389 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x389 += einsum("ia,jbca->ijcb", t1.bb, v.bbbb.ovvv)
    x390 += einsum("ijab->ijab", x389)
    del x389
    x390 += einsum("iabj->jiba", v.bbbb.ovvo)
    x390 -= einsum("ijab->jiab", v.bbbb.oovv)
    x391 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x391 += einsum("ia,jkba->ijkb", t1.bb, x390)
    del x390
    x400 -= einsum("ijka->kija", x391)
    del x391
    x393 += einsum("ia->ia", f.bb.ov)
    x394 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x394 += einsum("ia,jkab->jkib", x393, t2.bbbb)
    x400 += einsum("ijka->kjia", x394)
    del x394
    x420 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x420 += einsum("ia,ja->ij", r1.bb, x393)
    del x393
    x422 += einsum("ij->ij", x420)
    del x420
    x423 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x423 += einsum("ij,jkab->kiab", x422, t2.bbbb)
    del x422
    x441 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x441 += einsum("ijab->jiba", x423)
    del x423
    x395 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x395 += einsum("ia,jakb->ikjb", t1.bb, v.bbbb.ovov)
    x396 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x396 += einsum("ia,jkla->jilk", t1.bb, x395)
    x398 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x398 += einsum("ijkl->lkji", x396)
    del x396
    x415 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x415 -= einsum("ijka->jkia", x395)
    del x395
    x397 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x397 += einsum("ia,jkla->ijlk", t1.bb, v.bbbb.ooov)
    x398 += einsum("ijkl->jkli", x397)
    x398 -= einsum("ijkl->kjli", x397)
    del x397
    x398 += einsum("ijkl->kilj", v.bbbb.oooo)
    x399 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x399 += einsum("ia,ijkl->jkla", t1.bb, x398)
    del x398
    x400 += einsum("ijka->ikja", x399)
    del x399
    x400 -= einsum("ijak->ijka", v.bbbb.oovo)
    x401 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x401 += einsum("ia,ijkb->jkab", r1.bb, x400)
    del x400
    x441 += einsum("ijab->ijab", x401)
    del x401
    x402 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x402 += einsum("ia,bcda->ibdc", t1.bb, v.bbbb.vvvv)
    x406 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x406 -= einsum("iabc->iabc", x402)
    del x402
    x403 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x403 += einsum("ijab,iacd->jbcd", t2.abab, v.aabb.ovvv)
    x406 += einsum("iabc->iabc", x403)
    del x403
    x404 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x404 += einsum("iabc->ibac", v.bbbb.ovvv)
    x404 -= einsum("iabc->ibca", v.bbbb.ovvv)
    x405 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x405 += einsum("iabc,ijcd->jdab", x404, x61)
    del x61
    x406 += einsum("iabc->iabc", x405)
    del x405
    x424 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x424 += einsum("ia,ibca->bc", r1.bb, x404)
    x425 -= einsum("ab->ab", x424)
    del x424
    x426 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x426 += einsum("ab,ijbc->ijca", x425, t2.bbbb)
    del x425
    x441 += einsum("ijab->jiab", x426)
    del x426
    x434 = np.zeros((nvir[1], nvir[1]), dtype=np.float64)
    x434 += einsum("ia,ibca->bc", t1.bb, x404)
    del x404
    x435 -= einsum("ab->ab", x434)
    del x434
    x436 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x436 += einsum("ia,ba->ib", t1.bb, x435)
    del x435
    x440 += einsum("ia->ia", x436)
    del x436
    x441 += einsum("ia,jb->ijab", r1.bb, x440)
    del x440
    x406 += einsum("aibc->iabc", v.bbbb.vovv)
    x407 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x407 += einsum("ia,jbca->ijbc", r1.bb, x406)
    del x406
    x441 -= einsum("ijab->ijab", x407)
    del x407
    x408 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x408 -= einsum("iabc->ibac", v.bbbb.ovvv)
    x408 += einsum("iabc->ibca", v.bbbb.ovvv)
    x409 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x409 += einsum("ia,jbca->ijbc", t1.bb, x408)
    del x408
    x410 -= einsum("ijab->ijab", x409)
    del x409
    x410 += einsum("iabj->jiba", v.bbbb.ovvo)
    x410 -= einsum("ijab->jiab", v.bbbb.oovv)
    x411 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x411 += einsum("ia,jkba->ijkb", r1.bb, x410)
    del x410
    x418 += einsum("ijka->ikja", x411)
    del x411
    x415 += einsum("ijka->ikja", v.bbbb.ooov)
    x416 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x416 += einsum("ia,jkla->ijkl", r1.bb, x415)
    del x415
    x417 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x417 += einsum("ia,jkil->jkla", t1.bb, x416)
    del x416
    x418 += einsum("ijka->ijka", x417)
    del x417
    x419 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x419 += einsum("ia,jikb->jkab", t1.bb, x418)
    del x418
    x441 -= einsum("ijab->ijab", x419)
    del x419
    x427 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x427 += einsum("ijka->ikja", v.bbbb.ooov)
    x427 -= einsum("ijka->kija", v.bbbb.ooov)
    x428 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x428 += einsum("ia,ijka->jk", r1.bb, x427)
    x429 -= einsum("ij->ij", x428)
    del x428
    x430 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x430 += einsum("ij,ikab->kjab", x429, t2.bbbb)
    del x429
    x441 -= einsum("ijab->ijba", x430)
    del x430
    ree2new_bbbb = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    ree2new_bbbb += einsum("ijab->ijab", x441)
    ree2new_bbbb -= einsum("ijab->ijba", x441)
    ree2new_bbbb -= einsum("ijab->jiab", x441)
    ree2new_bbbb += einsum("ijab->jiba", x441)
    del x441
    x501 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x501 += einsum("ia,ijka->jk", t1.bb, x427)
    del x427
    x502 -= einsum("ij->ij", x501)
    del x501
    x442 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x442 += einsum("ijab,cadb->ijcd", r2.bbbb, v.bbbb.vvvv)
    x498 += einsum("ijab->ijab", x442) * 0.5
    del x442
    x443 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x443 += einsum("ijab,kbla->ijlk", r2.bbbb, v.bbbb.ovov)
    x444 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x444 += einsum("ijab,klji->klba", t2.bbbb, x443)
    x498 += einsum("ijab->ijab", x444) * 0.5
    del x444
    x482 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x482 += einsum("ia,jkli->jkla", t1.bb, x443)
    del x443
    x484 += einsum("ijka->ijka", x482)
    del x482
    x485 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x485 += einsum("ia,jkib->jkab", t1.bb, x484) * 0.5
    del x484
    x498 += einsum("ijab->ijab", x485)
    del x485
    x445 += einsum("iabj->jiba", v.bbbb.ovvo)
    x445 += einsum("ijab->jiab", v.bbbb.oovv) * -1
    x446 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x446 += einsum("ijab,jkbc->kica", x445, x57) * 0.5
    del x57
    del x445
    x498 += einsum("ijab->ijab", x446)
    del x446
    x448 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x448 += einsum("ijab,kalb->ijkl", t2.bbbb, v.bbbb.ovov)
    x449 = np.zeros((nocc[1], nocc[1], nocc[1], nocc[1]), dtype=np.float64)
    x449 += einsum("ijkl->lkji", x448)
    x487 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x487 += einsum("ia,jkil->kjla", t1.bb, x448)
    del x448
    x488 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x488 += einsum("ijka->ijka", x487) * -1
    del x487
    x449 += einsum("ijkl->kilj", v.bbbb.oooo)
    x450 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x450 += einsum("ijab,jikl->klab", r2.bbbb, x449) * 0.5
    del x449
    x498 += einsum("ijab->jiab", x450)
    del x450
    x471 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x471 += einsum("ijab,jcid->abdc", r2.bbbb, v.bbbb.ovov)
    x472 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x472 += einsum("ia,bcda->ibcd", t1.bb, x471)
    del x471
    x474 += einsum("iabc->iabc", x472)
    del x472
    x475 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x475 += einsum("ia,jbca->ijbc", t1.bb, x474) * 0.5
    del x474
    x498 += einsum("ijab->ijab", x475)
    del x475
    x477 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x477 += einsum("ijab,jkic->kbac", t2.bbbb, v.bbbb.ooov)
    x480 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x480 += einsum("iabc->iabc", x477)
    del x477
    x478 = np.zeros((nvir[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x478 += einsum("ijab,icjd->abcd", t2.bbbb, v.bbbb.ovov)
    x479 = np.zeros((nocc[1], nvir[1], nvir[1], nvir[1]), dtype=np.float64)
    x479 += einsum("ia,bcad->icbd", t1.bb, x478)
    del x478
    x480 += einsum("iabc->iabc", x479) * -1
    del x479
    x481 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x481 += einsum("ia,jbca->ijbc", r1.bb, x480)
    del x480
    x498 += einsum("ijab->ijab", x481) * -1
    del x481
    x486 = np.zeros((nocc[1], nocc[1], nocc[1], nvir[1]), dtype=np.float64)
    x486 += einsum("ijab,kbca->jikc", t2.bbbb, v.bbbb.ovvv)
    x488 += einsum("ijka->ijka", x486)
    del x486
    x489 = np.zeros((nocc[1], nocc[1], nvir[1], nvir[1]), dtype=np.float64)
    x489 += einsum("ia,jkib->jkab", r1.bb, x488)
    del x488
    x498 += einsum("ijab->ijab", x489) * -1
    del x489
    ree2new_bbbb += einsum("ijab->ijab", x498)
    ree2new_bbbb += einsum("ijab->ijba", x498) * -1
    ree2new_bbbb += einsum("ijab->jiab", x498) * -1
    ree2new_bbbb += einsum("ijab->jiba", x498)
    del x498
    x499 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x499 += einsum("ab,ib->ia", f.bb.vv, t1.bb)
    x504 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x504 -= einsum("ia->ia", x499)
    del x499
    x500 = np.zeros((nocc[1], nocc[1]), dtype=np.float64)
    x500 += einsum("ia,ja->ij", f.bb.ov, t1.bb)
    x502 += einsum("ij->ij", x500)
    del x500
    x502 += einsum("ij->ij", f.bb.oo)
    x503 = np.zeros((nocc[1], nvir[1]), dtype=np.float64)
    x503 += einsum("ia,ij->ja", t1.bb, x502)
    del x502
    x504 += einsum("ia->ia", x503)
    del x503
    x504 -= einsum("ai->ia", f.bb.vo)
    ree2new_bbbb -= einsum("ia,jb->jiba", r1.bb, x504)
    ree2new_bbbb -= einsum("ia,jb->ijab", r1.bb, x504)
    ree2new_bbbb += einsum("ia,jb->ijba", r1.bb, x504)
    ree2new_bbbb += einsum("ia,jb->jiab", r1.bb, x504)
    del x504

    ree1new = SimpleNamespace(aa=ree1new_aaaa, ab=ree1new_abab, ba=ree1new_baba, bb=ree1new_bbbb)
    ree2new = SimpleNamespace(aaaa=ree2new_aaaaaaaa, aaab=ree2new_aaabaaab, aaba=ree2new_aabaaaba, aabb=ree2new_aabbaabb, abaa=ree2new_abaaabaa, abab=ree2new_abababab, abba=ree2new_abbaabba, abbb=ree2new_abbbabbb, baaa=ree2new_baaabaaa, baab=ree2new_baabbaab, baba=ree2new_babababa, babb=ree2new_babbbabb, bbaa=ree2new_bbaabbaa, bbab=ree2new_bbabbbab, bbba=ree2new_bbbabbba, bbbb=ree2new_bbbbbbbb)

    return ree1new, ree2new
