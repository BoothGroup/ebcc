Looping here
Occupied Ket state for EA moment (final index is perturbation index)
Total number of terms to simplify: 1
R0_0 += -1.0*einsum('ai->ai', T1)

Total number of terms to simplify: 12
R0_1 += 1.0*einsum('baji->abij', T2)

Total number of terms to simplify: 5
R0_2 += -1.0*einsum('Iai->Iai', U11)


Looping here
Virtual Ket state for EA moment (final index is perturbation index)
Total number of terms to simplify: 1
R0_0 += 1.0*einsum('ab->ab', delta)

Total number of terms to simplify: 4

Total number of terms to simplify: 2


Time to generate all ket states:  2.4877663031220436

Generating action of H-E on a single perturbation...
Applying wick theorem for space 1/3 and R-term 1/3...
Wick theorem applied in 65.84706486295909 sec
Total number of terms to simplify: 50
Simplifying terms took 0.046102217864245176 sec
Applying wick theorem for space 1/3 and R-term 2/3...
Wick theorem applied in 114.72946334676817 sec
Total number of terms to simplify: 18
Simplifying terms took 0.018313013948500156 sec
Applying wick theorem for space 1/3 and R-term 3/3...
Wick theorem applied in 73.99263798305765 sec
Total number of terms to simplify: 4
Simplifying terms took 0.0005706893280148506 sec
Total number of terms to simplify: 17
S_0 += 1.0*einsum('I,Ia->a', G, R3)
S_0 += 1.0*einsum('ab,b->a', F.vv, R1)
S_0 += 1.0*einsum('ib,abi->a', F.ov, R2)
S_0 += 1.0*einsum('Iab,Ib->a', g.vv, R3)
S_0 += 0.5*einsum('iabc,cbi->a', I.ovvv, R2)
S_0 += -1.0*einsum('ib,ai,b->a', F.ov, T1, R1)
S_0 += 1.0*einsum('Iab,I,b->a', g.vv, S1, R1)
S_0 += 1.0*einsum('Iib,I,abi->a', g.ov, S1, R2)
S_0 += -1.0*einsum('Iib,ai,Ib->a', g.ov, T1, R3)
S_0 += 1.0*einsum('Iib,bi,Ia->a', g.ov, T1, R3)
S_0 += -1.0*einsum('Iib,Iai,b->a', g.ov, U11, R1)
S_0 += -1.0*einsum('iabc,ci,b->a', I.ovvv, T1, R1)
S_0 += 0.5*einsum('ijbc,ai,cbj->a', I.oovv, T1, R2)
S_0 += -1.0*einsum('ijbc,ci,abj->a', I.oovv, T1, R2)
S_0 += 0.5*einsum('ijbc,acji,b->a', I.oovv, T2, R1)
S_0 += -1.0*einsum('Iib,ai,I,b->a', g.ov, T1, S1, R1)
S_0 += -1.0*einsum('ijbc,ai,cj,b->a', I.oovv, T1, T1, R1)

Applying wick theorem for space 2/3 and R-term 1/3...
Wick theorem applied in 1948.6634722910821 sec
Total number of terms to simplify: 834
Simplifying terms took 10.730891729239374 sec
Applying wick theorem for space 2/3 and R-term 2/3...
Wick theorem applied in 4269.460895779077 sec
Total number of terms to simplify: 484
Simplifying terms took 5.577659183181822 sec
Applying wick theorem for space 2/3 and R-term 3/3...
Wick theorem applied in 2077.9051183969714 sec
Total number of terms to simplify: 46
Simplifying terms took 0.04221349209547043 sec
Total number of terms to simplify: 124
S_1 += -1.0*einsum('ai,b->abi', F.vo, R1)
S_1 += 1.0*einsum('bi,a->abi', F.vo, R1)
S_1 += 1.0*einsum('ji,baj->abi', F.oo, R2)
S_1 += -1.0*einsum('ac,bci->abi', F.vv, R2)
S_1 += 1.0*einsum('bc,aci->abi', F.vv, R2)
S_1 += -1.0*einsum('Iai,Ib->abi', g.vo, R3)
S_1 += 1.0*einsum('Ibi,Ia->abi', g.vo, R3)
S_1 += 1.0*einsum('baic,c->abi', I.vvov, R1)
S_1 += 1.0*einsum('jaic,bcj->abi', I.ovov, R2)
S_1 += -1.0*einsum('jbic,acj->abi', I.ovov, R2)
S_1 += 0.5*einsum('bacd,dci->abi', I.vvvv, R2)
S_1 += -1.0*einsum('I,Iai,b->abi', G, U11, R1)
S_1 += 1.0*einsum('I,Ibi,a->abi', G, U11, R1)
S_1 += 1.0*einsum('ji,aj,b->abi', F.oo, T1, R1)
S_1 += -1.0*einsum('ji,bj,a->abi', F.oo, T1, R1)
S_1 += -1.0*einsum('ac,ci,b->abi', F.vv, T1, R1)
S_1 += 1.0*einsum('bc,ci,a->abi', F.vv, T1, R1)
S_1 += -1.0*einsum('Iai,I,b->abi', g.vo, S1, R1)
S_1 += 1.0*einsum('Ibi,I,a->abi', g.vo, S1, R1)
S_1 += 1.0*einsum('jc,aj,bci->abi', F.ov, T1, R2)
S_1 += -1.0*einsum('jc,bj,aci->abi', F.ov, T1, R2)
S_1 += 1.0*einsum('jc,ci,baj->abi', F.ov, T1, R2)
S_1 += 1.0*einsum('jc,acji,b->abi', F.ov, T2, R1)
S_1 += 1.0*einsum('jc,baji,c->abi', F.ov, T2, R1)
S_1 += -1.0*einsum('jc,bcji,a->abi', F.ov, T2, R1)
S_1 += 1.0*einsum('Iji,I,baj->abi', g.oo, S1, R2)
S_1 += 1.0*einsum('Iji,aj,Ib->abi', g.oo, T1, R3)
S_1 += -1.0*einsum('Iji,bj,Ia->abi', g.oo, T1, R3)
S_1 += 1.0*einsum('Iji,Iaj,b->abi', g.oo, U11, R1)
S_1 += -1.0*einsum('Iji,Ibj,a->abi', g.oo, U11, R1)
S_1 += -1.0*einsum('Iac,I,bci->abi', g.vv, S1, R2)
S_1 += -1.0*einsum('Iac,ci,Ib->abi', g.vv, T1, R3)
S_1 += 1.0*einsum('Iac,Ibi,c->abi', g.vv, U11, R1)
S_1 += -1.0*einsum('Iac,Ici,b->abi', g.vv, U11, R1)
S_1 += 1.0*einsum('Ibc,I,aci->abi', g.vv, S1, R2)
S_1 += 1.0*einsum('Ibc,ci,Ia->abi', g.vv, T1, R3)
S_1 += -1.0*einsum('Ibc,Iai,c->abi', g.vv, U11, R1)
S_1 += 1.0*einsum('Ibc,Ici,a->abi', g.vv, U11, R1)
S_1 += -1.0*einsum('jaic,bj,c->abi', I.ovov, T1, R1)
S_1 += 1.0*einsum('jaic,cj,b->abi', I.ovov, T1, R1)
S_1 += 1.0*einsum('jbic,aj,c->abi', I.ovov, T1, R1)
S_1 += -1.0*einsum('jbic,cj,a->abi', I.ovov, T1, R1)
S_1 += -1.0*einsum('bacd,di,c->abi', I.vvvv, T1, R1)
S_1 += -1.0*einsum('Ijc,Iai,bcj->abi', g.ov, U11, R2)
S_1 += 1.0*einsum('Ijc,Iaj,bci->abi', g.ov, U11, R2)
S_1 += 1.0*einsum('Ijc,Ibi,acj->abi', g.ov, U11, R2)
S_1 += -1.0*einsum('Ijc,Ibj,aci->abi', g.ov, U11, R2)
S_1 += 1.0*einsum('Ijc,Ici,baj->abi', g.ov, U11, R2)
S_1 += 1.0*einsum('Ijc,acji,Ib->abi', g.ov, T2, R3)
S_1 += 1.0*einsum('Ijc,baji,Ic->abi', g.ov, T2, R3)
S_1 += -1.0*einsum('Ijc,bcji,Ia->abi', g.ov, T2, R3)
S_1 += 1.0*einsum('jkic,aj,bck->abi', I.ooov, T1, R2)
S_1 += -1.0*einsum('jkic,bj,ack->abi', I.ooov, T1, R2)
S_1 += -1.0*einsum('jkic,cj,bak->abi', I.ooov, T1, R2)
S_1 += -0.5*einsum('jkic,ackj,b->abi', I.ooov, T2, R1)
S_1 += -0.5*einsum('jkic,bakj,c->abi', I.ooov, T2, R1)
S_1 += 0.5*einsum('jkic,bckj,a->abi', I.ooov, T2, R1)
S_1 += -0.5*einsum('jacd,bj,dci->abi', I.ovvv, T1, R2)
S_1 += -1.0*einsum('jacd,di,bcj->abi', I.ovvv, T1, R2)
S_1 += 1.0*einsum('jacd,dj,bci->abi', I.ovvv, T1, R2)
S_1 += 1.0*einsum('jacd,bdji,c->abi', I.ovvv, T2, R1)
S_1 += 0.5*einsum('jacd,dcji,b->abi', I.ovvv, T2, R1)
S_1 += 0.5*einsum('jbcd,aj,dci->abi', I.ovvv, T1, R2)
S_1 += 1.0*einsum('jbcd,di,acj->abi', I.ovvv, T1, R2)
S_1 += -1.0*einsum('jbcd,dj,aci->abi', I.ovvv, T1, R2)
S_1 += -1.0*einsum('jbcd,adji,c->abi', I.ovvv, T2, R1)
S_1 += -0.5*einsum('jbcd,dcji,a->abi', I.ovvv, T2, R1)
S_1 += -1.0*einsum('jkcd,adji,bck->abi', I.oovv, T2, R2)
S_1 += -0.5*einsum('jkcd,adkj,bci->abi', I.oovv, T2, R2)
S_1 += -0.5*einsum('jkcd,baji,dck->abi', I.oovv, T2, R2)
S_1 += -0.25*einsum('jkcd,bakj,dci->abi', I.oovv, T2, R2)
S_1 += 1.0*einsum('jkcd,bdji,ack->abi', I.oovv, T2, R2)
S_1 += 0.5*einsum('jkcd,bdkj,aci->abi', I.oovv, T2, R2)
S_1 += -0.5*einsum('jkcd,dcji,bak->abi', I.oovv, T2, R2)
S_1 += 1.0*einsum('jc,ci,aj,b->abi', F.ov, T1, T1, R1)
S_1 += -1.0*einsum('jc,ci,bj,a->abi', F.ov, T1, T1, R1)
S_1 += 1.0*einsum('Iji,aj,I,b->abi', g.oo, T1, S1, R1)
S_1 += -1.0*einsum('Iji,bj,I,a->abi', g.oo, T1, S1, R1)
S_1 += -1.0*einsum('Iac,ci,I,b->abi', g.vv, T1, S1, R1)
S_1 += 1.0*einsum('Ibc,ci,I,a->abi', g.vv, T1, S1, R1)
S_1 += 1.0*einsum('Ijc,aj,I,bci->abi', g.ov, T1, S1, R2)
S_1 += -1.0*einsum('Ijc,aj,Ibi,c->abi', g.ov, T1, U11, R1)
S_1 += 1.0*einsum('Ijc,aj,Ici,b->abi', g.ov, T1, U11, R1)
S_1 += -1.0*einsum('Ijc,bj,I,aci->abi', g.ov, T1, S1, R2)
S_1 += 1.0*einsum('Ijc,bj,Iai,c->abi', g.ov, T1, U11, R1)
S_1 += -1.0*einsum('Ijc,bj,Ici,a->abi', g.ov, T1, U11, R1)
S_1 += 1.0*einsum('Ijc,ci,I,baj->abi', g.ov, T1, S1, R2)
S_1 += 1.0*einsum('Ijc,ci,aj,Ib->abi', g.ov, T1, T1, R3)
S_1 += -1.0*einsum('Ijc,ci,bj,Ia->abi', g.ov, T1, T1, R3)
S_1 += 1.0*einsum('Ijc,ci,Iaj,b->abi', g.ov, T1, U11, R1)
S_1 += -1.0*einsum('Ijc,ci,Ibj,a->abi', g.ov, T1, U11, R1)
S_1 += -1.0*einsum('Ijc,cj,Iai,b->abi', g.ov, T1, U11, R1)
S_1 += 1.0*einsum('Ijc,cj,Ibi,a->abi', g.ov, T1, U11, R1)
S_1 += 1.0*einsum('Ijc,acji,I,b->abi', g.ov, T2, S1, R1)
S_1 += 1.0*einsum('Ijc,baji,I,c->abi', g.ov, T2, S1, R1)
S_1 += -1.0*einsum('Ijc,bcji,I,a->abi', g.ov, T2, S1, R1)
S_1 += 1.0*einsum('jkic,aj,ck,b->abi', I.ooov, T1, T1, R1)
S_1 += 1.0*einsum('jkic,bj,ak,c->abi', I.ooov, T1, T1, R1)
S_1 += -1.0*einsum('jkic,bj,ck,a->abi', I.ooov, T1, T1, R1)
S_1 += 1.0*einsum('jacd,di,bj,c->abi', I.ovvv, T1, T1, R1)
S_1 += -1.0*einsum('jacd,di,cj,b->abi', I.ovvv, T1, T1, R1)
S_1 += -1.0*einsum('jbcd,di,aj,c->abi', I.ovvv, T1, T1, R1)
S_1 += 1.0*einsum('jbcd,di,cj,a->abi', I.ovvv, T1, T1, R1)
S_1 += 1.0*einsum('jkcd,aj,dk,bci->abi', I.oovv, T1, T1, R2)
S_1 += 1.0*einsum('jkcd,aj,bdki,c->abi', I.oovv, T1, T2, R1)
S_1 += 0.5*einsum('jkcd,aj,dcki,b->abi', I.oovv, T1, T2, R1)
S_1 += 0.5*einsum('jkcd,bj,ak,dci->abi', I.oovv, T1, T1, R2)
S_1 += -1.0*einsum('jkcd,bj,dk,aci->abi', I.oovv, T1, T1, R2)
S_1 += -1.0*einsum('jkcd,bj,adki,c->abi', I.oovv, T1, T2, R1)
S_1 += -0.5*einsum('jkcd,bj,dcki,a->abi', I.oovv, T1, T2, R1)
S_1 += -1.0*einsum('jkcd,di,aj,bck->abi', I.oovv, T1, T1, R2)
S_1 += 1.0*einsum('jkcd,di,bj,ack->abi', I.oovv, T1, T1, R2)
S_1 += 1.0*einsum('jkcd,di,cj,bak->abi', I.oovv, T1, T1, R2)
S_1 += 0.5*einsum('jkcd,di,ackj,b->abi', I.oovv, T1, T2, R1)
S_1 += 0.5*einsum('jkcd,di,bakj,c->abi', I.oovv, T1, T2, R1)
S_1 += -0.5*einsum('jkcd,di,bckj,a->abi', I.oovv, T1, T2, R1)
S_1 += -1.0*einsum('jkcd,dj,acki,b->abi', I.oovv, T1, T2, R1)
S_1 += -1.0*einsum('jkcd,dj,baki,c->abi', I.oovv, T1, T2, R1)
S_1 += 1.0*einsum('jkcd,dj,bcki,a->abi', I.oovv, T1, T2, R1)
S_1 += 1.0*einsum('Ijc,ci,aj,I,b->abi', g.ov, T1, T1, S1, R1)
S_1 += -1.0*einsum('Ijc,ci,bj,I,a->abi', g.ov, T1, T1, S1, R1)
S_1 += -1.0*einsum('jkcd,di,aj,ck,b->abi', I.oovv, T1, T1, T1, R1)
S_1 += -1.0*einsum('jkcd,di,bj,ak,c->abi', I.oovv, T1, T1, T1, R1)
S_1 += 1.0*einsum('jkcd,di,bj,ck,a->abi', I.oovv, T1, T1, T1, R1)

Applying wick theorem for space 3/3 and R-term 1/3...
Wick theorem applied in 143.31227253284305 sec
Total number of terms to simplify: 215
Simplifying terms took 0.8744073892012239 sec
Applying wick theorem for space 3/3 and R-term 2/3...
Wick theorem applied in 243.0008322680369 sec
Total number of terms to simplify: 78
Simplifying terms took 0.11820876318961382 sec
Applying wick theorem for space 3/3 and R-term 3/3...
Wick theorem applied in 210.18264549272135 sec
Total number of terms to simplify: 65
Simplifying terms took 0.07027102122083306 sec
Total number of terms to simplify: 27
S_2 += 1.0*einsum('I,a->Ia', G, R1)
S_2 += 1.0*einsum('ab,Ib->Ia', F.vv, R3)
S_2 += 1.0*einsum('IJ,Ja->Ia', w, R3)
S_2 += 1.0*einsum('Iab,b->Ia', g_boscre.vv, R1)
S_2 += 1.0*einsum('Iib,abi->Ia', g_boscre.ov, R2)
S_2 += 1.0*einsum('IJ,J,a->Ia', w, S1, R1)
S_2 += -1.0*einsum('ib,ai,Ib->Ia', F.ov, T1, R3)
S_2 += -1.0*einsum('ib,Iai,b->Ia', F.ov, U11, R1)
S_2 += 1.0*einsum('ib,Ibi,a->Ia', F.ov, U11, R1)
S_2 += 1.0*einsum('Jab,J,Ib->Ia', g.vv, S1, R3)
S_2 += -1.0*einsum('Iib,ai,b->Ia', g_boscre.ov, T1, R1)
S_2 += 1.0*einsum('Iib,bi,a->Ia', g_boscre.ov, T1, R1)
S_2 += -1.0*einsum('Jib,Iai,Jb->Ia', g.ov, U11, R3)
S_2 += 1.0*einsum('Jib,Ibi,Ja->Ia', g.ov, U11, R3)
S_2 += -1.0*einsum('Jib,Jai,Ib->Ia', g.ov, U11, R3)
S_2 += -1.0*einsum('iabc,ci,Ib->Ia', I.ovvv, T1, R3)
S_2 += -1.0*einsum('iabc,Ici,b->Ia', I.ovvv, U11, R1)
S_2 += 0.5*einsum('ijbc,Iai,cbj->Ia', I.oovv, U11, R2)
S_2 += -1.0*einsum('ijbc,Ici,abj->Ia', I.oovv, U11, R2)
S_2 += 0.5*einsum('ijbc,acji,Ib->Ia', I.oovv, T2, R3)
S_2 += -1.0*einsum('Jib,J,Iai,b->Ia', g.ov, S1, U11, R1)
S_2 += 1.0*einsum('Jib,J,Ibi,a->Ia', g.ov, S1, U11, R1)
S_2 += -1.0*einsum('Jib,ai,J,Ib->Ia', g.ov, T1, S1, R3)
S_2 += -1.0*einsum('ijbc,ai,cj,Ib->Ia', I.oovv, T1, T1, R3)
S_2 += -1.0*einsum('ijbc,ai,Icj,b->Ia', I.oovv, T1, U11, R1)
S_2 += 1.0*einsum('ijbc,ci,Iaj,b->Ia', I.oovv, T1, U11, R1)
S_2 += -1.0*einsum('ijbc,ci,Ibj,a->Ia', I.oovv, T1, U11, R1)


Finding bra expression...(first index is operator index)
Occupied Bra state for EA moment (first index is perturbation index)
Total number of terms to simplify: 11
E_bra_0 += -1.0*einsum('ia->ia', L1)

Total number of terms to simplify: 4
E_bra_1 += 1.0*einsum('ijab->ijba', L2)

Total number of terms to simplify: 0


Virtual Bra state for EA moment (first index is perturbation index)
Total number of terms to simplify: 69
E_bra_0 += 1.0*einsum('ab->ab', delta)
E_bra_0 += -1.0*einsum('ia,bi->ba', L1, T1)
E_bra_0 += -1.0*einsum('Iia,Ibi->ba', LU11old, U11)
E_bra_0 += -0.5*einsum('ijab,bcji->ca', L2, T2)

Total number of terms to simplify: 26
E_bra_1 += -1.0*einsum('ia,bc->biac', L1, delta)
E_bra_1 += 1.0*einsum('ia,bc->bica', L1, delta)
E_bra_1 += 1.0*einsum('ijab,ci->cjba', L2, T1)

Total number of terms to simplify: 0


