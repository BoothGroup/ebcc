Energy expression: 
E += 1.0*einsum('I,I->', G, S1old)
E += 1.0*einsum('ia,ai->', F, T1old)
E += 1.0*einsum('Iia,Iai->', g, U11old)
E += 0.25*einsum('ijab,baji->', I, T2old)
E += 1.0*einsum('Iia,ai,I->', g, T1old, S1old)
E += -0.5*einsum('ijab,bi,aj->', I, T1old, T1old)
*******
T1 += 1.0*einsum('ai->ai', F)
T1 += 1.0*einsum('I,Iai->ai', G, U11old)
T1 += -1.0*einsum('ji,aj->ai', F, T1old)
T1 += 1.0*einsum('ab,bi->ai', F, T1old)
T1 += 1.0*einsum('Iai,I->ai', g, S1old)
T1 += -1.0*einsum('jb,abji->ai', F, T2old)
T1 += -1.0*einsum('Iji,Iaj->ai', g, U11old)
T1 += 1.0*einsum('Iab,Ibi->ai', g, U11old)
T1 += -1.0*einsum('jaib,bj->ai', I, T1old)
T1 += 0.5*einsum('jkib,abkj->ai', I, T2old)
T1 += -0.5*einsum('jabc,cbji->ai', I, T2old)
T1 += -1.0*einsum('jb,bi,aj->ai', F, T1old, T1old)
T1 += -1.0*einsum('Iji,aj,I->ai', g, T1old, S1old)
T1 += 1.0*einsum('Iab,bi,I->ai', g, T1old, S1old)
T1 += -1.0*einsum('Ijb,aj,Ibi->ai', g, T1old, U11old)
T1 += -1.0*einsum('Ijb,bi,Iaj->ai', g, T1old, U11old)
T1 += 1.0*einsum('Ijb,bj,Iai->ai', g, T1old, U11old)
T1 += -1.0*einsum('Ijb,abji,I->ai', g, T2old, S1old)
T1 += -1.0*einsum('jkib,aj,bk->ai', I, T1old, T1old)
T1 += 1.0*einsum('jabc,ci,bj->ai', I, T1old, T1old)
T1 += -0.5*einsum('jkbc,aj,cbki->ai', I, T1old, T2old)
T1 += -0.5*einsum('jkbc,ci,abkj->ai', I, T1old, T2old)
T1 += 1.0*einsum('jkbc,cj,abki->ai', I, T1old, T2old)
T1 += -1.0*einsum('Ijb,bi,aj,I->ai', g, T1old, T1old, S1old)
T1 += 1.0*einsum('jkbc,ci,aj,bk->ai', I, T1old, T1old, T1old)
*******
T2 += 1.0*einsum('baji->abij', I)
T2 += 1.0*einsum('ki,bakj->abij', F, T2old)
T2 += -1.0*einsum('kj,baki->abij', F, T2old)
T2 += 1.0*einsum('ac,bcji->abij', F, T2old)
T2 += -1.0*einsum('bc,acji->abij', F, T2old)
T2 += 1.0*einsum('Iai,Ibj->abij', g, U11old)
T2 += -1.0*einsum('Iaj,Ibi->abij', g, U11old)
T2 += -1.0*einsum('Ibi,Iaj->abij', g, U11old)
T2 += 1.0*einsum('Ibj,Iai->abij', g, U11old)
T2 += -1.0*einsum('kaji,bk->abij', I, T1old)
T2 += 1.0*einsum('kbji,ak->abij', I, T1old)
T2 += -1.0*einsum('baic,cj->abij', I, T1old)
T2 += 1.0*einsum('bajc,ci->abij', I, T1old)
T2 += -0.5*einsum('klji,balk->abij', I, T2old)
T2 += 1.0*einsum('kaic,bckj->abij', I, T2old)
T2 += -1.0*einsum('kajc,bcki->abij', I, T2old)
T2 += -1.0*einsum('kbic,ackj->abij', I, T2old)
T2 += 1.0*einsum('kbjc,acki->abij', I, T2old)
T2 += -0.5*einsum('bacd,dcji->abij', I, T2old)
T2 += -1.0*einsum('kc,ak,bcji->abij', F, T1old, T2old)
T2 += 1.0*einsum('kc,bk,acji->abij', F, T1old, T2old)
T2 += 1.0*einsum('kc,ci,bakj->abij', F, T1old, T2old)
T2 += -1.0*einsum('kc,cj,baki->abij', F, T1old, T2old)
T2 += -1.0*einsum('Iki,ak,Ibj->abij', g, T1old, U11old)
T2 += 1.0*einsum('Iki,bk,Iaj->abij', g, T1old, U11old)
T2 += 1.0*einsum('Iki,bakj,I->abij', g, T2old, S1old)
T2 += 1.0*einsum('Ikj,ak,Ibi->abij', g, T1old, U11old)
T2 += -1.0*einsum('Ikj,bk,Iai->abij', g, T1old, U11old)
T2 += -1.0*einsum('Ikj,baki,I->abij', g, T2old, S1old)
T2 += 1.0*einsum('Iac,ci,Ibj->abij', g, T1old, U11old)
T2 += -1.0*einsum('Iac,cj,Ibi->abij', g, T1old, U11old)
T2 += 1.0*einsum('Iac,bcji,I->abij', g, T2old, S1old)
T2 += -1.0*einsum('Ibc,ci,Iaj->abij', g, T1old, U11old)
T2 += 1.0*einsum('Ibc,cj,Iai->abij', g, T1old, U11old)
T2 += -1.0*einsum('Ibc,acji,I->abij', g, T2old, S1old)
T2 += 1.0*einsum('klji,bk,al->abij', I, T1old, T1old)
T2 += 1.0*einsum('kaic,cj,bk->abij', I, T1old, T1old)
T2 += -1.0*einsum('kajc,ci,bk->abij', I, T1old, T1old)
T2 += -1.0*einsum('kbic,cj,ak->abij', I, T1old, T1old)
T2 += 1.0*einsum('kbjc,ci,ak->abij', I, T1old, T1old)
T2 += 1.0*einsum('bacd,di,cj->abij', I, T1old, T1old)
T2 += 1.0*einsum('Ikc,acji,Ibk->abij', g, T2old, U11old)
T2 += -1.0*einsum('Ikc,acki,Ibj->abij', g, T2old, U11old)
T2 += 1.0*einsum('Ikc,ackj,Ibi->abij', g, T2old, U11old)
T2 += -1.0*einsum('Ikc,baki,Icj->abij', g, T2old, U11old)
T2 += 1.0*einsum('Ikc,bakj,Ici->abij', g, T2old, U11old)
T2 += -1.0*einsum('Ikc,bcji,Iak->abij', g, T2old, U11old)
T2 += 1.0*einsum('Ikc,bcki,Iaj->abij', g, T2old, U11old)
T2 += -1.0*einsum('Ikc,bckj,Iai->abij', g, T2old, U11old)
T2 += 1.0*einsum('klic,ak,bclj->abij', I, T1old, T2old)
T2 += -1.0*einsum('klic,bk,aclj->abij', I, T1old, T2old)
T2 += 0.5*einsum('klic,cj,balk->abij', I, T1old, T2old)
T2 += -1.0*einsum('klic,ck,balj->abij', I, T1old, T2old)
T2 += -1.0*einsum('kljc,ak,bcli->abij', I, T1old, T2old)
T2 += 1.0*einsum('kljc,bk,acli->abij', I, T1old, T2old)
T2 += -0.5*einsum('kljc,ci,balk->abij', I, T1old, T2old)
T2 += 1.0*einsum('kljc,ck,bali->abij', I, T1old, T2old)
T2 += 0.5*einsum('kacd,bk,dcji->abij', I, T1old, T2old)
T2 += -1.0*einsum('kacd,di,bckj->abij', I, T1old, T2old)
T2 += 1.0*einsum('kacd,dj,bcki->abij', I, T1old, T2old)
T2 += -1.0*einsum('kacd,dk,bcji->abij', I, T1old, T2old)
T2 += -0.5*einsum('kbcd,ak,dcji->abij', I, T1old, T2old)
T2 += 1.0*einsum('kbcd,di,ackj->abij', I, T1old, T2old)
T2 += -1.0*einsum('kbcd,dj,acki->abij', I, T1old, T2old)
T2 += 1.0*einsum('kbcd,dk,acji->abij', I, T1old, T2old)
T2 += 0.5*einsum('klcd,adji,bclk->abij', I, T2old, T2old)
T2 += -1.0*einsum('klcd,adki,bclj->abij', I, T2old, T2old)
T2 += -0.5*einsum('klcd,baki,dclj->abij', I, T2old, T2old)
T2 += -0.5*einsum('klcd,bdji,aclk->abij', I, T2old, T2old)
T2 += 1.0*einsum('klcd,bdki,aclj->abij', I, T2old, T2old)
T2 += 0.25*einsum('klcd,dcji,balk->abij', I, T2old, T2old)
T2 += -0.5*einsum('klcd,dcki,balj->abij', I, T2old, T2old)
T2 += -1.0*einsum('Ikc,ak,bcji,I->abij', g, T1old, T2old, S1old)
T2 += 1.0*einsum('Ikc,bk,acji,I->abij', g, T1old, T2old, S1old)
T2 += -1.0*einsum('Ikc,ci,ak,Ibj->abij', g, T1old, T1old, U11old)
T2 += 1.0*einsum('Ikc,ci,bk,Iaj->abij', g, T1old, T1old, U11old)
T2 += 1.0*einsum('Ikc,ci,bakj,I->abij', g, T1old, T2old, S1old)
T2 += 1.0*einsum('Ikc,cj,ak,Ibi->abij', g, T1old, T1old, U11old)
T2 += -1.0*einsum('Ikc,cj,bk,Iai->abij', g, T1old, T1old, U11old)
T2 += -1.0*einsum('Ikc,cj,baki,I->abij', g, T1old, T2old, S1old)
T2 += -1.0*einsum('klic,cj,bk,al->abij', I, T1old, T1old, T1old)
T2 += 1.0*einsum('kljc,ci,bk,al->abij', I, T1old, T1old, T1old)
T2 += -1.0*einsum('kacd,di,cj,bk->abij', I, T1old, T1old, T1old)
T2 += 1.0*einsum('kbcd,di,cj,ak->abij', I, T1old, T1old, T1old)
T2 += -1.0*einsum('klcd,ak,dl,bcji->abij', I, T1old, T1old, T2old)
T2 += -0.5*einsum('klcd,bk,al,dcji->abij', I, T1old, T1old, T2old)
T2 += 1.0*einsum('klcd,bk,dl,acji->abij', I, T1old, T1old, T2old)
T2 += -1.0*einsum('klcd,di,ak,bclj->abij', I, T1old, T1old, T2old)
T2 += 1.0*einsum('klcd,di,bk,aclj->abij', I, T1old, T1old, T2old)
T2 += -0.5*einsum('klcd,di,cj,balk->abij', I, T1old, T1old, T2old)
T2 += 1.0*einsum('klcd,di,ck,balj->abij', I, T1old, T1old, T2old)
T2 += 1.0*einsum('klcd,dj,ak,bcli->abij', I, T1old, T1old, T2old)
T2 += -1.0*einsum('klcd,dj,bk,acli->abij', I, T1old, T1old, T2old)
T2 += -1.0*einsum('klcd,dj,ck,bali->abij', I, T1old, T1old, T2old)
T2 += 1.0*einsum('klcd,di,cj,bk,al->abij', I, T1old, T1old, T1old, T1old)
*******
S1 += 1.0*einsum('I->I', G)
S1 += 1.0*einsum('J,IJ->I', G, S2old)
S1 += 1.0*einsum('IJ,J->I', w, S1old)
S1 += 1.0*einsum('ia,Iai->I', F, U11old)
S1 += 1.0*einsum('Iia,ai->I', g, T1old)
S1 += 1.0*einsum('Jia,IJai->I', g, U12old)
S1 += 1.0*einsum('Jia,J,Iai->I', g, S1old, U11old)
S1 += 1.0*einsum('Jia,ai,IJ->I', g, T1old, S2old)
S1 += -1.0*einsum('ijab,bi,Iaj->I', I, T1old, U11old)
*******
S2 += 1.0*einsum('IK,JK->IJ', w, S2old)
S2 += 1.0*einsum('JK,IK->IJ', w, S2old)
S2 += 1.0*einsum('ia,IJai->IJ', F, U12old)
S2 += 1.0*einsum('Iia,Jai->IJ', g, U11old)
S2 += 1.0*einsum('Jia,Iai->IJ', g, U11old)
S2 += 1.0*einsum('Kia,K,IJai->IJ', g, S1old, U12old)
S2 += 1.0*einsum('Kia,IK,Jai->IJ', g, S2old, U11old)
S2 += 1.0*einsum('Kia,JK,Iai->IJ', g, S2old, U11old)
S2 += -1.0*einsum('ijab,bi,IJaj->IJ', I, T1old, U12old)
S2 += -1.0*einsum('ijab,Ibi,Jaj->IJ', I, U11old, U11old)
*******
U11 += 1.0*einsum('Iai->Iai', g)
U11 += 1.0*einsum('J,IJai->Iai', G, U12old)
U11 += -1.0*einsum('ji,Iaj->Iai', F, U11old)
U11 += 1.0*einsum('ab,Ibi->Iai', F, U11old)
U11 += 1.0*einsum('IJ,Jai->Iai', w, U11old)
U11 += -1.0*einsum('Iji,aj->Iai', g, T1old)
U11 += 1.0*einsum('Iab,bi->Iai', g, T1old)
U11 += 1.0*einsum('Jai,IJ->Iai', g, S2old)
U11 += -1.0*einsum('Ijb,abji->Iai', g, T2old)
U11 += -1.0*einsum('Jji,IJaj->Iai', g, U12old)
U11 += 1.0*einsum('Jab,IJbi->Iai', g, U12old)
U11 += -1.0*einsum('jaib,Ibj->Iai', I, U11old)
U11 += -1.0*einsum('jb,aj,Ibi->Iai', F, T1old, U11old)
U11 += -1.0*einsum('jb,bi,Iaj->Iai', F, T1old, U11old)
U11 += -1.0*einsum('Ijb,bi,aj->Iai', g, T1old, T1old)
U11 += -1.0*einsum('Jji,J,Iaj->Iai', g, S1old, U11old)
U11 += -1.0*einsum('Jji,aj,IJ->Iai', g, T1old, S2old)
U11 += 1.0*einsum('Jab,J,Ibi->Iai', g, S1old, U11old)
U11 += 1.0*einsum('Jab,bi,IJ->Iai', g, T1old, S2old)
U11 += -1.0*einsum('Jjb,aj,IJbi->Iai', g, T1old, U12old)
U11 += -1.0*einsum('Jjb,bi,IJaj->Iai', g, T1old, U12old)
U11 += 1.0*einsum('Jjb,bj,IJai->Iai', g, T1old, U12old)
U11 += -1.0*einsum('Jjb,Iaj,Jbi->Iai', g, U11old, U11old)
U11 += -1.0*einsum('Jjb,Ibi,Jaj->Iai', g, U11old, U11old)
U11 += 1.0*einsum('Jjb,Ibj,Jai->Iai', g, U11old, U11old)
U11 += -1.0*einsum('Jjb,abji,IJ->Iai', g, T2old, S2old)
U11 += -1.0*einsum('jkib,aj,Ibk->Iai', I, T1old, U11old)
U11 += 1.0*einsum('jkib,bj,Iak->Iai', I, T1old, U11old)
U11 += 1.0*einsum('jabc,ci,Ibj->Iai', I, T1old, U11old)
U11 += -1.0*einsum('jabc,cj,Ibi->Iai', I, T1old, U11old)
U11 += 1.0*einsum('jkbc,acji,Ibk->Iai', I, T2old, U11old)
U11 += 0.5*einsum('jkbc,ackj,Ibi->Iai', I, T2old, U11old)
U11 += 0.5*einsum('jkbc,cbji,Iak->Iai', I, T2old, U11old)
U11 += -1.0*einsum('Jjb,aj,J,Ibi->Iai', g, T1old, S1old, U11old)
U11 += -1.0*einsum('Jjb,bi,J,Iaj->Iai', g, T1old, S1old, U11old)
U11 += -1.0*einsum('Jjb,bi,aj,IJ->Iai', g, T1old, T1old, S2old)
U11 += -1.0*einsum('jkbc,aj,ck,Ibi->Iai', I, T1old, T1old, U11old)
U11 += 1.0*einsum('jkbc,ci,aj,Ibk->Iai', I, T1old, T1old, U11old)
U11 += -1.0*einsum('jkbc,ci,bj,Iak->Iai', I, T1old, T1old, U11old)
*******
U12 += -1.0*einsum('ji,IJaj->IJai', F, U12old)
U12 += 1.0*einsum('ab,IJbi->IJai', F, U12old)
U12 += 1.0*einsum('IK,JKai->IJai', w, U12old)
U12 += 1.0*einsum('JK,IKai->IJai', w, U12old)
U12 += -1.0*einsum('Iji,Jaj->IJai', g, U11old)
U12 += 1.0*einsum('Iab,Jbi->IJai', g, U11old)
U12 += -1.0*einsum('Jji,Iaj->IJai', g, U11old)
U12 += 1.0*einsum('Jab,Ibi->IJai', g, U11old)
U12 += -1.0*einsum('jaib,IJbj->IJai', I, U12old)
U12 += -1.0*einsum('jb,aj,IJbi->IJai', F, T1old, U12old)
U12 += -1.0*einsum('jb,bi,IJaj->IJai', F, T1old, U12old)
U12 += -1.0*einsum('jb,Iaj,Jbi->IJai', F, U11old, U11old)
U12 += -1.0*einsum('jb,Ibi,Jaj->IJai', F, U11old, U11old)
U12 += -1.0*einsum('Ijb,aj,Jbi->IJai', g, T1old, U11old)
U12 += -1.0*einsum('Ijb,bi,Jaj->IJai', g, T1old, U11old)
U12 += -1.0*einsum('Jjb,aj,Ibi->IJai', g, T1old, U11old)
U12 += -1.0*einsum('Jjb,bi,Iaj->IJai', g, T1old, U11old)
U12 += -1.0*einsum('Kji,K,IJaj->IJai', g, S1old, U12old)
U12 += -1.0*einsum('Kji,IK,Jaj->IJai', g, S2old, U11old)
U12 += -1.0*einsum('Kji,JK,Iaj->IJai', g, S2old, U11old)
U12 += 1.0*einsum('Kab,K,IJbi->IJai', g, S1old, U12old)
U12 += 1.0*einsum('Kab,IK,Jbi->IJai', g, S2old, U11old)
U12 += 1.0*einsum('Kab,JK,Ibi->IJai', g, S2old, U11old)
U12 += -1.0*einsum('Kjb,Iaj,JKbi->IJai', g, U11old, U12old)
U12 += -1.0*einsum('Kjb,Ibi,JKaj->IJai', g, U11old, U12old)
U12 += 1.0*einsum('Kjb,Ibj,JKai->IJai', g, U11old, U12old)
U12 += -1.0*einsum('Kjb,Jaj,IKbi->IJai', g, U11old, U12old)
U12 += -1.0*einsum('Kjb,Jbi,IKaj->IJai', g, U11old, U12old)
U12 += 1.0*einsum('Kjb,Jbj,IKai->IJai', g, U11old, U12old)
U12 += 1.0*einsum('Kjb,Kai,IJbj->IJai', g, U11old, U12old)
U12 += -1.0*einsum('Kjb,Kaj,IJbi->IJai', g, U11old, U12old)
U12 += -1.0*einsum('Kjb,Kbi,IJaj->IJai', g, U11old, U12old)
U12 += -1.0*einsum('jkib,aj,IJbk->IJai', I, T1old, U12old)
U12 += 1.0*einsum('jkib,bj,IJak->IJai', I, T1old, U12old)
U12 += -1.0*einsum('jkib,Iaj,Jbk->IJai', I, U11old, U11old)
U12 += 1.0*einsum('jkib,Ibj,Jak->IJai', I, U11old, U11old)
U12 += 1.0*einsum('jabc,ci,IJbj->IJai', I, T1old, U12old)
U12 += -1.0*einsum('jabc,cj,IJbi->IJai', I, T1old, U12old)
U12 += 1.0*einsum('jabc,Ici,Jbj->IJai', I, U11old, U11old)
U12 += -1.0*einsum('jabc,Icj,Jbi->IJai', I, U11old, U11old)
U12 += 1.0*einsum('jkbc,acji,IJbk->IJai', I, T2old, U12old)
U12 += 0.5*einsum('jkbc,ackj,IJbi->IJai', I, T2old, U12old)
U12 += 0.5*einsum('jkbc,cbji,IJak->IJai', I, T2old, U12old)
U12 += -1.0*einsum('Kjb,K,Iaj,Jbi->IJai', g, S1old, U11old, U11old)
U12 += -1.0*einsum('Kjb,K,Ibi,Jaj->IJai', g, S1old, U11old, U11old)
U12 += -1.0*einsum('Kjb,aj,K,IJbi->IJai', g, T1old, S1old, U12old)
U12 += -1.0*einsum('Kjb,aj,IK,Jbi->IJai', g, T1old, S2old, U11old)
U12 += -1.0*einsum('Kjb,aj,JK,Ibi->IJai', g, T1old, S2old, U11old)
U12 += -1.0*einsum('Kjb,bi,K,IJaj->IJai', g, T1old, S1old, U12old)
U12 += -1.0*einsum('Kjb,bi,IK,Jaj->IJai', g, T1old, S2old, U11old)
U12 += -1.0*einsum('Kjb,bi,JK,Iaj->IJai', g, T1old, S2old, U11old)
U12 += -1.0*einsum('jkbc,aj,ck,IJbi->IJai', I, T1old, T1old, U12old)
U12 += 1.0*einsum('jkbc,aj,Ici,Jbk->IJai', I, T1old, U11old, U11old)
U12 += -1.0*einsum('jkbc,aj,Ick,Jbi->IJai', I, T1old, U11old, U11old)
U12 += 1.0*einsum('jkbc,ci,aj,IJbk->IJai', I, T1old, T1old, U12old)
U12 += -1.0*einsum('jkbc,ci,bj,IJak->IJai', I, T1old, T1old, U12old)
U12 += 1.0*einsum('jkbc,ci,Iaj,Jbk->IJai', I, T1old, U11old, U11old)
U12 += -1.0*einsum('jkbc,ci,Ibj,Jak->IJai', I, T1old, U11old, U11old)
U12 += 1.0*einsum('jkbc,cj,Iak,Jbi->IJai', I, T1old, U11old, U11old)
U12 += 1.0*einsum('jkbc,cj,Ibi,Jak->IJai', I, T1old, U11old, U11old)
*******
